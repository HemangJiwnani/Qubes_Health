import csv
from fastapi import FastAPI, File, UploadFile, Form
from pydantic import BaseModel
import requests
import glob
import re 
import copy
import json
from fuzzywuzzy import fuzz
from fuzzywuzzy import process
from mangum import Mangum

def change_resolution(input_image_path, output_image_path, basewidth, baseheight):
    image = cv2.imread(input_image_path, 1)
    resized_image = cv2.resize(image, (basewidth, baseheight))
    cv2.imwrite(output_image_path, resized_image)

def geti(text_j):
    return text_j.get("text")

def getb(text_j):
    return text_j.get("boundingBox")
def run(text_json):
    # for i in range(len(text_json)):
    #     print(text_json[i].get('text'))
    #     print(text_json[i].get('boundingBox'))
    #     print("######################")

    # hospital = "Ananthapuri"

    global Description_bb, gross_bb
    table_identfier = {
        "Amount": ["Amt", "AMT","Amount","Net Amt.", "Gross Amt", "Net Amt", "Pat Amt", "Payer Amt", "Net Art", "Charges",
                   "Gross Amount", "Net Amount", "Total Amount", "Total", "Amount Per Day", "RefTariff", "Price",
                   "Gross Amt.", "AMOUNT", "Amount (Rs . )", "Amount(c)", "Charges(Rs)", "Payer Art.", "Amount(Rs.)",
                   "Gross Am", "Gross Amo", "Gross Amt .", "Net Amount({)", "Amount (Rs)", "Service Amount",
                   "Net Amount", "Amount(?", "Amount(()", "Amount[)", "Amount(@", "Amount(7)",
                   "Not Amount", "Amount[()", "Gross Amu .", ". Service Amount", "Debit(Rs)", "Debit(Rs", "Amount(<)",
                   "Amount()", "Amount (Rs )", "Net Amount(<)", "Amount(?)", "Net Amountit", "Net Amount(?)","Amount[t",
                   "Amount(c", "`AMOUNT","moun","Amout","OF EXPENSESS","OF EXPENSES","Net Final Gross Amount"
                   ,"Net Gross Amount","MOUNT","Net Amount(7)","Net Amountto)","Net Amount(()","Amount[?)","Net Amount()"
                   ,"Amount(Rs.) .","Amount(Rs.)","Amount(Rs. )","Amount[ BL.","Pat Ami","Amount( )","Patient Amount"
                    ,"Company Amount","Amount (Rs.)","Amount (As. ]","Amount( Rs.)","Amount[Rs.)","VatAmt","- Net Amount"
                   ,"Service Amoun","NCL Amount","Amount (Rs. )","Amount [ Rs.)","Amount(Rs. )","Amount<","Patient Amt",
                   "Patient Art","Gross Art","Net Art.","Payer Art","Gross. Amt","Amount ( Rs)","Amount ( Rs )","Company Amt"
                   ,"Package Amt","Amount ?)","Amouni()","Am antic","AMOUNT(In RS.)","AMOUNT (In Rs.)","AMOUNT(In. Rs.)"],
        "Quantity": ["Qty", "Quantity", "Oty", "Qty/Duration","Addl Conc","Policy Conc","Qty Service Amount Contractual"],
        "Particular": ["Particular", "Particulars","articulars", "Description", "Service", "Service Name","Services", "S No Particulars",
                       "Following is the Break Up of Bill:","Description of Healthcare Services","Following is the Break Up of Bill :"
                     , "Summary of Transactions","Billing Group Name","Particular's","PTION","DESCRIPTION","Sarvice Name"
                       ,"Service Home","Service Nam","Item Name","Service Group Name","Description of Healthcare Services.",
                       "e Name","PARTICULARS","Package Name","tem","item","service Head","Service Head","Item","DESCRIPTION",
                       "SCRIPTION"],
        "Rate": ["Rate", "VAT", "Vat", "GST", "Gst","Tax","TaxAmt"],
        "SNo": ["S.No.", "S#", "S No", "SI. No", "SL.", "S.No", "SI.NO.", "SI#", "SI #", "S . NO .", "S . No.",
                "S. No .", "SL.NO.", "L.NO.", "5.No .", "SI.No.", "S", "SI. NO", "$1. No", "S . No", "'S . NO.",
                "S . NO.", "SI. No.","SR.NO","S.NO","S.NO.","SI NO","81. No","ST. NO","51.No.","1.No.","Charge Head","ST,NO."
                ,"SING.","SI,No.","5#","S. NO.","St.No.",".No.","SINO.","NO."],
        "Date": ["Date", "Dt", "Dtd", "Start Date", "End Date", "Doc Date","Hrs/Time","Hrs/Time]","Package Date"],
        "Discount": ["Discount", "Disc", "Conc", "Disc Amt", "Credits(Rs.)", "Ohcount", "iscount","Contractual Discount"
                     ,"Dlicount","Disc Art","Disc Ami"],
        # "Doctor": ["Doctor", "Dr. Name", "Dr Name"],
        "Code": ["Code", "Alias Code","ode", "HSN/SAC", "HSN/SA","ISN/SAC", "Charge Code","Primary Cod", "Charge Cod",
                 "AC No", "Primary Code","CODE","Accession No HSN Code Batch No Expiry Date","Package Code"],
        "Lab": ["Test Name", "Result", "Normal Value", "Unit", "Batch/Expiry"],
        "No": ["Doc No", "No.","Ref . No .","Ref. No.","No of Days"],
        "combined": ["Gross Amt Conc", "Particulars Gross Amt.", "Particulars Cross Amt.", "SL.NO. . Primary Code",
                     "S.No Particulars", "SL.NO PARTICULARS", "I No. Service Name", "SI No. Service Name",
                     "S No Particulars", "S . No . Particulars", "S. No . Particulars", "S. No . Particular"
            , "S . No. Particulars","Sr.No. Service Name","SNo. Service Name","L.NO. Primary Code","Gross Amt Con"
                     ,"SI.No Service Group Name","S . No . Particular","S, No . Particulars","Net Amt. Patient Amt",
                     "Net Amt. . Patient Amt","S. No. Particulars",'Unit Price']
    }

    table_end = {
        "Total": ["Deposit", "Total : MATH", "Total :","TOTAL", "Total : MA", "Surcharge Amt :", "Total Rs :", "Grand Total :",
                  "Total", ":Total", "ToCOL", "Sub Total", "AMOUNT", "Total Bill Amount", "Totai Bill Amount",
                  "Total ;","TOTAL TAX :", "total", "Totai Bili Amount", "Service Total :", "TOTAL AMOUNT :", "TOTAL AMOUNT ;"
                  ,"Grand Total","@ Grand Total ;","Grand Total t","Gross Amount :","TOTAL AMOUNT","Total 8ill Amount"
                  ,"Total Bill Amour","Net Amount","Total Bill Amt :","Grass Total","Total Bill Amount:","Total Bill Amount: .",
                  "al Bill Amount:","TOTAL BILL"],
        "Bill": ["Bill Not Settled", "Bill Settled", "Bill Total Gross Total", "Bill Total", "ISTITUTE", "BILL AMOUNT:"
            , "BILL AMOUNT :", "- -", "Total Interim Bill Amount Till Date", "Slip No.", "Slip No", "Total Amount :"
                 ,"Bill Amount","BILL AMOUNT :","BILL AMOUNT","BILLING DEPARTMENT","BILL AMOUNT .","Net Bill Amount:"],
        "others": ["I.C. NO..", "Toenterology", "Item Level Service Tax(Rs.)", "To Pay",
                   "Total Interim BillAmount After MOU Discount Till Date", "Patient Receipts:",
                   "Less Non Medical Amount Paid By Patient","TOTAL BILL AMOUNT",
                   "Total Interim Bill Amount After MOU Discount Till Date","Gross Total :","Net Payable :"]
    }
    item_list=[]
    table_keys = table_identfier.keys()
    table_list = []
    table_end_keys = table_end.keys()
    table_list_end = []

    for key in table_keys:
        table_list.extend(table_identfier[key])

    for key1 in table_end_keys:
        table_list_end.extend(table_end[key1])

    table_list = [x.upper() for x in table_list]
    print(table_list)
    table_identified = False

    headers_present = []
    headers_present_bb = []

    i = 0
    while i < len(text_json) - 2:
        if geti(text_json[i]).upper() in table_list:
            # print(geti(text_json[i]))
            print('i=', geti(text_json[i]))
            print('i+1-', geti(text_json[i + 1]))
            if geti(text_json[i + 1]).upper() in table_list or geti(text_json[i + 2]).upper() in table_list:
                # print(geti(text_json[i+1]))
                print('i+1==',geti(text_json[i + 1]))
                print('i+2==',geti(text_json[i + 2]))
                print('trueeeee')
                table_identified = True
                bb = getb(text_json[i])
                bb_next = getb(text_json[i + 1])
                bb_range = abs(bb_next[1] - bb[1]) * 0.5
                print('bb=',bb)
                print('bbnext=',bb_next)
                print('range0', bb_range)

                while abs(getb(text_json[i])[1] - bb[1]) < bb_range or geti(text_json[i]).upper() in table_list:
                    print('%%%%%%%%%%%%%%%%%%%')
                    if abs(getb(text_json[i])[1] - bb[1]) < bb_range:
                        print('islessthanbbrangeTRUEEE')
                    print('falsee')
                    print(geti(text_json[i]).upper())
                    print('getb[1]=', getb(text_json[i])[1])
                    print('bb[1]=', bb[1])
                    print('abs=', abs(getb(text_json[i])[1] - bb[1]))
                    headers_present.append(geti(text_json[i]))
                    headers_present_bb.append(getb(text_json[i]))
                    bb_next = getb(text_json[i])
                    if abs(bb_next[1] - bb[1]) != 0:
                        bb_range = max(abs(bb_next[1] - bb[1]) * 0.3, 10)
                    bb = bb_next
                    print('bb', bb)
                    print('range', bb_range)
                    i = i + 1

                break
        i = i + 1

    x = copy.deepcopy(headers_present_bb)

    header_dict = {}

    for h in range(len(headers_present_bb)):
        header_dict[str(headers_present_bb[h])] = headers_present[h]

    x = sorted(x, key=lambda x: x[0])

    final_header = []
    final_header_bb = []

    # for h in x:
    #     final_header_bb.append(h)
    #     final_header.append(header_dict[str(h)])
    # # headers_present = [x for x in table_list if x in final_header]
    # # print('newhead=', headers_present)
    # headers_present = final_header
    # headers_present_bb = final_header_bb
    # # final_header = [x.upper() for x in final_header]
    #
    # combinedmatch = [x for x in table_identfier["combined"] if x in headers_present]
    # print('combinedmatch===', combinedmatch)
    # # below if sno missing from headers.
    # SNomatch = [x for x in table_identfier["SNo"] if x in headers_present]
    # print('snomatch=', SNomatch)
    # if not SNomatch and (len(headers_present) <= 2 or len(headers_present) >= 3):
    #     headers_present.insert(0, 'SI NO')
    #     si_bb = text_json[i]['words'][0].get('boundingBox')
    #     headers_present_bb.insert(0, si_bb)
    #     print('1111')
    # else:
    #     print('sno already present invalid')
    #
    # if combinedmatch and (combinedmatch[0] == 'Gross Amt Conc' or combinedmatch[0] == 'Gross Amt Con'):
    #     # print('entered')
    #     # print('combinedmatch=', combinedmatch)
    #     if combinedmatch[0] == 'Gross Amt Conc':
    #         headers_present.remove('Gross Amt Conc')
    #     elif combinedmatch[0] == 'Gross Amt Con':
    #         headers_present.remove('Gross Amt Con')
    #     del headers_present_bb[1]
    #     headers_present.insert(1, 'Gross Amt')
    #     grossam = text_json[i + 1].get('boundingBox')
    #     headers_present_bb.insert(1, grossam)
    #     headers_present.insert(2, 'Conc')
    #     conc = text_json[i]['words'][1].get('boundingBox')
    #     conc = [element * 7 for element in conc]
    #     headers_present_bb.insert(2, conc)
    #     print('2222')
    #
    # if combinedmatch and (combinedmatch[0] == 'Particulars Gross Amt.' or combinedmatch[0] == 'Particulars Cross Amt.'):
    #     print('entered')
    #     print('combinedmatch=', combinedmatch)
    #     parti = text_json[i - 2].get('boundingBox')
    #     grossam = text_json[i]['words'][1].get('boundingBox')
    #     print('3333')
    #     if combinedmatch[0] == headers_present[0]:
    #         print('000')
    #         headers_present = [ele for ele in headers_present if ele not in combinedmatch]
    #         print('headersafterdeleteingmatch=', headers_present)
    #         del headers_present_bb[0]
    #         headers_present.insert(0, 'Particulars')
    #         headers_present.insert(1, 'Gross Amt')
    #         headers_present_bb.insert(0, parti)
    #         headers_present_bb.insert(1, grossam)
    #     elif combinedmatch[0] == headers_present[1]:
    #         print('111')
    #         headers_present = [ele for ele in headers_present if ele not in combinedmatch]
    #         print('headersafterdeleteingmatch=', headers_present)
    #         del headers_present_bb[1]
    #         headers_present.insert(1, 'Particulars')
    #         headers_present.insert(2, 'Gross Amt')
    #         headers_present_bb.insert(1, parti)
    #         # grossam = [element * 2 for element in grossam] for 42 just tested
    #         headers_present_bb.insert(2, grossam)
    #
    # if combinedmatch and (combinedmatch[0] == 'SL.NO. . Primary Code' or combinedmatch[0] == 'L.NO. Primary Code'):
    #     print(combinedmatch)
    #     headers_present = [ele for ele in headers_present if ele not in combinedmatch]
    #     del headers_present_bb[0]
    #     primcode = text_json[i + 1]['words'][1].get('boundingBox')
    #     if 'SI NO' in headers_present:
    #         print('already present')
    #     else:
    #         sino = text_json[i - 3].get('boundingBox')
    #         headers_present.insert(0, 'SI NO')
    #         headers_present_bb.insert(0, sino)
    #     headers_present.insert(1, 'Primary code')
    #     # primcode = [element * 3 for element in primcode] just tested for 10 img
    #     headers_present_bb.insert(1, primcode)
    #     print('4444')
    #
    # discountmatch = [x for x in table_identfier["Discount"] if x in headers_present]
    # print('dischmatch=', discountmatch)
    # if combinedmatch and (combinedmatch[0] == 'S No Particulars' or combinedmatch[0] == 'S.No Particulars'or combinedmatch[0] == 'S . No . Particular'):
    #     print('combinedmatch=', combinedmatch)
    #     headers_present = [ele for ele in headers_present if ele not in combinedmatch]
    #     del headers_present_bb[0]
    #     if 'SI NO' in headers_present:
    #         print('already present')
    #     else:
    #         sino = text_json[i - 5].get('boundingBox')
    #         headers_present.insert(0, 'SI NO')
    #         headers_present_bb.insert(0, sino)
    #     parti = text_json[i]['words'][0].get('boundingBox')
    #     headers_present.insert(1, 'Particulars')
    #     headers_present_bb.insert(1, parti)
    #     if not discountmatch:
    #         headers_present.insert(4, 'Discount')
    #         disc = text_json[i]['words'][1].get('boundingBox')
    #         print('disc=', disc)
    #         headers_present_bb.insert(4, disc)
    #     print('5555')
    #
    # if combinedmatch and (combinedmatch[0] == 'SL.NO PARTICULARS' or combinedmatch[0] == 'I No. Service Name' or
    #                       combinedmatch[0] == 'SI No. Service Name' or combinedmatch[0] == 'S . No . Particulars' or
    #                       combinedmatch[0] == 'S. No . Particulars' or combinedmatch[0] == 'S. No . Particular' or
    #                       combinedmatch[0] == 'S . No. Particulars' or combinedmatch[0]=='Sr.No. Service Name'
    #                       or combinedmatch[0] == 'SNo. Service Name' or combinedmatch[0] == 'S, No . Particulars'
    #                       or combinedmatch[0] == 'S. No. Particulars'):
    #     print('combinedmatch=', combinedmatch)
    #     headers_present = [ele for ele in headers_present if ele not in combinedmatch]
    #     del headers_present_bb[0]
    #     if 'SI NO' in headers_present:
    #         print('already present')
    #     else:
    #         sino = text_json[i - 4].get('boundingBox')
    #         headers_present.insert(0, 'SI NO')
    #         headers_present_bb.insert(0, sino)
    #     parti = text_json[i]['words'][0].get('boundingBox')
    #     headers_present.insert(1, 'Particulars')
    #     headers_present_bb.insert(1, parti)
    #     print('6666')
    #
    # if combinedmatch and combinedmatch[0]=='SI.No Service Group Name':
    #     print('combinedmatchservicegroupname=', combinedmatch)
    #     headers_present = [ele for ele in headers_present if ele not in combinedmatch]
    #     del headers_present_bb[0]
    #     servicegroupname = text_json[i]['words'][0].get('boundingBox')
    #     sino = text_json[i - 3].get('boundingBox')
    #     headers_present.insert(0, 'SI NO')
    #     headers_present_bb.insert(0, sino)
    #     headers_present.insert(1, 'Service Group Name')
    #     # primcode = [element * 3 for element in primcode] just tested for 10 img
    #     headers_present_bb.insert(1, servicegroupname)
    #     # print('headersservicegroupafter',headers_present)
    #     print('7777')
    #
    # # if combinedmatch and (combinedmatch[0] == 'Net Amt. Patient Amt' or combinedmatch[0] == 'Net Amt. . Patient Amt'):
    # #     print('combinedmatchnetpatientamt=', combinedmatch)
    # #     headers_present = [ele for ele in headers_present if ele not in combinedmatch]
    # #     del headers_present_bb[4]
    # #     netamt = text_json[i-2].get('boundingBox')
    # #     headers_present.insert(4,'Net Amt')
    # #     headers_present_bb.insert(4,netamt)
    # #     patientamt = text_json[i]['words'][0].get('boundingBox')
    # #     patientamt = [element * 7 for element in patientamt]
    # #     headers_present.insert(5,'Patient Amt')
    # #     headers_present_bb.insert(5,patientamt)
    # #     print('headersafternetpatient-',headers_present)
    # #     print('8888')
    #
    # # if combinedmatch and (combinedmatch[0] == 'S. No. Particulars' and combinedmatch[1] == 'Unit Price'):
    # #     print('combinedmatchnetpatientamt=', combinedmatch)
    # #     headers_present = [ele for ele in headers_present if ele not in combinedmatch]
    # #     del headers_present_bb[2]
    # #     unit = text_json[i-2].get('boundingBox')
    # #     headers_present.insert(2,'Unit')
    # #     headers_present_bb.insert(2,unit)
    # #     price = text_json[i]['words'][0].get('boundingBox')
    # #     price = [element * 7 for element in price]
    # #     headers_present.insert(3,'Price')
    # #     headers_present_bb.insert(3,price)
    # #     print('unitpriceafterheaders=',headers_present)
    # #     print('9999')
    #
    # Descriptionmatch = [x for x in table_identfier["Particular"] if x in headers_present]
    # print(Descriptionmatch)
    # if not Descriptionmatch:
    #     print('truee')
    #     if len(text_json[i]['words']) > 1: # just added to mitigate issue
    #         headers_present.insert(1, 'Description')
    #         Description_bb = text_json[i]['words'][1].get('boundingBox')
    #         headers_present_bb.insert(1, Description_bb)
    #
    # print('headersafter==', headers_present)
    # print(headers_present_bb)
    #
    # if table_identified:
    #     # print(i)
    #     rows = []
    #     rows_bb = []
    #
    #     while i < len(text_json):
    #
    #         bb = getb(text_json[i])
    #         bb_next = getb(text_json[i + 1])
    #
    #         while (bb_next[0] - bb[0]) < abs(bb[1] - bb_next[1]):
    #             rows.append([geti(text_json[i])])
    #             rows_bb.append([getb(text_json[i])])
    #             i = i + 1
    #             bb = bb_next
    #             if i + 1 >= len(text_json):
    #                 break
    #             bb_next = getb(text_json[i + 1])
    #
    #         temp_row = []
    #         temp_row_bb = []
    #         flag = False
    #         while (bb_next[0] - bb[0]) > abs(bb[1] - bb_next[1]):
    #             temp_row.append(geti(text_json[i]))
    #             temp_row_bb.append(getb(text_json[i]))
    #             i = i + 1
    #             bb = bb_next
    #             if i + 1 >= len(text_json):
    #                 flag = False
    #                 break
    #             bb_next = getb(text_json[i + 1])
    #             flag = True
    #         if flag:
    #             temp_row.append(geti(text_json[i]))
    #             temp_row_bb.append(getb(text_json[i]))
    #             i = i + 1
    #
    #         endmatches = [x for x in table_list_end if x in temp_row]
    #         if endmatches:
    #             print('matched', endmatches)
    #             break
    #         # print(temp_row)
    #         for l in temp_row:
    #             # print('l==', l)
    #             if l.__contains__('(100%'):
    #                 continue
    #             # if l.__contains__('%'):
    #             #     temp_row.remove(l)
    #         print(temp_row)
    #         rows.append(temp_row)
    #         rows_bb.append(temp_row_bb)
    #
    #         if i + 1 >= len(text_json):
    #             break
    #
    #     row_new = []
    #     for i in range(len(rows)):
    #         # if row_length == len(rows[i]):
    #         row_new.append(rows[i])
    #     print('new==', row_new)
    #     for i in row_new:
    #         if len(i)>=2:
    #             if len(i[0])>3:
    #                 item_list.append(i[0])
    #             else:
    #                 item_list.append(i[1])
    #     return item_list

def table_size_dt(noc):
    if noc==6:
        list1_dt=[[' ',' ',' '],[' ',' ',' '],[' ',' ',' '],[' ',' ',' '],[' ',' ',' '],[' ',' ',' ']]
    elif noc==7:
        list1_dt=[[' ',' ',' '],[' ',' ',' '],[' ',' ',' '],[' ',' ',' '],[' ',' ',' '],[' ',' ',' '],[' ',' ',' ']]
    elif noc==8:
        list1_dt=[[' ',' ',' '],[' ',' ',' '],[' ',' ',' '],[' ',' ',' '],[' ',' ',' '],[' ',' ',' '],[' ',' ',' '],[' ',' ',' ']]
    elif noc==9:
        list1_dt=[[' ',' ',' '],[' ',' ',' '],[' ',' ',' '],[' ',' ',' '],[' ',' ',' '],[' ',' ',' '],[' ',' ',' '],[' ',' ',' '],[' ',' ',' ']]
    return list1_dt
def avg(lst):
    avg1=0
    try:
        # print('kkkkll',lst)
        avg1=int(sum(lst) / len(lst))
    except:
        print('something wrong')
    return avg1

def partially_presennt_also(list1,str1):
    print(len(list1))
    partially_presennt_also = 'No'
    for li in list1:
        if re.sub('[^A-Za-z]','',str1)==re.sub('[^A-Za-z]','',li):
            print(str1,'##',li,' ---- ',re.sub('[^A-Za-z]','',str1),re.sub('[^A-Za-z]','',li))
            partially_presennt_also = 'Yes'
        # else:
        #     print(str1,'##',li,' **** ',re.sub('[^A-Za-z]','',str1),re.sub('[^A-Za-z]','',li))
    return partially_presennt_also

def table_size(noc):
    if noc==6:
        list1=[' ',' ',' ',' ',' ',' ']
    elif noc==7:
        list1=[' ',' ',' ',' ',' ',' ',' ']
    elif noc==8:
        list1=[' ',' ',' ',' ',' ',' ',' ',' ']
    elif noc==9:
        list1=[' ',' ',' ',' ',' ',' ',' ',' ',' ']
    return list1
def opr1_7(listA,listB):
    listC=[]
    eA0,eA1,eA2,eA3,eA4,eA5,eA6=listA[0],listA[1],listA[2],listA[3],listA[4],listA[5],listA[6]
    eB0,eB1,eB2,eB3,eB4,eB5,eB6=listB[0],listB[1],listB[2],listB[3],listB[4],listB[5],listB[6]
    eC0,eC1,eC2,eC3,eC4,eC5,eC6=(listA[0]+' '+listB[0]).strip(),(listA[1]+' '+listB[1]).strip(),(listA[2]+' '+listB[2]).strip(),(listA[3]+' '+listB[3]).strip(),(listA[4]+' '+listB[4]).strip(),(listA[5]+' '+listB[5]).strip(),(listA[6]+' '+listB[6]).strip()
    if len(eC0)==0:
        eC0=' '
    listC.append(eC0)
    if len(eC1)==0:
        eC1=' '
    listC.append(eC1)
    if len(eC2)==0:
        eC2=' '
    listC.append(eC2)
    if len(eC3)==0:
        eC3=' '
    listC.append(eC3)
    if len(eC4)==0:
        eC4=' '
    listC.append(eC4)
    if len(eC5)==0:
        eC5=' '
    listC.append(eC5)
    if len(eC6)==0:
        eC6=' '
    listC.append(eC6)
    return listC
def opr1_6(listA,listB):
    listC=[]
    eA0,eA1,eA2,eA3,eA4,eA5=listA[0],listA[1],listA[2],listA[3],listA[4],listA[5]
    eB0,eB1,eB2,eB3,eB4,eB5=listB[0],listB[1],listB[2],listB[3],listB[4],listB[5]
    eC0,eC1,eC2,eC3,eC4,eC5=(listA[0]+' '+listB[0]).strip(),(listA[1]+' '+listB[1]).strip(),(listA[2]+' '+listB[2]).strip(),(listA[3]+' '+listB[3]).strip(),(listA[4]+' '+listB[4]).strip(),(listA[5]+' '+listB[5]).strip()
    if len(eC0)==0:
        eC0=' '
    listC.append(eC0)
    if len(eC1)==0:
        eC1=' '
    listC.append(eC1)
    if len(eC2)==0:
        eC2=' '
    listC.append(eC2)
    if len(eC3)==0:
        eC3=' '
    listC.append(eC3)
    if len(eC4)==0:
        eC4=' '
    listC.append(eC4)
    if len(eC5)==0:
        eC5=' '
    listC.append(eC5)
    return listC
def opr1_8(listA,listB):
    listC=[]
    eA0,eA1,eA2,eA3,eA4,eA5,eA6,eA7=listA[0],listA[1],listA[2],listA[3],listA[4],listA[5],listA[6],listA[7]
    eB0,eB1,eB2,eB3,eB4,eB5,eB6,eB7=listB[0],listB[1],listB[2],listB[3],listB[4],listB[5],listB[6],listB[7]
    eC0,eC1,eC2,eC3,eC4,eC5,eC6,eC7=(listA[0]+' '+listB[0]).strip(),(listA[1]+' '+listB[1]).strip(),(listA[2]+' '+listB[2]).strip(),(listA[3]+' '+listB[3]).strip(),(listA[4]+' '+listB[4]).strip(),(listA[5]+' '+listB[5]).strip(),(listA[6]+' '+listB[6]).strip(),(listA[7]+' '+listB[7]).strip()
    if len(eC0)==0:
        eC0=' '
    listC.append(eC0)
    if len(eC1)==0:
        eC1=' '
    listC.append(eC1)
    if len(eC2)==0:
        eC2=' '
    listC.append(eC2)
    if len(eC3)==0:
        eC3=' '
    listC.append(eC3)
    if len(eC4)==0:
        eC4=' '
    listC.append(eC4)
    if len(eC5)==0:
        eC5=' '
    listC.append(eC5)
    if len(eC6)==0:
        eC6=' '
    listC.append(eC6)
    if len(eC7)==0:
        eC7=' '
    listC.append(eC7)
    return listC
def opr1_9(listA,listB):
    listC=[]
    eA0,eA1,eA2,eA3,eA4,eA5,eA6,eA7,eA8=listA[0],listA[1],listA[2],listA[3],listA[4],listA[5],listA[6],listA[7],listA[8]
    eB0,eB1,eB2,eB3,eB4,eB5,eB6,eB7,eB8=listB[0],listB[1],listB[2],listB[3],listB[4],listB[5],listB[6],listB[7],listB[8]
    eC0,eC1,eC2,eC3,eC4,eC5,eC6,eC7,eC8=(listA[0]+' '+listB[0]).strip(),(listA[1]+' '+listB[1]).strip(),(listA[2]+' '+listB[2]).strip(),(listA[3]+' '+listB[3]).strip(),(listA[4]+' '+listB[4]).strip(),(listA[5]+' '+listB[5]).strip(),(listA[6]+' '+listB[6]).strip(),(listA[7]+' '+listB[7]).strip(),(listA[8]+' '+listB[8]).strip()
    if len(eC0)==0:
        eC0=' '
    listC.append(eC0)
    if len(eC1)==0:
        eC1=' '
    listC.append(eC1)
    if len(eC2)==0:
        eC2=' '
    listC.append(eC2)
    if len(eC3)==0:
        eC3=' '
    listC.append(eC3)
    if len(eC4)==0:
        eC4=' '
    listC.append(eC4)
    if len(eC5)==0:
        eC5=' '
    listC.append(eC5)
    if len(eC6)==0:
        eC6=' '
    listC.append(eC6)
    if len(eC7)==0:
        eC7=' '
    listC.append(eC7)
    if len(eC8)==0:
        eC8=' '
    listC.append(eC8)
    return listC
def opr1(listA,listB,src_dc):
    noc=src_dc['#colm']
    listC_now=[]
    if noc=='6':
        listC_now=opr1_6(listA,listB)
    elif noc=='7':
        listC_now=opr1_7(listA,listB)
    if noc=='8':
        listC_now=opr1_8(listA,listB)
    if noc=='9':
        listC_now=opr1_9(listA,listB)
    return listC_now
def dic_merge(dc_one,dc_two):
    dc11=dc_one
    h=1
    dc1={}
    for d in dc11:
        dc1[h]=dc11[d]
        h +=1
    dc2=dc_two
    x1=len(dc1)+1
    for d in dc2:
        dc1[x1]=dc2[d]
        x1 +=1
    return dc1
def text_concat(json_data):
    text = " ".join([str(text.get('text')) for text in json_data])
    return text
def cln_data1(list11:list,pattern,indx1,indx2):
    # l1=re.findall('\d\/\d{2}\/\d{4}\s\d{2}\:\d{2}',list11[0])
    l1=re.findall(pattern,list11[indx1])
    if len(l1)==1 and len(list11[indx2])==1 and len(list11[-1])!=1:
        # list11.pop(1)
        list11.pop(indx2)
        st=''
        # list11.insert(1,st.join(l1).strip())
        list11.insert(indx2,st.join(l1).strip())
        st1=''
        # ttt=st1.join(list11[0]).strip().replace(st.join(l1).strip(),'').replace(' +',' ')
        # list11.pop(0)
        # list11.insert(0,ttt)
        ttt=st1.join(list11[indx1]).strip().replace(st.join(l1).strip(),'').replace(' +',' ')
        list11.pop(indx1)
        list11.insert(indx1,ttt)    
    return list11
def split_and_shift_data(list11:list,indx1,indx2,prt):
    dt1=''
    dt2=''
    if prt==' ' and list11[indx1].__contains__(', '):
        ty=list11[indx1]
        list11.pop(indx1)
        list11.insert(indx1,ty.replace(', ',','))
    if prt==' ':
        dt1='.'
        dt2=','
    if len(list11[indx1])>12 and list11[indx1].__contains__(prt) and len(re.findall('\d\/\d{2}\/\d{4}|\d\-\d{2}\-\d{4}',list11[indx1]))==1:
        itm=list11[indx1].split(prt)
        l_val=itm[0]
        r_val=itm[1]
        if indx1>indx2:
            list11.pop(indx1)
            list11.insert(indx1,r_val)
            list11.pop(indx2)
            list11.insert(indx2,l_val)
        else:
            # print('mohit')
            list11.pop(indx1)
            list11.insert(indx1,l_val)
            list11.pop(indx2)
            list11.insert(indx2,r_val)
    if len(list11[indx1])>3 and list11[indx1].__contains__(prt) and len(re.findall('\d\/\d{2}\/\d{4}|\d\-\d{2}\-\d{4}',list11[indx1]))==0 and list11[indx1].replace(prt,'').replace(' ','').replace('.','').replace(',','').isdigit()==True and (list11[indx1].__contains__(dt1) or list11[indx1].__contains__(dt2)) and len(list11[indx2].strip())==0 and len(list11[indx1].split(prt))==2 and (list11[indx1].split(prt)[1][0] in ['1','2','3','4','5','6','7','8','9']):
        # print('hhhhhh',list11)
        itm=list11[indx1].split(prt)
        l_val=itm[0]
        r_val=itm[1]
        if indx1>indx2:
            list11.pop(indx1)
            list11.insert(indx1,r_val)
            list11.pop(indx2)
            list11.insert(indx2,l_val)
        else:
            # print('mohit')
            list11.pop(indx1)
            list11.insert(indx1,l_val)
            list11.pop(indx2)
            list11.insert(indx2,r_val)
    # print(list11,'00000')
    return list11
def split_and_shift_data_one(list11:list,indx1,indx2,prt,cnd):    
    if len(list11[indx1])>3 and list11[indx1].__contains__(prt) and len(re.findall(cnd,list11[indx1]))>=1  and len(list11[indx2].strip())==0 and len(list11[indx1].split(prt))==2 :
    # if len(list11[indx1])>3 and list11[indx1].__contains__(prt) and (list11[indx1].__contains__(dt1) or list11[indx1].__contains__(dt2)) and len(list11[indx2].strip())==0 and len(list11[indx1].split(prt))==2 and list11[indx1].replace(prt,'').replace(' ','').replace('.','').replace(',','').isdigit()==True and list11[indx1].split(prt)[1][0] in ['1','2','3','4','5','6','7','8','9']:
        itm=list11[indx1].split(prt)
        l_val=itm[0]
        r_val=itm[1]
        if indx1>indx2:
            list11.pop(indx1)
            list11.insert(indx1,r_val)
            list11.pop(indx2)
            list11.insert(indx2,l_val)
        else:
            # print('mohit')
            list11.pop(indx1)
            list11.insert(indx1,l_val)
            list11.pop(indx2)
            list11.insert(indx2,r_val)
    # print(list11,'00000')
    return list11
def addj_overlap_opr(list11:list,indx1,indx2,prt):
    if len(list11[indx1])>3 and list11[indx1].__contains__(prt) and (len(list11[indx1].split(prt))==2 and (len(list11[indx1].split(prt)[0])==len(list11[indx2]))):
        itm=list11[indx1].split(prt)
        l_val=itm[0]
        r_val=itm[1]
        if l_val==list11[indx2]:
            list11.pop(indx1)
            list11.insert(indx1,r_val)
    if len(list11[indx1])>3 and list11[indx1].__contains__(prt) and len(list11[indx1].split(prt))>2 and len(list11[indx2])>2 and list11[indx1].startswith(list11[indx1])==True:
        itm1=list11[indx1]
        itm2=list11[indx2]
        itm=itm1.replace(itm2,'')
        list11.pop(indx1)
        list11.insert(indx1,itm)
    return list11
def crop_and_shift_data(list11:list,ptrn,indx1,cnd1,indx2,cnd2):
    l1=re.findall(ptrn,list11[indx1])
    # print('mohittt')
    if len(l1)==1 and len(list11[indx1])>=cnd1 and len(list11[indx2])>=cnd2:
        l1v=list11[indx2]
        st=''
        tt=list11[indx1].replace(st.join(l1).strip(),'')
        tt=re.sub(' +',' ',tt).strip()
        list11.pop(indx1)
        list11.insert(indx1,st.join(l1).strip())
        list11.pop(indx2)
        list11.insert(indx2,(tt+' '+l1v).strip())
    if len(list11[indx1])>=cnd1 and len(re.sub('[^0-9]','',list11[indx1]))==0:
        tt1=list11[indx1]
        tt2=list11[indx2]
        list11.pop(indx1)
        list11.insert(indx1,' ')
        
        list11.pop(indx2)
        list11.insert(indx2,(tt1+' '+tt2).strip())

    return list11
def cln_val1_4(b1,b2,b3,b4):
    b1=re.sub('[^a-zA-Z0-9., ]','',b1)
    b2=re.sub('[^a-zA-Z0-9., ]','',b2)
    b3=re.sub('[^a-zA-Z0-9., ]','',b3)
    b4=re.sub('[^a-zA-Z0-9., ]','',b4)
    if len(b1.strip())==0:
        b1=0
    else:
        b1=1
    if len(b2.strip())==0:
        b2=0
    else:
        b2=1
    if len(b3.strip())==0:
        b3=0
    else:
        b3=1
    if len(b4.strip())==0:
        b4=0
    else:
        b4=1
    b1=int(b1)
    b2=int(b2)
    b3=int(b3)
    b4=int(b4)
    return b1,b2,b3,b4
def cln_val1_3(b1,b2,b3):
    b1=re.sub('[^a-zA-Z0-9., ]','',b1)
    b2=re.sub('[^a-zA-Z0-9., ]','',b2)
    b3=re.sub('[^a-zA-Z0-9., ]','',b3)
    if len(b1.strip())==0:
        b1=0
    else:
        b1=1
    if len(b2.strip())==0:
        b2=0
    else:
        b2=1
    if len(b3.strip())==0:
        b3=0
    else:
        b3=1
    b1=int(b1)
    b2=int(b2)
    b3=int(b3)
    return b1,b2,b3
def cln_val1_2(b1,b2):
    b1=re.sub('[^a-zA-Z0-9., ]','',b1)
    b2=re.sub('[^a-zA-Z0-9., ]','',b2)
    if len(b1.strip())==0:
        b1=0
    else:
        b1=1
    if len(b2.strip())==0:
        b2=0
    else:
        b2=1
    b1=int(b1)
    b2=int(b2)
    return b1,b2
def correct_conclude(dic_1,src_dc,head_list):
    dic1=dic_1
    pt1,idx=src_dc['correct_cld_1'].split(',')
    idx=int(idx)
    dic2={}
    l2=1
    hdd=''
    for d in dic1:
        if dic1[d][0] in head_list:
            hdd=dic1[d][0]
        if dic1[d][idx].__contains__(hdd):
            dic1[d].pop(idx)
            dic1[d].insert(idx,pt1.replace('#',hdd))
        dic2[l2]=dic1[d]
        l2 +=1
    dic_1=dic2
    return dic_1
def avoid_split_line_forfour(dic_n:dict,head_list:list,src_dc):
    noc=src_dc['#colm']
    lst_n=[]
    dic1={}
    ln=1
    b1,b2,b3,b4=0,0,0,0
    c1,c2,c3,c4=0,0,0,0
    q1,q2,q3,q4=src_dc['num_data'].split(',')
    id1,id2,id3,id4=int(q1[-1])-1,int(q2[-1])-1,int(q3[-1])-1,int(q4[-1])-1
    for d in dic_n:
        if dic_n[d].count(' ')==int(noc):
            continue
        lst_n.append(dic_n[d])
    last_i=[]
    for i in lst_n:            
        last_i.append(i)            
        if len(last_i)==2:
            b1,b2,b3,b4=last_i[0][id1],last_i[0][id2],last_i[0][id3],last_i[0][id4]
            b1,b2,b3,b4=cln_val1_4(b1,b2,b3,b4)
            c1,c2,c3,c4=last_i[1][id1],last_i[1][id2],last_i[1][id3],last_i[1][id4]
            c1,c2,c3,c4=cln_val1_4(c1,c2,c3,c4)
            # print(last_i,b1,b2,b3,b4,'-----',c1,c2,c3,c4)
            for l in last_i:
                if last_i[0][0] in head_list and last_i[1][0] not in head_list:
                    # print(last_i,'1111')
                    dic1[ln]=last_i[0]
                    ln +=1
                    last_i.pop(0)
                    break
                elif last_i[0][0] not in head_list and last_i[1][0] in head_list:
                    # print(last_i,'2222')
                    dic1[ln]=last_i[0]
                    ln +=1
                    dic1[ln]=last_i[1]
                    ln +=1
                    last_i=[]
                    break
                elif last_i[0][0] not in head_list and last_i[1][0] not in head_list:
                    if b1*c1==1 or b2*c2==1 or b3*c3==1 or b4*c4==1:
                        # print(last_i,'3333(A)')
                        dic1[ln]=last_i[0]
                        ln +=1
                        last_i.pop(0)
                        break
                    if (b1==b2==b3==b4==0) and (c1==c2==c3==c4==0):
                        dic1[ln]=last_i[0]
                        ln +=1
                        last_i.pop(0)
                        break
                    if (b1==b2==b3==b4==0 and (c1==1 or c2==1 or c3==1 or c4==1)) or ((b1==1 or b2==1 or b3==1 or b4==1) and c1==c2==c3==c4==0):
                        # print(last_i,'3333(B)')
                        dic1[ln]=last_i[0]
                        ln +=1
                        last_i.pop(0)
                        break
                    if (b1==1 or b2==1 or b3==1 or b4==1) and (c1==1 or c2==1 or c3==1 or c4==1) and (b1*c1==0 and b2*c2==0 and b3*c3==0 and b4*c4==0):
                        # print(last_i,'3333(C)')
                        nww=opr1(last_i[0],last_i[1],src_dc)
                        dic1[ln]=nww
                        ln +=1
                        last_i=[]
                        break
    if len(last_i)==1:
        dic1[ln]=last_i[0]
    dic_n=dic1
    return dic_n
def avoid_split_line_forthree(dic_n:dict,head_list:list,src_dc):
    noc=src_dc['#colm']
    lst_n=[]
    dic1={}
    ln=1
    b1,b2,b3=0,0,0
    c1,c2,c3=0,0,0
    q1,q2,q3=src_dc['num_data'].split(',')
    id1,id2,id3=int(q1[-1])-1,int(q2[-1])-1,int(q3[-1])-1
    for d in dic_n:
        if dic_n[d].count(' ')==int(noc):
            continue
        lst_n.append(dic_n[d])
    last_i=[]
    for i in lst_n:            
        last_i.append(i)            
        if len(last_i)==2:
            b1,b2,b3=last_i[0][id1],last_i[0][id2],last_i[0][id3]
            b1,b2,b3=cln_val1_3(b1,b2,b3)
            c1,c2,c3=last_i[1][id1],last_i[1][id2],last_i[1][id3]
            c1,c2,c3=cln_val1_3(c1,c2,c3)
            # print(last_i,b1,b2,b3,b4,'-----',c1,c2,c3,c4)
            for l in last_i:
                if last_i[0][0] in head_list and last_i[1][0] not in head_list:
                    # print(last_i,'1111')
                    dic1[ln]=last_i[0]
                    ln +=1
                    last_i.pop(0)
                    break
                elif last_i[0][0] not in head_list and last_i[1][0] in head_list:
                    # print(last_i,'2222')
                    dic1[ln]=last_i[0]
                    ln +=1
                    dic1[ln]=last_i[1]
                    ln +=1
                    last_i=[]
                    break
                elif last_i[0][0] not in head_list and last_i[1][0] not in head_list:
                    if b1*c1==1 or b2*c2==1 or b3*c3==1:
                        # print(last_i,'3333(A)')
                        dic1[ln]=last_i[0]
                        ln +=1
                        last_i.pop(0)
                        break
                    if (b1==b2==b3==0) and (c1==c2==c3==0):
                        dic1[ln]=last_i[0]
                        ln +=1
                        last_i.pop(0)
                        break
                    if (b1==b2==b3==0 and (c1==1 or c2==1 or c3==1)) or ((b1==1 or b2==1 or b3==1) and c1==c2==c3==0):
                        # print(last_i,'3333(B)')
                        dic1[ln]=last_i[0]
                        ln +=1
                        last_i.pop(0)
                        break
                    if (b1==1 or b2==1 or b3==1) and (c1==1 or c2==1 or c3==1) and (b1*c1==0 and b2*c2==0 and b3*c3==0):
                        # print(last_i,'3333(C)')
                        nww=opr1(last_i[0],last_i[1],src_dc)
                        dic1[ln]=nww
                        ln +=1
                        last_i=[]
                        break
    if len(last_i)==1:
        dic1[ln]=last_i[0]
    dic_n=dic1
    return dic_n
def avoid_split_line_fortwo(dic_n:dict,head_list:list,src_dc):
    noc=src_dc['#colm']
    lst_n=[]
    dic1={}
    ln=1
    b1,b2,b3=0,0,0
    c1,c2,c3=0,0,0
    q1,q2=src_dc['num_data'].split(',')
    id1,id2=int(q1[-1])-1,int(q2[-1])-1
    for d in dic_n:
        if dic_n[d].count(' ')==int(noc):
            continue
        lst_n.append(dic_n[d])
    last_i=[]
    for i in lst_n:            
        last_i.append(i)            
        if len(last_i)==2:
            b1,b2=last_i[0][id1],last_i[0][id2]
            b1,b2=cln_val1_2(b1,b2)
            c1,c2=last_i[1][id1],last_i[1][id2]
            c1,c2=cln_val1_2(c1,c2)
            # print(last_i,b1,b2,b3,b4,'-----',c1,c2,c3,c4)
            # print(last_i)
            for l in last_i:
                if last_i[0][0] in head_list and last_i[1][0] not in head_list:
                    # print(last_i,'1111')
                    dic1[ln]=last_i[0]
                    ln +=1
                    last_i.pop(0)
                    break
                elif last_i[0][0] not in head_list and last_i[1][0] in head_list:
                    # print(last_i,'2222')
                    dic1[ln]=last_i[0]
                    ln +=1
                    dic1[ln]=last_i[1]
                    ln +=1
                    last_i=[]
                    break
                
                elif last_i[0][0] in head_list and last_i[1][0] in head_list:
                    # print(last_i,'2222/2222')
                    dic1[ln]=last_i[0]
                    ln +=1
                    dic1[ln]=last_i[1]
                    ln +=1
                    last_i=[]
                    break
                
                elif last_i[0][0] not in head_list and last_i[1][0] not in head_list:
                    if b1*c1==1 or b2*c2==1:
                        # print(last_i,'3333(A)')
                        dic1[ln]=last_i[0]
                        ln +=1
                        last_i.pop(0)
                        break
                    if (b1==b2==0) and (c1==c2==0):
                        dic1[ln]=last_i[0]
                        ln +=1
                        last_i.pop(0)
                        break
                    if (b1==b2==0 and (c1==1 or c2==1)) or ((b1==1 or b2==1) and c1==c2==0):
                        # print(last_i,'3333(B)')
                        dic1[ln]=last_i[0]
                        ln +=1
                        last_i.pop(0)
                        break
                    if (b1==1 or b2==1) and (c1==1 or c2==1) and (b1*c1==0 and b2*c2==0):
                        # print(last_i,'3333(C)')
                        nww=opr1(last_i[0],last_i[1],src_dc)
                        dic1[ln]=nww
                        ln +=1
                        last_i=[]
                        break
                
    if len(last_i)==1:
        dic1[ln]=last_i[0]
    dic_n=dic1
    return dic_n
def footer_cln_one(dic_f:dict,pattern,ccn,indx1,indx2):
    dic1={}
    lf=1
    for d in dic_f:
        # if (len(re.findall('\d\/\d{4}\s\d{2}\:\d{2}',dic_f[d][0]))==1 and dic_f[d].count(' ')>=4) or (len(re.findall('\d\/\d{4}\s\d{2}\:\d{2}',dic_f[d][1]))==1 and dic_f[d].count(' ')>=4 and len(dic_f[d][0])==1):
        #     continue
        if (len(re.findall(pattern,dic_f[d][indx1]))==1 and dic_f[d].count(' ')>=ccn) or (len(re.findall(pattern,dic_f[d][indx2]))==1 and dic_f[d].count(' ')>=ccn and len(dic_f[d][indx1])==1):
            continue
        dic1[lf]=dic_f[d]
        lf +=1
    dic_f=dic1
    return dic_f
def add_sbt_for_packages(dic_1:dict):
    dic1={}
    l4=1
    adt1=0
    adt2,adt3,adt4,adt5=' ',' ',' ',' '
    for d in dic_1:
        if adt1!=0:
            adt2=dic_1[d][-1]
            adt3=dic_1[d][-2]
            adt4=dic_1[d][-3]
            adt5=dic_1[d][-4]
            break
        if dic_1[d][0].strip()=='Packages':
            adt1=d  
    for d in dic_1: 
        if adt1!=0 and l4==adt1+2: 
            lh=['Packages(Subtotal)', ' ', ' ']
            lh.append(adt5)
            lh.append(adt4)
            lh.append(adt3)
            lh.append(adt2)
            dic1[l4]=lh 
            l4 += 1           
        dic1[l4]=dic_1[d]
        l4 += 1
    dic_1=dic1
    return dic_1
def add_sbt_for_packages_one(dic_1:dict,src_dc):
    head=src_dc['head_list'].split(',')
    noc=int(src_dc['#colm'])
    sbt=src_dc['sbt']
    pkg1=[]
    if noc==6:
        pkg1=['Packages(Subtotal)',' ',' ',' ',' ',' ']
    elif noc==7:
        pkg1=['Packages(Subtotal)',' ',' ',' ',' ',' ',' ']
    elif noc==8:
        pkg1=['Packages(Subtotal)',' ',' ',' ',' ',' ',' ',' ']
    elif noc==9:
        pkg1=['Packages(Subtotal)',' ',' ',' ',' ',' ',' ',' ',' ']
    dic1={}
    l4=1
    xf=1
    lastt=[]
    for d in dic_1:
        xf +=1
        ss=''
        if xf>2 and dic_1[d][0] in head and len(ss.join(lastt))>5 and ss.join(lastt).__contains__(sbt)==False and lastt[0] not in head:
            dic1[l4]=pkg1
            l4 += 1
            dic1[l4]=pkg1
            l4 += 1
        dic1[l4]=dic_1[d]
        lastt=dic_1[d]
        l4 += 1
    dic_1=dic1

    return dic_1    
def clean_row_one(dic_3:dict,pattern,indx1,indx2):
    dic1={}
    l6=1        
    for d in dic_3:            
        dic1[l6]=cln_data1(dic_3[d],pattern,indx1,indx2)
        l6 += 1
    dic_3=dic1
    return dic_3
def skip_data_one(dic_3,src_dc):
    dic1={}
    l6=1  
    p1,i1,p2,i2,p3,i3,p4,i4,p5,i5=src_dc['sd1_yes'].split(',')
    i1,i2,i3,i4,i5=int(i1),int(i2),int(i3),int(i4),int(i5)   
    for d in dic_3:  
        # print('1111112222222',dic_3[d],'---',len(re.findall(p2,dic_3[d][i2]))) 
        # if (dic_3[d][i1].__contains__(p1)) or  (dic_3[d][i2].__contains__(p2)) or  (dic_3[d][i3].__contains__(p3)) or  (dic_3[d][i4].__contains__(p4)) or  (dic_3[d][i5].__contains__(p5)):
            # print('qqqqqqqqqqq',dic_3[d])
        if (len(re.findall(p1,dic_3[d][i1]))>=1) or  (len(re.findall(p2,dic_3[d][i2]))>=1) or  (len(re.findall(p3,dic_3[d][i3]))>=1) or  (len(re.findall(p4,dic_3[d][i4]))>=1) or  (len(re.findall(p5,dic_3[d][i5]))>=1):
            # print('qqqqqqqqqqq',dic_3[d])
            continue    
        dic1[l6]=dic_3[d]
        l6 += 1
    dic_3=dic1
    return dic_3
def correct_head(dic1,src_dc):
    noc=int(src_dc['#colm'])
    head_list=src_dc['head_list'].split(',')
    dic2=dic1
    dic1={}
    l=1
    for d in dic2:
        pl0=dic2[d][0]
        if dic2[d][1:].count(' ')==noc-1:
            c_val=0
            for h in head_list:
                if fuzz.ratio(h,dic2[d][0])>90 and (len(h)-len(dic2[d][0])) in range(-2,2):
                    # dic2[d][0]=h
                    if c_val==0:
                        # print('aaaaa',dic2[d][0],'---',h,'--',fuzz.ratio(h,dic2[d][0]))
                        c_val=fuzz.ratio(h,dic2[d][0])
                        pl0=h
                    if c_val!=0 and fuzz.ratio(h,dic2[d][0])>c_val:
                        # print('bbbbb',dic2[d][0],'---',h,'--',fuzz.ratio(h,dic2[d][0]))
                        c_val=fuzz.ratio(h,dic2[d][0])
                        pl0=h
            dic2[d].pop(0)
            dic2[d].insert(0,pl0)
        dic1[l]=dic2[d]
        l +=1
    return dic1
def prefer_next(dic_3,pattern1):
    dic1={}
    l6=1 
    xc=1       
    for d in dic_3:  
        xc +=1
        ss='' 
        if xc>1 and ss.join(dic_3[d]).__contains__(pattern1):
            if ss.join(dic1[l6-1]).__contains__(pattern1):
                # print(dic_3[d],'--',dic1[l6-1])
                dic1[l6-1]= dic_3[d]
                continue    
        dic1[l6]=dic_3[d]
        l6 += 1
    dic_3=dic1
    return dic_3
def one_to_many_3(dic_3,src_dc):
    dic1={}
    l6=1 
    xc=1 
    pat1=src_dc['one_to_many'].split(',')[1]
    pat2=src_dc['one_to_many'].split(',')[2]      
    for d in dic_3:
        x_temp=''
        if len(re.findall(pat1,dic_3[d][0]))==1 and len(re.findall(pat2,dic_3[d][0]))==1 and len(dic_3[d][1])==1 and len(dic_3[d][2])==1:
            x_temp=  dic_3[d][0]
            x_0= re.findall(pat1,dic_3[d][0])[0]
            x_1= re.findall(pat2,dic_3[d][0])[0]
            x_2=x_temp.replace(x_0,'').replace(x_1,'').strip()
            dic_3[d]=dic_3[d][3:]
            dic_3[d].insert(0,x_2)
            dic_3[d].insert(0,x_1)
            dic_3[d].insert(0,x_0)
        dic1[l6]=dic_3[d]
        l6 += 1
    dic_3=dic1
    return dic_3
def clean_row_onetwo(dic_3:dict,indx,param,skp):
    dic1={}
    l6=1  
    pr=''
    if param=='space':
        pr=' '
    for d in dic_3:  
        temm= dic_3[d]
        if len(dic_3[d][indx])>2 and (len(re.sub('[0-9 ]','',dic_3[d][indx])))==0 and len(dic_3[d][indx].split(pr))==2:
            t01=temm[indx].split(pr)[skp+1]
            # print(temm,'999999999999999999999',t01)
            temm.pop(indx)
            temm.insert(indx,t01)
        dic1[l6]=temm
        l6 += 1
    dic_3=dic1
    return dic_3
def clean_row_onethree(dic_3:dict,indx1,indx2,param,noc):
    dic1={}
    l6=1  
    for d in dic_3:
        if len(dic_3[d][indx1])==1 and len(dic_3[d][indx2])>1 and len(re.findall(param,dic_3[d][indx2]))==1 and dic_3[d].count(' ')==noc-1:
            tmm=dic_3[d][indx2]
            dic_3[d].pop(indx2)
            dic_3[d].insert(indx2,' ')
            dic_3[d].pop(indx1)
            dic_3[d].insert(indx1,tmm)
        dic1[l6]=dic_3[d]
        l6 +=1
    dic_3=dic1
    return dic_3
def clean_amt_specific(dic1:dict,src_dc):
    dic_3=dic1
    dic1={}
    l6=1 
    id1=int(src_dc['ca_yes'][-1])-1     
    for d in dic_3:
        ll=dic_3[d][id1].replace(' ','').replace(' . ','.').replace(' .','.').replace('. ','.')
        if len(ll)==0:
            ll=' '
        dic_3[d].pop(id1)
        dic_3[d].insert(id1,ll)          
        dic1[l6]=dic_3[d]
        l6 += 1
    dic_3=dic1
    return dic_3
def add_to_cnld(dic_1,src_dc,head_list):
    dic1={}
    l6=1  
    # head = src_dc['head_list'].split(',') 
    head = head_list 
    noc=int(src_dc['#colm'])
    cnt=0
    lnn=[]
    for d in dic_1: 
        if cnt==1:
            dic1[l6]=dic_1[d]
            l6 += 1
            dic1[l6]=lnn
            l6 += 1 
            dic1[l6]=lnn
            l6 += 1
            cnt=0
            continue
        if dic_1[d][0] in head and dic_1[d].count(' ')==noc-1 and dic_1[d][0].strip()=='Packages' and cnt==0:
            dic1[l6]=dic_1[d]
            l6 += 1
            cnt=1
            lnn=copy.deepcopy(dic_1[d])
            lnn.pop(0)
            lnn.insert(0,'Packages(Subtotal)')
            continue
        dic1[l6]=dic_1[d]
        l6 += 1
    dic_1=dic1
    return dic_1
def add_subtotal(dic_1,src_dc,head_list):
    dic1={}
    l6=1  
    # head = src_dc['head_list'].split(',')  
    head = head_list
    noc=int(src_dc['#colm'])
    for d in dic_1: 
        if len(re.findall('\d\.\d|\d{2}\,?\d',dic_1[d][-1]))>=1 and dic_1[d].count(' ')==noc-1:
            dic_1[d].pop(1)
            dic_1[d].insert(1,'Subtotal')
        dic1[l6]=dic_1[d]
        l6 += 1
    dic_1=dic1
    return dic_1
def add_subtotal_one(dic_1,src_dc,head_list):
    dic1={}
    l6=1  
    # head = src_dc['head_list'].split(',')  
    head = head_list
    noc=int(src_dc['#colm'])
    nn=0
    patrn=src_dc['add_subtotal'].split(',')[1]
    if src_dc['Hospital']=='lilavati':
        dicc=dic_1
        ld=1
        dic_1={}
        fn = len(dicc)
        f=0
        for d in dicc:
            f +=1
            if f<fn and len(dicc[d][2])>1 and len(re.findall(patrn,dicc[d][-1].replace(' ','')))>=1 and dicc[d].count(' ')==noc-2 and dicc[d+1].count(' ')>=noc-2 and len(dicc[d+1][-1])==1:
               kk=dicc[d][-1]
               ll1=copy.deepcopy(dicc[d])
               ll2=copy.deepcopy(dicc[d])
               ll1.pop(-1)
               ll1.append(' ')
               dic_1[ld]=ll1
               ld +=1
               ll2.pop(2)
               ll2.insert(2,' ')
               ll2.pop(-1)
               ll2.append(kk)
               dic_1[ld]=ll2
               ld +=1
               continue
            dic_1[ld]=dicc[d]
            ld +=1
        dicc=dic_1
        ld=1
        dic_1={}
        lasst=[]
        for d in dicc:
            if dicc[d].count(' ')==noc-2 and len(dicc[d][2])>1 and len(dicc[d][-1])>1 and len(lasst[-1])==1:
                # print('mohit',dicc[d],lasst,'--',ld)
                lasst=opr1(lasst,dicc[d],src_dc)
                dic_1[ld-1]=lasst
                continue
            dic_1[ld]=dicc[d]
            lasst=dicc[d]
            ld +=1
    elif src_dc['Hospital']=='srch':
        dicc=dic_1
        ld=1
        dic_1={}
        xn=len(dicc)
        sn=0
        for d in dicc:
            sn +=1
            ss=''
            if sn<xn and len(dicc[d][2])>1 and (len(re.findall('\d\.\d',dicc[d][-1].replace(' ','')))>=1 or len(re.findall('\d{3}',dicc[d][-1].replace(' ','')))>=1) and (len(re.findall('\d\.\d',dicc[d][-3].replace(' ','')))>=1 or len(re.findall('\d{3}',dicc[d][-3].replace(' ','')))>=1) and dicc[d].count(' ')==noc-3 and ((dicc[d+1].count(' ')>=noc-2 and len(dicc[d+1][-1])==1) or ss.join(dicc[d+1]).__contains__('Total')) :
               print('mohit',dicc[d])
               kk=dicc[d][-1]
               ll1=copy.deepcopy(dicc[d])
               ll2=copy.deepcopy(dicc[d])
               ll1.pop(-1)
               ll1.append(' ')
               ll1.pop(-3)
               ll1.append(' ')
               dic_1[ld]=ll1
               ld +=1
               ll2.pop(2)
               ll2.insert(2,' ')
               ll2.pop(-1)
               ll2.append(kk)
               dic_1[ld]=ll2
               ld +=1
               continue
            if sn==xn and len(dicc[d][2])>1 and (len(re.findall('\d\.\d',dicc[d][-1].replace(' ','')))>=1 or len(re.findall('\d{3}',dicc[d][-1].replace(' ','')))>=1) and (len(re.findall('\d\.\d',dicc[d][-3].replace(' ','')))>=1 or len(re.findall('\d{3}',dicc[d][-3].replace(' ','')))>=1) and dicc[d].count(' ')==noc-3 and (len(dicc[d][-3])>len(dicc[d-1][-3]) and len(dicc[d][-1])>len(dicc[d-1][-1])) :
               print('mohit1',dicc[d])
               kk=dicc[d][-1]
               ll1=copy.deepcopy(dicc[d])
               ll2=copy.deepcopy(dicc[d])
               ll1.pop(-1)
               ll1.append(' ')
               ll1.pop(-3)
               ll1.append(' ')
               dic_1[ld]=ll1
               ld +=1
               ll2.pop(2)
               ll2.insert(2,' ')
               ll2.pop(-1)
               ll2.append(kk)
               dic_1[ld]=ll2
               ld +=1
               continue
            dic_1[ld]=dicc[d]
            ld +=1
        dicc=dic_1
        ld=1
        dic_1={}
        lasst=[]
        for d in dicc:
            if dicc[d].count(' ')==noc-2 and len(dicc[d][2])>1 and len(dicc[d][-1])>1 and len(lasst[-1])==1:
                # print('mohit',dicc[d],lasst,'--',ld)
                lasst=opr1(lasst,dicc[d],src_dc)
                dic_1[ld-1]=lasst
                continue
            dic_1[ld]=dicc[d]
            lasst=dicc[d]
            ld +=1
    for d in dic_1:
        if src_dc['add_subtotal'].split(',')[0]=='basic' and (len(re.findall(patrn,dic_1[d][-1]))>=1 and dic_1[d].count(' ')==noc-1):
            dic_1[d].pop(1)
            dic_1[d].insert(1,'Subtotal')
        if src_dc['add_subtotal'].split(',')[0]=='stg_one' and (len(re.findall(patrn,dic_1[d][-3]))>=1 and len(re.findall(patrn,dic_1[d][-1]))>=1 and dic_1[d].count(' ')==noc-2):
            print('ravi',dic_1[d])
            dic_1[d].pop(1)
            dic_1[d].insert(1,'Subtotal')
        dic1[l6]=dic_1[d]
        l6 += 1
    dic_1=dic1
    # if src_dc['Hospital']=='srch':
    #     dicc=dic_1
    #     ld=1
    #     dic_1={}
    #     lasst=[]
    #     xf=1
    #     now1=[]
    #     for d in dicc:
    #         xf +=1
    #         ss=''
    #         if xf>2 and dicc[d][0] in head and dicc[d].count(' ')==noc-1  and lasst.count(' ')<noc and ss.join(lasst).__contains__('Subtotal')==False:
    #             print(dicc[d],'ppppppppppppppp')
    #             now1=copy.deepcopy(dicc[d])
    #             now1.pop(0)
    #             now1.insert(0,' ')
    #             now1.pop(1)
    #             now1.insert(1,'Subtotal')
    #             dic_1[ld]=now1
    #             ld +=1                
    #         dic_1[ld]=dicc[d]
    #         lasst=dicc[d]
    #         ld +=1
    return dic_1
def add_subtotal_two(dic_1,src_dc,head_list):
    # print('mohit11')
    dic1={}
    l6=1  
    # head = src_dc['head_list'].split(',')  
    head = head_list
    noc=int(src_dc['#colm'])
    sbt=src_dc['sbt']
    f=1
    lastt=[]
    for d in dic_1:
        
        f +=1
        s=''
        if dic_1[d][0] in head and f>3 and len(s.join(lastt))>5 and s.join(lastt).__contains__(sbt)==False and noc==7:
            x=[' ',' ',' ',' ',' ',' ',' ']
            x.pop(-2)
            x.insert(-2,sbt)
            dic1[l6]=x
            l6 +=1
        
        dic1[l6]=dic_1[d]
        lastt=dic_1[d]
        l6 +=1
    dic_1=dic1
    return dic_1
def head_to_head_sbt(dic_1,src_dc,head_list):
    dic1={}
    l6=1  
    # head = src_dc['head_list'].split(',')  
    head = head_list
    noc=int(src_dc['#colm'])
    list1=[]
    if noc==6:
        list1=[' ',' ',' ',' ',' ',' ']
    elif noc==7:
        list1=[' ',' ',' ',' ',' ',' ',' ']
    elif noc==8:
        list1=[' ',' ',' ',' ',' ',' ',' ',' ']
    elif noc==9:
        list1=[' ',' ',' ',' ',' ',' ',' ',' ',' ']

    cval=''
    cct=1
    for d in dic_1: 
        cct +=1
        if dic_1[d][0] in head and dic_1[d].count(' ')==noc-2 and cct<=3:
            cval=dic_1[d][noc-1]
            dic_1[d].pop(noc-1)
            dic_1[d].insert(noc-1,' ')
        elif dic_1[d][0] in head and dic_1[d].count(' ')==noc-2 and cct>3:
            # print(list1,'00000000lllllllllllllll')
            list1.pop(2)
            list1.insert(2,'Subtotal')
            list1.pop(noc-1)
            list1.insert(noc-1,cval)
            # print(list1,'22222222lllllllllllllll')
            listm=copy.deepcopy(list1)
            dic1[l6]=listm
            l6 += 1
            cval=dic_1[d][noc-1]
            dic_1[d].pop(noc-1)
            dic_1[d].insert(1,' ')
        dic1[l6]=dic_1[d]
        l6 += 1
    list1.pop(2)
    list1.insert(2,'Subtotal')
    list1.pop(noc-1)
    list1.insert(noc-1,cval)
    listm=copy.deepcopy(list1)
    dic1[l6]=listm
    dic_1=dic1
    
    # hospital = src_dc['Hospital']
    # if hospital == 'krishna':
    #     print('Krishnaaaaaaaa')
    #     mergelist = src_dc['merge_set'].split(",")
    #     print('mergelist=', mergelist)
    #     for d in dic_1:
    #         # print('d==',d)
    #         if dic_1[d][0] in mergelist:
    #             print('d==', d)
    #             print('dic1dd=',dic_1[d])
    #             lastval = dic_1[d][5]
    #             dic_1[d].pop(5)
    #             dic_1[d].insert(5,' ')
    # print('dic_1==',dic_1)
    # # print('dic1=',dic1)
    return dic_1

def sift_sbt(dic_1,src_dc,head_list):
    dic1={}
    l6=1  
    # head = src_dc['head_list'].split(',') 
    head = head_list 
    sbt = src_dc['sbt']
    noc = int(src_dc['#colm'])
    kk=0
    line=[' ',' ',' ',' ',' ',' ']
    for d in dic_1:
        print('jjjjhhhhiiii',dic_1[d])
    type=0
    for d in dic_1:
        ss=''
        if ss.join(dic_1[d]).__contains__(sbt):
            type=1
            break
    if type==1:
        print('typeeee_one')
        for d in dic_1:
            kk +=1
            ss=''
            if ss.join(dic_1[d]).__contains__(sbt):
                line=dic_1[d]
                continue
            if dic_1[d][0] in head and kk>2:
                dic1[l6]=line
                l6 += 1 
            dic1[l6]=dic_1[d]
            l6 += 1
        dic1[l6]=line
        dic_1=dic1
    if type==0:
        print('typeeee_zero')
        for d in dic_1:
            kk +=1
            ss=''
            if dic_1[d]==[' ',' ',' ',' ',' ',' ']:
                continue
            
            if dic_1[d][0] in head and kk>2:
                dic1[l6]=[' ',' ',' ',' ','Sub Total',' ']
                l6 += 1 
            dic1[l6]=dic_1[d]
            l6 += 1
        dic1[l6]=[' ',' ',' ',' ','Sub Total',' ']
        dic_1=dic1
    return dic_1

def head_pos_corr(dic_3,idx,src_dc,head_list):
    # head = src_dc['head_list'].split(',')
    head = head_list
    dic1={}
    l6=1      
    for d in dic_3:  
        if dic_3[d][idx] in head:
            hed=dic_3[d][idx]
            dic_3[d].pop(idx)
            dic_3[d].insert(idx,' ')
            dic_3[d].pop(0)
            dic_3[d].insert(0,hed)
        dic1[l6]=dic_3[d]
        l6 += 1
    dic_3=dic1
    return dic_3
def clean_row_two(dic_3:dict,indx1,indx2,prt):    
    dic1={}
    l6=1        
    for d in dic_3:          
        dic1[l6]=split_and_shift_data(dic_3[d],indx1,indx2,prt)
        l6 += 1
    dic_3=dic1
    return dic_3
def clean_row_two_one(dic_3,indx1,indx2,prt,cnd):
    dic1={}
    l6=1        
    for d in dic_3:          
        dic1[l6]=split_and_shift_data_one(dic_3[d],indx1,indx2,prt,cnd)
        l6 += 1
    dic_3=dic1
    return dic_3
def addj_overlap(dic_3,indx1,indx2,prt):
    dic1={}
    l6=1        
    for d in dic_3:          
        dic1[l6]=addj_overlap_opr(dic_3[d],indx1,indx2,prt)
        l6 += 1
    dic_3=dic1
    return dic_3
def one_to_two_line(dic_1,src_dc,head_list):
    dic1={}
    l6=1  
    # head = src_dc['head_list'].split(',') 
    head = head_list  
    sb_head = src_dc['merge_set'].split(',') 
    noc=int(src_dc['#colm'])
    line1=[]
    line2=[]
    if src_dc['one_to_two_line'].split(',')[0]=='yes':
        for d in dic_1:         
            if dic_1[d][0] in head and dic_1[d][1] in sb_head and dic_1[d].count(' ')==noc-2:
                id1=dic_1[d][0]
                id2=dic_1[d][1]
                line1=copy.deepcopy(dic_1[d])
                line2=copy.deepcopy(dic_1[d])
                line1.pop(1)
                line1.pop(0)           
                line1.insert(0,id1)
                line1.insert(1,' ')
                dic1[l6]=line1
                l6 += 1
                line2.pop(1)
                line2.pop(0)           
                line2.insert(0,' ')
                line2.insert(1,id2)
                dic1[l6]=line2
                l6 += 1
                continue     
            dic1[l6]=dic_1[d]
            l6 += 1
    elif src_dc['one_to_two_line'].split(',')[0]=='lvl1':  
        i1,i2,pat1= src_dc['one_to_two_line'].split(',')[1:]  
        i1,i2=int(i1),int(i2)   
        for d in dic_1:         
            if len(dic_1[d][i1])>2 and len(dic_1[d][i2])>2 and len(re.findall(pat1,dic_1[d][i2]))>=1 and dic_1[d].count(' ')==noc-2:
                id1=dic_1[d][i1]
                id2=dic_1[d][i2]
                line1=copy.deepcopy(dic_1[d])
                line2=copy.deepcopy(dic_1[d])
                line1.pop(i2)
                line1.pop(i1)           
                line1.insert(i1,id1)
                line1.insert(i2,' ')
                dic1[l6]=line1
                l6 += 1
                line2.pop(i2)
                line2.pop(i1)           
                line2.insert(i1,' ')
                line2.insert(i2,id2)
                dic1[l6]=line2
                l6 += 1
                continue     
            dic1[l6]=dic_1[d]
            l6 += 1
    elif src_dc['one_to_two_line'].split(',')[0]=='lvl2':  
        cnt,i1,pat1= src_dc['one_to_two_line'].split(',')[1:]  
        cnt,i1=int(cnt),int(i1) 
          
        line1=[' ',' ',' ',' ',' ',' ']
        for d in dic_1:         
            if noc==6 and len(dic_1[d][0])>2 and len(dic_1[d][i1])>2 and len(re.findall(pat1,dic_1[d][i1]))>=1 and dic_1[d].count(' ')<cnt:
                hhd=''
                for x in head:
                    if dic_1[d][0].startswith(x)==True and 3<len(x)<10:
                        hhd=x
                        break
                if len(hhd)>1:
                    thed=dic_1[d][0].replace(hhd,'').strip()
                    line1.pop(0)           
                    line1.insert(0,hhd)
                    dic1[l6]=line1
                    l6 += 1
                    line2=dic_1[d]
                    line2.pop(0)          
                    line2.insert(0,thed)
                    dic1[l6]=line2
                    l6 += 1
                    continue     
            dic1[l6]=dic_1[d]
            l6 += 1
    
    dic_1=dic1
    return dic_1
def recognise_head(dic_1,src_dc,head_list):
    print('dic_1',dic_1)
    sbt=src_dc['sbt']
    noc=int(src_dc['#colm'])           
    line1=[' ',' ',' ',' ',' ',' ',' ',' ',' ']
    lastrow=[]
    dic1={}
    l6=1
    for d in dic_1: 
        sl=''       
        if noc==9 and dic_1[d][0] not in head_list and len(lastrow)>1 and sl.join(lastrow).__contains__(sbt):
            hhd=''
            for x in head_list:
                if dic_1[d][0].startswith(x)==True:
                    hhd=x
                    # print(hhd,'hhd')
                    break
            if len(hhd)>1:
                line1=copy.deepcopy(line1)
                thed=dic_1[d][0].replace(hhd,'').strip()
                line1.pop(0)           
                line1.insert(0,hhd)
                dic1[l6]=line1
                l6 += 1                    
                line2=dic_1[d]
                line2.pop(0)          
                line2.insert(0,thed)
                dic1[l6]=line2
                l6 += 1
                continue     
        dic1[l6]=dic_1[d]
        lastrow=dic_1[d]
        l6 += 1
    return dic1
def clean_row_three(dic_3:dict,src_dc):
    ptrn,indx1,cnd1,indx2,cnd2=src_dc['cs1_yes'].split(';')
    indx1,cnd1,indx2,cnd2=int(indx1),int(cnd1),int(indx2),int(cnd2)
    dic1={}
    l6=1        
    for d in dic_3:            
        dic1[l6]=crop_and_shift_data(dic_3[d],ptrn,indx1,cnd1,indx2,cnd2)
        l6 += 1
    dic_3=dic1
    return dic_3
def correct_zero_element(l1,l2):
    clnt=0
    for i in l1:
        if i==0:
            l1.pop(clnt)
            l1.insert(clnt,l2[clnt])
        clnt +=1
    # print(l1)
    return l1
def claim_range(json_data,src_dc,clm_universal,lmrk_univ):
    noc=int(src_dc['#colm'])
    hd_tm=src_dc['hd_tm'].split(',')[0]
    hdtm_max=int(src_dc['hd_tm'].split(',')[1])
    if len(src_dc['hd_cl1'])==0:
        hd_cl1=src_dc['hd_cl1']
    else:
        hd_cl1=src_dc['hd_cl1'].split(',')[1]
    if len(src_dc['hd_cl2'])==0:
        hd_cl2=src_dc['hd_cl2']
    else:
        hd_cl2=src_dc['hd_cl2'].split(',')[1]
    if len(src_dc['hd_cl3'])==0:
        hd_cl3=src_dc['hd_cl3']
    else:
        hd_cl3=src_dc['hd_cl3'].split(',')[1]
    if len(src_dc['hd_cl4'])==0:
        hd_cl4=src_dc['hd_cl4']
    else:
        hd_cl4=src_dc['hd_cl4'].split(',')[1]
    if len(src_dc['hd_cl5'])==0:
        hd_cl5=src_dc['hd_cl5']
    else:
        hd_cl5=src_dc['hd_cl5'].split(',')[1]
    if len(src_dc['hd_cl6'])==0:
        hd_cl6=src_dc['hd_cl6']
    else:
        hd_cl6=src_dc['hd_cl6'].split(',')[1]
    if len(src_dc['hd_cl7'])==0:
        hd_cl7=src_dc['hd_cl7']
    else:
        hd_cl7=src_dc['hd_cl7'].split(',')[1]
    if len(src_dc['hd_cl8'])==0:
        hd_cl8=src_dc['hd_cl8']
    else:
        hd_cl8=src_dc['hd_cl8'].split(',')[1]
    if len(src_dc['hd_cl9'])==0:
        hd_cl9=src_dc['hd_cl9']
    else:
        hd_cl9=src_dc['hd_cl9'].split(',')[1]
    print(hd_tm,'--',hd_cl1,'--',hd_cl2,'--',hd_cl3,'--',hd_cl4,'--',hd_cl5,'--',hd_cl6,'--',hd_cl7,'--',hd_cl8,'--',hd_cl9,'hhhhhhh') 
    tm0,tm1,tm,vr0=0,0,0,0
    vr0=int(src_dc['vr0'])
    if noc==6:            
        v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12=0,0,0,0,0,0,0,0,0,0,0,0   
    elif noc==7:            
        v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13,v14=0,0,0,0,0,0,0,0,0,0,0,0,0,0
    elif noc==8:            
        v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13,v14,v15,v16=0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    elif noc==9:            
        v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13,v14,v15,v16,v17,v18=0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    for i in range(len(json_data)):
        hospital = src_dc['Hospital']
        if hospital == 'Zen':
            # print('Zennnnnn')
            # for i in range(len(json_data)):
            if json_data[i].get('text') == 'Bill Amount':
                # print('Bill Amounttttt', json_data[i].get('boundingBox'))
                # print(json_data[i].get('boundingBox'))
                continue
                # print('dataaa', json_data[i])
        if len(re.findall(hd_tm,json_data[i].get('text')))==1 and len(json_data[i].get('text'))<=hdtm_max:
            hd_tm=json_data[i].get('text')            
            x1=json_data[i].get('boundingBox')[0]
            x2=json_data[i].get('boundingBox')[2]
            tm1=json_data[i].get('boundingBox')[7]+vr0
            tm0=json_data[i].get('boundingBox')[1]-(3*vr0)//2
            tm=x2-x1
            print('abc',json_data[i].get('boundingBox'),json_data[i].get('text'),'--',tm0,'--',tm1)
            break
     
    for i in range(len(json_data)):
        # print('clll',json_data[i].get('text'),'--',tm0,'--',json_data[i].get('boundingBox')[1],'--',tm1)
        # print(json_data[i].get('text').lower().__contains__(hd_cl1.lower()),'2222222222',json_data[i].get('text'))
        x1,x2=0,0
        if len(hd_cl1)>1 and len(re.findall(hd_cl1,json_data[i].get('text')))>=1 and tm0<json_data[i].get('boundingBox')[1]<tm1 and v1==0 and v2==0:
            print('1111111',json_data[i].get('text'),json_data[i].get('boundingBox'))
            A=src_dc['hd_cl1_0']
            B=src_dc['hd_cl1_1']
            a = int(A.split(',')[0])
            b = int(A.split(',')[1])
            c = int(B.split(',')[0])
            d = int(B.split(',')[1])
            if A.split(',')[2]=='1':
                a=-a
            if B.split(',')[2]=='1':
                c=-c
            for word in json_data[i].get('words'):
                if len(re.findall(hd_cl1,word.get('text')))==1:
                    # print(word)
                    x1=word.get('boundingBox')[0]
                    x2=word.get('boundingBox')[2]
                    break
            # print(x1,'--',x2,'--',tm,'--',a,'-',b,'-',c,'-',d,'--',hd_cl1)
            v1=x1-((a*tm)//b)
            v2=x2+((c*tm)//d)
            # continue
        if len(hd_cl2)>1 and len(re.findall(hd_cl2,json_data[i].get('text')))>=1 and tm0<json_data[i].get('boundingBox')[1]<tm1 and v3==0 and v4==0:
            print('22222222',json_data[i].get('text'),json_data[i].get('boundingBox'))
            A=src_dc['hd_cl2_0']
            B=src_dc['hd_cl2_1']
            a = int(A.split(',')[0])
            b = int(A.split(',')[1])
            c = int(B.split(',')[0])
            d = int(B.split(',')[1])
            if A.split(',')[2]=='1':
                a=-a
            if B.split(',')[2]=='1':
                c=-c
            for word in json_data[i].get('words'):
                if len(re.findall(hd_cl2,word.get('text')))==1:
                    x1=word.get('boundingBox')[0]
                    x2=word.get('boundingBox')[2]
                    break
            # print(x1,'-',a,'-',tm,'-',b,'---',x2,'-',c,'-',tm,'-',d)
            v3=x1-((a*tm)//b)
            v4=x2+((c*tm)//d)
            # continue            
        if len(hd_cl3)>1 and len(re.findall(hd_cl3,json_data[i].get('text')))>=1 and tm0<json_data[i].get('boundingBox')[1]<tm1 and v5==0 and v6==0:
            print('333333333',json_data[i].get('text'),json_data[i].get('boundingBox'))
            A=src_dc['hd_cl3_0']
            B=src_dc['hd_cl3_1']
            a = int(A.split(',')[0])
            b = int(A.split(',')[1])
            c = int(B.split(',')[0])
            d = int(B.split(',')[1])
            if A.split(',')[2]=='1':
                a=-a
            if B.split(',')[2]=='1':
                c=-c
            for word in json_data[i].get('words'):
                if len(re.findall(hd_cl3,word.get('text')))==1:
                    x1=word.get('boundingBox')[0]
                    x2=word.get('boundingBox')[2]
                    break
            v5=x1-((a*tm)//b)
            v6=x2+((c*tm)//d)
            # continue
        if len(hd_cl4)>1 and len(re.findall(hd_cl4,json_data[i].get('text')))>=1 and tm0<json_data[i].get('boundingBox')[1]<tm1 and v7==0 and v8==0:
            print('444444444',json_data[i].get('text'),json_data[i].get('boundingBox'))
            A=src_dc['hd_cl4_0']
            B=src_dc['hd_cl4_1']
            a = int(A.split(',')[0])
            b = int(A.split(',')[1])
            c = int(B.split(',')[0])
            d = int(B.split(',')[1])
            if A.split(',')[2]=='1':
                a=-a
            if B.split(',')[2]=='1':
                c=-c
            for word in json_data[i].get('words'):
                if len(re.findall(hd_cl4,word.get('text')))==1:
                    x1=word.get('boundingBox')[0]
                    x2=word.get('boundingBox')[2]
                    break
            v7=x1-((a*tm)//b)
            v8=x2+((c*tm)//d)
            # continue
        if len(hd_cl5)>1 and len(re.findall(hd_cl5,json_data[i].get('text')))>=1 and tm0<json_data[i].get('boundingBox')[1]<tm1 and v9==0 and v10==0:
            print('55555555555',json_data[i].get('text'),json_data[i].get('boundingBox'))
            A=src_dc['hd_cl5_0']
            B=src_dc['hd_cl5_1']
            a = int(A.split(',')[0])
            b = int(A.split(',')[1])
            c = int(B.split(',')[0])
            d = int(B.split(',')[1])
            if A.split(',')[2]=='1':
                a=-a
            if B.split(',')[2]=='1':
                c=-c
            for word in json_data[i].get('words'):
                if len(re.findall(hd_cl5,word.get('text')))==1:
                    x1=word.get('boundingBox')[0]
                    x2=word.get('boundingBox')[2]
                    break
            v9=x1-((a*tm)//b)
            v10=x2+((c*tm)//d)
            # continue
        if len(hd_cl6)>1 and len(re.findall(hd_cl6,json_data[i].get('text')))>=1 and tm0<json_data[i].get('boundingBox')[1]<tm1 and v11==0 and v12==0:
            print('666666666',json_data[i].get('text'),json_data[i].get('boundingBox'))
            A=src_dc['hd_cl6_0']
            B=src_dc['hd_cl6_1']
            a = int(A.split(',')[0])
            b = int(A.split(',')[1])
            c = int(B.split(',')[0])
            d = int(B.split(',')[1])
            if A.split(',')[2]=='1':
                a=-a
            if B.split(',')[2]=='1':
                c=-c
            for word in json_data[i].get('words'):
                if len(re.findall(hd_cl6,word.get('text')))==1:
                    x1=word.get('boundingBox')[0]
                    x2=word.get('boundingBox')[2]
                    break
            v11=x1-((a*tm)//b)
            v12=x2+((c*tm)//d)
            # continue          
        if len(hd_cl7)>1 and len(re.findall(hd_cl7,json_data[i].get('text')))>=1 and tm0<json_data[i].get('boundingBox')[1]<tm1 and v13==0 and v14==0:
            A=src_dc['hd_cl7_0']
            B=src_dc['hd_cl7_1']
            a = int(A.split(',')[0])
            b = int(A.split(',')[1])
            c = int(B.split(',')[0])
            d = int(B.split(',')[1])
            if A.split(',')[2]=='1':
                a=-a
            if B.split(',')[2]=='1':
                c=-c
            for word in json_data[i].get('words'):
                if len(re.findall(hd_cl7,word.get('text')))==1:
                    x1=word.get('boundingBox')[0]
                    x2=word.get('boundingBox')[2]
                    break
            v13=x1-((a*tm)//b)
            v14=x2+((c*tm)//d)
            # continue
        if len(hd_cl8)>1 and len(re.findall(hd_cl8,json_data[i].get('text')))>=1 and tm0<json_data[i].get('boundingBox')[1]<tm1 and v15==0 and v16==0:
            A=src_dc['hd_cl8_0']
            B=src_dc['hd_cl8_1']
            a = int(A.split(',')[0])
            b = int(A.split(',')[1])
            c = int(B.split(',')[0])
            d = int(B.split(',')[1])
            if A.split(',')[2]=='1':
                a=-a
            if B.split(',')[2]=='1':
                c=-c
            for word in json_data[i].get('words'):
                if len(re.findall(hd_cl8,word.get('text')))==1:
                    x1=word.get('boundingBox')[0]
                    x2=word.get('boundingBox')[2]
                    break
            v15=x1-((a*tm)//b)
            v16=x2+((c*tm)//d)
            # continue    
        if len(hd_cl9)>1 and len(re.findall(hd_cl9,json_data[i].get('text')))>=1 and tm0<json_data[i].get('boundingBox')[1]<tm1 and v17==0 and v18==0:
            A=src_dc['hd_cl9_0']
            B=src_dc['hd_cl9_1']
            a = int(A.split(',')[0])
            b = int(A.split(',')[1])
            c = int(B.split(',')[0])
            d = int(B.split(',')[1])
            if A.split(',')[2]=='1':
                a=-a
            if B.split(',')[2]=='1':
                c=-c
            for word in json_data[i].get('words'):
                if len(re.findall(hd_cl9,word.get('text')))==1:
                    x1=word.get('boundingBox')[0]
                    x2=word.get('boundingBox')[2]
                    break
            v17=x1-((a*tm)//b)
            v18=x2+((c*tm)//d)
            # continue   
    lmrk_new=0
    cord_error=0
    if len(src_dc['l_mark_for_render'])>1:
        l_mark=src_dc['l_mark_for_render']        
        for i in range(len(json_data)):        
            if json_data[i].get('text').__contains__(l_mark):
                lmrk_new=json_data[i].get('boundingBox')[0]
                print(lmrk_new,'yyyyyyyyy')
                break
        if lmrk_univ!=0 and lmrk_new!=0:            
            cord_error=lmrk_univ-lmrk_new
        if lmrk_univ==0:
            lmrk_univ=lmrk_new
    clm_universal_now=[]
    if noc==6:
        clm_rng=[v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12]
    elif noc==7:
        clm_rng=[v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13,v14]
    elif noc==8:
        clm_rng=[v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13,v14,v15,v16]
    elif noc==9:
        clm_rng=[v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13,v14,v15,v16,v17,v18]
    if clm_rng.count(0)>=2:
        print('miss',clm_rng,cord_error)
        clm_universal_now=clm_universal
        if cord_error>35:  
            # print('mfp',cord_error)          
            clm_universal_now=[x-cord_error-(cord_error//2) for x in clm_universal_now] 
        elif cord_error<-35:  
            # print('mfp',cord_error)          
            clm_universal_now=[x-cord_error+(cord_error//2) for x in clm_universal_now]
        clm_rng = correct_zero_element(clm_rng,clm_universal_now)
        # clm_universal=clm_rng
    else:
        print('hit',clm_rng)
        clm_universal=clm_rng
    print(clm_rng)
    return clm_rng,clm_universal,lmrk_univ
def claim_range_spl(json_data,src_dc,clm_universal):
    noc=int(src_dc['#colm'])
    hd_tm=src_dc['hd_tm'].split(',')[0]  
    hdtm_max=int(src_dc['hd_tm'].split(',')[1])

    tm0,tm1,tm,vr0=0,0,0,0
    if len(src_dc['hd_cl1'])==0:
        hd_cl1=src_dc['hd_cl1']
    else:
        hd_cl1=src_dc['hd_cl1']
        hd_cl1_l,cl1_l_id,hd_cl1_r,cl1_r_id=src_dc['hd_cl1'].split(',')[1:]
        cl1_l_id,cl1_r_id=int(cl1_l_id),int(cl1_r_id)
    if len(src_dc['hd_cl2'])==0:
        hd_cl2=src_dc['hd_cl2']
    else:
        hd_cl2=src_dc['hd_cl2']
        hd_cl2_l,cl2_l_id,hd_cl2_r,cl2_r_id=src_dc['hd_cl2'].split(',')[1:]
        cl2_l_id,cl2_r_id=int(cl2_l_id),int(cl2_r_id)
    if len(src_dc['hd_cl3'])==0:
        hd_cl3=src_dc['hd_cl3']
    else:
        hd_cl3=src_dc['hd_cl3']
        hd_cl3_l,cl3_l_id,hd_cl3_r,cl3_r_id=src_dc['hd_cl3'].split(',')[1:]
        cl3_l_id,cl3_r_id=int(cl3_l_id),int(cl3_r_id)
    if len(src_dc['hd_cl4'])==0:
        hd_cl4=src_dc['hd_cl4']
    else:
        hd_cl4=src_dc['hd_cl1']
        hd_cl4_l,cl4_l_id,hd_cl4_r,cl4_r_id=src_dc['hd_cl4'].split(',')[1:]
        cl4_l_id,cl4_r_id=int(cl4_l_id),int(cl4_r_id)
    if len(src_dc['hd_cl5'])==0:
        hd_cl5=src_dc['hd_cl5']
    else:
        hd_cl5=src_dc['hd_cl5']
        hd_cl5_l,cl5_l_id,hd_cl5_r,cl5_r_id=src_dc['hd_cl5'].split(',')[1:]
        cl5_l_id,cl5_r_id=int(cl5_l_id),int(cl5_r_id)
    if len(src_dc['hd_cl6'])==0:
        hd_cl6=src_dc['hd_cl6']
    else:
        hd_cl6=src_dc['hd_cl6']
        hd_cl6_l,cl6_l_id,hd_cl6_r,cl6_r_id=src_dc['hd_cl6'].split(',')[1:]
        cl6_l_id,cl6_r_id=int(cl6_l_id),int(cl6_r_id)
    
    if len(src_dc['hd_cl7'])==0:
        hd_cl7=src_dc['hd_cl7']
    else:
        hd_cl7=src_dc['hd_cl7']
        hd_cl7_l,cl7_l_id,hd_cl7_r,cl7_r_id=src_dc['hd_cl7'].split(',')[1:]
        cl7_l_id,cl7_r_id=int(cl7_l_id),int(cl7_r_id)
    if len(src_dc['hd_cl8'])==0:
        hd_cl8=src_dc['hd_cl8']
    else:
        hd_cl8=src_dc['hd_cl8']
        hd_cl8_l,cl8_l_id,hd_cl8_r,cl8_r_id=src_dc['hd_cl8'].split(',')[1:]
        cl8_l_id,cl8_r_id=int(cl8_l_id),int(cl8_r_id)
    if len(src_dc['hd_cl9'])==0:
        hd_cl9=src_dc['hd_cl9']
    else:
        hd_cl9=src_dc['hd_cl9']
        hd_cl9_l,cl9_l_id,hd_cl9_r,cl9_r_id=src_dc['hd_cl9'].split(',')[1:]
        cl9_l_id,cl9_r_id=int(cl9_l_id),int(cl9_r_id)
    if noc==6:            
        v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12=0,0,0,0,0,0,0,0,0,0,0,0 
    elif noc==7:            
        v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13,v14=0,0,0,0,0,0,0,0,0,0,0,0,0,0
    elif noc==8:            
        v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13,v14,v15,v16=0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    elif noc==9:            
        v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13,v14,v15,v16,v17,v18=0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0
    # print('thisssss',hdtm_max,hd_tm)
    hospital = src_dc['Hospital']
    for i in range(len(json_data)):  
        # print(json_data[i].get('text'),re.findall(hd_tm,json_data[i].get('text')))    
        # if  json_data[i].get('text')=="20DDDBD621":
        #     continue     
        if hospital=='aig' and i<14:
            continue   
        if len(re.findall(hd_tm,json_data[i].get('text')))==1 and len(json_data[i].get('text'))<=hdtm_max:
            hd_tm=json_data[i].get('text')            
            x1=json_data[i].get('boundingBox')[0]
            x2=json_data[i].get('boundingBox')[2]
            tm=x2-x1
            print('hd_tm',json_data[i].get('text'))
            break 
         
    for i in range(len(json_data)):
        x1,x2=0,0 
        if len(hd_cl1)>1 and len(re.findall(hd_cl1_l,json_data[i].get('text')))==1 and v1==0:
            x1=json_data[i].get('boundingBox')[cl1_l_id]
            A=src_dc['hd_cl1_0']
            a = int(A.split(',')[0])
            b = int(A.split(',')[1])
            if A.split(',')[2]=='1':
                a=-a
            v1=x1-((a*tm)//b)
        if len(hd_cl1)>1 and len(re.findall(hd_cl1_r,json_data[i].get('text')))==1 and v2==0:
            x2=json_data[i].get('boundingBox')[cl1_r_id]
            B=src_dc['hd_cl1_1']
            c = int(B.split(',')[0])
            d = int(B.split(',')[1])
            if B.split(',')[2]=='1':
                c=-c
            v2=x2+((c*tm)//d) 
        if len(hd_cl1)>1 and v1!=0 and v2!=0:
            break
    # print(v1,'-----',v2) 
    for i in range(len(json_data)):
        x1,x2=0,0 
        if len(hd_cl2)>1 and len(re.findall(hd_cl2_l,json_data[i].get('text')))==1 and v3==0:
            x1=json_data[i].get('boundingBox')[cl2_l_id]
            A=src_dc['hd_cl2_0']
            a = int(A.split(',')[0])
            b = int(A.split(',')[1])
            if A.split(',')[2]=='1':
                a=-a
            v3=x1-((a*tm)//b)
        if len(hd_cl2)>1 and len(re.findall(hd_cl2_r,json_data[i].get('text')))==1 and v4==0:
            x2=json_data[i].get('boundingBox')[cl2_r_id]
            B=src_dc['hd_cl2_1']
            c = int(B.split(',')[0])
            d = int(B.split(',')[1])
            if B.split(',')[2]=='1':
                c=-c
            v4=x2+((c*tm)//d) 
        if len(hd_cl2)>1 and v3!=0 and v4!=0:
            break 
    for i in range(len(json_data)):
        x1,x2=0,0 
        if len(hd_cl3)>1 and len(re.findall(hd_cl3_l,json_data[i].get('text')))==1 and v5==0:
            x1=json_data[i].get('boundingBox')[cl3_l_id]
            A=src_dc['hd_cl3_0']
            a = int(A.split(',')[0])
            b = int(A.split(',')[1])
            if A.split(',')[2]=='1':
                a=-a
            v5=x1-((a*tm)//b)
        if len(hd_cl3)>1 and len(re.findall(hd_cl3_r,json_data[i].get('text')))==1 and v6==0:
            x2=json_data[i].get('boundingBox')[cl3_r_id]
            B=src_dc['hd_cl3_1']
            c = int(B.split(',')[0])
            d = int(B.split(',')[1])
            if B.split(',')[2]=='1':
                c=-c
            v6=x2+((c*tm)//d) 
        if len(hd_cl3)>1 and v5!=0 and v6!=0:
            break
    
    for i in range(len(json_data)):
        # if  json_data[i].get('text')=="20DDDBD621":
        #     continue
        if hospital=='aig' and i<14:
            continue
        x1,x2=0,0 
        if len(hd_cl4)>1 and len(re.findall(hd_cl4_l,json_data[i].get('text')))==1 and v7==0:
            x1=json_data[i].get('boundingBox')[cl4_l_id]
            A=src_dc['hd_cl4_0']
            a = int(A.split(',')[0])
            b = int(A.split(',')[1])
            if A.split(',')[2]=='1':
                a=-a
            v7=x1-((a*tm)//b)
        if len(hd_cl4)>1 and len(re.findall(hd_cl4_r,json_data[i].get('text')))==1 and v8==0:
            x2=json_data[i].get('boundingBox')[cl4_r_id]
            B=src_dc['hd_cl4_1']
            c = int(B.split(',')[0])
            d = int(B.split(',')[1])
            if B.split(',')[2]=='1':
                c=-c
            v8=x2+((c*tm)//d) 
        if len(hd_cl4)>1 and v7!=0 and v8!=0:
            break
 
    for i in range(len(json_data)):
        # if  json_data[i].get('text')=="20DDDBD621":
        #     continue
        if hospital=='aig' and i<14:
            continue
        x1,x2=0,0 
        if len(hd_cl5)>1 and len(re.findall(hd_cl5_l,json_data[i].get('text')))==1 and v9==0:
            x1=json_data[i].get('boundingBox')[cl5_l_id]
            A=src_dc['hd_cl5_0']
            a = int(A.split(',')[0])
            b = int(A.split(',')[1])
            if A.split(',')[2]=='1':
                a=-a
            v9=x1-((a*tm)//b)
        if len(hd_cl5)>1 and len(re.findall(hd_cl5_r,json_data[i].get('text')))==1 and v10==0:
            x2=json_data[i].get('boundingBox')[cl5_r_id]
            B=src_dc['hd_cl5_1']
            c = int(B.split(',')[0])
            d = int(B.split(',')[1])
            if B.split(',')[2]=='1':
                c=-c
            v10=x2+((c*tm)//d) 
        if len(hd_cl5)>1 and v9!=0 and v10!=0:
            break 
    for i in range(len(json_data)):
        # if  json_data[i].get('text')=="20DDDBD621":
        #     continue
        if hospital=='aig' and i<14:
            continue
        x1,x2=0,0 
        if len(hd_cl6)>1 and len(re.findall(hd_cl6_l,json_data[i].get('text')))==1 and v11==0:
            x1=json_data[i].get('boundingBox')[cl6_l_id]
            A=src_dc['hd_cl6_0']
            a = int(A.split(',')[0])
            b = int(A.split(',')[1])
            if A.split(',')[2]=='1':
                a=-a
            v11=x1-((a*tm)//b)
        if len(hd_cl6)>1 and len(re.findall(hd_cl6_r,json_data[i].get('text')))==1 and v12==0:
            x2=json_data[i].get('boundingBox')[cl6_r_id]
            B=src_dc['hd_cl6_1']
            c = int(B.split(',')[0])
            d = int(B.split(',')[1])
            if B.split(',')[2]=='1':
                c=-c
            v12=x2+((c*tm)//d) 
        if len(hd_cl6)>1 and v11!=0 and v12!=0:
            break
    for i in range(len(json_data)):
        # if  json_data[i].get('text')=="20DDDBD621":
        #     continue
        if hospital=='aig' and i<14:
            # print('milakyaaaa')
            continue
        x1,x2=0,0 
        if len(hd_cl7)>1 and len(re.findall(hd_cl7_l,json_data[i].get('text')))==1 and v13==0:
            x1=json_data[i].get('boundingBox')[cl7_l_id]
            A=src_dc['hd_cl7_0']
            a = int(A.split(',')[0])
            b = int(A.split(',')[1])
            if A.split(',')[2]=='1':
                a=-a
            v13=x1-((a*tm)//b)
        if len(hd_cl7)>1 and len(re.findall(hd_cl7_r,json_data[i].get('text')))==1 and v14==0:
            x2=json_data[i].get('boundingBox')[cl7_r_id]
            B=src_dc['hd_cl7_1']
            c = int(B.split(',')[0])
            d = int(B.split(',')[1])
            if B.split(',')[2]=='1':
                c=-c
            v14=x2+((c*tm)//d) 
        if len(hd_cl7)>1 and v13!=0 and v14!=0:
            break 
    for i in range(len(json_data)):
        x1,x2=0,0 
        if len(hd_cl8)>1 and len(re.findall(hd_cl8_l,json_data[i].get('text')))==1 and v15==0:
            x1=json_data[i].get('boundingBox')[cl8_l_id]
            A=src_dc['hd_cl8_0']
            a = int(A.split(',')[0])
            b = int(A.split(',')[1])
            if A.split(',')[2]=='1':
                a=-a
            v15=x1-((a*tm)//b)
        if len(hd_cl8)>1 and len(re.findall(hd_cl8_r,json_data[i].get('text')))==1 and v16==0:
            x2=json_data[i].get('boundingBox')[cl8_r_id]
            B=src_dc['hd_cl8_1']
            c = int(B.split(',')[0])
            d = int(B.split(',')[1])
            if B.split(',')[2]=='1':
                c=-c
            v16=x2+((c*tm)//d) 
        if len(hd_cl8)>1 and v15!=0 and v16!=0:
            break
    for i in range(len(json_data)):
        x1,x2=0,0 
        if len(hd_cl9)>1 and len(re.findall(hd_cl9_l,json_data[i].get('text')))==1 and v17==0:
            x1=json_data[i].get('boundingBox')[cl9_l_id]
            A=src_dc['hd_cl9_0']
            a = int(A.split(',')[0])
            b = int(A.split(',')[1])
            if A.split(',')[2]=='1':
                a=-a
            v17=x1-((a*tm)//b)
        if len(hd_cl9)>1 and len(re.findall(hd_cl9_r,json_data[i].get('text')))==1 and v18==0:
            x2=json_data[i].get('boundingBox')[cl9_r_id]
            B=src_dc['hd_cl9_1']
            c = int(B.split(',')[0])
            d = int(B.split(',')[1])
            if B.split(',')[2]=='1':
                c=-c
            v18=x2+((c*tm)//d) 
        if len(hd_cl9)>1 and v17!=0 and v18!=0:
            break
    # print('clm_range_spl',v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13,v14,v15,v16)
    if noc==6:
        clm_rng=[v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12]
    elif noc==7:
        clm_rng=[v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13,v14]
    elif noc==8:
        clm_rng=[v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13,v14,v15,v16]
    elif noc==9:
        clm_rng=[v1,v2,v3,v4,v5,v6,v7,v8,v9,v10,v11,v12,v13,v14,v15,v16,v17,v18]
    if clm_rng.count(0)>=2:
        clm_rng=correct_zero_element(clm_rng,clm_universal)
        clm_universal=clm_rng
    else:
        clm_universal=clm_rng
    if hospital=='Gleneagles_GHC' or hospital == 'Global':
        print('in clm_rang_spl')
        for i in range(len(json_data)):
            if len(re.findall('UHID',json_data[i].get('text')))==1 and len(json_data[i].get('text')) < 6:
                print('present',clm_rng)
            else:
                print('UHID merged with Name so default claim range')
                clm_rng = [59, 396, 359, 1109, 1390, 1599, 1480, 1734, 1765, 2184, 2065, 2634]
    if hospital=='Rubanhospital_N0330':
        print('in clm_rang_spl')
        for i in range(len(json_data)):
            if len(re.findall('Amount',json_data[i].get('text')))==1 and len(json_data[i].get('text')) < 8:
                print('present',clm_rng)
            else:
                print('Amount not present')
                clm_rng = [53, 508, 508, 833, 833, 1158, 1036, 1946, 1946, 2206, 2249, 2379]
    if hospital == 'Vydehi_N0951':
        print('in clm_rang_spl')
        for i in range(len(json_data)):
            if len(re.findall('Amount',json_data[i].get('text')))==1 and len(json_data[i].get('text')) < 8:
                print('present',clm_rng)
                break
            elif len(re.findall('Amount',json_data[i].get('text')))==1 and len(json_data[i].get('text'))>8:
                print('Amount not preesent')
                clm_rng = [7, 493, 490, 851, 851, 1208, 994, 1995, 1995, 2138, 2144, 2573]
    if hospital == 'Sushrut_N1598':
        print('in clm_rang_spl')
        for i in range(len(json_data)):
            if 'Discharge Type' in str(json_data):
                print('present',clm_rng)
                break
            elif 'Discharge Type' not in str(json_data):
                print('discharge not preesent')
                clm_rng = [32, 493, 595, 1330, 1330, 1600, 1629, 2049, 2128, 2128, 2074, 2704]
    print(clm_rng)
    return clm_rng,clm_universal

def source_dictinary(filename1,hospital_name):  
    src_dc={}
    src1=[]
    with open(filename1, 'r', encoding='utf-8', errors='ignore') as f:
        myreader = csv.reader(f)
        count=1        
        for my in myreader:
            if count==1:
                src1=my
            count +=1
            if my[0]==hospital_name:
                for i in range(len(my)):
                    src_dc[src1[i]]=my[i]
    return src_dc
def start_one(json_data,src_dc):
    start1=src_dc['start1'].split(',')[0]
    start_no='abcdzyxw'
    if len(src_dc['start_no'])>1:
        start_no=src_dc['start_no']
    start_yes=0
    for i in range(len(json_data)):
        if len(re.findall(start1,json_data[i].get('text')))==1 and len(re.findall(start_no,json_data[i].get('text')))==0:
            start_yes=1 
            break
    if start_yes==0:
        start1=src_dc['start1'].split(',')[1] 
        for i in range(len(json_data)):
            if len(re.findall(start1,json_data[i].get('text')))==1 and len(re.findall(start_no,json_data[i].get('text')))==0:
                start_yes=1 
                break
    if start_yes==0 and len(src_dc['start1'].split(','))==3:
        start1=src_dc['start1'].split(',')[2] 
        for i in range(len(json_data)):
            if len(re.findall(start1,json_data[i].get('text')))==1 and len(re.findall(start_no,json_data[i].get('text')))==0:
                start_yes=1 
                break 
    return start1
def end_one(json_data,src_dc):
    end1=src_dc['end1'].split(',')[0]
    end_no='abcdzyxw'
    if len(src_dc['end_no'])>1:
        end_no=src_dc['end_no']
    end_yes=0   
    for i in range(len(json_data)):
        if len(re.findall(end1,json_data[i].get('text')))==1 and len(re.findall(end_no,json_data[i].get('text')))==0:
            end_yes=1 
            break
    if end_yes==0:        
        end1=src_dc['end1'].split(',')[1] 
        for i in range(len(json_data)):
            if len(re.findall(end1,json_data[i].get('text')))==1 and len(re.findall(end_no,json_data[i].get('text')))==0:
                end_yes=1 
                break 
    if end_yes==0 and len(src_dc['end1'].split(','))>2:
        end1=src_dc['end1'].split(',')[2]
        for i in range(len(json_data)):
            if len(re.findall(end1,json_data[i].get('text')))==1 and len(re.findall(end_no,json_data[i].get('text')))==0:
                end_yes=1 
                break
    if end_yes==0 and len(src_dc['end1'].split(','))==4:
        end1=src_dc['end1'].split(',')[3] 
        for i in range(len(json_data)):
            if len(re.findall(end1,json_data[i].get('text')))==1 and len(re.findall(end_no,json_data[i].get('text')))==0:
                end_yes=1 
                break
    # print(end_no,'noooo')
    return end1
def correct_box(dic1,src_dc):
    dic11=dic1
    lw=1
    dic1={}
    for d in dic11:
        for x in src_dc['correct_box'].split('#'):
            if len(x)>1:
                i1,p1,p2=x.split(',')
                i1=int(i1)
                if p2=='space':
                    p2=' '
                if dic11[d][i1].__contains__(p1):
                    t1= dic11[d][i1]
                    t1=t1.replace(p1,p2)
                    dic11[d].pop(i1)
                    dic11[d].insert(i1,t1)
        dic1[lw]=dic11[d]
        lw +=1
    return dic1
def head_to_home(dic1,src_dc,idh,head_list,noc):
    dic11=dic1
    lw=1
    dic1={}
    for d in dic11:
        if dic11[d].count(' ')==noc-1 and dic11[d][idh] in head_list:
            hid=copy.deepcopy(dic11[d][idh])
            dic11[d].pop(idh)
            dic11[d].insert(idh,' ')
            dic11[d].pop(0)
            dic11[d].insert(0,hid)
        dic1[lw]=dic11[d]
        lw +=1
    return dic1
def vacant_box(dic1,src_dc,idh1,idh2,idh3,idh4):
    dic11=dic1
    lw=1
    dic1={}
    indx_vac=[idh1,idh2,idh3,idh4]
    for d in dic11:
        for v in indx_vac:
            dic11[d].pop(v)
            dic11[d].insert(v,' ')
        dic1[lw]=dic11[d]
        lw +=1
    return dic1
def correct_spl_box(dic1,src_dc):
    noc=int(src_dc['#colm'])
    dic11=dic1
    lw=1
    dic1={}
    for d in dic11:
        for x in src_dc['correct_spl_box'].split('#'):
            if len(x)>1:
                i1,p1,p2=x.split(',')
                i1=int(i1)
                if p2=='space':
                    p2=' '
                if dic11[d][i1]==p1 and dic11[d].count(' ')==noc-1:
                    t1= dic11[d][i1]
                    t1=t1.replace(p1,p2)
                    dic11[d].pop(i1)
                    dic11[d].insert(i1,t1)
        dic1[lw]=dic11[d]
        lw +=1
    return dic1
def boxwise_corr(dic1,src_dc):
    noc=int(src_dc['#colm'])
    dic11=dic1
    lw=1
    dic1={}
    for d in dic11:
        for x in src_dc['boxwise_corr'].split('#'):
            if len(x)>1:
                i1,p1,p2=x.split(',')
                i1=int(i1)
                if p2=='space':
                    p2=' '
                if dic11[d][i1]==p1:
                    t1= dic11[d][i1]
                    t1=t1.replace(p1,p2)
                    dic11[d].pop(i1)
                    dic11[d].insert(i1,t1)
        dic1[lw]=dic11[d]
        lw +=1
    return dic1
def specific_head_corr(dic1,src_dc,noc):
    for xsc in src_dc['specific_head_corr'].split('#'):
        p1,i1,p2,i2=xsc.split(',')
        i1,i2=int(i1),int(i2)
        dic2=dic1
        dic1={}
        ld=1
        for d in dic2:
            if dic2[d][i1]==p1 and dic2[d].count(' ')==noc-1:
                dic2[d].pop(i1)
                dic2[d].insert(i1,' ')
                dic2[d].pop(i2)
                dic2[d].insert(i2,p2)
            dic1[ld] = dic2[d]
            ld += 1
    return dic1

def head_identify(dic1,src_dc,sbt,noc,head_list,hospital,summary_headers):
    # print('uuuu_in',head_list)
    print('sssssmmm',summary_headers)
    # LOG.debug('sssssmmm' + str(summary_headers))
    print(sbt,'sbbbbbt')
    top_item=[]
    if len(summary_headers)>=1:
        top_item = summary_headers 
    sbt_n=src_dc['sbt_no']
    i=0
    if hospital in ['action']:
        i=1
    print(i,'sbbbbbt')
    dic2=dic1
    dic1={}
    ld=1
    f =0
    seq=0
    a_one=0
    a_samp=[]
    for d in dic2:
        f +=1
        ss=''
        if f>=2 and ss.join(dic2[d]).__contains__(sbt)==True and ss.join(dic2[d]).__contains__(sbt_n)==False and seq==0:           
            a_one=1
        if f==1 and dic2[d].count(' ')==noc-1 and dic2[d][i] in head_list:           
            seq=1
        if f>=2 and dic2[d].count(' ')==noc-1 and len(dic2[d][i])>=3 and ss.join(dic2[d-1]).__contains__(sbt)==True and ss.join(dic2[d-1]).__contains__(sbt_n)==False:           
            seq=1
            print('jjjjjhhhhhh_11111',dic2[d])
            a_samp = copy.deepcopy(dic2[d])
            # print('condddd',str(dic2[d][i]) not in head_list,top_item!=[])
            if str(dic2[d][i]) not in head_list and top_item!=[]:
                use_this=65
                poss_head = str(dic2[d][i])
                for j in top_item:                    
                    if fuzz.ratio(j.upper(),str(dic2[d][i]).upper())>=use_this:
                        use_this = fuzz.ratio(j.upper(),str(dic2[d][i]).upper())
                        print('ccccc',j,dic2[d][i])
                        poss_head = str(j)
                if poss_head!=' ':
                    head_list.append(poss_head)
                    dic2[d].pop(i)
                    dic2[d].insert(i,poss_head)
                    print('jjjjjhhhhhh_22222',dic2[d],dic2[d-1])
                else:
                    head_list.append(str(dic2[d][i]))
                    print('jjjjjhhhhhh_22222_else',dic2[d])   
            elif str(dic2[d][i]) not in head_list and top_item==[]:  
                head_list.append(str(dic2[d][i]))
                print('jjjjjhhhhhh_22222_outer_else',dic2[d]) 
        dic1[ld] = dic2[d]
        ld += 1
    if a_one==1 and  hospital not in ['max','fortis','manipal','Shankara_N16938']:
        a_samp.pop(i)
        a_samp.insert(i,'Service_one') 
        dic2=dic1
        dic1={}
        ld=1
        f =0
        for d in dic2:
            f +=1
            if f==1:
               dic1[ld]=a_samp
               ld +=1
               continue 
            dic1[ld] = dic2[d]
            ld += 1
        head_list.append('Service_one')
    return dic1,head_list

def update_list(str1,str2,str3,str4,h1,h2,h3,h4,list1):
    list1.pop(h1)
    list1.insert(h1,str1)
    list1.pop(h2)
    list1.insert(h2,str2)
    list1.pop(h3)
    list1.insert(h3,str3)
    list1.pop(h4)
    list1.insert(h4,str4)
    return list1
def update_list1(str1,str2,str4,h1,h2,h3,list1):
    print(str1,str2,str4,h1,h2,h3,list1)
    list1.pop(h1)
    list1.insert(h1,str1)
    # print('1',str1,str2,str4,h1,h2,h3,list1)
    list1.pop(h2)
    list1.insert(h2,str2)
    # print('2',str1,str2,str4,h1,h2,h3,list1)
    list1.pop(h3)
    list1.insert(h3,str4)
    # print('3',str1,str2,str4,h1,h2,h3,list1)
    return list1
def correct_combination(list1,cct):
    try:
        h1,h2,h3,h4=10,10,10,10
        str5='disc_na'
        if cct.split(',')[-1].isdigit()==True:
            if len(cct.split(','))==3:
                g1,g2,g3=cct.split(',')
                h1,h2,h3=int(g1),int(g2),int(g3)
        else:
            if len(cct.split(','))==5:
                g1,g2,g3,g4,_=cct.split(',')
                h1,h2,h3,h4=int(g1),int(g2),int(g3),int(g4)
                if cct.split(',')[4]=='percent':
                    str5='percent'
                else:
                    str5='simple'
        
        if str5=='percent':
            print('thos')
            str1,str2,str3,str4=list1[h1],list1[h2],list1[h3],list1[h4]
            if str1=='B':
                str1='3'
            qty=str1
            rate=str2.replace('$','5')
            dis=str3.replace('O','0').replace('o','0')
            amt=str4.replace('$','5')

            # print(list1)
            if qty==' ' and (dis==' ' or dis=='0') and rate!=' ' and amt!=' ' and rate.replace('.','',1).isdigit()==True and amt.replace('.','',1).isdigit()==True:
                print('firsttttttttt',amt,rate)
                if str(rate)==str(amt):
                    str1='1'
                    str3='0'
                    str4=str(amt)
                    return update_list(str1,str2,str3,str4,h1,h2,h3,h4,list1)
                if str(rate)!=str(amt):
                    print('firsttttttttt_11111')
                    qty=1
                    loop_break1=0  
                    loop_break2=0  
                    for x in range(1,9):
                        qty=x
                        amt_num=float(amt)
                        new_amt=float(qty)*float(rate)
                        new_amt=round(new_amt,2)
                        if new_amt==amt_num:
                            str1=str(qty)
                            str4=str(amt_num)
                            loop_break1=1
                            break
                    if loop_break1==0:
                        amt_nn='1'+str(amt) 
                        qty=1
                        print('yyyyyy',amt_nn,rate)
                        for x in range(1,9):
                            qty=x
                            amt_num=float(amt_nn)
                            new_amt=float(qty)*float(rate)
                            new_amt=round(new_amt,2)
                            if new_amt==amt_num:
                                print('uuuuuu',str1,'----',str(qty))
                                if str(qty)!='1':
                                    continue
                                if (str1=='1' or str1==' ') and str(qty)=='1':
                                    print('ppppppp')
                                    str1=str(qty)
                                    str4=str(amt_num)
                                    loop_break1=1
                                    return update_list(str1,str2,str3,str4,h1,h2,h3,h4,list1)
                    if loop_break1==0:
                        set_correct={'4':'1','8':'3','1':'4','3':'8','5':'6'}
                        temp_dis=0
                        if dis.replace('-','',1).isdigit()==True:
                            temp_dis=int(dis.replace('-','',1))
                        for y in set_correct:
                            if y==str(amt)[0]:
                                amt_= copy.deepcopy(set_correct[y]+ str(amt)[1:])
                                qty=1
                                for x in range(1,9):
                                    qty=x
                                    amt_num=float(amt_)
                                    new_amt=float(qty)*float(rate)
                                    new_amt=round(new_amt,2)
                                    new_amt1=(new_amt*temp_dis)/100
                                    new_amt1=round(new_amt1,2)
                                    new_amt -=new_amt1
                                    print(new_amt,amt_num,'oooooooo_innn')
                                    if new_amt==amt_num:
                                        str2=str(rate)
                                        str1=str(qty)
                                        str4=str(amt_num)
                                        return update_list(str1,str2,str3,str4,h1,h2,h3,h4,list1)

                if str(rate)!=amt and len(str(rate))==len(amt):
                    set_correct={'4':'1','8':'3','1':'4','3':'8','5':'6'}
                    if str(rate)[1:]==amt[1:]:
                        for sc in set_correct:
                            if sc==str(rate)[0] and set_correct[sc]==amt[0]:
                                amt=sc+amt[1:]
                                if amt==str(rate):
                                    str4=amt
                                    str1='1'
                                    print('yess1')
                    else:
                        qty=1
                        break_loop=0
                        for x in range(1,9):
                            qty=x
                            amt_num=float(amt)
                            new_amt=float(qty)*float(rate)
                            new_amt=round(new_amt,2)
                            if new_amt!=amt_num:
                                print(new_amt,amt_num,'yuyuyuyu')
                                for sc in set_correct:
                                    if sc==str(amt_num)[0]:
                                        amt11=set_correct[sc]+str(amt_num)[1:]
                                        # print('kokoko',amt11,str(new_amt))
                                        if amt11==str(new_amt):
                                            str4=amt11
                                            str1=str(qty)
                                            print('yess1',str4,str1)
                                            break_loop=1
                                            break
                                if break_loop==1:
                                    break           
                if rate!=amt and len(rate)==len(amt)+1 and rate[1:]==amt:
                    set_correct={'4':'1','8':'3','1':'4','3':'8','5':'6'}
                    print('yuyuyuy')
                    for sc in set_correct:
                        if sc==rate[0]:
                            
                            if sc+amt==rate:
                                str4=rate
                                print('yess2')
                # else:
                #     print('no')
            elif qty!=' ' and qty.isdigit()==True and (dis==' ' or dis=='0') and rate!=' ' and amt!=' ' and rate.replace('.','',1).isdigit()==True and amt.replace('.','',1).isdigit()==True:
                print('wwwww122',float(qty)*float(rate),float(amt))
                if float(qty)*float(rate)!=float(amt) and (float(qty)*float(rate)-float(amt)<-1 or float(qty)*float(rate)-float(amt)>-1):
                    print('wwwww',float(qty)*float(rate),float(amt))
                    set_correct={'4':'1','8':'3','1':'4','3':'8','5':'6'}
                    t_amt=float(qty)*float(rate)
                    t_amt=round(t_amt,2)
                    for sc in set_correct:
                        print(t_amt,type(t_amt),float(sc+amt[1:]),type(float(sc+amt[1:])))
                        if t_amt==float(sc+amt[1:]) or 0<t_amt-float(sc+amt[1:])<0.5 or 0<float(sc+amt[1:])-t_amt<0.5:
                            print(t_amt,'ooooo1')
                            str4=str(t_amt)
                            break
            elif qty==' ' and (dis!=' ' or dis!='0') and rate!=' ' and amt!=' ' and rate.replace('.','',1).isdigit()==True and amt.replace('.','',1).isdigit()==True:
                temp_dis=0
                if dis.replace('-','',1).isdigit()==True:
                    temp_dis=int(dis.replace('-','',1))
                print('wwwwwfff',qty,dis,rate,amt,temp_dis)
                set_correct={'4':'1','8':'3','1':'4','3':'8','5':'6'}
                if temp_dis>0:
                    qty=1
                    for x in range(1,9):
                        qty=x
                        loop_break=0
                        amt_num=float(amt)
                        new_amt=float(qty)*float(rate)
                        new_amt=round(new_amt,2)
                        new_amt1=(new_amt*temp_dis)/100
                        new_amt1=round(new_amt1,2)
                        new_amt -=new_amt1
                        print(new_amt,new_amt1,amt_num,temp_dis,'yuyuyuyu_innn')
                        if new_amt==amt_num:
                            str1=str(qty)
                            str4=str(amt_num)
                            return update_list(str1,str2,str3,str4,h1,h2,h3,h4,list1)
                        if new_amt!=amt_num:
                            print(new_amt,new_amt1,amt_num,temp_dis,'yuyuyuyu')
                            if qty==1 and len(rate)<len(amt) and float(rate)<float(amt):
                                print('yes',new_amt,new_amt1,amt_num,temp_dis,'yuyuyuyu')
                                
                                for x in range(1,9):
                                    rate1=str(x)+str(rate)
                                    new_amt_one=float(qty)*float(rate1)
                                    new_amt_one=round(new_amt_one,2)
                                    new_amt1_11=(new_amt_one*temp_dis)/100
                                    new_amt1_11=round(new_amt1_11,2)
                                    new_amt_one -=new_amt1_11
                                    print('tyuityui',new_amt1_11,new_amt_one,amt_num)
                                    if new_amt_one==amt_num:
                                        print('ttttyyy')
                                        loop_break=1
                                if loop_break==0:
                                    for sc in set_correct:
                                        if sc==str(amt)[0]:
                                            amt_num=float(set_correct[sc]+str(amt)[1:])
                                    for x in range(1,9):
                                        rate1=str(x)+str(rate)
                                        new_amt_one=float(qty)*float(rate1)
                                        new_amt_one=round(new_amt_one,2)
                                        new_amt1_11=(new_amt_one*temp_dis)/100
                                        new_amt1_11=round(new_amt1_11,2)
                                        new_amt_one -=new_amt1_11
                                        print('tyuityui',new_amt1_11,new_amt_one,amt_num)
                                        if new_amt_one==amt_num:
                                            print('ttttyyy')
                                            loop_break=1
                            if len(str(new_amt))>len(str(amt_num)):
                                print('yuttttt')
                                for i in range(1,10):
                                    n_amt=float(str(i)+str(amt_num))
                                    if new_amt==n_amt:
                                        str4=str(i)+str(amt_num)
                                        loop_break=1
                                        str1=str(qty)
                                        return update_list(str1,str2,str3,str4,h1,h2,h3,h4,list1)
                            if len(str(new_amt))==len(str(amt_num)):
                                print('yugggggg')
                                for sc in set_correct:
                                    if sc==str(str(amt_num)[0]):
                                        n_amt=float(set_correct[sc]+str(amt_num)[1:])
                                        if new_amt==n_amt:
                                            str4=set_correct[sc]+str(amt_num)[1:]
                                            loop_break=1
                                            str1=str(qty)
                                            return update_list(str1,str2,str3,str4,h1,h2,h3,h4,list1)
                            if loop_break==1:
                                break
            
            elif qty!=' ' and qty.isdigit()==False and len(qty.replace(',','').replace('.',''))==1 and (dis==' ' or dis=='0') and rate!=' ' and amt!=' ' and rate.replace('.','',1).isdigit()==True and amt.replace('.','',1).isdigit()==True:
                print('wwwwwrrr',float(qty)*float(rate),float(amt))
                if float(qty)*float(rate)!=float(amt) and (float(qty)*float(rate)-float(amt)<-1 or float(qty)*float(rate)-float(amt)>-1):
                    print('wwwwwuuu',float(qty)*float(rate),float(amt))
                    set_correct={'4':'1','8':'3','1':'4','3':'8','5':'6'}
                    t_amt=float(qty)*float(rate)
                    for sc in set_correct:
                        print(t_amt,type(t_amt),float(sc+amt[1:]),type(float(sc+amt[1:])))
                        if t_amt==float(sc+amt[1:]):
                            print(t_amt,'oooooeee2')
                            str4=str(t_amt)
                            break
            
            if str(amt).startswith('5') and str4.startswith('$') and str1==' ' and len(str4)>len(str2):
                print('3333333',qty,rate,dis,amt)
                if str1==' ' and (dis!=' ' or dis!='0') and rate!=' ' and amt!=' ' and rate.replace('.','',1).isdigit()==True and amt.replace('.','',1).isdigit()==True:
                    for x in [['4','3'],['1','3'],['4','8'],['1','8']]:
                        rate=str(x[0])+rate
                        amt=str(x[1])+amt[1:]
                        print('rattttt',rate,amt)
                        temp_dis=0
                        if dis.replace('-','',1).isdigit()==True:
                            temp_dis=int(dis.replace('-','',1))
                        print('wwwwwfff',qty,dis,rate,amt,temp_dis)                    
                        if temp_dis>0:
                            qty=1
                            for x in range(1,9):
                                qty=x
                                loop_break=0
                                amt_num=float(amt)
                                new_amt=float(qty)*float(rate)
                                new_amt=round(new_amt,2)
                                new_amt1=(new_amt*temp_dis)/100
                                new_amt1=round(new_amt1,2)
                                new_amt -=new_amt1
                                print(new_amt,new_amt1,amt_num,temp_dis,'oooooooo_innn')
                                if new_amt==amt_num:
                                    str2=str(rate)
                                    str1=str(qty)
                                    str4=str(amt_num)
                                    break
            
            if qty!=' ' and qty.isdigit()==True and (dis==' ' or dis=='0') and rate!=' ' and amt!=' ' and rate.replace('.','',1).replace(',','',1).isdigit()==True and amt.replace(',','',1).replace('.','',1).isdigit()==True:
                rate = rate.replace(',','',1)
                amt = amt.replace(',','',1)
                if dis==' ':
                    o_rate= float(rate)
                    o_amt= float(amt)
                    if float(amt)!=float(qty)*float(rate):
                        print('yhiiii',qty,rate,dis,amt,o_rate,o_amt,'--',float(amt),float(qty)*float(rate))
                        if str(qty).startswith('1'):
                            if float(amt)==float(qty[1:])*float(rate):
                                str1=str(qty[1:])
            print('nnoonononono')
            qty=str1
            rate=str2
            dis=str3
            amt=str4
            list1.pop(h1)
            list1.insert(h1,str1)
            list1.pop(h2)
            list1.insert(h2,str2)
            list1.pop(h3)
            list1.insert(h3,str3)
            list1.pop(h4)
            list1.insert(h4,str4)
            return list1
        if str5=='simple':
            str1,str2,str3,str4=list1[h1],list1[h2],list1[h3],list1[h4]
            qty=str1

            rate=str2.replace('$','5')
            dis=str3.replace('0.00','0').replace('0.0','0').replace('0,00','0').replace('0 00','0').replace('0.OC','0')
            amt=str4.replace('$','5')

            # print(isinstance(rate,float))
            if qty==' ' and (dis==' ' or dis=='0') and rate!=' ' and amt!=' ' and rate.replace('.','',1).isdigit()==True and amt.replace('.','',1).isdigit()==True:
                if rate==amt:
                    str1='1'
                    str3='0'
                
                if str(rate)!=str(amt):
                    print('for qty null and rate,amt not null',str(rate),str(amt))
                    qty=1
                    for x in range(1,22):
                        qty=x
                        amt_num=float(amt)
                        new_amt=float(qty)*float(rate)
                        new_amt = round(new_amt, 2)
                        if new_amt==amt_num:
                            print('matched')
                            str1=str(qty)
                            str4=str(amt_num)
                            return update_list(str1,str2,str3,str4,h1,h2,h3,h4,list1)

                
                if rate!=amt and len(rate)==len(amt) and rate[1:]==amt[1:]:
                    set_correct={'4':'1','8':'3','1':'4','3':'8','5':'6'}
                    for sc in set_correct:
                        if sc==rate[0] and set_correct[sc]==amt[0]:
                            amt=sc+amt[1:]
                            if amt==rate:
                                str4=amt
                                print('yess1')

                elif rate!=amt and len(rate)==len(amt)+1 and rate[1:]==amt:
                    set_correct={'4':'1','8':'3','1':'4','3':'8','5':'6'}
                    for sc in set_correct:
                        if sc==rate[0] and set_correct[sc]==amt[0]:
                            amt=sc+amt[1:]
                            if amt==rate:
                                str4=amt
                                print('yess2')
                else:
                    print('no')
            
            elif qty!=' ' and qty.isdigit()==True and (dis==' ' or dis=='0') and rate!=' ' and amt!=' ' and rate.replace('.','',1).isdigit()==True and amt.replace('.','',1).isdigit()==True:
                print('wwwww1',float(qty)*float(rate),float(amt))
                if float(qty)*float(rate)!=float(amt) and (float(qty)*float(rate)-float(amt)<-1 or float(qty)*float(rate)-float(amt)>-1):
                    print('wwwww',float(qty)*float(rate),float(amt))
                    set_correct={'4':'1','8':'3','1':'4','3':'8','5':'6'}
                    t_amt=float(qty)*float(rate)
                    t_amt=round(t_amt,2)
                    for sc in set_correct:
                        print(t_amt,type(t_amt),float(sc+amt[1:]),type(float(sc+amt[1:])))
                        if t_amt==float(sc+amt[1:]) or 0<t_amt-float(sc+amt[1:])<0.5 or 0<float(sc+amt[1:])-t_amt<0.5:
                            print(t_amt,'ooooo1')
                            str4=str(t_amt)
                            break
            elif qty==' ' and (dis!=' ' or dis!='0') and rate!=' ' and amt!=' ' and rate.replace('.','',1).isdigit()==True and amt.replace('.','',1).isdigit()==True:
                temp_dis=0
                if dis.replace('-','',1).isdigit()==True:
                    temp_dis=int(dis.replace('-','',1))
                print('wwwwwfff',qty,dis,rate,amt,temp_dis)
                set_correct={'4':'1','8':'3','1':'4','3':'8','5':'6'}
                if temp_dis>0:
                    qty=1
                    for x in range(1,9):
                        qty=x
                        loop_break=0
                        amt=float(amt)
                        new_amt=float(qty)*float(rate)
                        new_amt=round(new_amt,2)
                        new_amt1=round(dis,2)
                        new_amt -=new_amt1
                        if new_amt!=amt:
                            print(new_amt,new_amt1,amt,temp_dis,'yuyuyuyu')
                            if len(str(new_amt))>len(str(amt)):
                                print('yuttttt')
                                for i in range(1,10):
                                    n_amt=float(str(i)+str(amt))
                                    if new_amt==n_amt:
                                        str4=str(i)+str(amt)
                                        loop_break=1
                                        str1=str(qty)
                                        break
                            if len(str(new_amt))==len(str(amt)):
                                print('yugggggg')
                                for sc in set_correct:
                                    if sc==str(str(amt)[0]):
                                        n_amt=float(set_correct[sc]+str(amt)[1:])
                                        if new_amt==n_amt:
                                            str4=set_correct[sc]+str(amt)[1:]
                                            loop_break=1
                                            str1=str(qty)
                                            break
                            if loop_break==1:
                                break
            elif qty!=' ' and qty.isdigit()==False and len(qty.replace(',','').replace('.',''))==1 and (dis==' ' or dis=='0') and rate!=' ' and amt!=' ' and rate.replace('.','',1).isdigit()==True and amt.replace('.','',1).isdigit()==True:
                print('wwwwwrrr',float(qty)*float(rate),float(amt))
                if float(qty)*float(rate)!=float(amt) and (float(qty)*float(rate)-float(amt)<-1 or float(qty)*float(rate)-float(amt)>-1):
                    print('wwwwwuuu',float(qty)*float(rate),float(amt))
                    set_correct={'4':'1','8':'3','1':'4','3':'8','5':'6'}
                    t_amt=float(qty)*float(rate)
                    for sc in set_correct:
                        print(t_amt,type(t_amt),float(sc+amt[1:]),type(float(sc+amt[1:])))
                        if t_amt==float(sc+amt[1:]):
                            print(t_amt,'oooooeee2')
                            str4=str(t_amt)
                            break

            qty=str1
            rate=str2
            dis=str3
            amt=str4
            list1.pop(h1)
            list1.insert(h1,str1)
            list1.pop(h2)
            list1.insert(h2,str2)
            list1.pop(h3)
            list1.insert(h3,str3)
            list1.pop(h4)
            list1.insert(h4,str4)
            return list1
    
        if str5=='disc_na':
            print('this',h1,h2,h4)
            str1,str2,str4=list1[h1],list1[h2],list1[h3]
            qty=str1
            rate=str2.replace('$','5').replace('B','8')
            amt=str4.replace('$','5').replace('B','8')
            print('this',qty,rate,amt)
            if rate!=' ' and amt!=' ' and rate.replace('.','').replace(',','').replace(' ','').isdigit()==True and amt.replace('.','').replace(',','').replace(' ','').isdigit()==True :
                print('firsttttttttt',qty,rate,amt)
                if str(rate)==str(amt):
                    str1='1'
                    str2=str(rate)
                    str4=str(amt)
                    return update_list1(str1,str2,str4,h1,h2,h3,list1)
                if str(rate)!=str(amt):
                    print('firsttttttttt_11111')
                    qty=1
                    loop_break1=0  
                    loop_break2=0 
                    rate = rate.replace(',','')
                    rate = rate.replace(' ', '')
                    amt = amt.replace(',','')
                    amt = amt.replace(' ', '') 
                    for x in range(1,42):
                        qty=x
                        amt_num=float(amt)
                        new_amt=float(qty)*float(rate)
                        new_amt=round(new_amt,2)
                        if new_amt==amt_num:
                            str1=str(qty)
                            str4=str(amt_num)
                            loop_break1=1
                            break
                    if loop_break1==0:
                        amt_nn='1'+str(amt) 
                        qty=1

                        for x in range(1,42):
                            qty=x
                            amt_num=float(amt_nn)
                            new_amt=float(qty)*float(rate)
                            new_amt=round(new_amt,2)
                            if new_amt==amt_num:
                                if str1!=str(qty):
                                    continue
                                str1=str(qty)
                                str4=str(amt_num)
                                loop_break1=1
                                break
                    if loop_break1==0:
                        set_correct={'4':'1','8':'3','1':'4','3':'8','5':'6','6':'5'}
                        
                        for y in set_correct:
                            if y==str(amt)[0]:
                                amt_= copy.deepcopy(set_correct[y]+ str(amt)[1:])
                                qty=1
                                for x in range(1,42):
                                    qty=x
                                    amt_num=float(amt_)
                                    new_amt=float(qty)*float(rate)
                                    new_amt=round(new_amt,2)
                                    
                                    print(new_amt,amt_num,'oooooooo_innn')
                                    if new_amt==amt_num:
                                        str2=str(float(rate))
                                        str1=str(qty)
                                        str4=str(amt_num)
                                        return update_list1(str1,str2,str4,h1,h2,h3,list1)


            qty=str1
            rate=str2
            amt=str4
            list1.pop(h1)
            list1.insert(h1,str1)
            list1.pop(h2)
            list1.insert(h2,str2)
            list1.pop(h3)
            list1.insert(h3,str4)
            
            return list1
        
    except:  
        print('lilililili')  
        return list1

def peronailse_at_basic_ext(dic1,src_dc,head_list,sbt,noc,hospital):
    if hospital=='artemis':
        dic2=dic1
        dic1={}
        lq=1
        lastq=[]
        f=0
        fn=len(dic2)
        for d in dic2:
            f +=1
            # print('tttttt',dic2[d])
            if dic2[d][4] == 'KU/ Sector-5T':
                dic2[d][4] = ' '
            if len(dic2[d][4].split())==2 and dic2[d][5] == ' ' and len(re.findall('\d+\.\d+', dic2[d][4])) == 1:
                print('if 5th indx is in 4th index')
                a,b = dic2[d][4].split()
                dic2[d][4] = a
                dic2[d][5] = b
            if f>3 and f<fn and dic2[d].count(' ')>=3 and dic2[d][0] not in head_list and len(lastq)>1 and lastq[0] in head_list and dic2[d+1][0] in head_list:
                # print('hqqqq',dic2[d])
                continue
            dic1[lq]=dic2[d]
            lastq=dic2[d]
            lq +=1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd==', dic2[d])
            if d > 1 and d < len(dic2) and len(re.findall('\d\.\d', dic2[d][5])) == 1 and len(
                    re.findall('\d\'\d', dic2[d][3])) == 1 and dic2[d].count(' ') == 4 and \
                    dic2[d - 1][0] == 'Consultations(Subtotal)' and dic2[d - 1].count(' ') == 5:
                print('for sattawik.pdf if vals and subtotals in diff lines')
                dic2[d - 1][3] = dic2[d][3]
                dic2[d - 1][5] = dic2[d][5]
                dic2[d][3] = ' '
                dic2[d][5] = ' '

            dic1[lq] = dic2[d]
            lq += 1

    if hospital=='aig':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd==', dic2[d])
            if dic2[d][0] == 'Diagnostic':
                dic2[d][0] = 'Diagnostic Services'
            if dic2[d][5].__contains__('Page ') == True:
                dic2[d].pop(5)
                dic2[d].insert(5, ' ')
            if len(dic2[d][5].split()) >= 2:
                dic2[d].pop(6)
                dic2[d].insert(6, ' ')
            if dic2[d][6].__contains__('Page'):
                dic2[d].pop(6)
                dic2[d].insert(6, ' ')
            if dic2[d][0] == 'Andrace' and dic2[d][1] == '. PRAKASHAM Prakacam ANDHRA PRADESH INDIA':
                dic2[d].pop(0)
                dic2[d].insert(0, ' ')
                dic2[d].pop(1)
                dic2[d].insert(1, ' ')
            if (dic2[d][0] == 'Arrace' or dic2[d][0] == 'Addrec') and (
                    dic2[d][2].__contains__('VISHAKAPATNAM GAIIIWAKA Vicathan') or \
                    dic2[d][2].__contains__('Vicakhanatnam')):
                print('for 220100662722_N16331', dic2[d])
                dic2[d].pop(0)
                dic2[d].insert(0, ' ')
                dic2[d].pop(2)
                dic2[d].insert(2, ' ')
                dic2[d].pop(3)
                dic2[d].insert(3, ' ')
            if len(dic2[d][0].split()) == 3 and len(re.findall('\d{2}\-\d{2}\-\d{4}\s?\D{4}\s?\d{9}', dic2[d][0])) == 1:
                print('for code and date and parti merged', dic2[d])
                text = dic2[d][0]
                text = text.split()
                dic2[d].pop(0)
                dic2[d].insert(0, text[0])
                dic2[d].pop(1)
                dic2[d].insert(1, text[1])
                dic2[d].pop(2)
                dic2[d].insert(2, text[2])
            if len(dic2[d][0].split()) > 3 and dic2[d][1] == ' ' and dic2[d][2] == ' ' and len(
                    re.findall('\d{2}\-\d{2}\-\d{4}', dic2[d][0])) == 1 and len(
                re.findall('\D{4}\d{9}', dic2[d][0])) == 1:
                print('for 110100501554 date code parti merged', dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\D{4}\d{9}', text)
                matchdate = re.search(r'\d{2}\-\d{2}\-\d{4}', text)
                dic2[d][2] = dic2[d][0]
                dic2[d].pop(0)
                dic2[d].insert(0, matchdate.group())
                dic2[d].pop(1)
                dic2[d].insert(1, matchcode.group())
                dic2[d][2] = dic2[d][2].replace(matchdate.group(), "")
                dic2[d][2] = dic2[d][2].replace(matchcode.group(), "")
            if len(dic2[d][1].split()) >= 3 and dic2[d][2] == ' ' and len(re.findall('\D{5}\s?\d{9}', dic2[d][1])) == 1:
                print('for 110100497930', dic2[d])
                text = dic2[d][1]
                matchcode = re.search(r'\D{5}\d{9}', text)
                dic2[d].pop(1)
                dic2[d].insert(1, matchcode.group())
                dic2[d][2] = text.replace(matchcode.group(), "")

            dic1[lq] = dic2[d]
            lq += 1

        dic2=dic1
        dic1={}
        lq=1
        four=['Total']
        for d in dic2:
            if dic2[d][4] in four:
                continue
            dic1[lq] = dic2[d]
            lq +=1

        dic2=dic1
        dic1={}
        lq=1
        for_head_item=['GENERAL WARD SURGERY PACKAGE','CARDIOLOGY PACKAGE','PACKAGE EXTRAS']
        for d in dic2:
            fitq=''
            for fhi in for_head_item:
                if fhi in dic2[d][0] and dic2[d][1:].count(' ')==6:
                    fitq = fhi
            if fitq!='':
                hdit = copy.deepcopy(dic2[d])
                hdit.pop(0)
                hdit.insert(0,fitq)
                dic1[lq] = hdit
                lq +=1
                continue
            dic1[lq] = dic2[d]
            lq +=1
    if hospital=='aig1':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd==', dic2[d])
            if dic2[d][1] == '|Diagnostic Services':
                dic2[d][1] = 'Diagnostic Services'
            if  dic2[d][0]!= ' '  and dic2[d][1]== ' ' and len(re.findall('\d+\-\d+\-\d+', dic2[d][0].split()[0])) == 1  and\
                      dic2[d].count(' ')<=3 and len(dic2[d][0].split())>=2:
                print('if date, parti togther')
                text = dic2[d][0]
                if len(re.findall('\d+\-\d+\-\d+', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d+\-\d+\-\d+',text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(),'')
            if dic2[d][1] in head_list:
                dic2[d][0] = dic2[d][1]


            dic1[lq] = dic2[d]
            lq += 1

    if hospital=='manipal':
        dic2=dic1
        dic1={}
        lq=1
        f=0
        fn=len(dic2)
        for d in dic2:
            f +=1
            ss=''
            if f>2 and f<fn and len(dic2[d][3])>3 and dic2[d].count(' ')==5 and ss.join(dic2[d]).__contains__('SAC')==False and len(re.findall('\d\s?\.\s?\d',dic2[d+1][5]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][5]))==0 and len(dic2[d-1][1])>20 and dic2[d].count(' ')==5:
                print('vvvvvvv',dic2[d])
                dic1[lq-1] = opr1(dic2[d-1],dic2[d],src_dc)
                continue
            if f>2 and len(re.findall('\d\s?\.\s?\d',dic2[d][5]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d][3]))==1 and ss.join(dic2[d]).__contains__('SAC')==False and len(dic2[d-1][5].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][3]))==0 and len(dic2[d-1][3].strip())>10 and len(dic2[d][1].strip())>5:
                print('oooooo',dic2[d])
                la1=copy.deepcopy(dic2[d-1])
                la2=copy.deepcopy(dic2[d])
                ty1=la1[3]
                ty2=la2[1]
                ty1 = ty1+ ' ' +ty2
                la1.pop(3)
                la1.insert(3,ty1)
                dic1[lq-1]=la1
                la2.pop(1)
                la2.insert(1,' ')
                dic1[lq]=la2
                lq +=1
                print(la1,la2,'@@@@@@@@@')
                continue
            if f>4 and f<fn and dic2[d][2:].count(' ')==4 and len(dic2[d][1])>20 and ss.join(dic2[d]).__contains__('SAC')==False and len(re.findall('\d\s?\.\s?\d',dic2[d+1][5]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][5]))==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-2][5]))==1 and len(dic2[d-1][1])>20 and dic2[d-1][2:].count(' ')<4:
                ss1=' '
                elone= ss1.join(dic2[d-1][1:]).strip()
                elone=re.sub(' +',' ',elone)
                newl=[' ',elone,' ',' ',' ',' ']
                dic1[lq-1]=copy.deepcopy(newl)
                print('ssssssssss555_0000',dic2[d],dic2[d-1])
            if f>4 and  len(dic2[d][1])>3 and len(re.findall('\d\s?\.\s?\d',dic2[d][3]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d][5]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][3]))==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][5]))==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-2][3]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d-2][5]))==1 and dic2[d-1][2:].count(' ')<4 and ss.join(dic2[d-1]).__contains__('SAC')==False:
                ss1=' '
                elone= ss1.join(dic2[d-1][1:]).strip()
                elone=re.sub(' +',' ',elone)
                newl=[' ',elone,' ',' ',' ',' ']
                dic1[lq-1]=copy.deepcopy(newl)
                print('ssssssssss555_1111',dic2[d],dic2[d-1])
            dic1[lq]=dic2[d]    
            lq +=1

        dic2=dic1
        dic1={}
        lq=1
        f=0
        for d in dic2:
            # print('ggggggg',dic2[d])
            f +=1
            if len(re.findall('\d{2}\-\d{2}\-\d{4}|\d{2}\-\w{3}\-\d{2}',dic2[d][5]))==1:
                print('hqqqq_00000',dic2[d])
                el5=copy.deepcopy(dic2[d][5]) 
                el5=re.sub(re.findall('\d{2}\-\d{2}\-\d{4}|\d{2}\-\w{3}\-\d{2}',el5)[0],' ',el5)
                if len(el5)>1:
                    el5=el5.strip()
                dic2[d].pop(5)
                dic2[d].insert(5,el5)
                print('hqqqq_11111',dic2[d])
            if f>2 and len(re.findall('\d\s?\.\s?\d',dic2[d][3]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d][5]))==1 and (len(re.findall('^\d',dic2[d][2]))==1 or len(dic2[d][2].strip())==0) and 0<=len(dic2[d][2].strip())<=5 and len(dic2[d][1].strip())==0 and dic2[d-1][1:].count(' ')<4:
                print('hhhhhhhhh_000',dic2[d-1],dic2[d])
                ss=' '
                elone= ss.join(dic2[d-1][1:]).strip()
                elone=re.sub(' +',' ',elone)
                newl=[' ',elone,' ',' ',' ',' ']
                dic1[lq-1]=copy.deepcopy(newl)
                print('hhhhhhhhh_1111',newl)
            elif f>2 and len(re.findall('\d\s?\.\s?\d',dic2[d][2]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d][5]))==1 and (len(dic2[d][3].strip())==0) and len(dic2[d][1].strip())==0 and dic2[d-1][1:].count(' ')<4:
                print('hhhhhhhhh_000',dic2[d-1],dic2[d])
                ss=' '
                elone= ss.join(dic2[d-1][1:]).strip()
                elone=re.sub(' +',' ',elone)
                newl=[' ',elone,' ',' ',' ',' ']
                dic1[lq-1]=copy.deepcopy(newl)
                print('hhhhhhhhh_1111',newl)
            dic1[lq]=dic2[d]
            lastq=dic2[d]
            lq +=1
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('ddd==', dic2[d])
            if dic2[d][2] == 'Total' and dic2[d].count(' ') >= 3:
                print('for Total in 2nd index i.e last line')
                dic2[d][4] = 'Sub Total'
                dic2[d][2] = ' '
            if 'Sub Tota' in dic2[d][4] and 'Sub Total' not in dic2[d][4]:
                print('xgiojb',dic2[d])
                nevv = copy.deepcopy(dic2[d])
                nevv.pop(4)
                nevv.insert(4,'Sub Total:')
                dic1[lq]=nevv
                lq +=1
                continue
            if dic2[d][1:].count(' ')==5 and 'SAC' in dic2[d][0] and len(re.findall('\d{6}',dic2[d][0]))==1:
                nevv = copy.deepcopy(dic2[d])
                nevv_zero = nevv[0]
                nevv.pop(0)
                nevv.insert(0,' ')
                nevv.pop(1)
                nevv.insert(1,nevv_zero)
                dic1[lq]=nevv
                lq +=1
                continue
            dic1[lq]=dic2[d]
            lq +=1
    if hospital=='fortis'  or hospital == 'fortis1':
        dic2 = dic1
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            # print('ddd=',dic2[d])
            if f > 3 and f < fn and dic2[d - 1][0] == 'BLOOD' and dic2[d - 1].count(' ') == 8 and dic2[d][
                0] == 'COMPONENT' and ss.join(dic2[d - 2]).__contains__('SUB TOTAL') == True:
                print('hqqqq_howww', dic2[d])
                lastl = dic2[d - 1]
                lastle = dic2[d - 1][0] + ' ' + dic2[d][0]
                lastl.pop(0)
                lastl.insert(0, lastle)
                dic1[lq - 1] = lastl
                dic2[d].pop(0)
                dic2[d].insert(0, ' ')
            if f > 3 and f < fn and dic2[d][0] == 'ROOM RENT' and ss.join(dic2[d - 1]).__contains__(
                    'SUB TOTAL') == True and len(re.findall('\d{6}', dic2[d][1])) == 1 and len(
                    re.findall('\d{2}\-\w{3}\-\d{4}', dic2[d][4])) == 1 and (
                    len(re.findall('\d\.\d', dic2[d][6])) == 1 or len(re.findall('\d\.\d', dic2[d][8])) == 1):
                new_p = ['ROOM RENT', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = new_p
                lq += 1
                dic2[d].pop(0)
                dic2[d].insert(0, ' ')
            if f > 3 and (len(re.findall('\d{6}\D{4}\s\D{7}', dic2[d][1])) == 1 or len(
                    re.findall('\d{6}\s\D{4}\s\D{6}', dic2[d][1])) == 1) and len(
                    re.findall('\d{4}\.\d{2}', dic2[d][6])) == 1 and \
                    len(re.findall('\d{3}\.\d{2}', dic2[d][7])) == 1 and len(
                re.findall('\d{4}\.\d{2}', dic2[d][8])) == 1 and dic2[d].count(' ') == 4:
                print('for 220100623770 999311Twin shamtug')
                text = dic2[d][1]
                if len(re.findall('\d{6}\D{4}\s\D{7}', dic2[d][1])) == 1:
                    matchparti = re.search(r'\D{4}\s\D{7}', text)
                elif len(re.findall('\d{6}\s\D{4}\s\D{6}', dic2[d][1])) == 1:
                    matchparti = re.search(r'\D{4}\s\D{6}', text)
                dic2[d][0] = matchparti.group()
                dic2[d][1] = dic2[d][1].replace(matchparti.group(), '')
            dic1[lq] = dic2[d]
            lastq = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            print('ddd==', dic2[d])
            if d>1 and d<len(dic2) and dic2[d][0].__contains__('DIET') and dic2[d + 1][0].__contains__('CONSULTATION'):
                dic2[d][0] = dic2[d][0] + ' ' + dic2[d + 1][0]
                dic2[d + 1][0] = ' '
            if dic2[d][6] != ' ' and len(dic2[d][6].split()) >= 2 and len(dic2[d][6].split()[0]) <= 2:
                print('6th indx split')
                text = dic2[d][6].split()
                dic2[d][5] = text[0]
                dic2[d][6] = text[-1]

            dic1[lq] = dic2[d]
            lastq = dic2[d]
            lq += 1

    if hospital=='max' or hospital == 'nanavati':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd==', dic2[d])
            if dic2[d][0] == 'Freery':
                dic2[d][0] = 'Surgery'
            if dic2[d][0] == 'Durer Charges':
                dic2[d][0] = 'Other Charges'
            if dic2[d][0] == 'E':
                dic2[d][0] = ' '
            if d>1 and d<len(dic2) and dic2[d][0].__contains__('Speech and language') and dic2[d+1][0] == 'consultation':
                dic2[d][0] = dic2[d][0]+' '+dic2[d+1][0]
                dic2[d+1][0] = ' '
            if dic2[d][1].__contains__('Sub T') or dic2[d][1].__contains__('Sub. . Tota') or dic2[d][1].__contains__(
                    'Sub. Tot'):
                dic2[d].pop(1)
                dic2[d].insert(1, 'Sub Total')
            if len(re.findall('^1\s0.\d{2}', dic2[d][3])) == 1 and len(dic2[d][3].split()) == 2 and len(
                    dic2[d][2].strip()) == 0 and len(re.findall('^0.\d{2}', dic2[d][5])) == 1:
                print('oppppp', dic2[d])
                md2 = dic2[d][3].split()[0]
                md3 = dic2[d][3].split()[1]
                dic2[d].pop(2)
                dic2[d].pop(2)
                dic2[d].insert(2, md3)
                dic2[d].insert(2, md2)
            if dic2[d][0] == 'Room Ram':
                dic2[d][0] = 'Room Rent'
            if dic2[d][0] != ' ' and dic2[d][1] != ' ' and dic2[d][1] in dic2[d][0] and len(
                    re.findall('\d+\/\d+\/\d+', dic2[d][1])) == 2:
                print('if date in 1st and 2nd indx')
                dic2[d][0] = dic2[d][0].replace(dic2[d][1], '')
            if dic2[d][0] != ' ' and dic2[d][1] != ' ' and len(
                    re.findall('\d+\/\d+\/\d{2}\s\d+\D\d+', dic2[d][0])) == 1:
                print('if first half date in 0th indx and full date in 2nd indx')
                text = dic2[d][0]
                matchdate = re.search(r'\d+\/\d+\/\d{2}\s\d+\D\d+', text)
                dic2[d][0] = dic2[d][0].replace(matchdate.group(), '')
                dic2[d][0] = dic2[d][0].strip()
            if dic2[d][0] != ' ' and len(
                    re.findall('\d+\/\d+\/\d+\s\d+\:\d+\s?\-\s?\d+\/\d+\/\d+\s\d+\:\d+', dic2[d][0])) == 1 and \
                    len(re.findall('\d+\/\d+\/\d+\s\d+\:\d+\s?\-\s?\d+\/\d+\/\d+\s\d+\:\d+', dic2[d][1])) == 1:
                print('for room rent date in 0th indx and 1st indx')
                text = dic2[d][0]
                matchdate = re.search(r'\d+\/\d+\/\d+\s\d+\:\d+\s?\-\s?\d+\/\d+\/\d+\s\d+\:\d+', text)
                dic2[d][1] = matchdate.group()
                dic2[d][0] = dic2[d][0].replace(matchdate.group(), '')
                dic2[d][0] = dic2[d][0].strip()

            dic1[lq] = dic2[d]
            lq += 1
        blnk=0
        b_st=0
        dic2=dic1
        dic1={}
        lq=1
        lh=0
        for d in dic2:
            lh +=1
            ss=''
            if lh==1 and ss.join(dic2[d]).__contains__(sbt)==False and ss.join(dic2[d]).__contains__('Total'):
                b_st=1 
            if lh==2 and ss.join(dic2[d]).__contains__('payble') and b_st==1:
                blnk=1
                break
            dic1[lq]=dic2[d]
            lq +=1
        if blnk==1:
            dic1[1]=[' ',' ',' ',' ',' ',' ']
    if hospital == 'max_daycare':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd===',dic2[d])
            if d>1 and  (len(re.findall('\d\s?\.\s?\d',dic2[d][4]))==1 or len(re.findall('\.\s?\d',dic2[d][4]))==1 or dic2[d][4] == ' ') and len(re.findall('\d\s?\.\s?\d',dic2[d][3]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d][5]))==1 and  \
                    dic2[d][0]!= ' ' and dic2[d-1][0]!= ' ' and dic2[d-1].count(' ')==5 and dic2[d].count(' ')<=2 and dic2[d-1][0].__contains__('Dialy'):
                print('if lines divided for dialysis')
                dic2[d-1][1:] = dic2[d][1:]
                dic2[d][1:] = [' ', ' ', ' ', ' ', ' ']
            if d>2 and  len(re.findall('\d\s?\.\s?\d',dic2[d][4]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d][3]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d][5]))==1 and  \
                    dic2[d-1][0]!= ' ' and dic2[d-2][0]!= ' ' and dic2[d-1].count(' ')==5 and dic2[d-2].count(' ')==5 and dic2[d].count(' ')<=2 and dic2[d-2][0].__contains__('Dialy'):
                print('if lines divided in 3 for dialysis')
                dic2[d-2][1:] = dic2[d][1:]
                dic2[d][1:] = [' ', ' ', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
    # /////////////////////////////
    if hospital == 'sarvodaya_1':
        dic2 = dic1
        print('doooothis')
        dic1 = {}
        lq = 1
        for d in dic2:
            print('d11==',dic2[d])
            if d>1 and dic2[d][7]!= ' ' and 'Total' not in dic2[d][7] and 'Rs' in dic2[d][7] and dic2[d-1][0] not in head_list and dic2[d][0] in head_list:
                print('for totals below headers')
                dic2[d][7] = 'Total Rs'
                listnw = [dic2[d][0], ' ', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq+=1
                dic1[lq-1] = listnw
                dic2[d][0] = ' '
            if d>1 and dic2[d][3]!= ' ' and dic2[d][4]!= ' ' and dic2[d][5]!= ' ' and dic2[d-1][2].__contains__('Room Rent') and dic2[d].count(' ')<=3 and dic2[d-1].count(' ')>=4:
                print('for room rent')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if  dic2[d][1]!= ' '  and dic2[d][2]!= ' ' and dic2[d][1]==dic2[d][2] and len(re.findall('\w+\d+', dic2[d][1].split()[0])) == 1 and len(re.findall('\w+\d+', dic2[d][2].split()[0])) == 1 and\
                      dic2[d].count(' ')<=3 and len(dic2[d][1].split())>=2:
                print('if code and parti togther and in 1st and 2nd indx')
                text = dic2[d][1]
                if len(re.findall('\w+\d+', dic2[d][1].split()[0])) == 1:
                    matchcode = re.search(r'\w+\d+',text.split()[0])
                dic2[d][1] = matchcode.group()
                dic2[d][2] = dic2[d][2].replace(matchcode.group(),'')
                print('mactcode',matchcode.group())
            if  dic2[d][0]!= ' ' and  dic2[d][1]== ' '  and dic2[d][2]== ' ' and dic2[d][0]!='Total' and len(dic2[d][0].split())>=3 and len(re.findall('\w+\d+', dic2[d][0].split()[1])) == 1 and len(re.findall('\d+\-\d+\-\d+', dic2[d][0].split()[0])) == 1:
                print('if date, code and parti togther and in 0th')
                text = dic2[d][0]
                if len(re.findall('\w+\d+', dic2[d][0].split()[1])) == 1:
                    matchcode = re.search(r'\w+\d+',text.split()[1])
                if len(re.findall('\d+\-\d+\-\d+', dic2[d][0].split()[0])) == 1:
                    matchdate = re.search(r'\d+\-\d+\-\d+',text.split()[0])
                dic2[d][1] = matchcode.group()
                dic2[d][0] = matchdate.group()
                dic2[d][2] = text.replace(matchcode.group(),'').replace(matchdate.group(),'').replace(' ','',1).replace(' ','',1)
            # if d>1 and d<len(dic2) and  dic2[d][0] in head_list and dic2[d+1][7].__contains__('Total'):
            #     dic2[d][7] = dic2[d+1][7]
            #     dic2[d+1][7] = ' '


            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'sarvodaya_2' or hospital=='convenienthospital':
        dic2 = dic1
        print('doooothis')
        dic1 = {}
        lq = 1
        for d in dic2:
            print('d11==', dic2[d])
            if dic2[d][7].__contains__('Net Ins') or dic2[d][7].__contains__('Net') or dic2[d][7].__contains__('Ins'):
                dic2[d][7] = ' '
            if d > 1 and dic2[d][3] != ' ' and dic2[d][4] != ' ' and dic2[d][5] != ' ' and dic2[d - 1][2].__contains__(
                    'Room Rent') and dic2[d].count(' ') <= 3 and dic2[d - 1].count(' ') >= 4:
                print('for room rent')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if dic2[d][1] != ' ' and dic2[d][2] != ' ' and dic2[d][1] == dic2[d][2] and len(
                    re.findall('^\D+\d+', dic2[d][1].split()[0])) == 1 and len(
                    re.findall('^\D+\d+', dic2[d][2].split()[0])) == 1 and \
                    dic2[d].count(' ') <= 3 and len(dic2[d][1].split()) >= 2:
                print('if code and parti togther and in 1st and 2nd indx')
                text = dic2[d][1]
                if len(re.findall('^\D+\d+', dic2[d][1].split()[0])) == 1:
                    matchcode = re.search(r'^\D+\d+', text.split()[0])
                dic2[d][1] = matchcode.group()
                dic2[d][2] = dic2[d][2].replace(matchcode.group(), '')
                dic2[d][2] = dic2[d][2].strip()
                print('mactcode', matchcode.group())
            if dic2[d][0] != ' ' and dic2[d][1] == ' ' and dic2[d][2] == ' ' and dic2[d][0] != 'Total' and len(
                    dic2[d][0].split()) >= 3 and len(re.findall('\D+\d+', dic2[d][0].split()[1])) == 1 and len(
                    re.findall('\d+\-\d+\-\d+', dic2[d][0].split()[0])) == 1:
                print('if date, code and parti togther and in 0th')
                text = dic2[d][0]
                if len(re.findall('\D+\d+', dic2[d][0].split()[1])) == 1:
                    matchcode = re.search(r'\D+\d+', text.split()[1])
                if len(re.findall('\d+\-\d+\-\d+', dic2[d][0].split()[0])) == 1:
                    matchdate = re.search(r'\d+\-\d+\-\d+', text.split()[0])
                dic2[d][1] = matchcode.group()
                dic2[d][0] = matchdate.group()
                dic2[d][2] = text.replace(matchcode.group(), '').replace(matchdate.group(), '').replace(' ', '',
                                                                                                        1).replace(' ',
                                                                                                                   '',
                                                                                                                   1)
                dic2[d][2] = dic2[d][2].strip()
            if dic2[d][1] != ' ' and dic2[d][2] != ' ' and dic2[d][1] != ' ' and dic2[d][2] != ' ' and dic2[d][1] == \
                    dic2[d][2]:
                print('if 1st and 2nd are same then 1st empty')
                dic2[d][1] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='sarvodaya-2':
        dic2=dic1
        print('doooothis')
        dic1={}
        lq=1 
        for d in dic2:
            if dic2[d][5].__contains__('Total Rs'):
                print('yes_thisss',dic2[d])
                newll=copy.deepcopy(dic2[d])
                newll.pop(5)
                newll.insert(5,' ') 
                dic1[lq]=newll
                lq +=1
                continue
            if d>1 and dic2[d][4]!= ' ' and dic2[d][5]!= ' ' and dic2[d][7]!= ' ' and dic2[d-1][2].__contains__('Room Rent') and dic2[d].count(' ')<=3 and dic2[d-1].count(' ')>=4:
                print('for room rent')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            dic1[lq]=dic2[d]
            lq +=1
    if hospital == 'sarvodaya3-pharma':
        dic2 = dic1
        dicA = {}
        lq = 1
        for d in dic2:
            if len(dic2[d][3].split()) == 2 and len(re.findall('\d\.\d', dic2[d][3])) == 2:
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # /////////////////////////////
    if hospital=='yashoda' or hospital == 'yashodamalakpet_N3060':
        do_title=['CARDIOLOGY','HIGH PROTEIN DIET','INTENSIVE CARE UNIT','ROOM RENT','RBS WITH GLUCOMETER','PHARMACY','PITUTARY INSTRUMENTS','WARMER','OXYGEN','OPERATION THEATRE CHARGES','CATHTERIZATION CHARGES','VENTILATOR']
        
        dic2=dic1
        dic1={}
        lq=1
        f=0
        fn=len(dic2)
        for d in dic2:
            f +=1
            dic2[d].pop(2)
            dic2[d].insert(2,' ')
            dic2[d].pop(4)
            dic2[d].insert(4,' ')
            if len(re.findall('^\d\d?\s',dic2[d][0]))==1:
                tr_0=re.findall('^\d\d?\s',dic2[d][0])[0].strip()
                tr_1=dic2[d][0].replace(tr_0,'').strip()
                dic2[d].pop(0)
                dic2[d].insert(0,tr_1)
            

            if len(re.findall(' X ',dic2[d][1]))==1:
                tr_1,tr_2=dic2[d][1].split(' X ')
                dic2[d].pop(1)
                dic2[d].pop(1)
                dic2[d].insert(1,tr_2.strip())
                dic2[d].insert(1,tr_1.strip())
            if len(re.findall('\)\sx\s\d',dic2[d][1]))==1:
                try:
                    # tr_1,tr_2=dic2[d][1].split(') x \d')
                    print('this_came_in_yashoda',dic2[d][1])
                    tr_1,tr_2=re.split('\)\sx\s\d',dic2[d][1])
                    dic2[d].pop(1)
                    dic2[d].pop(1)
                    dic2[d].insert(1,tr_2.strip())
                    dic2[d].insert(1,tr_1.strip())
                except:
                    print('error_at_yashoda_interprretation')
            dic1[lq]=dic2[d]
            lq +=1
        
        dic2=dic1
        la=1
        dic1={}
        f=1
        print('now_at_yashoda_merge_222_basic')
        for d in dic2:
            f +=1
            ss =''
            if f==2 and len(re.findall('[A-Z]+\s?[A-Z]+',dic2[d][0]))>=1 and len(dic2[d][0])>5 and dic2[d].count(' ')==5 and dic2[d][0] not in head_list:
                print('this_i_found_spl222_basic_first',dic2[d])
                head_list.append(dic2[d][0])
            dic1[la]=dic2[d]
            la +=1
        print('opopopopopopopop11111',head_list)    

        dic2=dic1
        la=1
        dic1={}
        f=1
        print('now_at_yashoda_merge_222_basic')
        for d in dic2:
            f +=1
            ss =''
            if f==2 and len(re.findall('[A-Z]+\s[A-Z]+',dic2[d][0]))>=1 and len(dic2[d][0])>5 and dic2[d].count(' ')==5 and dic2[d][0] not in head_list:
                print('this_i_found_spl222_basic_first',dic2[d])
                head_list.append(dic2[d][0]) 
            # print('this_i_found',dic2[d])
            if f>3 and dic2[d-1][1].__contains__(sbt) and dic2[d][0] not in head_list and len(dic2[d][0])>5 and dic2[d].count(' ')==5:
                print('this_i_found_spl222_basic',dic2[d])
                head_list.append(dic2[d][0])
            dic1[la]=dic2[d]
            la +=1
        print('opopopopopopopop',head_list)

        dic2=dic1
        dic1={}
        lq=1
        f=0
        fn=len(dic2)
        for d in dic2:
            f +=1
            if dic2[d][0] in head_list and dic2[d].count(' ')<=4:
                print('case_correction_yashoda_at_basic',dic2[d][0])
                dtl=dic2[d][0].title()
                dic2[d].pop(0)
                dic2[d].insert(0,dtl)
            if f>2 and dic2[d][0] in head_list and dic2[d-1][0] in head_list and dic2[d].count(' ')==5 and dic2[d-1].count(' ')==5 and dic2[d][0]==dic2[d-1][0]:
                print('ddddd',dic2[d])
                dtl=dic2[d][0].title()
                dic2[d].pop(0)
                dic2[d].insert(0,dtl)
            if dic2[d].count(' ')==5 and len(dic2[d][0])>10 and len(re.findall('^[A-Z]\s[A-Z]+',dic2[d][0]))==1:
                nwh1 = copy.deepcopy(dic2[d][0])
                nwh = re.sub('^[A-Z]\s','',nwh1)
                if nwh in head_list:
                    print('eeelllmmmm',dic2[d][0],'-------',nwh)
                    dic2[d].pop(0)
                    dic2[d].insert(0,nwh)

            dic1[lq]=dic2[d]
            lq +=1

        dic2=dic1
        la=1
        dic1={}
        f=1
        fn=len(dic2)
        skip_line_three = 0 
        for d in dic2:
            # print('fffffff',dic2[d])
            f +=1
            ss =''
            if f==3 and skip_line_three==1:
                continue
                
            if f==2 and fn>=3 and dic2[d][0]=='SURGERY PACKAGE' and dic2[d+1][0] not in head_list and len(re.findall('\d\s?\.\s?\d',dic2[d][5]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d+1][5]))==1 and len(dic2[d+1][0].split())==2:
                print('this_i_found_splat_yashoda',dic2[d])
                dic1[la] = ['SURGERY PACKAGE', ' ', ' ', ' ', ' ', ' ']
                la +=1
                ness = copy.deepcopy(dic2[d+1][0])
                nes1,nes2 = ness.split()
                dic2[d].pop(0)
                dic2[d].insert(0,nes1)
                dic1[la]=dic2[d]
                la +=1
                dic2[d+1].pop(0)
                dic2[d+1].insert(0,nes2)
                dic1[la]=dic2[d+1]
                la +=1
                skip_line_three=1
                continue
            dic1[la]=dic2[d]
            la +=1

    if hospital=='noblehospitalspune':
        dic2=dic1
        dic1={}
        lq=1
        f=0
        for d in dic2:
            ss=''
            f +=1
            if "Surgery Charges" in dic2[d][0] and dic2[d][1:].count(' ')<5 and len(dic2[d][0])>30 and ss.join(dic2[d-1]).__contains__(sbt)==False:
                dic1[lq] = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
                lq +=1
                dic1[lq] = ['Surgery Charges', ' ', ' ', ' ', ' ', ' ']
                lq +=1
                nevv = copy.deepcopy(dic2[d])
                nvv_z = nevv[0].replace("Surgery Charges","").strip()
                nevv.pop(0)
                nevv.insert(0,nvv_z)
                dic1[lq]=nevv
                lq +=1
                continue
            
            if f>2 and "Sale Return Amount" in dic2[d][0] and "Administration Charges" in dic2[d-1][0]:
                dic1[lq] = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
                lq +=1
                print('hhhhhhbbbbb3333',dic2[d-1],dic2[d])
            if dic2[d][0] in head_list and dic2[d][1:].count(' ')==5:
                nevv = copy.deepcopy(dic2[d])
                print('nobeeeee_for_headddd',nevv)
                nevv.pop(5)
                nevv.insert(5,'0.0')
                dic1[lq]=nevv
                lq +=1
                continue
            if 'Pharmacy' in dic2[d][0] and 'Sale' in dic2[d][0] and 'Return' in dic2[d][0] and 'Amount' in dic2[d][0] and dic2[d][1:].count(' ')==5:
                nvv_z = 'Pharmacy /Sale Return Amount (-)'
                nevv = copy.deepcopy(dic2[d])
                print('nobeeeee_for_headddd_spllll',nevv)
                nevv.pop(0)
                nevv.insert(0,nvv_z)
                dic1[lq]=nevv
                lq +=1
                continue            
            dic1[lq]=dic2[d]
            lq +=1 


        dic2=dic1
        dic1={}
        lq=1
        f =0
        for d in dic2:
            f +=1
            nevv = copy.deepcopy(dic2[d])
            # print('nobeeeee_inn',nevv)
            if nevv[2].__contains__('=') and len(nevv[1].strip())==0 and len(nevv[3].strip())==0:
                if len(nevv[2].split('='))==2:
                    tw1,tw2 = nevv[2].split('=')
                    print('nobbbqqq',nevv,tw1.__contains__('X'),tw1.__contains__('x'))
                    if tw1.__contains__('X'):
                        if len(nevv[2].split('X'))==2:
                            twf1,twf2 = tw1.split('X')
                            nv_1=twf1
                            nv_2=twf2
                            nv_3=tw2
                            nevv.pop(1)
                            nevv.insert(1,nv_1.strip())
                            nevv.pop(2)
                            nevv.insert(2,nv_2.strip())
                            nevv.pop(3)
                            nevv.insert(3,nv_3.strip())
                            print('nobeeeee_nowww',nevv)
                    if tw1.__contains__('x'):
                        if len(nevv[2].split('x'))==2:
                            twf1,twf2 = tw1.split('x')
                            nv_1=twf1
                            nv_2=twf2
                            nv_3=tw2
                            nevv.pop(1)
                            nevv.insert(1,nv_1.strip())
                            nevv.pop(2)
                            nevv.insert(2,nv_2.strip())
                            nevv.pop(3)
                            nevv.insert(3,nv_3.strip())
                            print('nobeeeee_nowww222',nevv)
                    
            dic1[lq]=nevv
            lq +=1 

    if hospital=='yashoda-2':

        dic2=dic1
        dic1={}
        la=1
        f =0
        for d in dic2:
            f +=1
            try:
                if len(re.findall('\d\s?\.\s?\d',dic2[d][1]))==1 and len(re.sub('[0-9]','',dic2[d][1]))<2 and len(re.findall('\d\s?\.\s?\d',dic2[d][2]))==1 and len(re.sub('[0-9]','',dic2[d][2]))<2 and len(dic2[d][0])>25 and len(dic2[d][3].strip())==0:
                    print('hhhhhhhhhhhhbbbbbbbbbb',dic2[d]) 
                    nevv = copy.deepcopy(dic2[d])
                    nevv1 = nevv[:1] + [' '] + nevv[1:3] + nevv[4:]
                    nevv = nevv1
                    print('hhhhhhhhllllllll',nevv)
                    dic1[la]=nevv
                    la +=1 
                    continue
            except:
                print('yashoda-222_hospital_basic_zeroandfirst_cell_error_yt7890oouu')
            dic1[la]=dic2[d]
            la +=1 

        dic2=dic1
        dic1={}
        la=1
        f =0
        for d in dic2:
            f +=1
            try:
                if len(dic2[d][0].strip())>20  and len(re.findall('\d\d?\/\d{2}\/\d{4}\s\d{2}\:\d{2}\s\-\s\w{4}\/\d{2,6}|\d\d?\/\d{2}\/\d{4}\s\d{2}\:\d{2}\s\-\s\d{2}\-\d{2}\/\d{2,6}',dic2[d][0]))==1:
                    print('yasoda-2_ssssss',re.findall('\d\d?\/\d{2}\/\d{4}\s\d{2}\:\d{2}\s\-\s\w{4}\/\d{2,6}|\d\d?\/\d{2}\/\d{4}\s\d{2}\:\d{2}\s\-\s\d{2}\-\d{2}\/\d{2,6}',dic2[d][0])[0],'-----',dic2[d])
                    nevv = copy.deepcopy(dic2[d])

                    nvv_z = copy.deepcopy(re.findall('\d\d?\/\d{2}\/\d{4}\s\d{2}\:\d{2}\s\-\s\w{4}\/\d{2,6}|\d\d?\/\d{2}\/\d{4}\s\d{2}\:\d{2}\s\-\s\d{2}\-\d{2}\/\d{2,6}',dic2[d][0])[0])
                    nvv_o_ext = copy.deepcopy(dic2[d][1])
                    nvv_o = re.sub(re.findall('\d\d?\/\d{2}\/\d{4}\s\d{2}\:\d{2}\s\-\s\w{4}\/\d{2,6}|\d\d?\/\d{2}\/\d{4}\s\d{2}\:\d{2}\s\-\s\d{2}\-\d{2}\/\d{2,6}',dic2[d][0])[0],'',dic2[d][0])
                    nvv_o = (nvv_o_ext.strip() + ' ' + nvv_o.strip()).strip()
                    nevv.pop(0)
                    
                    nevv.insert(0,nvv_z.strip(' - '))
                    nevv.pop(1)
                    nevv.insert(1,nvv_o.strip(' - '))
                    dic1[la] = nevv
                    la +=1
                    continue
                
            except:
                print('yashoda-222_hospital_basic_zeroandfirst_cell_error_ytyi67523')
            dic1[la]=dic2[d]
            la +=1

    if hospital=='yashoda-3':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00=',dic2[d])
            if dic2[d][0]!= ' ' and dic2[d][0] not in head_list and dic2[d].count(' ')>=4 and len(re.findall('\d+\-\w+\-\d+',dic2[d][0]))==0:
                print('extra lines')
                dic2[d][1] = dic2[d][0]
                dic2[d][0] = ' '

            dic1[lq]=dic2[d]
            lq +=1

    if hospital=="holy":
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            if dic2[d][0] in head_list and len(re.findall('\d\s?\.\s?\d',dic2[d][5])) and dic2[d].count(' ')<3:
                print('hjklhgff111',dic2[d])
                nevv = copy.deepcopy(dic2[d])
                linzero = nevv[0]
                dic1[lq]=[linzero , ' ', ' ', ' ', ' ', ' ']
                lq +=1
                nevv.pop(0)
                nevv.insert(0,' ')
                dic1[lq]=nevv
                lq +=1
                continue
            if len(re.findall('\d\s?\.\s?\d',dic2[d][5]))==1 and dic2[d][:5].count(' ')==5:
                print('kkklllffffff',dic2[d])
                continue
            if dic2[d][0]==dic2[d][1] and len(dic2[d][1])>2:
                print('kkklllffffff_ppppppp',dic2[d])
                nevv = copy.deepcopy(dic2[d])
                nevv.pop(1)
                nevv.insert(1,' ')
                dic1[lq]=nevv
                lq +=1
                continue
            dic1[lq]=dic2[d]
            lq +=1

    if hospital=="srch":
        dic2=dic1
        dic1={}
        lq=1
        f=0
        for d in dic2:
            f +=1
            if dic2[d].count(' ')==6:
                continue
            if len(re.findall('\d.\d{2,4}.00',dic2[d][5]))==1 and 5<len(dic2[d][5])<10 and dic2[d][5].replace('.','').isdigit()==True:
                print('lastgggg_srch',dic2[d])
                nevv = copy.deepcopy(dic2[d])
                nvv_f = nevv[5].replace('.','',1)
                nevv.pop(5)
                nevv.insert(5,nvv_f)
                dic1[lq] = nevv
                lq +=1
                continue
            if f>2 and len(re.findall('\d\s?\.\s?\d',dic2[d][5]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d][3]))==1 and dic2[d-1][3:].count(' ')==3 and len(dic2[d][0].strip())==0 and len(re.findall('\d{3}',dic2[d-1][0]))>=1:
                print('kkklllffffff_555',dic2[d])
                nww=opr1(dic2[d-1],dic2[d],src_dc)
                dic1[lq-1]=nww
                continue
            if "BED CHARGES" in dic2[d][0] and len(dic2[d][0].strip())>12 and len(re.findall('\d\s?\.\s?\d',dic2[d][5]))==1:
                print('ggggggglffffff_5557777',dic2[d])
                dic1[lq] = ['BED CHARGES', ' ', ' ', ' ', ' ', ' ']
                lq +=1
                nevv = copy.deepcopy(dic2[d])
                nvv_z = nevv[0].replace("BED CHARGES","").strip()
                nevv.pop(0)
                nevv.insert(0,nvv_z)
                dic1[lq] = nevv
                lq +=1
                continue
            if dic2[d][0] in head_list and len(re.findall('\d\s?\.\s?\d',dic2[d][3]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d][5]))==1:
                nevv = copy.deepcopy(dic2[d])
                print('ggggggglffffhhhh7777',dic2[d])
                nvv_z = nevv[0]
                nevv.pop(0)
                nevv.insert(0,' ')
                dic1[lq] = nevv
                lq +=1
                dic1[lq] = ['nvv_z', ' ', ' ', ' ', ' ', ' ']
                lq +=1
            dic1[lq]=dic2[d]
            lq +=1

    if hospital == 'yashoda-pharma' or hospital == 'yashodamalakpet_N3060-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            dic2[d].pop(1)
            dic2[d].insert(1, ' ')

            if len(re.findall('\d{2}\/\d{2}\/\d{4}', dic2[d][0])) == 1:
                if len(re.findall('\d\s?\.\s?\d', dic2[d - 1][5])) == 1:
                    # print('xxxx',dic2[d-1])
                    dtr_5 = dic2[d - 1][5]
                    last_dtr = copy.deepcopy(dic2[d - 1])
                    last_dtr.pop(5)
                    last_dtr.insert(5, ' ')
                    dic1[lq - 1] = last_dtr
                    mid_dtr = copy.deepcopy([' ', ' ', ' ', ' ', ' ', dtr_5])
                    dic1[lq] = mid_dtr
                    lq += 1

                dtr0 = dic2[d][0]
                lis_dtr = copy.deepcopy([dtr0, ' ', ' ', ' ', ' ', ' '])
                dic1[lq] = lis_dtr
                lq += 1
                dic2[d].pop(0)
                dic2[d].insert(0, ' ')
            dic1[lq] = dic2[d]
            lq += 1
        dic2 = dic1
        dic1 = {}
        lq = 1
        f = 0
        for d in dic2:
            print('dd==', dic2[d])
            f += 1
            dic2[d].pop(5)
            dic2[d].insert(5, ' ')
            if len(re.findall('\d{2}\/\d{2}\/\d{4}', dic2[d][0])) == 1:
                dtr1 = re.findall('\d{2}\/\d{2}\/\d{4}', dic2[d][0])[0].strip()
                dtr0 = dic2[d][0].replace(dtr1, '').strip()
                dic2[d].pop(0)
                dic2[d].pop(0)
                dic2[d].insert(0, dtr1)
                dic2[d].insert(0, dtr0)
            if len(re.findall('\d\s?\.\s?\d', dic2[d][5])) == 1 and dic2[d].count(' ') == 5:
                continue
            if dic2[d][0].__contains__('Item Issues'):
                print('uuuu1', dic2[d])
                dic2[d].pop(0)
                dic2[d].insert(0, 'Item Issues')
            if dic2[d][0].__contains__('Item Returns'):
                dic2[d].pop(0)
                dic2[d].insert(0, 'Item Returns')
            if f > 3 and dic2[d][4].__contains__(' -'):
                dic2[d][4] = dic2[d][4].replace(' -', '.')
            if dic2[d][0] == 'Iton Returns >> > > >':
                dic2[d][0] = 'Item Returns'
            if dic2[d][2] == 'Item Returns':
                dic2[d][0] = 'Item Returns'
                dic2[d][2] = ' '
            if f > 3 and f < len(dic2) + 3 and len(
                    re.findall('\w{5}\s\d{2}\w{2}\s\w{3}\s\w{8}\s\d\w{2}\s\w{3}', dic2[d][2])) == 1 and len(
                    re.findall('\w{4}', dic2[d][3])) == 1 and len(
                    re.findall('\d{2}\s\.\s\d{2}\s\d{2}\s\.\s\d{2}', dic2[d][4])) == 1 and \
                    dic2[d].count(' ') == 3:
                print('for 220201947841 FUPAN 40MG')
                text = dic2[d][2]
                val = dic2[d][4]
                matchparti1 = re.search(r'\w{5}\s\d{2}\w{2}\s', text)
                matchval1 = re.search(r'\d{2}\s\.\s\d{2}\s', val)
                listnw = [' ', ' ', matchparti1.group(), ' ', matchval1.group(), ' ']
                dic2[d][2] = text.replace(matchparti1.group(), '')
                dic2[d][4] = val.replace(matchval1.group(), '')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if f > 3 and f < len(dic2) + 3 and len(
                    re.findall('\w{7}\s\d{2}\w{2}\-\(\w{7}\)\s\w{5}\s\d{2}\w{2}\s\w{3}', dic2[d][2])) == 1 and len(
                    re.findall('\w{4}', dic2[d][3])) == 1 and len(
                    re.findall('\d{2}\.\d{2}\s\d{2}\s\.\s\d{2}', dic2[d][4])) == 1 and \
                    dic2[d].count(' ') == 3:
                print('for 220100577137 FUPAN 40MG')
                text = dic2[d][2]
                val = dic2[d][4]
                matchparti1 = re.search(r'\w{7}\s\d{2}\w{2}\-\(\w{7}\)\s', text)
                matchval1 = re.search(r'\d{2}\.\d{2}\s', val)
                listnw = [' ', ' ', matchparti1.group(), ' ', matchval1.group(), ' ']
                dic2[d][2] = text.replace(matchparti1.group(), '')
                dic2[d][4] = val.replace(matchval1.group(), '')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1

        dic2=dic1
        dic1={}
        lq=1
        spl_yashoda_pharma_line = [[' ', ' ', 'SYRINGE 10ML-(EMERALD) FUPAN 40MG INJ', 'PHPNK', '25.00 45 . 20', ' ']]
        spl_yashoda_pharma_line_newww_split = [[[' ', ' ', 'SYRINGE 10ML-(EMERALD)', ' ', '25.00', ' '], [' ', ' ', 'FUPAN 40MG INJ', ' ', '45 . 20', ' ']]]
        for d in dic2:
            if dic2[d] in spl_yashoda_pharma_line:
                # print('uuuuuuuuuuuqqqqqq11111',dic2[d])
                dic1[lq]=spl_yashoda_pharma_line_newww_split[0][0]
                lq +=1
                # print('uuuuuuuuuuuqqqqqq222222',spl_yashoda_pharma_line_newww_split[0][0])
                dic1[lq]=spl_yashoda_pharma_line_newww_split[0][1]
                lq +=1
                # print('uuuuuuuuuuuqqqqqq333333',spl_yashoda_pharma_line_newww_split[0][1])
                continue
            dic1[lq]=dic2[d]
            lq +=1

    if hospital=='srch-pharma':

        dic2 = dic1
        dic1 = {}
        lq = 1
        print('uiiiopppp',)
        for d in dic2:
            if dic2[d][0]=='redit Sa' and dic2[d].count(' ')==5:
                
                print('yyuuuuuoooo9999',dic2[d].count(' '),len(re.findall('\d\s?\.\s?\d',dic2[d][5])))
                nevv = copy.deepcopy(dic2[d])
                nevv.pop(0)
                nevv.insert(0,'Credit Sales')
                nevv.pop(4)
                nevv.insert(4,' ')
                dic1[lq] = nevv
                lq += 1 
                continue
            dic1[lq] = dic2[d]
            lq += 1 
       
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            if len(re.findall('\d{2}\/\d{2}\/\d{4}',dic2[d][0]))==1:
                f1=copy.deepcopy(re.findall('\d{2}\/\d{2}\/\d{4}',dic2[d][0])[0])
                if len(dic2[d][1].strip())==0:
                    f2=copy.deepcopy(dic2[d][0].split(f1)[1].strip())
                    dic2[d].pop(0)
                    dic2[d].pop(0)
                    dic2[d].insert(0,f2)
                    dic2[d].insert(0,f1)
                else:
                    dic2[d].pop(0)
                    dic2[d].insert(0,f1)
            if len(dic2[d][5])>1:
                f3=dic2[d][5].split()[0]
                dic2[d].pop(-1)
                dic2[d].append(f3)
            dic1[lq]=dic2[d]
            lq +=1

        dic2=dic1
        dic1={}
        lq=1
        f=1
        for d in dic2:
            f +=1
            if f>3 and dic2[d][0] in head_list:
                dic2[d-1].pop(1)
                dic2[d-1].insert(1,'Subtotal')
                dic1[lq-1]=dic2[d-1]
            dic1[lq]=dic2[d]
            lq +=1


    if hospital=='lilavati-pharma':
        dic2=dic1
        dic1={}
        lq=1
        f =1
        l_st=[]
        for d in dic2:
            f +=1
            if f>3 and dic2[d].count(' ')==5 and len(dic2[d][0])>1 and l_st.count(' ')==4 and len(l_st[5])>1 and l_st[1]!='Subtotal':
                print('fffff',dic2[d])
                tq=l_st[5]
                l_st.pop(5)
                l_st.insert(5,' ')
                dic1[lq-1]=l_st
                dic1[lq]=[' ','Subtotal',' ',' ',' ',tq]
                lq +=1
            dic1[lq]=dic2[d]
            l_st=dic2[d]
            lq +=1
        
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            if dic2[d].count(' ')<noc-2 and len(dic2[d][0])>1:
                tq=dic2[d][0]
                dic1[lq]=[tq,' ',' ',' ',' ',' ']
                lq +=1
                dic2[d].pop(0)
                dic2[d].insert(0,' ')
            dic1[lq]=dic2[d]
            lq +=1
    
    
    if hospital=='lilavati':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            if len(dic2[d][0])>20 and len(re.findall('[A-Z]{2}\/\d{5,8}',dic2[d][0]))==1:
                print('hjhjhjhjhj',dic2[d],re.findall('[A-Z]{2}\/\d{5,8}',dic2[d][0]))
                nwl = copy.deepcopy(dic2[d])
                fst_one = copy.deepcopy(dic2[d][0])
                snd_one = copy.deepcopy(dic2[d][1])
                tht_one = copy.deepcopy(dic2[d][2])

                ov1,ov3 = re.split('[A-Z]{2}\/\d{5,8}',fst_one)
                ov1 = ov1.strip()
                ov2 = re.findall('[A-Z]{2}\/\d{5,8}',fst_one)[0]
                ov3 = ov3.strip()
                print('o1,o2,o3',ov1,'***',ov2,'***',ov3)
                fst_one = ov1
                snd_one = (ov2+' '+snd_one).strip()
                tht_one = (ov3+' '+tht_one).strip()
                
                nwl.pop(0)
                nwl.insert(0,fst_one)
                nwl.pop(1)
                nwl.insert(1,snd_one)
                nwl.pop(2)
                nwl.insert(2,tht_one)
                dic1[lq]=nwl
                lq +=1
                continue
            
            dic1[lq]=dic2[d]
            lq +=1

    if hospital=='ruby':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            
            if len(re.findall('\d\d?\/\d\d?',dic2[d][0]))==1 and dic2[d].count(' ')==5 and 3<=len(dic2[d][0].strip())<=6:
                print('fffvvv',dic2[d],len(dic2[d][0].strip()),dic2[d].count(' '),len(re.findall('\d\d?\/\d\d?',dic2[d][0])))
                continue
            dic1[lq]=dic2[d]
            lq +=1

        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            if dic2[d].count(' ')==5 and len(re.findall('\-\d{2}\-',dic2[d][5]))>=1:
                continue
            dic1[lq]=dic2[d]
            lq +=1

        say_head={'10':'ROOM & NURSING CHARGES','20':'ICU CHARGES','40':'MEDICINE & CONSUMABLES','50':'PROFESSIONAL FEES','60':'INVESTIGATION CHARGES','30':'OT CHARGES','80':'MISCELLANEOUS CHARGES','90':'PACKAGE CHARGES'}
        say_head_now=''
        dic2=dic1
        dic1={}
        lq=1
        pick_head = []
        for d in dic2:
            print('yyyyuuu',dic2[d])
            if dic2[d][1][0:2] in say_head:
                # say_head_now=say_head[dic2[d][1][0:2]]
                pick_head.append(dic2[d][1][0:2])
                # break
            if say_head_now=='' and (len(re.findall('\d{2}\-\d{3}', dic2[d][1][0:6])) == 1 or dic2[d][1] == ' '):
                say_head_now='OTHERS'
        fl=0 
        
        print(pick_head,'qwwweerttt') 
        
        if len(pick_head)!=0:
            pick_head1=pick_head
            pick_head=[]
            for ph in pick_head1:
                if ph in say_head:
                    pick_head.append(ph)
            if len(pick_head)!=0:
                say_head_now=say_head[max(set(pick_head), key = pick_head.count)]  
        print(say_head_now,'qwwweerttt')
        
        if say_head_now=='':
            say_head_now=' '
        for d in dic2:
            fl+=1
            if fl==1:
                dic1[lq]=[say_head_now,' ',' ',' ',' ',' ']
                lq +=1
            dic1[lq]=dic2[d]
            lq +=1

    if hospital=='ruby-pharma':
        dic1_a=dic1
        la=1
        dic1={}
        for d in dic1_a:
            if len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d][5]))==1:
                print('ppppp',dic1_a[d])
                dtr6=re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d][5])[0]
                dtr5=dic1_a[d][5].replace(dtr6,'').strip()
                dic1_a[d].pop(5)
                dic1_a[d].pop(5)
                dic1_a[d].insert(5,dtr6)
                dic1_a[d].insert(5,dtr5)
                
            if len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d][5]))==1:
                print('ppppp',dic1_a[d])
                dtr6=re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d][5])[0]
                dtr5=dic1_a[d][5].replace(dtr6,'').strip()
                dic1_a[d].pop(5)
                dic1_a[d].pop(5)
                dic1_a[d].insert(5,dtr6)
                dic1_a[d].insert(5,dtr5)

            if (dic1_a[d][0]=='SSUE' or dic1_a[d][0]=='ISSUE') and dic1_a[d].count(' ')==6:
                dic1_a[d].pop(0)
                dic1_a[d].insert(0,"ISSUES")
            if dic1_a[d][0]=='RETURN' and dic1_a[d].count(' ')==6:
                dic1_a[d].pop(0)
                dic1_a[d].insert(0,"RETURNS")
            dic1[la]=dic1_a[d]
            la +=1

        dic1_a=dic1
        la=1
        dic1={}
        for d in dic1_a:
            if len(dic1_a[d][5])>6 and  len(dic1_a[d][5].split())>=2 and len(re.findall('\d\.\d',dic1_a[d][5].split()[0]))==1 and len(re.findall('\d\.\d',dic1_a[d][5].split()[1]))==0 and len(re.sub('[A-Za-z]','',dic1_a[d][5].split()[1]))<3:
                print('ppppp',dic1_a[d])
                dtr5 = dic1_a[d][5].split()[0]
                dtr6 = dic1_a[d][5].replace(dtr5,'').strip()
                dic1_a[d].pop(5)
                dic1_a[d].insert(5,dtr5)
                dic1_a[d].pop(6)
                dic1_a[d].insert(6,dtr6)
                
            dic1[la]=dic1_a[d]
            la +=1

    
    if hospital=='apolo':
        dic2=dic1
        dic1={}
        lq=1
        f=0
        fn=len(dic2)
        date_fix={'or-2021':'29-Apr-2021'}
        total_fix={'t Sub Tot':'Dept Sub Total :'}
        for d in dic2:           
            f +=1
            if f>2 and dic2[d-1][0] in head_list and dic2[d].count(' ')==8:
                if dic2[d][1] in date_fix:
                    # print('uuuuuu',date_fix[dic2[d][1]])
                    tsv=copy.deepcopy(date_fix[dic2[d][1]])
                    dic2[d].pop(1)
                    dic2[d].insert(1,tsv)
                
            if dic2[d][6] in total_fix:
                # print('uuuuuu',date_fix[dic2[d][1]])
                tsv=copy.deepcopy(total_fix[dic2[d][6]])
                dic2[d].pop(6)
                dic2[d].insert(6,tsv)
            if f>2 and len(re.findall('^TAB',dic2[d][1]))==1 and len(re.findall('\d\/\d{2}\/\d{4}',dic2[d][3]))==1 and len(dic2[d][0].strip())==0 and dic2[d][4:].count(' ')==5 and len(re.findall('\d{5}',dic2[d-1][0]))==1 and len(dic2[d-1][1])>4 and dic2[d-1][2:].count(' ')==7:
                print('fffffff',dic2[d-1],dic2[d])
                dic1[lq-1] = opr1(dic2[d-1],dic2[d],src_dc)
                continue
            if len(dic2[d][0])>5 and dic2[d].count(' ')<=7 and (len(re.findall('\d\s?\.\s?\d',dic2[d][8]))>=1 or len(re.findall('\d\.\d',dic2[d][6]))>=1) and len(dic2[d][0].split())>=2 and dic2[d][0].split()[0].isdigit()==True:            
                # print('hqqqq',dic2[d])
                tq1=dic2[d][0].split()[0]
                ttq1=copy.deepcopy(dic2[d][0].split()[0])
                # print(tq1,'--',len(dic2[d][0].split()[1]),'--',dic2[d][0].split()[1],'--',re.sub('[0-9 ]','',dic2[d][0].split()[1]))
                if len(tq1) in range(1,3) and len(dic2[d][0].split()[1])<=12 and len(re.sub('[0-9 ]','',dic2[d][0].split()[1]))<=5:
                    # print('noooww',dic2[d])
                    tq1=dic2[d][0].split()[1]
                tq2=dic2[d][0].replace(tq1,'').replace(ttq1,'').strip()
                tq3=tq2+' '+dic2[d][1]
                dic2[d].pop(0)
                dic2[d].pop(0)
                dic2[d].insert(0,tq3)
                dic2[d].insert(0,tq1)
            if len(dic2[d][0])>5 and len(dic2[d][1])==1 and len(re.sub('[0-9 ]','',dic2[d][0]))>=3 and (len(re.findall('\d\.\d',dic2[d][8]))>=1 or len(re.findall('\d\.\d',dic2[d][6]))>=1) and dic2[d].count(' ')<=6:
                ta=dic2[d][0]
                ta1=''
                ta2=''
                if len(re.findall('\d{3,}',dic2[d][0]))>=1:
                    ta1=re.findall('\d{3,}',dic2[d][0])[0]
                    ta2=ta.split(ta1)[1]
                    dic2[d].pop(0)
                    dic2[d].pop(0)
                    dic2[d].insert(0,ta2)
                    dic2[d].insert(0,ta1)
            #         rahul
            if f>2 and d<len(dic2) and  dic2[d].count(" ") == 5 and dic2[d+1].count(" ") == 6 and  dic2[d+1][1].replace(" ","").isdigit() == True  and len(re.findall("\d{1,}:\d{1,}",dic2[d+1][3]))>=1 and len(dic2[d][1])<1 and len(re.findall("\d{1,}\/\d{1,}\/\d{1,}",dic2[d][3]))>=1 and  len(re.findall("\d{1,} d{1,}",dic2[d][6]))>=1 and    len(re.findall("\d{1,} d{1,}",dic2[d][8]))>=1 :
                opr1(dic2[d+1],dic2[d],src_dc)
            if f>2 and d<len(dic2)-2 and  dic2[d].count(" ") == 5 and dic2[d+1].count(" ") == 6 and dic2[d+2].count(" ") == 6 and  len((dic2[d+1][1])) >=7 and len(re.findall("\d{1,}.\d{1,}",dic2[d+2][6]))>=1  and  len(re.findall("\d{1,} \d{1,}",dic2[d+2][8]))>=1 and    len(re.findall("\d{1,}\/\d{1,}\/\d{1,}",dic2[d][3]))>=1 and  len(re.findall("\(\w{1,}\)",dic2[d+2][1])) >=1 and  len(re.findall("\d{1,}.\d{1,}",dic2[d][8]))>=1 and  len(re.findall("\d{1,} \d{1,}",dic2[d][8]))>=1:
                print("fafuuuuu",dic2[d])
                x = dic2[d+2][6]
                dic2[d+2][6] = " "
                print(x,"xxxx")
                dic2[d+3][6] = x
                y = dic2[d+2][8]
                dic2[d+2][8] = " "
                print(y,"yyyyy")
                dic2[d+3][8] = y
            # ////////////
            dic1[lq]=dic2[d]
            lq +=1
        # for d in dic1:
        #     print('hhhhhh',dic1[d])
        dic2=dic1
        dic1={}
        lq=1
        f=0
        fn=len(dic2)
        for d in dic2:  
            # print('hhhhhh',dic2[d])          
            f +=1
            if f>2 and f+1<fn and len(re.findall('\d{2}\-[A-Z][a-z]{2}\-\d{4}',dic2[d+1][0]))==1 and len(dic2[d+1][0])==11 and dic2[d+1].count(' ')==8 and dic2[d+2][1] in ['Food and Beverages'] and dic2[d+2].count(' ')==8 and len(re.findall('\d\d?\:\d\d?',dic2[d][3]))==1 and 3<len(dic2[d][3])<6 and len(re.findall('\d\s?\.\s?\d',dic2[d][8]))==1 and dic2[d].count(' ')==7 and len(re.findall('\d\d?\/\d{2}\/\d{4}',dic2[d-1][3]))==1 and 8<len(dic2[d-1][3])<19 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==1:
                # print('guuuuuuu',dic2[d-1],dic2[d])
                lunk=copy.deepcopy(dic2[d])
                lunk_1 = lunk[3]
                lunk_2 = lunk[8]
                lunk.pop(8)
                lunk.insert(8,' ')
                lunk_one = copy.deepcopy(lunk)
                # lunk_two = [' ', ' ', ' ', ' ', ' ', 'Dept Sub Total :', ' ', ' ', lunk_2]
                dic1[lq-1] = opr1(dic2[d-1],lunk_one,src_dc)
                # dic1[lq] = lunk_two
                # print(lq-1,lq,opr1(dic2[d-1],lunk_one,src_dc),lunk_two)
                continue
            dic1[lq]=dic2[d]
            lq +=1
        # for d in dic1:
        #     print('ggggggg',dic1[d])
        dic2=dic1
        dic1={}
        lq=1
        f=1
        for d in dic2:
            f +=1
            if f>3 and dic2[d].count(' ')==7 and len(re.findall('\d\.\d',dic2[d][6]))==1 and len(re.findall('\d\.\d',dic2[d][8]))==1 and len(dic2[d-1][6].strip())==0 and len(dic2[d-1][8].strip())==0 and len(dic2[d-1][1].strip())>4:
                print('kkkkkkk',dic2[d])
                dic2[d]=opr1(dic2[d-1],dic2[d],src_dc)                
                lq -=1
            dic1[lq]=dic2[d]
            lq +=1
        # #####################for 110100506850

        dic2 = dic1
        dic1 = {}
        lq = 1
        f = 1
        for d in dic2:
            f += 1
            if dic2[d][1] == 'Microblology':
                dic2[d][1] = 'Microbiology'
            if dic2[d][1] == 'Physiotherapy and Rehab Cen':
                dic2[d][1] = 'Physiotherapy and Rehab Centre'
            if dic2[d][1] == 'consultation':
                dic2[d][1] = 'Consultation'
            if dic2[d][1] == 'n(999311)':
                dic2[d][0] = 'Consultation(999311)'
                dic2[d][1] = ' '
            if dic2[d][0].__contains__('ROOM RENT') and len(re.findall('\d+\s\d+\D\s\d+\.\d+', dic2[d][5])) == 1:
                print('for room rent 5 26, 100.00 in 5th indx')
                text = dic2[d][5].split()
                dic2[d][5] = text[0]
                dic2[d][6] = text[1]+text[2]
            if dic2[d][0].__contains__('ROOM RENT') and len(re.findall('\d+\.\d+', dic2[d][6])) == 1 and dic2[d][8] == ' ':
                print('for room rent 8th indx empty and 6th indx not empty')
                dic2[d][8] = dic2[d][6]
                dic2[d][6] = ' '
            # if dic2[d][5].__contains__('hr'):
            #     dic2[d][4] = dic2[d][4] + ' ' + dic2[d][5]
            #     dic2[d][5] = ' '
            # if dic2[d][4].__contains__('hr') or dic2[d][4].__contains__('min'):
            #     print('if hr is present in 4th index with date')
            #     text = dic2[d][4]
            #     if len(re.findall('\s\w?\w+\s\d+\w+', dic2[d][4])) == 1:
            #         print('11111sttttttttt')
            #         matchtime = re.search(r'\s\w?\w+\s\d+\w+', text)
            #     elif len(re.findall('\s\d+\w+\s\d+\w+', dic2[d][4])) == 1:
            #         print('222222nnndddd')
            #         matchtime = re.search(r'\s\d+\w+\s\d+\w+', text)
            #     dic2[d][5] = matchtime.group()
            if dic2[d][0] == 'Murilcal Records(9993)':
                dic2[d][0] = 'Medical Records(9993)'
            if dic2[d][0] == '01 Charges(9993)':
                dic2[d][0] = 'OT Charges(9993)'
            if dic2[d][6] == 'Page 4 of 19' or dic2[d][6] == 'Page 2 of 4' or dic2[d][6] == 'Page 3 of 13' or dic2[d][
                6].__contains__('Page'):
                dic2[d][6] = ' '
            if dic2[d][5] != ' ' and len(dic2[d][5].split()) == 2 and len(re.findall('\d+\.\d+', dic2[d][5])) >= 1 and \
                    dic2[d][6] == ' ':
                print('if qty,rate together in 5th index')
                a, b = dic2[d][5].split()
                dic2[d][5] = a
                dic2[d][6] = b
            if '|' == dic2[d][0][0] and dic2[d].count(' ')>=6:
                print('yesss header with |',dic2[d][0])
                dic2[d][0] = dic2[d][0].replace(dic2[d][0][0],'')
            if dic2[d][1] == ' ' and len(re.findall('\d{2}\s\d{8}', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()[0]) == 2 and len(dic2[d][0].split()[1]) == 8 and dic2[d].count(' ') >= 4:
                print('for 220201949817 with 2space8 digits and parti in oth index', dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\d{2}\s\d{8}', text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(), '')
            if dic2[d][1] == ' ' and len(re.findall('\d{2}\s\d{9}', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()[0]) == 2 and len(dic2[d][0].split()[1]) == 9 and dic2[d].count(' ') >= 4:
                print('for 220201949817 with 2space9 digits and parti in oth index')
                text = dic2[d][0]
                matchcode = re.search(r'\d{2}\s\d{9}', text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(), '')
            if (dic2[d][1] == ' ' or dic2[d][1] != ' ') and (
                    len(re.findall('\d{8}\s', dic2[d][0])) == 1 or len(re.findall('\d{9}\s', dic2[d][0])) == 1 or len(
                    re.findall('\d{6}\s', dic2[d][0])) == 1 or len(re.findall('\d{5}\s', dic2[d][0])) == 1) and len(
                    dic2[d][0].split()) > 2 and len(dic2[d][0].split()[0]) >= 5:
                print('if code and parti together with 5,6,8,9, digits', dic2[d])
                text = dic2[d][0]
                if len(re.findall('\d{9}\s', dic2[d][0])) == 1:
                    matchcode = re.search(r'\d{9}\s', text)
                elif len(re.findall('\d{8}\s', dic2[d][0])) == 1:
                    matchcode = re.search(r'\d{8}\s', text)
                elif len(re.findall('\d{6}\s', dic2[d][0])) == 1:
                    matchcode = re.search(r'\d{6}\s', text)
                elif len(re.findall('\d{5}\s', dic2[d][0])) == 1:
                    matchcode = re.search(r'\d{5}\s', text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(), '')
                dic2[d][0] = dic2[d][0].replace(' ', '')
            if len(re.findall('\d{2}\D\d{3}', dic2[d][0])) == 1 and len(dic2[d][0].split()) > 2 and len(
                    dic2[d][0].split()[0]) == 6 and '(' not in dic2[d][0]:
                print('if code and parti together with 5 digits including +', dic2[d])
                text = dic2[d][0]
                if len(re.findall('\d{2}\D\d{3}', dic2[d][0])) == 1:
                    matchcode = re.search(r'\d{2}\D\d{3}', text)
                dic2[d][1] = text.replace(matchcode.group(), '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'apolo_daycare':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmmdd===', dic2[d])
            if dic2[d][1] in head_list:
                dic2[d][0] = dic2[d][1]

            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'Sahyadri':
        dic2 = dic1
        dic1 = {}
        lq = 1
        f = 0
        for d in dic2:
            f += 1
            if f > 2 and (len(re.findall('\d\s?\.\s?\d', dic2[d][6])) == 1 or len(
                    re.findall('\d{2}\/\d{2}\/\d{2}', dic2[d][1])) == 1) and dic2[d - 1][1:].count(' ') == 6 and \
                    dic2[d - 1][0] not in head_list:
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                print('shahhjiuytrwwnnbbbbb', dic2[d - 1], dic2[d])
                dic1[lq - 1] = new_l
                continue
            if d > 1 and len(re.findall('\w+', dic2[d][0])) and len(re.findall('\d\s\d', dic2[d][5])):
                print('splittt', dic2[d])
                a, b = dic2[d][5].split()
                dic2[d][5] = a
                dic2[d][6] = b

            dic1[lq] = dic2[d]
            lq += 1

    
    if hospital=='fortis'  or hospital == 'fortis1':
        dic2=dic1
        dic1={}
        lq=1
        f=1
        for d in dic2:
            f +=1
            if len(dic2[d][0])>4 and dic2[d].count(' ')==8 and dic2[d][0] not in head_list and (re.sub('\d','',dic2[d][0])).strip() in head_list:
                print('qqqqq',(re.sub('\d','',dic2[d][0])).strip())
                tq=(re.sub('\d','',dic2[d][0])).strip()
                dic2[d].pop(0)
                dic2[d].insert(0,tq)
            if f>3 and len(dic2[d][0])>4 and dic2[d].count(' ')==8 and dic2[d][0]=='PACKAGE' and dic2[d-1].count(' ')<=5 and (len(re.findall('\d\.\d',dic2[d-1][8]))>=1 or len(re.findall('\d\.\d',dic2[d-1][6]))>=1): 
                print('rrrrr',dic2[d])
                tr=dic2[d][0]+'#'
                dic2[d].pop(0)
                dic2[d].insert(0,tr)
            dic1[lq]=dic2[d]
            lq +=1
    if src_dc['Hospital']=='max' or src_dc['Hospital']=='blk-max' or hospital == 'nanavati':
        dic2=dic1
        dic1={}
        lq=1
        f=1
        sbt=src_dc['sbt']
        for d in dic2:
            ss=''
            f +=1
            if dic2[d][5]==dic2[d][3] and len(dic2[d][5])>2 and dic2[d].__contains__(sbt)==False and len(dic2[d][2].strip())==0:
                print('pppppp',dic2[d])
                tp=dic2[d][5]
                dic2[d].pop(2)
                dic2[d].insert(2,'1')
                dic2[d].pop(3)
                dic2[d].insert(3,tp)
                dic2[d].pop(5)
                dic2[d].insert(5,tp)
            if dic2[d][2]==dic2[d][3] and len(dic2[d][2])>2 and dic2[d].__contains__(sbt)==True:
                print('qqqqqqq',dic2[d])
                dic2[d].pop(2)
                dic2[d].insert(2,' ')
            if f>3 and (len(re.findall('\d\.\d',dic2[d][3]))>=1 or len(re.findall('\d\.\d',dic2[d][5]))>=1) and len(dic2[d][0].strip())==0 and len(dic2[d][1].strip())==0 and dic2[d].count(' ')>=3 and ss.join(dic2[d]).__contains__(sbt)==False and len(dic2[d-1][0])>1 and len(dic2[d-1][1])>1 and len(dic2[d-1][3])==1 and len(dic2[d-1][5])==1: 
                print('rrrrr',dic2[d])
                dic1[lq-1]=opr1(dic2[d-1],dic2[d],src_dc)
                continue
            dic1[lq]=dic2[d]
            lq +=1
        # ///////////////16th march
        dic2 = dic1
        dic1 = {}
        lq = 1
        f = 1
        for d in dic2:
            print('dd00=', dic2[d])
            if dic2[d][0] == 'IInvestigations':
                dic2[d][0] = 'Investigations'
            if dic2[d][0] == 'CConsultation':
                dic2[d][0] = 'Consultation'
            if dic2[d][1] == 'Total':
                dic2[d][1] = 'Sub Total'
            if dic2[d][2].__contains__('Tablets'):
                dic2[d][2] = dic2[d][2].replace('Tablets', '')
            if dic2[d][2].__contains__('Ampoul'):
                dic2[d][2] = dic2[d][2].replace('Ampoul', '')
            if dic2[d][2].__contains__('Bottle'):
                dic2[d][2] = dic2[d][2].replace('Bottle', '')
            if dic2[d][2].__contains__('es'):
                dic2[d][2] = dic2[d][2].replace('es', '')
            if dic2[d][2].__contains__('Pair'):
                dic2[d][2] = dic2[d][2].replace('Pair', '')
            if dic2[d][2].__contains__('No'):
                dic2[d][2] = dic2[d][2].replace('No', '')
            if dic2[d][2].__contains__('NO'):
                dic2[d][2] = dic2[d][2].replace('NO', '')
            if dic2[d][2].__contains__('-'):
                dic2[d][2] = dic2[d][2].replace('-', '')
            if dic2[d][2].__contains__('Capsul'):
                dic2[d][2] = dic2[d][2].replace('Capsul', '')
            if dic2[d][3].__contains__('es'):
                dic2[d][3] = dic2[d][3].replace('es', '')
            if dic2[d][3].__contains__('No'):
                dic2[d][3] = dic2[d][2].replace('No','')
            if d>1 and len(re.findall('\d{2}\/\d{2}\/\d{2}', dic2[d][0])) == 1 and dic2[d][1]== ' ' and dic2[d].count(' ')>=4:
                print('if date merged with 0th indx in surgery lines')
                text = dic2[d][0]
                matchdate = re.search(r'\d{2}\/\d{2}\/\d{2}',text)
                dic2[d][1] = matchdate.group()
                dic2[d][0] = dic2[d][0].replace(matchdate.group(),'')
            if d>1 and dic2[d][0] !=' ' and dic2[d][1] == 'Surgeon Fee' and dic2[d-1][3].__contains__('Sub T'):
                print('for surgery sbtss without date')
                dic2[d - 1][2] = ' '
                dic2[d - 1][3] = ' '
                dic2[d - 1][5] = ' '
            if len(re.findall('\d\/\d+\/\d+', dic2[d][1])) == 1 and len(re.findall('\d\/\d+\/\d+', dic2[d][3])) == 1:
                print('for surgery max date in 1st and 3rd')
                dic2[d][3] = ' '
            if len(dic2[d][3].split()) == 2 and len(re.findall('\d\.\d', dic2[d][3])) == 1 and dic2[d][2] == ' ':
                print('if qty rate in 3rd index and 2nd index empty')
                a, b = dic2[d][3].split()
                dic2[d][2] = a
                dic2[d][3] = b
            if len(dic2[d][3].split()) == 2 and len(re.findall('\d\.\d', dic2[d][3])) == 2 and dic2[d][4] == ' ':
                print('if rate and discount in 3rd index')
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if len(dic2[d][2].split()) > 1 and dic2[d][3] == ' ' and len(re.findall('\d\.\d', dic2[d][2])) == 1 and \
                    dic2[d][0] != ' ':
                print('price  in unit')
                text = dic2[d][2]
                if len(re.findall('\d{3}\.\d{2}', dic2[d][2])) == 1:
                    matchrate = re.search(r'\d{3}\.\d{2}', text)
                elif len(re.findall('\d{2}\.\d{2}', dic2[d][2])) == 1:
                    matchrate = re.search(r'\d{2}\.\d{2}', text)
                elif len(re.findall('\d{1}\.\d{2}', dic2[d][2])) == 1:
                    matchrate = re.search(r'\d{1}\.\d{2}', text)
                dic2[d][2] = dic2[d][2].replace(matchrate.group(), '')
                dic2[d][3] = matchrate.group()

            dic1[lq] = dic2[d]
            lq += 1
    #     /////////////////
    if hospital == 'fortisjindal':
        # print('mohit')
        dic2 = dic1
        dic1 = {}
        lq = 1
        f = 1
        for d in dic2:
            f += 1
            sf = ''
            if f > 3 and len(dic2[d][0]) > 3 and dic2[d][0].startswith('NIC') and sf.join(dic2[d - 1]).__contains__(
                    sbt):
                # print('gggggg',dic2[d])
                dic1[lq] = ['NIC', ' ', ' ', ' ', ' ', ' ', ]
                lq += 1
                t0 = dic2[d][0].replace('NIC', '')
                dic2[d].pop(0)
                dic2[d].insert(0, t0)
            if f > 3 and len(dic2[d][0]) > 3 and dic2[d][0].startswith('ENT') and sf.join(dic2[d - 1]).__contains__(
                    sbt):
                dic1[lq] = ['ENT', ' ', ' ', ' ', ' ', ' ', ]
                lq += 1
                t0 = dic2[d][0].replace('ENT', '')
                dic2[d].pop(0)
                dic2[d].insert(0, t0)
            if len(dic2[d][3]) > 3 and len(dic2[d][2]) > len(dic2[d][3]) and dic2[d][2].__contains__(dic2[d][3]):
                # print('momo1',dic2[d])
                l3 = len(dic2[d][3])
                if dic2[d][2][-l3:] == dic2[d][3]:
                    td = dic2[d][2].replace(dic2[d][3], '')
                    dic2[d].pop(2)
                    dic2[d].insert(2, td)
                    # print('momo2',dic2[d])
            if dic2[d][2] == dic2[d][3] and len(dic2[d][2]) > 5 and dic2[d][2].__contains__(' x '):
                dic2[d].pop(2)
                dic2[d].insert(2, ' ')
            if dic2[d][3] == dic2[d][4]:
                dic2[d].pop(4)
                dic2[d].insert(4, ' ')

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(dic2[d][0].strip()) > 5 and len(re.findall('\d{0,2}\/\d{2}\/\d{4}', dic2[d][0])) == 1 and len(
                    dic2[d][1].strip()) == 0:
                # print('uuuuuu',dic2[d])
                pw1 = re.findall('\d{0,2}\/\d{2}\/\d{4}', dic2[d][0])[0]
                pw = dic2[d][0].split(pw1)[1].strip()
                dic2[d].pop(0)
                dic2[d].pop(0)
                dic2[d].insert(0, pw)
                dic2[d].insert(0, pw1)
            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('fdd==', dic2[d])
            if dic2[d][0] == 'FESS (FUNCTIONAL ENDOSCOPIC SINUS SURGERY)':
                dic2[d][0] = dic2[d][0].replace('(', '')
                dic2[d][0] = dic2[d][0].replace(')', '')
            if dic2[d][0] == 'CLOSED REDUCTION+ K WIRE FIXATION + POP CAST':
                dic2[d][0] = dic2[d][0].replace('+', '')
            if d > 1 and d < len(dic2) and len(re.findall('\D{2}\s\&\s\D{2}', dic2[d][2])) == 1 and len(
                    re.findall('\d{3}', dic2[d][0])) == 1 and len(
                    re.findall('\d{2}\.\d{2}\s\D\s\d\.\d{2}', dic2[d][3])) == 1 and \
                    dic2[d].count(' ') == 2 and dic2[d - 1].count(' ') == 4:
                print('for 220202003836')
                dic2[d - 1][1] = ' '
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if len(dic2[d][3].split()) == 2 and dic2[d][4] == ' ':
                print('rate qty space')
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if len(dic2[d][3].split()) == 4 and dic2[d][4] == ' ' and (
                    dic2[d][3].__contains__('X x') or dic2[d][3].__contains__('x X')):
                print('rate with  X x')
                dic2[d][3] = dic2[d][3].replace('X ', '')
            if len(dic2[d][3].split()) == 3 and dic2[d][4] == ' ' and (
                    dic2[d][3].__contains__('X') or dic2[d][3].__contains__('K') or dic2[d][3].__contains__('<')):
                print('rate qty space with x')
                a, b, c = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = c
            if d > 1 and d < len(dic2) and len(re.findall('\D{4}', dic2[d][3])) == 1 and len(
                    re.findall('\D{6}', dic2[d][4])) == 1 and len(re.findall('\d\.\d', dic2[d][5])) == 1 and \
                    len(re.findall('\D{12}', dic2[d + 1][0])) == 1 and dic2[d].count(' ') == 3 and dic2[
                d + 1].count(' ') == 5:
                print('fopr 220202036381')
                dic2[d][3] = 'Total of RADIO DIAGNOSIS'
                dic2[d][4] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'fortisjindal-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dddd==', dic2[d])
            if dic2[d][5].__contains__('Oo') or dic2[d][5].__contains__('OO'):
                dic2[d][5] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    #     /////////////////

    if hospital == 'jupiter':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d{6}\s\d{2}\s|\d{8}\s', dic2[d][2])) == 1 and len(dic2[d][1].strip()) == 0:
                print('zzzzz', dic2[d])
                z1 = ''
                if len(re.findall('\d{6}\s\d{2}\s', dic2[d][2])) == 1:
                    z1 = re.findall('\d{6}\s\d{2}\s', dic2[d][2])[0].strip()
                elif len(re.findall('\d{8}\s', dic2[d][2])) == 1:
                    z1 = re.findall('\d{8}\s', dic2[d][2])[0].strip()
                z2 = dic2[d][2].replace(z1, '').strip()
                dic2[d].pop(1)
                dic2[d].pop(1)
                dic2[d].insert(1, z2)
                dic2[d].insert(1, z1)
            # if len(re.findall('\w\s\d', dic2[d][5])) == 1:
            #     kl1 = dic2[d][5].split()[0]
            #     kl2 = dic2[d][5].split()[1]
            #     dic2[d].pop(4)
            #     dic2[d].pop(4)
            #     dic2[d].insert(4, kl2)
            #     dic2[d].insert(4, kl1)
            #     print(kl1, '--', kl2, '---', dic2[d])
            dic1[lq] = dic2[d]
            lq += 1
        dic2 = dic1
        dic1 = {}
        lq = 1
        k = 1
        kw = 0
        for d in dic2:
            if k == 1 and dic2[d][3] in ['Security Deposit', 'Company O/S Amt. :']:
                kw = 1
                break
            k += 1
            dic1[lq] = dic2[d]
            lq += 1
        if kw == 1:
            dic1 = {}
            dic1[1] = [' ', ' ', ' ', ' ', ' ', ' ', ' ']
        #     /////16th march below
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('d==', dic2[d])
            if dic2[d][2] == 'NON ADMISSBLE MATERIALS':
                dic2[d][0] = dic2[d][2]
                dic2[d][2] = ' '
            if dic2[d][4] == dic2[d][5]:
                dic2[d][4] = ' '
            if dic2[d][3] == dic2[d][4] and dic2[d][3].__contains__('Sub T'):
                dic2[d][3] = ' '
            if dic2[d][2] != ' ' and (
                    dic2[d][4].__contains__('0.0') or dic2[d][4].__contains__('0,0') or dic2[d][4].__contains__('.0')):
                print('if gst is in 4th indx and exchanging with qty 3rd indx')
                dic2[d][4] = dic2[d][3]
                dic2[d][3] = ' '
            if (len(re.findall('\d+\/\d+\/\d+', dic2[d][0])) == 1) and len(dic2[d][0].split()) >= 2 and (dic2[d][
                                                                                                             1] == ' ' or
                                                                                                         dic2[d][
                                                                                                             1] != ' ') and \
                    dic2[d][2] != ' ' and (
                    len(re.findall('\d{8}', dic2[d][0])) == 1 or len(re.findall('\d{7}', dic2[d][0])) == 1):
                print('if date and code merged in 0th indx and parti in 2nd indx')
                text = dic2[d][0]
                if len(re.findall('\d{8}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{8}', text)
                elif len(re.findall('\d{7}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{7}', text)
                dic2[d][1] = matchdate.group()
                dic2[d][0] = text.replace(matchdate.group(), '')
            if (len(re.findall('\d{2}\D?\d+\D?\d{4}', dic2[d][0])) == 1 or len(
                    re.findall('\d{2}\D\d+\D\d{4}', dic2[d][0])) == 1 or len(
                re.findall('\d\s\d\D\d+\D\d{4}', dic2[d][0])) == 1 or len(
                re.findall('\d+\/\d+\/\d+', dic2[d][0])) == 1) and len(dic2[d][0].split()) >= 2 and dic2[d][
                1] == ' ' and (dic2[d][2] == ' ' or dic2[d][2] != ' '):
                print('if date and Parti for pharmacy together in 0th index')
                text = dic2[d][0]
                if len(re.findall('\d{2}\D?\d+\D?\d{4}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\D?\d+\D?\d{4}', text)
                elif len(re.findall('\d{2}\D\d+\D\d{4}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\D\d+\D\d{4}', text)
                elif len(re.findall('\d\s\d\D\d+\D\d{4}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d\s\d\D\d+\D\d{4}', text)
                elif len(re.findall('\d+\/\d+\/\d+', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d+\/\d+\/\d+', text)
                dic2[d][0] = matchdate.group()
                if dic2[d][2] != ' ':
                    print('yess not equal')
                    dic2[d][2] = text.replace(matchdate.group(), '') + ' ' + dic2[d][2]
                else:
                    dic2[d][2] = text.replace(matchdate.group(), '')
            if d > 1 and dic2[d][0] != ' ' and (len(re.findall('\d{2}\D?\d+\D?\d{4}', dic2[d - 1][0])) == 1 or len(
                    re.findall('\d{2}\D\d+\D\d{4}', dic2[d - 1][0])) == 1 or len(
                re.findall('\d+\/\d+\/\d+', dic2[d - 1][0])) == 1) and dic2[d - 1][2] != ' ' and dic2[d][
                0].count('/') < 1:
                print('after separting below line added to d-1 2nd indx')
                dic2[d - 1][2] = dic2[d - 1][2] + ' ' + dic2[d][0]
                dic2[d][0] = ' '
                dic2[d][1] = ' '
            if (dic2[d][6] == 'mount' or dic2[d][6] == 'Amount' or dic2[d][5] == 'Qty' or dic2[d][5] == 'INWNN' or
                dic2[d][5] == '-NW' or dic2[d][5] == 'w w' or dic2[d][5] == 'w L' or dic2[d][5] == 'NN' or dic2[d][
                    5] == 'W' or dic2[d][5] == 'NI' or dic2[d][5] == 'N' or dic2[d][5] == 'W I' or dic2[d][5] == 'N.' or
                dic2[d][5] == 'NNN- NNN.' or dic2[d][5] == 'NNI' or dic2[d][5] == 'INN') and len(
                re.findall('\d\.\d', dic2[d][6])) == 0:
                print('to remove above vals from 5th and 6th index')
                dic2[d][6] = ' '
                dic2[d][5] = ' '
            if d > 2 and dic2[d][0] in head_list and dic2[d - 1].count(' ') == 6 and 'Sub Tot' not in dic2[d - 1][4] and \
                    'Sub Tot' not in dic2[d - 2][4] and dic2[d - 1][6] != ' ':
                print('sbt nnot in d-1 line')
                dic2[d - 1][4] = 'Sub Total'

            dic1[lq] = dic2[d]
            lq += 1
    #  Manideep###################
    if hospital == 'asian':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddd000==', dic2[d])
            if dic2[d][1] != ' ' and dic2[d][2] != ' ' and len(dic2[d][1]) > 10 and len(
                    dic2[d][2].split()[0]) <= 8 and len(dic2[d][2].split()) >= 2 and \
                    (len(re.findall('^\d+', dic2[d][2].split()[0])) == 1 or len(
                        re.findall('^\D+\d+', dic2[d][2].split()[0])) == 1 or len(
                        re.findall('^\D+\d+\D+', dic2[d][2].split()[0])) == 1 or
                     len(re.findall('^\d+\D+\d+', dic2[d][2].split()[0])) == 1):
                print('if code, parti merged')
                text = dic2[d][2]
                if len(re.findall('^\d+', dic2[d][2].split()[0])) == 1:
                    matchcode = re.search(r'^\d+\s', text)
                if len(re.findall('^\d+\D+\d+', dic2[d][2].split()[0])) == 1:
                    matchcode = re.search(r'^\d+\D+\d+\s', text)
                if len(re.findall('^\D+\d+', dic2[d][2].split()[0])) == 1:
                    matchcode = re.search(r'^\D+\d+\s', text)
                if len(re.findall('^\D+\d+\:', dic2[d][2].split()[0])) == 1:
                    matchcode = re.search(r'^\D+\d+\:\s', text)
                if len(re.findall('^\d+\D+', dic2[d][2].split()[0])) == 1:
                    matchcode = re.search(r'^\d+\D+\s', text)
                if len(re.findall('^\d+\:\d+', dic2[d][2].split()[0])) == 1:
                    matchcode = re.search(r'^\d+\:\d+\s', text)

                dic2[d][2] = dic2[d][2].replace(matchcode.group(), '')
                dic2[d][2] = dic2[d][2].strip()

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddd111==', dic2[d])
            if dic2[d][3] != ' ' and dic2[d][4] != ' ' and dic2[d][3] == dic2[d][4]:
                # print('3rd and 4th indx same')
                dic2[d][4] = ' '
                dic2[d][3] = ' '
            if dic2[d][5] != ' ' and len(dic2[d][5].split()) >= 2 and len(re.findall('\d\.\d', dic2[d][5])) == 2 and \
                    dic2[d][6] == ' ' and 'Total' not in dic2[d][5]:
                print('if QTy and rate together in 5th indx and 6th indx empty')
                text = dic2[d][5].split()
                dic2[d][5] = text[0]
                dic2[d][6] = text[1]
            if dic2[d][6] != ' ' and len(dic2[d][6].split()) >= 2 and len(re.findall('\d\.\d', dic2[d][6])) == 2 and \
                    dic2[d][5] == ' ' and 'Total' not in dic2[d][6]:
                print('if QTy and rate together in 6th indx and 5th indx empty')
                text = dic2[d][6].split()
                dic2[d][5] = text[0]
                dic2[d][6] = text[1]

            dic1[lq] = dic2[d]
            lq += 1
    # ##############################
    if hospital == 'paras':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd===', dic2[d])
            if d > 1 and d < len(dic2) and len(
                    re.findall('\D{8}\s\d{4}\D{2}\s\D{3}\s\d\D\d{3}\D{2}\s\D{5}', dic2[d][2])) == 1 and len(
                re.findall('\d\.\d', dic2[d][5])) == 1 and \
                    dic2[d].count(' ') == 3 and dic2[d - 1].count(' ') == 5 and dic2[d - 1][1] == ' ':
                print('for 220202033922')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if d > 1 and d < len(dic2) and len(re.findall('\D{4}\s\D{4}\-\D\-\d{2}\s\D{5}', dic2[d][2])) == 1 and len(
                    re.findall('\d\.\d', dic2[d][5])) == 1 and \
                    dic2[d].count(' ') == 2 and dic2[d - 1].count(' ') == 5 and dic2[d + 1].count(' ') == 4:
                print('for 220202025646')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if dic2[d][0] != ' ' and len(dic2[d][0].split()) >= 3 and (
                    len(re.findall('\d+\/\d+\/\d+\s\d+\:\d+\:\d+\D?\s?\-\s?\d?\D+\d?\/?\d+\/\d+', dic2[d][0])) == 1 or
                    len(re.findall('\d+\/\d+\/\d+\s\d+\:\d+\:\d+\;?,?\s\d?\D+\/\d+\/\d+', dic2[d][0])) == 1 or
                    len(re.findall('\d+\/\d\s\d\/\d+\s\d+\:\d+\:\d+\D?\s?\-\s?\d?\D+\d?\/\d+\/\d+',
                                   dic2[d][0])) == 1) and dic2[d][2] == ' ':
                print('dateparticularmerge 22', dic2[d])
                text = dic2[d][0]
                if len(re.findall('\d+\/\d+\/\d+\s\d+\:\d+\:\d+\D?\s?\-\s?\d?\D+\d?\/?\d+\/\d+', dic2[d][0])) == 1:
                    matchDate = re.search(r'\d+\/\d+\/\d+\s\d+\:\d+\:\d+\D?\s?\-\s?\d?\D+\d?\/?\d+\/\d+', text)
                elif len(re.findall('\d+\/\d+\/\d+\s\d+\:\d+\:\d+\;?,?\s\d?\D+\/\d+\/\d+', text)) == 1:
                    matchDate = re.search(r'\d+\/\d+\/\d+\s\d+\:\d+\:\d+\;?,?\s\d?\D+\/\d+\/\d+', text)
                elif len(re.findall('\d+\/\d\s\d\/\d+\s\d+\:\d+\:\d+\D?\s?\-\s?\d?\D+\d?\/\d+\/\d+', dic2[d][0])) == 1:
                    matchDate = re.search(r'\d+\/\d\s\d\/\d+\s\d+\:\d+\:\d+\D?\s?\-\s?\d?\D+\d?\/\d+\/\d+', text)
                dic2[d][0] = matchDate.group()
                dic2[d][2] = text.replace(matchDate.group(), " ")
            dic1[lq] = dic2[d]
            lq += 1
    # /////////////////////////////
    if hospital == 'kokilaben':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd===',dic2[d])
            if d>1 and d<len(dic2) and len(re.findall('\D{6}\(\D{8}',dic2[d][0]))==1 and len(re.findall('\d\.\d',dic2[d][3]))==1 and len(re.findall('\d\.\d',dic2[d-1][4]))==1 and dic2[d].count(' ')==4 and dic2[d-1].count(' ')==5:
                print('for 220202090242 othersubtotal above line issue')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if d>1 and d<len(dic2) and len(re.findall('\D{6}\s\D{5}\s\D{4}\(\D{8}\)',dic2[d][0]))==1 and len(re.findall('\d\.\d',dic2[d][4]))==1 and len(re.findall('\d\.\d',dic2[d-1][3]))==1 and dic2[d].count(' ')==3 and dic2[d-1].count(' ')==6:
                print('for 220202090242 Doctor Visit Fees(Subtotal) above line issue')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            dic1[lq] = dic2[d]
            lq += 1
    # /////////////////////////////
    if hospital == 'blk' or hospital == 'Sharda_N17138':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd===', dic2[d])
            if dic2[d][0] == 'DRUGS, CONSUMABLES & IMPLANTS':
                dic2[d][0] = 'DRUGS CONSUMABLES & IMPLANTS'
            if dic2[d][1].__contains__('LAPAROSCOPIC TOTAL'):
                print('for 220100604665 LAPAROSCOPIC TOTAL')
                dic2[d][1] = dic2[d][1].replace('TOTAL', '')
            if dic2[d][2] == dic2[d][3] and len(re.findall('\d\.\d', dic2[d][2])) >= 1 and len(
                    re.findall('\d\.\d', dic2[d][3])) >= 1:
                dic2[d][2] = ' '
            if len(dic2[d][3].split()) == 2 and dic2[d][4] == ' ' and len(re.findall('\d\.\d', dic2[d][3])) == 2:
                print('with space in 3rd index')
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if len(dic2[d][3].split()) == 2 and len(re.findall('\d\.\d', dic2[d][3])) == 2:
                print('with space in 3rd index')
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if len(re.findall('\d{5}\,\d{2}\s\d\.\d{2}', dic2[d][3])) == 1 and dic2[d][4] == ' ':
                print('with space in 3rd index with comma 11070,00 0.20')
                a, b = dic2[d][3].split(' ', 1)
                dic2[d][3] = a
                dic2[d][4] = b
            if len(re.findall('\d\s\d{4}\.\d{2}\s\d\.\d{2}', dic2[d][3])) == 1 and dic2[d][4] == ' ' and len(
                    re.findall('\d{5}\.\d{2}', dic2[d][5])) == 1:
                print('with space in 3rd index  1 1767.00 1.00')
                a, b, c = dic2[d][3].split(' ', 2)
                dic2[d][3] = a + b
                dic2[d][4] = c
            if len(dic2[d][0].split()) > 4 and (len(re.findall('\d{3}\D{2}\d{2}\/\d{4}', dic2[d][0])) == 1 or len(
                    re.findall('\D{2}\d{2}\/\d{6}', dic2[d][0])) == 1) and (
                    len(re.findall('\d\/\d{2}\/\d{4}\s\d{2}\:\d{2}\s\-\s', dic2[d][0])) == 1 or len(
                    re.findall('\d\/\d{2}\/\d{4}\s\d{2}\.\d{2}\s\-\s', dic2[d][0])) == 1):
                print('dateparticularmerge', dic2[d])
                text = dic2[d][0]
                if len(re.findall('\d{2}\/\d{2}\/\d{4}\s?\d{2}\:\d{2}\s\-\s\d{2}\d{2}\/\d{6}', text)) == 1:
                    matchDatecode = re.search(r'\d{2}\/\d{2}\/\d{4}\s?\d{2}\:\d{2}\s\-\s\d{2}\d{2}\/\d{6}', text)
                elif len(re.findall('\d{2}\/\d{2}\/\d{4}\s?\d{2}\:\d{2}\s\-\s\D{2}\d{2}\/\d{6}', text)) == 1:
                    matchDatecode = re.search(r'\d{2}\/\d{2}\/\d{4}\s?\d{2}\:\d{2}\s\-\s\D{2}\d{2}\/\d{6}', text)
                elif len(re.findall('\d{2}\/\d{2}\/\d{4}\s?\d{2}\:\d{2}\s\-\s\d{3}\D{2}\d{2}\/\d{4}', text)) == 1:
                    matchDatecode = re.search(r'\d{2}\/\d{2}\/\d{4}\s?\d{2}\:\d{2}\s\-\s\d{3}\D{2}\d{2}\/\d{4}', text)
                dic2[d][1] = text.replace(matchDatecode.group(), " ")
                dic2[d][0] = matchDatecode.group()
            dic1[lq] = dic2[d]
            lq += 1
    # /////////////////////////////
    if hospital == 'hinduja':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd===',dic2[d])
            if dic2[d][2] == 'TAL' or dic2[d][2] == 'TER':
                dic2[d][2] = ' '
            if dic2[d][4] == 'RE * HOWVESad TY DIOEN' or dic2[d][4] == 'Rate':
                print('to remove abpove val')
                dic2[d][4] =' '
            if d==1 and (len(re.findall('\d{1}',dic2[d][5]))==1 or len(re.findall('\d{2}',dic2[d][5]))==1 or len(re.findall('\d\s\d',dic2[d][5]))==1) and len(re.findall('\d\.\d',dic2[d][5]))==0 and dic2[d].count(' ')==5:
                print('to remove pg nos from 1st line')
                dic2[d][5] = ' '
            if d<len(dic2) and len(re.findall('\D{3}\s\D{3}\s\D{6}\s\(\d{5}\s\d\)',dic2[d][0]))==1 and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic2[d][2]))==1 and len(re.findall('\d{1}\.\d{2}',dic2[d][3]))==1 and \
                    len(re.findall('\d{1}\.\d{2}', dic2[d][4])) == 1 and dic2[d].count(' ')==1 and dic2[d+1].count(' ')==4:
                print('for 220100603343')
                listnw = ['BED CHARGES',' ',' ',' ',' ',' ']
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq+=1
                dic1[lq-1] = listnw
            if d<len(dic2) and len(re.findall('\D{11}\s\D{6}\s\D{5}\s\D',dic2[d][0]))==1 and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic2[d][2]))==1 and len(re.findall('\d{1}\,\d{3}\.\d{2}',dic2[d][4]))==1 and \
                    len(re.findall('\d{1}\.\d{2}', dic2[d][3])) == 1 and len(dic2[d][5].split()) == 2 and dic2[d].count(' ')==1 and dic2[d+1].count(' ')==5:
                print('for 220202022192')
                a,b = dic2[d][5].split()
                dic2[d][5] = a
                listnw = ['ANAESTHESIOLOGY', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d>1 and d<len(dic2) and len(re.findall('\D{6}\s\D{3}\.\s\d\D{2}\s\(\d\D{2}',dic2[d][0]))==1 and dic2[d].count(' ')==0 and len(re.findall('\d{6}\-\D\d{6}',dic2[d][1]))==1 and \
                   dic2[d-1].count(' ')==5 and len(re.findall('\d{2}\/\d{2}\/\d{4}\s\d{2}\:\d{2}\s\D{2}',dic2[d-1][4]))==1:
                print('for 220100582067 01/10/2019 04:53 PM')
                dic2[d-1][4] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    # /////////////////////////////
    if hospital == 'hinduja_N10188':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] != ' ' and len(re.findall('^\d+\s', dic2[d][0])) == 1 and dic2[d][0].replace(dic2[d][0].split()[0],'').strip() in head_list:
                print('if sno no and header together')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\s',text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(),'')
                dic2[d][0] = dic2[d][0].strip()
            if dic2[d][0] in head_list and dic2[d].count(' ')==3:
                print('remove headlist 4, 5 indx values')
                dic2[d][4] = ' '
                dic2[d][5] = ' '


            dic1[lq] = dic2[d]
            lq += 1
    # /////////////////////////////
    if hospital == 'medanta' or hospital == 'medanta-lucknow':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd===', dic2[d])
            if dic2[d][0] == 'Room Charges(Subtotal':
                dic2[d][0] = 'Room Charges(Subtotal)'
            if dic2[d][0] == "Admission Charges'":
                dic2[d][0] = 'Admission Charges'
            if dic2[d][0] == "Aumin Charges ( Subtotal)":
                dic2[d][0] = 'Admin Charges (Subtotal)'
            if dic2[d][0] == '_ab Charges(Subtotal)' or dic2[d][0] == '.ab Charges(Subtotal)':
                dic2[d][0] = 'Lab Charges(Subtotal)'
            if dic2[d][0] == 'Heart Station(Subtotal':
                dic2[d][0] = 'Heart Station(Subtotal)'
            if dic2[d][0] == 'Blood Bank(Subtotal':
                dic2[d][0] = 'Blood Bank(Subtotal)'
            if dic2[d][0] == 'Charges(Subtotal]' or dic2[d][0] == 'Charges(Subtotal;' or dic2[d][
                0] == 'Charges(Subtotal':
                dic2[d][0] = 'Charges(Subtotal)'
            if dic2[d][0] == "Specialized Medical Consumable Charges'":
                dic2[d][0] = 'Specialized Medical Consumable Charges'
            if dic2[d][0] == 'Visiting Consultant Charges(Subtotal':
                dic2[d][0] = 'Visiting Consultant Charges(Subtotal)'
            if dic2[d][0] == 'Visiting Consultant Charge':
                dic2[d][0] = 'Visiting Consultant Charges'
            if d > 1 and d < len(dic2) and len(re.findall('\d{2}\/\d{2}\/\d{4}', dic2[d][0])) == 1 and len(
                    re.findall('\D{4}\d{6}\-\D{2}', dic2[d][0])) == 1:
                print('for 220100525678 last page missing vals')
                text = dic2[d][0]
                matchdate = re.search(r'\d{2}\/\d{2}\/\d{4}', text)
                dic2[d][1] = matchdate.group()
            if d > 1 and d < len(dic2) and dic2[d][0] == 'rges' and dic2[d].count(' ') == 5 and dic2[d - 1][
                0] == 'Operation Theatre':
                print('for 220201985557')
                dic2[d][0] = 'OT Charges'
            if len(re.findall('\d\.\d', dic2[d][4])) == 2 and dic2[d][5] == ' ':
                print('if qty and rate together and empty in 5th index')
                text = dic2[d][4]
                matchqty = re.search(r'\d{1}\.\d{2}', text)
                dic2[d][4] = matchqty.group()
                dic2[d][5] = text.replace(matchqty.group(), '')
            if len(re.findall('\d\.\d', dic2[d][4])) == 2 and dic2[d][5] != ' ' and dic2[d][5] in dic2[d][4]:
                print('if qty and rate together and not empty in 5th indxex')
                text = dic2[d][4]
                matchqty = re.search(r'\d{1}\.\d{2}', text)
                dic2[d][4] = matchqty.group()
                dic2[d][5] = text.replace(matchqty.group(), '')
            if d > 1 and d < len(dic2) and dic2[d][0] == 'Admission Charges' and dic2[d].count(' ') == 5 and dic2[
                d - 1].count(' ') == 6:
                print('for 220202046342')
                dic2[d - 1][0] = 'Admin Charges'
            if d > 1 and d < len(dic2) and dic2[d][0] == 'Anaesthesia Charges' and dic2[d].count(' ') == 5 and dic2[
                d - 1].count(' ') == 6:
                print('for 220202046342')
                dic2[d - 1][0] = 'Critical Care Charges'
            if dic2[d][4].__contains__('-.. _.... ... .. ... ..'):
                dic2[d][4] = dic2[d][4].replace('-.. _.... ... .. ... ..', '')
            if dic2[d][4].__contains__('-.... .'):
                dic2[d][4] = dic2[d][4].replace('-.... .', '')
            if dic2[d][4].__contains__('... ..'):
                dic2[d][4] = dic2[d][4].replace('... ..', '')
            if d > 1 and d < len(dic2) and (
                    dic2[d][0] == 'Charges(Subtotal' or dic2[d][0] == 'Charges(Subtotal)' or dic2[d][
                0] == 'Charges(Subtotal),') and dic2[d].count(' ') == 5 and dic2[d - 1].count(' ') == 3:
                print('for merging  Specialized Medical Consumable charges subtotal')
                dic2[d][0] = 'Charges(Subtotal)'
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='medanta_daycare':
        print('mmmmmmmmmmmmm')
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('ddd00==',dic2[d])
            if dic2[d][2]!= ' ' and dic2[d][4]!= ' ' and dic2[d][3] == ' ' and dic2[d][5] == ' ':
                print('for daycare without Total and Only Discount present in header')
                dic2[d][3] = dic2[d][2]
                dic2[d][5] = dic2[d][4]
                dic2[d][2] = ' '
                dic2[d][4] = ' '

            dic1[lq]=dic2[d]
            lq +=1
    # /////////////////////////////
    if hospital == 'krishna':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddd==', dic2[d])
            if dic2[d][0] == 'PULMONOLOG':
                dic2[d][0] = 'PULMONOLOGY'
            if dic2[d][0] == 'DT Pharmacy Charges':
                dic2[d][0] = 'OT Pharmacy Charges'
            if dic2[d][0] in src_dc['merge_set'] and dic2[d].count(' ') >= 4:
                dic2[d][5] = ' '
            if d > 1 and d < len(dic2) and (len(re.findall('\D{10}\s\D{7}', dic2[d][0])) == 1 or len(
                    re.findall('\D{7}\s\D{7}', dic2[d][0])) == 1) and (
                    len(re.findall('\d{3}\.\d{2}', dic2[d - 1][5])) == 1 or len(
                    re.findall('\d{2}\,\d{3}\.\d{2}', dic2[d - 1][5])) == 1) and dic2[d].count(' ') == 5 and dic2[
                d - 1].count(' ') == 5:
                print('for header and val not in same line and deleting them')
                dic2[d][5] = ' '
                dic2[d - 1][5] = ' '
            if len(re.findall('\d\.\d', dic2[d][3])) == 1 and len(re.findall('\d\.\d', dic2[d][4])) == 1:
                print('for deleting 4th indx if 3rd and 4th are same')
                dic2[d][3] = ' '
            if dic2[d][3] != ' ' and dic2[d][4] == ' ' and len(dic2[d][3].split()) == 3 and len(
                    re.findall('\d\.\d', dic2[d][3])) == 1:
                text = dic2[d][3].split()
                dic2[d][3] = text[0]
                dic2[d][4] = text[-1]
            if dic2[d][3].__contains__('*'):
                dic2[d][3] = dic2[d][3].replace('*', '')
            if dic2[d][4].__contains__('*'):
                dic2[d][4] = dic2[d][4].replace('*', '')
            if len(re.findall('\d{1,2}\s?\*\s?\d+', dic2[d][3])) and dic2[d][4] == ' ':
                a, b = re.split('\s?\*\s?', dic2[d][3], maxsplit=1)
                dic2[d][3] = a
                dic2[d][4] = b
            if len(re.findall("\w+\s\w+",dic2[d][0])) and dic2[d][1]==' ' and dic2[d][0] not in head_list and dic2[d].count(' ')<=3:
                print('ffffff',dic2[d])
                a, b = re.split('\s', dic2[d][0],maxsplit=1)
                dic2[d][0] = a
                dic2[d][1] = b
            dic1[lq] = dic2[d]
            lq += 1
    # /////////////////////////////
    if hospital == 'continental':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddd==', dic2[d])
            if dic2[d][4].__contains__('Page'):
                print('for removing Page')
                dic2[d][4] = dic2[d][4].replace('Page', '')
            if d > 2 and d < len(dic2) and dic2[d][0] in head_list and dic2[d - 1][4] != 'SUBTOTAL' and dic2[
                d - 1].count(' ') <= 2 and dic2[d + 1].count(' ') <= 2:
                print('if head_list in line itesm')
                dic2[d][0] = dic2[d][0].lower()

            dic1[lq] = dic2[d]
            lq += 1
    # /////////////////////////////
    if hospital == 'Zen':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddd==', dic2[d])
            if d > 1 and d<len(dic2) and dic2[d][0] in head_list and dic2[d+1].count(' ')==5:
                dic2[d+2][0]=dic2[d+1][0]+' '+dic2[d+2][0]
                dic2[d+1][0]=' '
            if dic2[d][3].__contains__(''):
                dic2[d][3]= dic2[d][3].replace('','')
            if dic2[d][5].__contains__(''):
                dic2[d][5] = dic2[d][5].replace('', '')
            if dic2[d][2].__contains__('sub Total'):
                dic2[d][2] = 'Sub Total'
            if dic2[d][0] != ' ' and len(re.findall('^\d+\.?\s', dic2[d][0])) == 1 and len(dic2[d][0].split()[0]) <= 3:
                print('to remove sno')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
                dic2[d][0] = dic2[d][0].strip()

            dic1[lq] = dic2[d]
            lq += 1
    # /////////////////////////////
    if hospital == 'Sunshine':
        dic2 = dic1
        dic1 = {}
        lq = 1
        f = 0
        for d in dic2:
            f += 1
            nevv = copy.deepcopy(dic2[d])

            if f > 2 and nevv[3].__contains__('*'):
                if len(re.findall('\d\s?\.\s?\d', nevv[4])) == 1:
                    print('thisss_sunshine', nevv, re.findall('\d\s?\*', nevv[3]))
                    nv_fur = nevv[3].strip(' *')
                    nevv.pop(3)
                    nevv.insert(3, nv_fur)
                elif len(re.findall('^\*\s\d{2}', nevv[3])) == 1 and len(nevv[4].strip()) == 0:
                    nv_fur = nevv[3].strip(' * ')
                    nevv.pop(3)
                    nevv.insert(3, ' ')
                    nevv.pop(4)
                    nevv.insert(4, nv_fur)
            if f > 2 and len(re.findall('\d\s\*\s\d{2}', nevv[3])) == 1 and len(nevv[4].strip()) == 0:
                if len(nevv[3].split('*')) == 2:
                    nvth, nvfr = nevv[3].split('*')
                    nevv.pop(3)
                    nevv.insert(3, nvth.strip())
                    nevv.pop(4)
                    nevv.insert(4, nvfr.strip())
            if f > 2 and nevv[0] in head_list and dic2[d - 1][0] in head_list and len(
                    re.findall('\d\s?\.\s?\d', dic2[d - 1][5])) == 1 and len(
                    re.findall('\d\s?\.\s?\d', dic2[d][5])) == 1 and dic2[d - 1].count(' ') == 4 and dic2[d].count(
                    ' ') == 4:
                print('oneisssyyy', dic2[d - 1], nevv)
                dic1[lq - 1] = nevv
                continue
            dic1[lq] = nevv
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddd==', dic2[d])
            if dic2[d][0] == 'PULMONOLOG':
                dic2[d][0] = 'PULMONOLOGY'
            if dic2[d][0] == 'MICRO BIOLOG':
                dic2[d][0] = 'MICRO BIOLOGY'
            if dic2[d][0] == 'EMERGENC':
                dic2[d][0] = 'EMERGENCY'
            if (dic2[d][0] == 'Ward Charges' or dic2[d][0] == 'Professional Charges' or dic2[d][
                0] == 'Pharmacy Charges' or dic2[d][0] == 'Laboratory Charges' or dic2[d][0] == 'Procedure Charges' or \
                dic2[d][0] == 'Service Charges' or dic2[d][0] == 'Consultation Charges') and (len(
                re.findall('\d\s?\.\s?\d', dic2[d][5])) == 1 or len(re.findall('\d\,\d{3}\,\d', dic2[d][5])) == 1 or
                                                                                              dic2[d][5] == ' '):
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if dic2[d][1] == ' ' and len(dic2[d][0].split()) >= 2 and len(re.findall('\w+\d+\s', dic2[d][0])) == 1:
                print('if code and parti together')
                text = dic2[d][0]
                if len(re.findall('\w+\d+\s', dic2[d][0])) == 1:
                    matchcode = re.search(r'\w+\d+\s', text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(), '')
            if dic2[d][3].__contains__('s\*') and dic2[d][3].split()[1] == '*' and len(
                    re.findall('\d+\,?\d+\s?\.\s?\d+', dic2[d][3])) == 1:
                print('if qty rate merged with *')
                text = dic2[d][3]
                dic2[d][3] = text.split()[0]
                if len(re.findall('\d+\,?\d+\s?\.\s?\d+', text)) == 1:
                    matchrate = re.search(r'\d+\,?\d+\s?\.\s?\d+', text)
                dic2[d][4] = matchrate.group()

            dic1[lq] = dic2[d]
            lq += 1
    # /////////////////////////////
    if hospital == 'Sunshine1':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddd==', dic2[d])
            if dic2[d][0] == 'PULMONOLOG':
                dic2[d][0] = 'PULMONOLOGY'
            if dic2[d][0] == 'MICRO BIOLOG':
                dic2[d][0] = 'MICRO BIOLOGY'
            if dic2[d][0] == 'EMERGENC':
                dic2[d][0] = 'EMERGENCY'
            if dic2[d][0] == 'IP Pharmacy Charges .':
                dic2[d][0] = 'IP Pharmacy Charges'
            if (dic2[d][0] == 'Ward Charges' or dic2[d][0] == 'Professional Charges' or dic2[d][
                0] == 'Pharmacy Charges' or dic2[d][0] == 'Laboratory Charges' or dic2[d][0] == 'Procedure Charges' or \
                dic2[d][0] == 'Service Charges' or dic2[d][0] == 'Consultation Charges') and (len(
                re.findall('\d\s?\.\s?\d', dic2[d][5])) == 1 or len(re.findall('\d\,\d{3}\,\d', dic2[d][5])) == 1):
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if len(re.findall('\d\.\d', dic2[d][5])) == 2 and dic2[d][4] == ' ':
                print('for spliting 5th index in rate and amount are together')
                a, b = dic2[d][5].split()
                dic2[d][4] = a
                dic2[d][5] = b
            if len(re.findall('\d\.\d', dic2[d][3])) == 1 and len(re.findall('\d\-\w{3}\-\d', dic2[d][1])) >= 1:
                print('for packgae details line items')
                dic2[d][4] = dic2[d][3]
                dic2[d][3] = ' '
            if (len(re.findall('\d\-\w{3}\-\d', dic2[d][1])) >= 1 or len(re.findall('\d\-\w{3}\.\d', dic2[d][1])) == 1):
                text = dic2[d][1]
                if len(re.findall('\d{2}\-\w{3}\-\d{2}\s\d{2}\-\w{3}\.\d{2}', dic2[d][1])) == 1:
                    matchdate = re.search(r'\d{2}\-\w{3}\-\d{2}\s\d{2}\-\w{3}\.\d{2}', text)
                elif len(re.findall('\d{2}\-\w{3}\-\d{2}\s\d{2}\-\w{3}\-\d{2}', dic2[d][1])) == 1:
                    matchdate = re.search(r'\d{2}\-\w{3}\-\d{2}\s\d{2}\-\w{3}\-\d{2}', text)
                elif len(re.findall('\d\-\w{3}\-\d', dic2[d][1])) >= 1:
                    matchdate = re.search(r'\d{2}\-\w{3}\-\d{2}', text)
                elif len(re.findall('\d\-\w{3}\.\d', dic2[d][1])) == 1:
                    matchdate = re.search(r'\d{2}\-\w{3}\.\d{2}', text)
                dic2[d][1] = text.replace(matchdate.group(), '')
                dic2[d][1] = dic2[d][1].replace(' ', '', 1)

            dic1[lq] = dic2[d]
            lq += 1
    # /////////////////////////////
    if hospital == 'deenanath_1':
        dic1_a = dic1
        la = 1
        dic1 = {}
        for d in dic1_a:
            if dic1_a[d][1] == "O'T INSTRUMENTS":
                dic1_a[d][1] = 'OT INSTRUMENTS'
            if dic1_a[d][1] in head_list and dic1_a[d].count(' ') == 5:
                hhh = copy.deepcopy(dic1_a[d][1])
                dic1_a[d].pop(1)
                dic1_a[d].insert(0, hhh)
            dic1[la] = dic1_a[d]
            la += 1
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddd==', dic2[d])
            if len(dic2[d][2].split()) == 2 and dic2[d][3] == ' ':
                a, b = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = b
            if dic2[d][1].__contains__('Bill :') or dic2[d][1].__contains__('Bill:'):
                dic2[d][5] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    # /////////////////////////////
    if hospital == 'deenanath_1-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddd00===', dic2[d])
            if len(dic2[d][1].split()) >= 2 and dic2[d][1].split()[0].__contains__('-'):
                dic2[d][0] = dic2[d][1].split()[0]
                dic2[d][1] = dic2[d][1].replace(dic2[d][1].split()[0], '', 1)
            if len(re.findall('\w{2}\s\d{2}\-\d{4}', dic2[d][1])) == 1 and 'PHARMACY RETAIL' not in dic2[d][1]:
                print('yess divide code from item')
                text = dic2[d][1]
                if len(re.findall('\w{2}\s\d{2}\-\d{4}', dic2[d][1])) == 1:
                    matchdate = re.search(r'\w{2}\s\d{2}\-\d{4}', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '', 1)

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddd11==', dic2[d])
            if dic2[d][3].__contains__('Nos'):
                dic2[d][3] = dic2[d][3].replace('Nos', '')
            if dic2[d][3].__contains__(' Nos'):
                dic2[d][3] = dic2[d][3].replace(' Nos', '')
            if dic2[d][3].__contains__('No'):
                dic2[d][3] = dic2[d][3].replace('No', '')
            if dic2[d][4].__contains__('MEDICA'):
                dic2[d][4] = dic2[d][4].replace('MEDICA', '')
            if dic2[d][2] == '5.000 . ... .0.000.':
                dic2[d][2] = '5.000'
            if len(re.findall('\d{1}\,\d{3}', dic2[d][2])) == 1:
                dic2[d][2] = dic2[d][2].replace(',', '.')
            if len(dic2[d][2].split()) == 3 and len(re.findall('\d\.\d', dic2[d][2])) == 2:
                print('if two qtys are together with dot in middle')
                a, b, c = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = c
            if len(dic2[d][5].split()) >= 2 and (
                    dic2[d][5].split()[0] == '0.00' or dic2[d][5].split()[0] == '0.90' or dic2[d][5].split()[
                0] == '9.00' or dic2[d][5].split()[0] == '0,00'):
                print('if returned amt and amount are together with >=2 spaces')
                text = dic2[d][5].split()[0]
                dic2[d][5] = dic2[d][5].replace(text, '', 1)
            if len(dic2[d][5].split()) == 2:
                print('if returned amt and amount are together with ==2 spaces')
                a, b = dic2[d][5].split()
                dic2[d][5] = b
            if len(dic2[d][2].split()) == 2 and dic2[d][2] == dic2[d][3]:
                print('if 2nd and 3rd index are same')
                a, b = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = b
            if len(dic2[d][3].split()) == 2 and dic2[d][2] in dic2[d][3]:
                print('if  3rd index contains 2nd index')
                a, b = dic2[d][3].split()
                dic2[d][3] = b
            if len(dic2[d][2].split()) == 2 and dic2[d][3] in dic2[d][2]:
                print('if  2nd index contains 3rd index')
                a, b = dic2[d][2].split()
                dic2[d][2] = a
            if len(dic2[d][3].split()) == 2 and dic2[d][2] == ' ':
                print('if  3rd index contains 2nd index and 2nd index is empty')
                a, b = dic2[d][3].split()
                dic2[d][2] = a
                dic2[d][3] = b
            if len(dic2[d][2].split()) == 2 and dic2[d][3] == ' ':
                print('if  2nd index contains 3rdd index and 3rdd index is empty')
                a, b = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = b
            if d > 1 and d < len(dic2) and dic2[d][4] == ' ' and dic2[d][5] == ' ' and dic2[d - 1][4] != ' ' and \
                    dic2[d - 1][5] != ' ' and dic2[d].count(' ') == 2 and dic2[d - 1].count(' ') >= 3:
                print('if lines are mismatched with d 2 spaces and d-1>=3 spaces')
                dic2[d][4] = dic2[d - 1][4]
                dic2[d][5] = dic2[d - 1][5]
                dic2[d - 1][4] = ' '
                dic2[d - 1][5] = ' '
            if d > 2 and d < len(dic2) - 2 and len(re.findall('\w{6}\s\w{7}\-\s\w{5}\s\w{2}', dic2[d][1])) == 1 and \
                    dic2[d].count(' ') == 2 and dic2[d + 1].count(' ') == 2 and dic2[d + 2].count(' ') == 2 and \
                    len(re.findall('\w{9}\s\w{4}\s\d{3}\w{2}', dic2[d + 1][1])) == 1:
                print('yesss')
                dic2[d][2] = dic2[d + 1][2]
                dic2[d][3] = dic2[d + 1][3]
                dic2[d + 1][2] = ' '
                dic2[d + 1][3] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    # /////////////////////////////
    if hospital == 'deenanath':
        dic1_a = dic1
        la = 1
        dic1 = {}
        for d in dic1_a:

            if dic1_a[d][1] == "O'T INSTRUMENTS":
                dic1_a[d][1] = 'OT INSTRUMENTS'
            if dic1_a[d][1] in head_list and dic1_a[d].count(' ') == 5:
                hhh = copy.deepcopy(dic1_a[d][1])
                dic1_a[d].pop(1)
                dic1_a[d].insert(0, hhh)
            dic1[la] = dic1_a[d]
            la += 1
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddd==', dic2[d])
            if dic2[d][0].__contains__(' :-'):
                dic2[d][0] = dic2[d][0].replace(' :-', '')
            if dic2[d][0].__contains__(' ;-'):
                dic2[d][0] = dic2[d][0].replace(' ;-', '')
            if dic2[d][0].__contains__(' :'):
                dic2[d][0] = dic2[d][0].replace(' :', '')
            if dic2[d][4]!= ' ' and dic2[d][5]!= ' ' and len(dic2[d][5].split())>=2 and dic2[d][4] == dic2[d][5].split()[0]:
                # print('if qty and amt together in 5th indx')
                text = dic2[d][5].split()
                dic2[d][5] = dic2[d][5].replace(dic2[d][5].split()[0],'')
            if len(dic2[d][2].split()) == 2 and dic2[d][3] == ' ':
                a, b = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = b
            if len(dic2[d][5].split()) == 2 and dic2[d][4] == ' ':
                # print('if QTy and amount in n5th indx and 4th indx empty')
                a, b = dic2[d][5].split()
                dic2[d][4] = a
                dic2[d][5] = b
            if dic2[d][0].__contains__('Bill'):
                dic2[d][5] = ' '
                dic2[d][0] = ' '
                dic2[d][4] = ' '
            if dic2[d][0].__contains__('PHARMACY BILL'):
                dic2[d][0] = ' '
                dic2[d][5] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    # /////////////////////////////
    if hospital == 'deenanath-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddd00==', dic2[d])
            if len(dic2[d][1].split()) >= 2 and dic2[d][1].split()[0].__contains__('-'):
                dic2[d][0] = dic2[d][1].split()[0]
                dic2[d][1] = dic2[d][1].replace(dic2[d][1].split()[0], '', 1)
            if len(re.findall('\w{2}\s\d{2}\-\d{4}', dic2[d][1])) == 1 and 'PHARMACY RETAIL' not in dic2[d][1]:
                print('yess divide code from item')
                text = dic2[d][1]
                if len(re.findall('\w{2}\s\d{2}\-\d{4}', dic2[d][1])) == 1:
                    matchdate = re.search(r'\w{2}\s\d{2}\-\d{4}', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '', 1)

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddd11==', dic2[d])
            if dic2[d][3].__contains__('Nos'):
                dic2[d][3] = dic2[d][3].replace('Nos', '')
            if dic2[d][3].__contains__(' Nos'):
                dic2[d][3] = dic2[d][3].replace(' Nos', '')
            if dic2[d][3].__contains__('No'):
                dic2[d][3] = dic2[d][3].replace('No', '')
            if dic2[d][4].__contains__('MEDICA'):
                dic2[d][4] = dic2[d][4].replace('MEDICA', '')
            if dic2[d][2] == '5.000 . ... .0.000.':
                dic2[d][2] = '5.000'
            if d > 1 and d < len(dic2) and dic2[d][0] == 'SR-06-0083' and dic2[d][
                1] == ' NEEDLE NO. 18 X 15 PRO MAN ?' and dic2[d].count(' ') == 4 and dic2[d + 1].count(' ') == 1:
                print('yessss')
                dic2[d][2:] = dic2[d + 1][2:]
                dic2[d + 1][2:] = [' ', ' ', ' ', ' ']
            if len(re.findall('\d{1}\,\d{3}', dic2[d][2])) == 1:
                dic2[d][2] = dic2[d][2].replace(',', '.')
            if len(dic2[d][2].split()) == 3 and len(re.findall('\d\.\d', dic2[d][2])) == 2:
                print('if two qtys are together with dot in middle')
                a, b, c = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = c
            if len(dic2[d][5].split()) >= 2 and (
                    dic2[d][5].split()[0] == '0.00' or dic2[d][5].split()[0] == '0.90' or dic2[d][5].split()[
                0] == '9.00' or dic2[d][5].split()[0] == '0,00'):
                print('if returned amt and amount are together with >=2 spaces')
                text = dic2[d][5].split()[0]
                dic2[d][5] = dic2[d][5].replace(text, '', 1)
            if len(dic2[d][5].split()) == 2:
                print('if returned amt and amount are together with ==2 spaces')
                a, b = dic2[d][5].split()
                dic2[d][5] = b
            if len(dic2[d][2].split()) == 2 and dic2[d][2] == dic2[d][3]:
                print('if 2nd and 3rd index are same')
                a, b = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = b
            if len(dic2[d][3].split()) == 2 and dic2[d][2] in dic2[d][3]:
                print('if  3rd index contains 2nd index')
                a, b = dic2[d][3].split()
                dic2[d][3] = b
            if len(dic2[d][2].split()) == 2 and dic2[d][3] in dic2[d][2]:
                print('if  2nd index contains 3rd index')
                a, b = dic2[d][2].split()
                dic2[d][2] = a
            if len(dic2[d][3].split()) == 2 and dic2[d][2] == ' ':
                print('if  3rd index contains 2nd index and 2nd index is empty')
                a, b = dic2[d][3].split()
                dic2[d][2] = a
                dic2[d][3] = b
            if len(dic2[d][2].split()) == 2 and dic2[d][3] == ' ':
                print('if  2nd index contains 3rdd index and 3rdd index is empty')
                a, b = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = b
            if d > 1 and d < len(dic2) and dic2[d][4] == ' ' and dic2[d][5] == ' ' and dic2[d - 1][4] != ' ' and \
                    dic2[d - 1][5] != ' ' and dic2[d].count(' ') == 2 and dic2[d - 1].count(' ') >= 3:
                print('if lines are mismatched with d 2 spaces and d-1>=3 spaces')
                dic2[d][4] = dic2[d - 1][4]
                dic2[d][5] = dic2[d - 1][5]
                dic2[d - 1][4] = ' '
                dic2[d - 1][5] = ' '
            if d > 2 and d < len(dic2) - 2 and len(re.findall('\w{6}\s\w{7}\-\s\w{5}\s\w{2}', dic2[d][1])) == 1 and \
                    dic2[d].count(' ') == 2 and dic2[d + 1].count(' ') == 2 and dic2[d + 2].count(' ') == 2 and \
                    len(re.findall('\w{9}\s\w{4}\s\d{3}\w{2}', dic2[d + 1][1])) == 1:
                print('yesss')
                dic2[d][2] = dic2[d + 1][2]
                dic2[d][3] = dic2[d + 1][3]
                dic2[d + 1][2] = ' '
                dic2[d + 1][3] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    # /////////////////////////////
    if hospital == 'bhailal-2':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:

            if dic2[d][0] in head_list and (len(re.findall('\d\s?\.\s?\d', dic2[d][5])) == 1 or len(re.findall('\d\s\d', dic2[d][5])) == 1) and dic2[d].count(' ') == 0:
                print('Consultation', dic2[d])
                nevv = copy.deepcopy(dic2[d])
                linzero = nevv[0]
                dic1[lq] = [linzero, ' ', ' ', ' ', ' ', ' ']
                lq += 1
                nevv.pop(0)
                nevv.insert(0, ' ')
                dic1[lq] = nevv
                lq += 1
                continue
            if dic2[d][0].__contains__('CONSULTATION') and dic2[d].count(' ') >= 1:
                    # in head_list and dic2[d].count(' ') >= 1 :
                print('CONSULTATION',dic2[d])
                nevv = copy.deepcopy(dic2[d])
                linn1 = [nevv[0], ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = linn1
                lq += 1
                linn2 = [' '] + nevv[1:]
                dic1[lq] = linn2
                lq += 1
                continue

            if d>1 and d<len(dic2) and len(re.findall('\d{1,2}\/\d{1,2}\/\d{4}',dic2[d-1][0])) and dic2[d-1].count(' ')==3 and dic2[d][3] not in sbt and dic2[d].count(' ')==5:
                print('220100800494',dic2[d-1],dic2[d])
                tty1 = opr1(dic2[d], dic2[d - 1], src_dc)
                dic1[lq - 1] = tty1
                continue


            if dic2[d][0] in head_list and dic2[d].count(' ')==4:
                print('LABORATORY',dic2[d],dic2[d+1])
                nevv=copy.deepcopy(dic2[d])
                nevv1=copy.deepcopy(dic2[d+1])
                nevv1.pop(5)
                nevv1.insert(5, nevv[5])
                nevv1.pop(6)
                nevv1.insert(6,nevv[6])
                dic1[lq] = nevv
                lq += 1
                nevv.pop(5)
                nevv.insert(5,' ')
                nevv.pop(6)
                nevv.insert(6,' ')

                dic1[lq]= nevv1
                lq+=1
                continue
            if d>1 and d<len(dic2) and len(re.findall('\d{1,2}\/\d{1,2}\/\d{4}',dic2[d-1][0])) and dic2[d-1].count(' ')==6 and dic2[d].count(' ')==2:
                print('SURGICAL220202527162',dic2[d])
                tty1 = opr1(dic2[d], dic2[d - 1], src_dc)
                dic1[lq - 1] = tty1
                continue



            if dic2[d][0].__contains__('Rupees in'):
                print('Rupees in', dic2[d])
                dic2[d].pop(0)
                dic2[d].insert(0, ' ')
            if dic2[d][3].__contains__(sbt) and dic2[d].count(' ')==4:
                print('ABORATORY TOTAL', dic2[d])
                dic2[d].pop(3)
                dic2[d].insert(3, ' ')


            if len(re.findall('\d\s\d\/\d{2}\/\d{3,4}\s?\D+?\d+',dic2[d][0])) or  len(re.findall('\D\d+\s\d+',dic2[d][0])) or len(re.findall('\d{1,2}\/\d{1,2}\/\d{4}\s\d+\s\D+',dic2[d][0])) and dic2[d].count(' ') >=1:
                       if len(re.findall('\d\s\d\/\d{2}\/\d{3,4}\s?\D+?\d+',dic2[d][0])):
                           a, b = re.split('\d\s\d\/\d{2}\/\d{3,4}',dic2[d][0])
                           print('aaa',a)
                           print('bbb',b)
                           dic2[d][0] = dic2[d][0].replace(b, '')
                           dic2[d][1] = b
                       if len(re.findall('\D\d+\s\d+', dic2[d][0])) and dic2[d].count(' ') >= 2:
                            a, b = re.split('\D\d+\s',dic2[d][0], maxsplit=1)
                            print('aaa',a)
                            print('bbb',b)
                            dic2[d][0] = dic2[d][0].replace(b, '')
                            dic2[d][1] = b
                       if len(re.findall('\d{1,2}\/\d{1,2}\/\d{4}\s\d+\s\D+',dic2[d][0]))  and dic2[d].count(' ') >=2:
                            a, b = re.split('\d{1,2}\/\d{1,2}\/\d+\s?\d+\s?',dic2[d][0], maxsplit=1)
                            print('aaa',a)
                            print('bbb',b)
                            dic2[d][0] = dic2[d][0].replace(b, '')
                            dic2[d][2] = b





                       # if len(re.findall('\D\d+\s\d+',dic2[d][0]))  and dic2[d].count(' ') >=2:
                       #       a, b = re.split('\D\d+\s',dic2[d][0], maxsplit=1)
                       #       print('aaa',a)
                       #       print('bbb',b)
                       #       dic2[d][0] = dic2[d][0].replace(b, '')
                       #       dic2[d][1] = b
                       #       dic1[lq] = dic2[d]
                       #       # lq += 1
                       #       # continue


            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print(';dddd=',dic2[d])
            if d>1 and d<len(dic2) and len(re.findall('\d{1,2}\/\d{1,2}\/\d{4}',dic2[d-1][0])) and dic2[d-1].count(' ')==5 and dic2[d].count(' ')>=2:
                print('220202527162_line_Merge',dic2[d],dic2[d+1])
                tty1 = opr1(dic2[d], dic2[d - 1], src_dc)
                dic1[lq-1] = tty1
                continue
            if d>1 and d<len(dic2) and len(re.findall('\d{1,2}\/\d{1,2}\/\d{4}', dic2[d-1][0])) and dic2[d-1].count(' ') == 6 and dic2[d].count(' ') == 3:
                print('220202527162_line_Merge2', dic2[d], dic2[d- 1])
                tty1 = opr1(dic2[d], dic2[d - 1], src_dc)
                dic1[lq-1] = tty1

                continue
            dic1[lq] = dic2[d]
            lq += 1
    # /////////////////////////////
    if hospital == 'SSB_Central':
        dic2 = dic1
        dicA = {}
        lq = 1
        for d in dic2:
            #for 0th colomn problem
            if len(dic2[d][0].split()) > 4 and dic2[d][1] == ' ' and dic2[d].count(' ') < 4:
                # print('heee',dic2[d])
                if len(re.findall('\d\/\d{1,2}\/\d+\s+\d+\:\d+\s+\-\s+\w{1,4}\/\d{6}', dic2[d][0])) and len(dic2[d][0].split()) > 4 and dic2[d][1] == ' ' and dic2[d].count(' ') < 4:
                    # print('heee1', dic2[d])
                    a, b = re.split('\d\/\d{1,2}\/\d+\s+\d+\:\d+\s+\-\s+\w{1,4}\/\d{6}',dic2[d][0], maxsplit=1)
                    # print('aaa', a)
                    # print('bbb', b)
                    dic2[d][0] = dic2[d][0].replace(b, '')
                    dic2[d][1] = b
                    # print('heee1op',dic2[d])
                if len(re.findall('\d\/\d{1,2}\/\d+\s+\d{1,2}\:\d{1,2}\s?\-\s?\w{1,2}\d{1,7}\/\d{1,6}', dic2[d][0])) and len(dic2[d][0].split()) > 4 and dic2[d][1] == ' ' and dic2[d].count(' ') < 4:
                    # print('heee2', dic2[d])
                    a, b = re.split('\d\/\d{1,2}\/\d+\s+\d{1,2}\:\d{1,2}\s?\-\s?\w{1,2}\d{1,7}\/\d{1,6}', dic2[d][0], maxsplit=2)
                    # print('aaa', a)
                    # print('bbb', b)
                    dic2[d][0] = dic2[d][0].replace(b, '')
                    dic2[d][1] = b
                    # print('heee2op', dic2[d])

        dic2 = dic1
        dicA = {}
        lq = 1
        for d in dic2:
            # for rate and qty  problem
            if len(dic2[d][2].split()) == 3 and dic2[d][3] == ' ' and dic2[d].count(' ') < 4:
                a, b, c = dic2[d][2].split()
                print('aaa',a)
                print('aaa1', b)
                print('aaa2', c)
                dic2[d][2] = b
                dic2[d][3] = c

            if len(dic2[d][2].split()) == 2 and dic2[d][3] == ' ' and dic2[d].count(' ') < 4:
                # print('heee',dic2[d])
                a, b = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = b
    # /////////////////////////////
    if hospital == 'yatharth':
        dic2 = dic1
        dicA = {}
        lq = 1
        for d in dic2:
            print('hello', dic2[d])
            if len(re.findall('\d\.\d', dic2[d][0])) == 2 and dic2[d][0].__contains__('For') or dic2[d][0].__contains__(
                    '*'):
                # print('hello',dic2[d])
                if dic2[d][0].__contains__('For'):
                    # print('for1', dic2[d])
                    a, b = dic2[d][0].split('For')
                    # print('for1', a)
                    # print('for2', b)
                    dic2[d][0] = dic2[d][0].replace(b, '')
                    dic2[d][3] = b
                if dic2[d][0].__contains__('*'):
                    # print('****', dic2[d])
                    a, b = dic2[d][0].split('*')
                    # print('****1', a)
                    # print('****2', b)
                    dic2[d][0] = dic2[d][0].replace(b, '')
                    dic2[d][3] = b
            if dic2[d][0].__contains__('OT CHARGES') == 1 and dic2[d].count(' ') == 5 and dic2[d + 1][0].__contains__(
                    'OT CHARGES') == 1:
                print('lllll', dic2[d + 1], dic2[d])
                dic2[d + 1][0] = dic2[d + 1][0].replace('OT CHARGES', 'OT charges')
            if dic2[d][0].__contains__('BED CATEGORYAmountGST AmountTotal Bill Amount') == 1 and dic2[d].count(
                    ' ') == 5:
                # print('llllll',dic2[d])
                dic2[d][0] = 'Total Bill Amount'
    # /////////////////////////////
    if hospital=='reliance-2':
        dic2 = dic1
        dicA = {}
        lq = 1
        for d in dic2:
            print('ddd==',dic2[d])

            dic1[lq] = dic2[d]
            lq += 1
    # /////////////////////////////
    if hospital == 'jaslok' or hospital == 'jaslok1':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:

            if len(re.findall('\w+\s?\d{1,2}\/\d{1,2}\/\d{4}', dic2[d][0])):
                a, b = re.split('\w+\s?', dic2[d][0], maxsplit=1)
                print('aaa', a)
                print('bbb', b)
                dic2[d][0] = dic2[d][0].replace(b, '')
                dic2[d][1] = b

            dic1[lq] = dic2[d]
            lq += 1
    # /////////////////////////////
    if hospital == 'jaslok2':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if d > 1 and d < len(dic2) and len(re.findall('\d\s?\.\s?\d', dic2[d - 1][4])) == 1 and dic2[d - 1].count(
                    ' ') == 2 and dic2[d - 1][5].count(' ') == True and dic2[d].count(' ') == 4:
                print('LOLO', dic2[d - 1])
                tty1 = opr1(dic2[d], dic2[d - 1], src_dc)
                dic1[lq - 1] = tty1
                continue
            if d > 1 and d < len(dic2) and len(re.findall('\w+\s\:\s\d+', dic2[d][1])) or len(
                    re.findall('\w+\s\:\s\d+', dic2[d][0])) and dic2[d].count(' ') >= 4:
                if d > 1 and d < len(dic2) and len(re.findall('\w+\s\:\s\d+', dic2[d][1])):
                    print('sharer', dic2[d])
                    dic2[d].pop(2)
                    dic2[d].insert(2, dic2[d][1])
                    dic2[d].pop(1)
                    dic2[d].insert(1, ' ')
                elif len(re.findall('\w+\s\:\s\d+', dic2[d][0])):
                    print('sharer', dic2[d])
                    dic2[d].pop(2)
                    dic2[d].insert(2, dic2[d][0])
                    dic2[d].pop(0)
                    dic2[d].insert(0, ' ')

            if len(dic2[d][0].split()) == 2 and len(re.findall('\d+\s\d{1,2}\/\d{1,2}\/\d', dic2[d][0])):
                print('codeDate', dic2[d])
                a, b = dic2[d][0].split()
                dic2[d].pop(0)
                dic2[d].insert(0, a)
                dic2[d].pop(1)
                dic2[d].insert(1, b)
            if len(dic2[d][0].split()) == 2 and len(re.findall('\d\/\d{3,4}\D?\d+', dic2[d][0])):
                print('Datecode', dic2[d])
                a, b = dic2[d][0].split()
                dic2[d].pop(0)
                dic2[d].insert(0, b)
            if len(re.findall('\w+|\w+\s\w+', dic2[d][1])) and len(re.findall('\w+|\w+\s\w+', dic2[d][2])) and dic2[
                d].count(' ') == 4:
                print('Repeate', dic2[d])
                dic2[d].pop(1)
                dic2[d].insert(1, ' ')

            dic1[lq] = dic2[d]
            lq += 1
    # /////////////////////////////
    if hospital == 'jaslok2-pharma' or hospital == 'jaslok1-pharma':
        dic2 = dic1
        dicA = {}
        lq = 1
        for d in dic2:
            print('dic2[ddd', dic2[d])

            if len(re.findall('\w{1,7}\s?\:\s?\d+\s?\-\s?', dic2[d][0])) and dic2[d].count(' ') >= 2:
                # print('hello', dic2[d])
                a, b = re.split('\w{1,7}\s?\:\s?\d+\s?\-\s?', dic2[d][0], maxsplit=2)
                # print('aaa', a)
                # print('bbb', b)
                dic2[d][0] = b

            if len(re.findall('\d{1,2}\/\d{1,2}\d{1,4}\s?', dic2[d][0])) and dic2[d].count(' ') >= 0:
                dic2[d][0] = dic2[d][0].replace('.', ' ')
                dic2[d][0] = dic2[d][0].replace('-', ' ')
                dic2[d][0] = dic2[d][0].strip()
                # print('hello', dic2[d])
                if len(dic2[d][0].split()) == 2:
                    print('hello', dic2[d])
                    a, b = dic2[d][0].split()
                    print('aaa', a)
                    print('bbb', b)
                    dic2[d][0] = b

                if len(dic2[d][0].split()) == 3:
                    a, b, c = dic2[d][0].split(' ', 3)
                    print('KKKK', dic2[d])
                    print('aaa', a)
                    print('bbb', b)
                    dic2[d][0] = b

            if (len(re.findall('\.', dic2[d][0])) >= 1 or len(re.findall('\-', dic2[d][0])) >= 1) and len(
                    re.findall('\d', dic2[d][0])) < 1:
                print('Cleaning 0th index', dic2[d])
                dic2[d][0] = ' '

            if (len(re.findall('\.', dic2[d][2])) >= 1 or len(re.findall('\-', dic2[d][2])) >= 1) and dic2[d].count(
                    ' ') >= 4 and dic2[d][2].__contains__('Total for Voucher') == False and dic2[d][2].__contains__(
                    sbt) == False:
                print('Cleaning 2nd index', dic2[d])
                dic2[d][2] = ' '

            if (len(re.findall('\-', dic2[d][1])) >= 1 and len(re.findall('\-', dic2[d][2])) >= 1):
                print('Cleaning the whole linex', dic2[d])
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']

            if dic2[d][2] != ' ' and len(dic2[d][2].split()) >= 2 and len(re.findall('\d+\.\d+', dic2[d][2])) == 1 and \
                    dic2[d][2].__contains__('-'):
                print('QtyMerge')
                a, b = re.split('\d+\.\d+', dic2[d][2])
                dic2[d][2] = b
            if dic2[d][1] != ' ' and len(dic2[d][1].split()) >= 2 and len(
                    re.findall('\d+\w+\d+', dic2[d][1].split()[0])):
                print('PartiMerge')
                a, b = re.split('\d+\w+\d+', dic2[d][1], maxsplit=1)
                dic2[d][1] = b
                dic2[d][1] = dic2[d][1].strip()

            if dic2[d][2].__contains__('Total for Voucher') or dic2[d][2].__contains__('Voucher') or dic2[d][
                1].__contains__('Total for Voucher'):
                print('Ttl fr Voucher')
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if d > 1 and d < len(dic2) and len(re.findall('\d{1,2}\/\d{1,2}\/\d{3,4}', dic2[d - 1][0])) and dic2[
                d - 1].count(' ') == 4 and dic2[d].count(' ') < 4:
                print('Merge', dic2[d - 1], dic2[d])
                tty1 = opr1(dic2[d], dic2[d - 1], src_dc)
                dic1[lq - 1] = tty1
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']

            if d > 1 and d < len(dic2) and len(re.findall('\d{1,2}\/\d{1,2}\/\d{3,4}', dic2[d - 1][0])) and dic2[
                d - 1].count(' ') > 4:
                print('Merge', dic2[d - 1], dic2[d])
                tty1 = opr1(dic2[d], dic2[d - 1], src_dc)
                dic1[lq - 1] = tty1
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']

            if d > 1 and d < len(dic2) and len(re.findall('\d{1,2}\/\d{1,2}\/\d{3,4}', dic2[d - 1][0])) and dic2[
                d - 1].count(' ') == 3:
                print('Merge', dic2[d - 1], dic2[d])
                tty1 = opr1(dic2[d], dic2[d - 1], src_dc)
                dic1[lq - 1] = tty1
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']

            if d > 1 and d < len(dic2) and len(re.findall('\d\s?\.\s?\d', dic2[d][5])) > 1:
                print('amountremark', dic2[d])
                if len(re.findall('\d\s?\.\s?\d', dic2[d][5])) < 4:
                    if len(re.findall('\d\.\d', dic2[d][5])) == 2:
                        a, b = dic2[d][5].split()
                        print('bb0', b)
                        dic2[d][5] = b

                    if len(re.findall('\d\.\d', dic2[d][5])) == 3:
                        print('amountremark', dic2[d])
                        a, b, c = dic2[d][5].split()
                        dic2[d][5] = c

            dic1[lq] = dic2[d]
            lq += 1
    # /////////////////////////////
    if hospital == 'jaslok-pharma':
        dic2 = dic1
        dicA = {}
        lq = 1
        for d in dic2:
            # print('hello',dic2[d])
            if len(re.findall('\w{1,7}\s?\:\d+', dic2[d][0])) and dic2[d].count(' ') > 4:
                # print('hello', dic2[d])
                a, b = re.split('\w{1,7}\s?\:\d+', dic2[d][0], maxsplit=2)
                # print('aaa', a)
                # print('bbb', b)
                dic2[d][0] = b

            if len(dic2[d][0].split()) == 2 and dic2[d].count(' ') < 3:
                print('removal', dic2[d])
                a, b = dic2[d][0].split()
                # print('aaa', a)
                # print('bbb', b)
                dic2[d][0] = a
    # /////////////////////////////
    if hospital == 'sundaram':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d?\D?\d+\D?\.\d+\s\D?\d?\D?\d+\.\d+', dic2[d][5])):
                print('Ratemerge', dic2[d])
                a, b = re.split('\s\D?\d?\D?\d+\.\d+', dic2[d][5], maxsplit=1)
                print('aaa', a)
                print('bbb', b)
                dic2[d][5] = dic2[d][5].replace(b, '')
                dic2[d][5] = a
            if d >= 1 and d < len(dic2) and len(re.findall('\d\/\d{2}\/\d+', dic2[d][1])) and dic2[d].count(
                    ' ') <= 2 and dic2[d + 1].count(' ') == 6 and dic2[d + 1][2] != ' ':
                dic2[d][2] = dic2[d][2] + ' ' + dic2[d + 1][2]
                dic2[d + 1][2] = ' '

            dic1[lq] = dic2[d]
            lq += 1
            # /////////////////////////////

    if hospital == 'amri':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d\/\d{2}\/\d', dic2[d][0])):
                print('extra', dic2[d])
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'baptist-bangalore':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('hellp',dic2[d])
            if dic2[d][3]!=' ' and dic2[d][5]!=' ' and dic2[d].count(' ')==4 and dic2[d-1][3]==' ' and dic2[d-1][5]==' ':
                print('hellp', dic2[d],dic2[d-1])
                dic2[d-1][5] = dic2[d][5]
                dic2[d-1][3] = dic2[d][3]
                dic2[d][3] = ' '
                dic2[d][5] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'AIMS1':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('hellp',dic2[d])
            if len(re.findall('^\d{1,}\s',dic2[d][0])) and dic2[d].count(' ')==5 :
                # print('hellp', dic2[d])
                dic2[d][0]=re.sub('^\d{1,}\s?','',dic2[d][0])
            if dic2[d][0] == 'MR':
                dic2[d][0] = 'MRI'
            if len(re.findall('^\d{1,}\s',dic2[d][1])) and dic2[d].count(' ')==1 :
                # print('hellp', dic2[d])
                dic2[d][1]=re.sub('^\d{1,}\s?','',dic2[d][1])

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Stephens':
        dic2 = dic1
        dicA = {}
        lq = 1
        for d in dic2:
            if dic2[d][1].__contains__('CONSULTATION CHARGES') and dic2[d].count(' ')==5:
                dic2[d].pop(1)
                dic2[d].insert(1, 'Consultation Charges')
            if dic2[d][1].__contains__('ADMISSION FEE') and dic2[d].count(' ')==5:
                dic2[d].pop(1)
                dic2[d].insert(1, 'Admission Fee')
            if dic2[d][1].__contains__('ACCOMMODATION') and dic2[d].count(' ')==5:
                dic2[d].pop(1)
                dic2[d].insert(1, 'Accomodation')
            if dic2[d][1].__contains__('ECG') and dic2[d].count(' ')==5:
                dic2[d].pop(1)
                dic2[d].insert(1, 'Ecg')
            if dic2[d][1] not in head_list:
                dic2[d][0] = dic2[d][0].replace(dic2[d][1],'').strip()
    if hospital == 'SPH':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('hellp',dic2[d])
            if dic2[d][1] in head_list and dic2[d].count(' ') == 5 and dic2[d + 1][2].__contains__(sbt):
                # print('hellp', dic2[d])
                dic2[d + 1][1] = dic2[d][1]
                dic2[d][1] = ' '
            if len(dic2[d][0].split()) > 1 and dic2[d][1] == ' ' and dic2[d].count(' ') < 4:
                print('hellp', dic2[d])
                a, b = dic2[d][0].split(' ', 1)
                dic2[d][1] = b
                dic2[d][0] = a
            if dic2[d][2].__contains__(sbt) and dic2[d].count(' ') == 5:
                dic2[d][2] = ' '
            if dic2[d].count(' ') == 5 and dic2[d][5] != ' ':
                dic2[d][5] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'sancheti':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('sannss', dic2[d])
            if (dic2[d][0] == 'quipments, Instruments & Consumables' or  dic2[d][0] == 'Equipments, Instruments & Consumables') and dic2[d].count(' ') == 5:
                dic2[d][0] = 'Equipments Instruments & Consumables'
            if dic2[d][0] == 'Equipments, Instruments & Consumable' and dic2[d].count(' ') == 5:
                dic2[d][0] = 'Equipments Instruments & Consumables'
            if dic2[d][0] == 'Implan' and dic2[d].count(' ') == 5:
                dic2[d][0] = 'Implant'
            if len(re.findall('^\d{1,}\s?', dic2[d][0])) == 1 and dic2[d].count(' ') < 4:
                print('lssmmsm', dic2[d])
                dic2[d][0] = re.sub('^\d{1,}\s?', '', dic2[d][0])
            if len(dic2[d][3].split(' '))==2:
                a,b = dic2[d][3].split(' ')
                dic2[d][3] = b
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Dharamshila':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if d > 1 and len(re.findall('^\d+\s?\D\s?\w+', dic2[d][0])):
                print('SNoHead', dic2[d])
                a, b = re.split('^\d+\s?\D\s?', dic2[d][0], maxsplit=1)
                # print('mm', a)
                # print('nn', b)
                dic2[d][0] = b
            if dic2[d][0] != ' ' and len(re.findall('\d{2}\-\d{2}\-\d{4}', dic2[d][0])) == 1 and dic2[d][1] == ' ':
                print('desdate', dic2[d])
                text = dic2[d][0]
                # matchcode = re.search('\D+\s\D+\w+\D+', dic2[d][0])
                matchdate = re.search('\d{2}\-\d{2}\-\d{4}', dic2[d][0])
                print('matchdaaaa', matchdate.group())

                dic2[d][1] = matchdate.group()
                dic2[d][0] = text.replace(matchdate.group(), '')



            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Mehata':
            dicA = dic1
            dic2 = dicA
            dic1 = {}
            lq = 1
            for d in dic2:
                for i in head_list:
                    if i in dic2[d][0] and dic2[d].count(' ') <= 3:
                        print('PROFILEEE')
                        lineee = [i, ' ', ' ', ' ', ' ', ' ']
                        dic1[lq] = dic2[d]
                        lq += 1
                        dic1[lq - 1] = lineee
                        dic2[d][0] = dic2[d][0].replace(i, '')

                if d > 1 and len(re.findall('\d{2}\/\d+\s\d{7}|\d\s?\d\/\d{2}\D?\D?\d{3,4}\s\d{7}', dic2[d][0])):
                    print('SNoHead', dic2[d])
                    a, b = re.split('\s\d{7}', dic2[d][0], maxsplit=1)
                    #print('mm', a)
                    #print('nn', b)
                    dic2[d][0] = a
                if d > 1 and len(re.findall('^\D?\d+\s\w+|^\w+\d+\s\w+', dic2[d][1])):
                    print('Codedescription', dic2[d])
                    a, b = re.split('^\D?\d+\s|^\w+\d+\s\w+', dic2[d][1], maxsplit=1)
                    print('mm', a)
                    print('nn', b)
                    dic2[d][1] = b
                if  dic2[d][2]!=' ' and dic2[d].count(' ')>=0 and dic2[d][1]!=' '  :
                    print('remove exp',dic2[d])
                    dic2[d][2]=' '


                dic1[lq] = dic2[d]
                lq += 1
    if hospital =='Shreeaggarsain_N16342':
        dic2 = dic1
        dicA = {}
        lq = 1
        for d in dic2:
            if len(re.findall('^\d{1,}\.\s',dic2[d][0]))==1 or len(re.findall('^\d{1,}\.\w',dic2[d][0]))==1 or len(re.findall('^\d{1,}\s',dic2[d][0]))==1 and dic2[d].count(' ')==5:
                dic2[d][0] = re.sub('^\d{1,}\.','',dic2[d][0]).strip()
            if dic2[d][1]=='CHARGE' and dic2[d].count(' ')==5 and dic2[d+1][1] in head_list:
                dic2[d][1] = ' '
                dic2[d][0] = dic2[d+1][1]
            dic1[lq] = dic2[d]
            lq += 1
    if hospital =='Oyster_N5539':
        dic2 = dic1
        dicA = {}
        lq = 1
        for d in dic2:
            if dic2[d][2]==dic2[d][5] and dic2[d][3]==' ' and dic2[d][2]!=' ' and dic2[d][5]!=' ':
                print('quatity',dic2[d])
                dic2[d][3] = '1.'
            if dic2[d][3]==' ' and dic2[d].count(' ')<4:
                print('dummy qty',dic2[d])
                dic2[d][3]='1.'
            dic1[lq] = dic2[d]
            lq += 1
    if hospital =='Oyster_N5539-pharma':
        dic2 = dic1
        dicA = {}
        lq = 1
        for d in dic2:
            if dic2[d][2]==' ' and dic2[d].count(' ')<3:
                print('sicllx',dic2[d])
                a,b = dic2[d][0].split(' ',1)
                dic2[d][0] = b
                dic2[d][2] = a
                print('sicllx', dic2[d])
            if len(re.findall('\d\.\d',dic2[d][5]))>0 and len(dic2[d][5].split())==2:
                a,b = dic2[d][5].split(' ',1)
                dic2[d][5]=b
            if len(re.findall('\d\.\d',dic2[d][4]))>0 and len(dic2[d][4].split())==2:
                a, b = dic2[d][4].split(' ', 1)
                dic2[d][4] = b
            dic1[lq] = dic2[d]
            lq += 1
    if hospital =='Tata':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if  len(re.findall('\d\/\d{2}\/\d{4}\s\w+', dic2[d][0])):
                print('date Perti',dic2[d])
                a, b = re.split('\s', dic2[d][0], maxsplit=1)
                print('aa', a)
                print('bb', b)
                dic2[d][0] = dic2[d][1].replace(b, '')
                dic2[d][0] = a
                dic2[d][1] = b

            if d>1 and len(re.findall('\d\.\d',dic2[d][5])) and dic2[d].count(' ')==5  and dic2[d-1].count(' ')==5:
                print('add sbt',dic2[d])
                dic2[d][2]= 'Sub Total'
                dic2[d-1][1]=dic2[d-1][1]+dic2[d][1]
                dic2[d][1]=' '
            if  len(re.findall('\d+\s\d+\.\d', dic2[d][3])):
                print('Rate debit',dic2[d])
                a, b = re.split('\s\d+\.\d', dic2[d][3], maxsplit=1)
                dic2[d][3] = a
            if  len(re.findall('\d+\s\d+\.\d', dic2[d][2])):
                print('QtyRate',dic2[d])
                a, b = re.split('\s\d+\.\d', dic2[d][2], maxsplit=1)
                dic2[d][2] = a
            if d>3 and dic2[d][3] in sbt and dic2[d][1] != ' ':
                dic2[d - 1][1] = dic2[d - 1][1] + dic2[d][1]
                dic2[d][1] = ' '
            for i in head_list :
                if i in dic2[d][0]and dic2[d].count(' ')<=3:
                    print('PROFILEEE')
                    lineee = [i, ' ', ' ', ' ', ' ', ' ']
                    dic1[lq] = dic2[d]
                    lq+=1
                    dic1[lq-1] =lineee
                    dic2[d][0] = dic2[d][0].replace(i,'')



            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'RGStone_N0433':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][2] == ' ' and dic2[d].count(' ')==2:
                print('line merged', dic2[d])
                a,b = re.split('\w{1}\d{2}\/\d{1,}',dic2[d][0],maxsplit=1)
                dic2[d][2] = b
                dic2[d][0] = dic2[d][0].replace(b,'')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital =='axis_N13322':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][2].__contains__('Sub Total') and dic2[d][3].__contains__('Sub Total'):
                print('kkkk',dic2[d])
                dic2[d][3] = ' '
            for i in head_list :
                if i in dic2[d][0]and dic2[d].count(' ')<=3:
                    print('PROFILEEE',dic2[d])
                    lineee = [i, ' ', ' ', ' ', ' ', ' ']
                    dic1[lq] = dic2[d]
                    lq+=1
                    dic1[lq-1] =lineee
                    dic2[d][0] = dic2[d][0].replace(i,'')


            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Pace_N16481':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d].count(' ') == 4 and len(re.findall('\d\.\d', dic2[d][5])) == 1:
                # print('helllm',dic2[d])
                dic2[d][5] = ' '
            if dic2[d].count(' ') == 3 and len(re.findall('\d\.\d', dic2[d][5])) == 1 and dic2[d][1] == ' ':
                print('helllm', dic2[d])
                dic2[d][5] = ' '
                dic2[d][4] = ' '
            if dic2[d].count(' ') < 4 and len(re.findall('\d\.\d', dic2[d][5])) >= 1:
                # print('helllm',dic2[d])
                dic2[d][0] = ' '
            if dic2[d][3].__contains__('*'):
                dic2[d][3] = dic2[d][3].strip('*')
                if len(dic2[d][3].split('*', 1)) == 2 and dic2[d][4] == ' ':
                    a, b = dic2[d][3].split('*', 1)
                    dic2[d][3] = a.strip()
                    dic2[d][4] = b.strip()
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Dr.Ramesh_N13693':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][3].__contains__('*'):
                # print('starr', dic2[d])
                dic2[d][3] = dic2[d][3].strip('*')
                dic2[d][3] = dic2[d][3].strip()
                dic2[d][4] = dic2[d][4].strip('*')
                dic2[d][4] = dic2[d][4].strip()
                # print('starr', dic2[d])
            if dic2[d][3] == dic2[d][4] and dic2[d][4] != ' ':
                dic2[d][3] = ' '
                # print('starr',dic2[d])
            if dic2[d][3].__contains__('*') and dic2[d][4] == ' ' or dic2[d][4] == '' and len(
                    dic2[d][3].split('*')) == 2:
                print('starr', dic2[d])
                a, b = dic2[d][3].split('*')
                dic2[d][3] = a.strip()
                dic2[d][4] = b.strip()
            if dic2[d][0] in src_dc['merge_set']:
                dic2[d][5] = ' '
                dic2[d][4] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'RGStone_N0433':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][4] == '0.00' and len(dic2[d][3].split(' ')) == 2:
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b

            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'care':
        dic2 = dic1
        dicA = {}
        lq = 1
        for d in dic2:
            if len(dic2[d][5].split()) == 2:
                print('dscas', dic2[d])
                a, b = dic2[d][5].split()
                dic2[d][5] = b

            if dic2[d][2] == dic2[d][1]:
                dic2[d][2] = ' '
            if dic2[d][2] == ' ' and len(dic2[d][4].split()) == 2:
                print('deede', dic2[d])
                a, b = dic2[d][4].split()
                dic2[d][4] = b
                dic2[d][2] = a
            if len(re.findall('\d\.\d', dic2[d][2])) == 1 and len(dic2[d][2].split()) > 1:
                print('primsms', dic2[d])
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'waluj_N16687':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][2]==' ' and dic2[d][5]!=' ' and dic2[d][3]==' ':
                print('dummy qty',dic2[d])
                dic2[d][2] = '1'
            if len(re.findall('^\d{1,}\s',dic2[d][0]))==1:
                dic2[d][0] = re.sub('^\d{1,}\s','',dic2[d][0])
            if dic2[d][2] == ' ' and dic2[d][5] != ' ' and dic2[d][3]!=' ' and dic2[d][5]==dic2[d][3]:
                dic2[d][2] = '1'
            dic1[lq] = dic2[d]
            lq += 1
    if hospital =='mazumdar_daycare':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d{1,2}\/\d{2}\/\d{2}\s\D?\s?\w+', dic2[d][0]))  and dic2[d][1] == ' ':
                print('if date in 0th index',dic2[d])
                text = dic2[d][0]
                matchdate = re.search(r'\d{1,2}\/\d{2}\/\d{2}',text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(),'')
            if len(re.findall('\d+\s\w+\-?\d+\-?\d+', dic2[d][4]))  and dic2[d][5] == ' ':
                print('if amount in 4th index',dic2[d])
                text2 = dic2[d][4]
                matchbill = re.search(r'\w+\-?\d+\-?\d+',text2)
                dic2[d][4] = matchbill.group()
                dic2[d][5] = text2.replace(matchbill.group(),'')


            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='psghospital':
        dic2 = dic1
        dicA = {}
        lq = 1
        for d in dic2:
            # print('dic2[ddd', dic2[d])
            # if dic2[d][0].__contains__('Y CHAR'):
            #     dic2[d][0] = 'X-RAY CHARGES'
            if len(re.findall('\d{1,}\-\w{3}\-\d{1,}',dic2[d][0]))==1 and dic2[d][1]==' ':
                print('dic2[ddd', dic2[d])
                if dic2[d][0].__contains__('PER'):
                    a,b= dic2[d][0].split('PER')
                    dic2[d][1] = b
                if dic2[d][0].__contains__('SPECIAL PROFESSIONAL CHARGES') and dic2[d][5]!=' ':
                    dic2[d][1]=dic2[d][0]
                    dic2[d][1] = dic2[d][1].replace('SPECIAL PROFESSIONAL CHARGES','')

                dic2[d][0] = re.sub('\d{1,}\-\w{3}\-\d{1,}','',dic2[d][0])
                print('dic2[ddd', dic2[d])
            if dic2[d][0].__contains__('SPECIAL PROFESSIONAL CHARGES') and dic2[d][5]!=' ' and dic2[d][1]==' ':
                dic2[d][0] = ' '
                dic2[d][1] = 'Subtotal'
            if dic2[d][0] in head_list and len(re.findall('\d',dic2[d][5]))>0 and dic2[d].count(' ')==4:
                dic2[d][0] = ' '
            if dic2[d][0]!=' ' and len(re.findall('\d\-\w{3}\-\d',dic2[d][0]))==0 and dic2[d][5]!=' ' and dic2[d].count(' ')==4 and dic2[d][0] not in head_list :
                print('dic2[ddd', dic2[d])
                dic2[d-1][0] = dic2[d-1][0]+' '+dic2[d][0]
                dic2[d][0] = ' '
                dic2[d][1] = 'Subtotal'
    if hospital == 'Victor_N0472':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d\-\d{2}\-\d',dic2[d][0]))==1 and len(re.findall('\d\-\d{2}\-\d',dic2[d][1])) == 1:
                # print('hellp',dic2[d])
                dic2[d][0] = re.sub('\d{1,}\-\d{1,}\-\d{1,}','',dic2[d][0])
                dic2[d][1] = re.sub('^\d{1,}\-\d{1,}\-\d{1,}', '', dic2[d][1])
                dic2[d][1]= dic2[d][1].strip()
            if dic2[d][0]=='GEON CHARGES':
                dic2[d][0]='SURGEON CHARGES'
            if dic2[d][0]=='CHARGES':
                dic2[d][0]=' '
            if dic2[d][0]=='AND GASES':
                dic2[d][0]=' '
            if dic2[d][0]=='ANESTHESIA EQUIPMENTS':
                dic2[d][0]='ANESTHESIA EQUIPMENTS AND GASES'
            if dic2[d][0]=='MEDICAL EQUIPMENT':
                dic2[d][0]='MEDICAL EQUIPMENT CHARGES'
            if dic2[d][0]=='DOCTORS INSTRUMENT':
                dic2[d][0]='DOCTORS INSTRUMENT CHARGES'
            if dic2[d][0]=='MISCELLANEOUS':
                dic2[d][0]='MISCELLANEOUS CHARGE'
            if dic2[d][0]=='CONSULTATION':
                dic2[d][0]='CONSULTATION CHARGES'
            if dic2[d][0]=='MICRO BIOLOGY &':
                dic2[d][0]='MICRO BIOLOGY & SEROLOGY'
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Malik_N4525':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('^\d{1}\s', dic2[d][0])) and dic2[d].count(' ') == 4:
                print('SNo Perti', dic2[d])
                a, b = re.split('^\d{1}\s', dic2[d][0], maxsplit=1)
                print('aa', a)
                print('bb', b)
                dic2[d][0] = dic2[d][1].replace(a, '')

                dic2[d][0] = b

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'sjm_16250':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d\D?\s\.?\s?\w+', dic2[d][0])) and dic2[d].count(' ') == 5:
                print('SNo Perti', dic2[d])
                a, b = re.split('\d\D?\s\.?\s?', dic2[d][0], maxsplit=1)
                print('aa', a)
                print('bb', b)
                dic2[d][0] = dic2[d][1].replace(a, '')

                dic2[d][0] = b

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'sjm_16250':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print("hghgfjf")
            if len(re.findall('\d\D?\s\.?\s?\w+', dic2[d][0])) and dic2[d].count(' ') == 5:
                print('SNo Perti', dic2[d])
                a, b = re.split('\d\D?\s\.?\s?', dic2[d][0], maxsplit=1)
                print('aa', a)
                print('bb', b)
                dic2[d][0] = dic2[d][1].replace(a, '')

                dic2[d][0] = b

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Neelkanth_N4462':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:

            if d>1 and len(re.findall('\d\-\d{2}\-\d{4}\s\w+', dic2[d][0])):
                print('date Perti', dic2[d])
                a, b = re.split('\s', dic2[d][0], maxsplit=1)
                print('aa', a)
                print('bb', b)
                dic2[d][0] = a
                dic2[d][1] = b

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='remedy_N0099':
            dicA = dic1
            dic2 = dicA
            dic1 = {}
            lq = 1
            for d in dic2:
                if d > 1 and len(re.findall('^\d+\s?\D\s?\w+', dic2[d][0])) and dic2[d].count(' ')==5:
                    print('SNoHead', dic2[d])
                    a, b = re.split('^\d+\s?\D\s?', dic2[d][0], maxsplit=1)
                    #print('mm', a)
                    #print('nn', b)
                    dic2[d][0] = b



                dic1[lq] = dic2[d]
                lq += 1
    if hospital == 'Bharati_N14741':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d\s\D?\s\d+\.', dic2[d][2])):
                print('Qtyrate', dic2[d])
                a, b = re.split('\s\D?\s', dic2[d][2], maxsplit=1)
                print('aa', a)
                print('bb', b)
                dic2[d][2] = dic2[d][2].replace(b, '')
                dic2[d][2] = a
                dic2[d][3] = b

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        f = 0
        for d in dic2:
            for i in head_list:
                if i in dic2[d][0] and dic2[d].count(' ') <= 3:
                    print('PROFILEEE')
                    lineee = [i, ' ', ' ', ' ', ' ', ' ']
                    dic1[lq] = dic2[d]
                    lq += 1
                    dic1[lq - 1] = lineee
                    dic2[d][0] = dic2[d][0].replace(i, '')

            if len(re.findall('\d\.\d', dic2[d][2])):
                print('rate in 2nd', dic2[d])
                dic2[d][3] = dic2[d][2]
                dic2[d][2] = ' '

            if (dic2[d][3].__contains__('X') or dic2[d][3].__contains__('=') or dic2[d][3].__contains__('<') or dic2[d][
                3].__contains__('x')):
                print('rate with  X x')
                dic2[d][3] = dic2[d][3].replace('X ', '')
                dic2[d][3] = dic2[d][3].replace('x ', '')
                dic2[d][3] = dic2[d][3].replace('x', '')
                dic2[d][3] = dic2[d][3].replace('=', '')
                dic2[d][3] = dic2[d][3].replace('= ', '')
                dic2[d][3] = dic2[d][3].replace('< ', '')
                dic2[d][3] = dic2[d][3].replace('<', '')
            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Olive_N8339':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][0] in head_list and dic2[d+1][4].__contains__('Sub Total :'):
                print('remove sbt',dic2[d])
                dic2[d+1] = [' ',' ',' ',' ',' ',' ']
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'remedy_N0099':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            for i in head_list:
                if i in dic2[d][0] and dic2[d].count(' ') <= 2:
                    print('PROFILEEE')
                    lineee = [i, ' ', ' ', ' ', ' ', ' ']
                    dic1[lq] = dic2[d]
                    lq += 1
                    dic1[lq - 1] = lineee
                    dic2[d][0] = dic2[d][0].replace(i, '')
            if d > 1 and len(re.findall('^\d{1,2}\s?\D\s?\w+', dic2[d][0])):
                print('SNoHead', dic2[d])
                if d > 1 and len(re.findall('^\d{1,2}\s?\D\s?\w+', dic2[d][0])):
                    a, b = re.split('^\d{1,2}\s?\D\s?', dic2[d][0], maxsplit=1)
                    print('mm', a)
                    print('nn', b)
                    dic2[d][0] = b

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Cytecare_N15167':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][1]==' ' and len(re.findall('\d\-\d{1,}\-\d',dic2[d][0]))>=1:
                text = dic2[d][0]
                matchrate = re.search(r'\d{1,}\-\d{2}\-\d{1,}', text)
                dic2[d][1] = matchrate.group()
                dic2[d][0] = text.replace(matchrate.group(),'')
            if len(re.findall('^\d{1,}',dic2[d][0]))==1:
                dic2[d][0] = re.sub('^\d{1,}\s','',dic2[d][0])
            if len(re.findall('\d\.\d',dic2[d][5]))==2 and len(dic2[d][5].split())==2:
                a,b = dic2[d][5].split()
                dic2[d][5] = b
            if dic2[d][5].__contains__(sbt) and dic2[d][3].__contains__(sbt):
                dic2[d][3] = ' ' 
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'wockhardt_N4183':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][0].__contains__('Please see attached') and dic2[d].count(' ')==5:
                dic2[d][5]= '1.00'
            if len(re.findall('^\d{1,}\s?',dic2[d][0]))==1:
                dic2[d][0] = re.sub('^\d{1,}\s?','',dic2[d][0])
            if dic2[d][0] in head_list and dic2[d].count(' ')<5:
                dic2[d][0] = dic2[d][0].lower()
            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Sevenstar_N16095-pharma':
        dic2=dic1
        print('doooothis')
        dic1={}
        lq=1
        for d in dic2:
            if dic2[d][0]=='Items' or dic2[d][3]=='Total' or dic2[d][0]=='items' or dic2[d][2]=='Qty':
                dic2[d]=[' ', ' ', ' ', ' ', ' ', ' ']
            if len(re.findall('\d{2}\-?\d{2}\-?\d{4}\s?\d{2}\:\d{2}\s\w+',dic2[d][0]))==1 or len(re.findall('\d{2}\s?\d{2}\s?\d{4}\s?\d{2}\:\d{2}\s\w+',dic2[d][0]))==1\
                    or len(re.findall('\d{2}\s?\d{2}\-?\d{4}\s?\d{2}\:\d{2}\s\w+',dic2[d][0]))==1or len(re.findall('\d{2}\-\d{2}\s?\d{4}\s?\d{2}\:\d{2}\s\w+',dic2[d][0]))==1:
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if dic2[d][2]=='SALES':
                dic2[d][2]='PHARMACY'
            if dic2[d][2]=='SALES RETURN':
                dic2[d][2]='PHARMACY RETURN'
            if dic2[d][2] in head_list:
                dic2[d][0]=dic2[d][2]
                dic2[d][2]=' '
            dic1[lq]=dic2[d]
            lq +=1
    if hospital == 'kauvery-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('^\d{1,2}\s', dic2[d][0])):
                print('SNo Perti', dic2[d])
                a, b = re.split('^\d{1,2}\s', dic2[d][0], maxsplit=1)
                print('aa', a)
                print('bb', b)
                dic2[d][0] = dic2[d][0].replace(a, '')

                dic2[d][0] = b

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'kauvery':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][4].__contains__('Sub Total') and dic2[d][5]!=' ':
                dic2[d][5]=' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'star_1':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][1] =='CONSULTATIONbydorabad':
                dic2[d][1] = 'CONSULTATION'
            if dic2[d][1] in head_list and dic2[d].count(' ')<6:
                dic2[d][5] = ' '
                dic2[d][4] = ' '
            if len(re.findall('^\d{1,}\s\w{3}\s\d{1,}',dic2[d][0]))==1 and len(dic2[d][0].split())>3:
                print('hemmap',dic2[d])
                text = dic2[d][0]
                matchrate = re.search(r'^\d{1,}\s\w{1,}\s\d{1,}\s', text)
                dic2[d][0] = matchrate.group()
                dic2[d][1] = text.replace(matchrate.group(),'')
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Poona-2':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][4]==' ' and dic2[d].count(' ')<5:
                dic2[d][4] = '1'
            if dic2[d][4].__contains__('X') or dic2[d][4].__contains__('x'):
                dic2[d][4] = dic2[d][4].strip('(')
                dic2[d][4] = dic2[d][4].strip(')')
                dic2[d][4] = dic2[d][4].strip()
                if dic2[d][4].__contains__('X'):
                    a,b = dic2[d][4].split('X')
                    dic2[d][4] = a.strip()
                    dic2[d][3] = b.strip()
                if dic2[d][4].__contains__('x'):
                    a, b = dic2[d][4].split('x')
                    dic2[d][4] = a.strip()
                    dic2[d][3] = b.strip()
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Jeewan_N14521':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('^\d{1,}', dic2[d][0])) == 1 and dic2[d].count(' ') == 5 or dic2[d].count(' ') == 2:
                print('removing sno', dic2[d])
            dic2[d][0] = re.sub('^\d{1,2}\s', '', dic2[d][0])
            if d > 1 and len(re.findall('^\d+\s?\D\s?\w+', dic2[d][0])) and dic2[d].count(' ') == 5:
                print('SNoHead', dic2[d])
                a, b = re.split('^\d+\s?\D\s?', dic2[d][0], maxsplit=1)
                # print('mm', a)
                # print('nn', b)
                dic2[d][0] = b
            if len(re.findall('\d\D?\d?\-\w{3}\-\d{2}\s\w+', dic2[d][0])):
                print('date perti')
                text = dic2[d][0]
                matchdate = re.search(r'\d\D?\d?\-\w{3}\-\d{2}', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), ' ')
            if d > 1 and len(re.findall('\d{1,2}\-\w{3}\-\d{2}', dic2[d - 1][0])) and dic2[d][0] != ' ' and dic2[
                d].count(' ') >= 4:
                print('shift', dic2[d])
                dic2[d][1] = dic2[d][0]
                dic2[d][0] = ' '
            if dic2[d][0] not in head_list and (len(re.findall('[.]\s+[^0-9]*', dic2[d][2])) == 1 or len(
                    re.findall('[-]\s+[^0-9]*', dic2[d][5])) == 1):
                print('merge', dic2[d])
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if d >=1 and d<len(dic2) and len(re.findall('\d{1,2}\-\w{3}\-\d{2}', dic2[d][0])) and dic2[d + 1][0] != ' ' and dic2[
                d + 1].count(' ') >= 4 and dic2[d + 1][1] not in sbt:
                print('merge2', dic2[d], dic2[d + 1])
                dic2[d][1] = dic2[d][1] + ' ' + dic2[d + 1][0]
                dic2[d + 1][0] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'kles_N0964':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][0] not in head_list and len(re.findall('[\-\-\-\-]', dic2[d][0])) and len(
                    re.findall('\d\.\d', dic2[d][5])):
                print('merge', dic2[d])
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'lokpriya_N2720':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:

            if d > 1 and dic2[d][5]!=' ' and dic2[d].count(' ') == 5 and dic2[d - 1].count(' ') == 1:
                print('add sbt', dic2[d])
                dic2[d][5] = ' '


            dic1[lq] = dic2[d]
            lq += 1
    if hospital =='jss_N1060':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if  len(re.findall('\d\/\d{2}\/\d{4}\s\d?\-?\w+', dic2[d][0])):
                print('date Perti',dic2[d])
                a, b = re.split('\s', dic2[d][0], maxsplit=1)
                print('aa', a)
                print('bb', b)
                dic2[d][0] = dic2[d][1].replace(b, '')
                dic2[d][0] = a
                dic2[d][1] = b
            if dic2[d][0].__contains__('PHARMACY [ GST:29AAATJ1930E5ZT DL Nos.: KA-MY2/20-121247/21-121248,KA-MY-2 20 122088 & 21') and dic2[d+1].count(' ')==5 and dic2[d+2].count(' ')==5:
                print('Pharma',dic2[d])
                dic2[d+1][0] = ' '
                dic2[d+2][0]= ' '
                dic2[d][0] = ' '
                dic2[d][0] = 'PHARMACY'



            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Brahma_N7077':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:

            if  d>1  and len(re.findall('\d{1,2}\-\d{1,2}\-\d{2,4}\s\w', dic2[d][1]))  and dic2[d+1][0]==' ' and dic2[d+1].count(' ')==5:
                print('date merge',dic2[d])
                dic2[d][1] = dic2[d][1] + ' ' + dic2[d+1][1]
                dic2[d+1][1] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'kles_N0964':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:

            for i in head_list:
                if i in dic2[d][0] and dic2[d].count(' ') <= 4:
                    print('PROFILEEE')
                    lineee = [i, ' ', ' ', ' ', ' ', ' ']
                    dic1[lq] = dic2[d]
                    lq += 1
                    dic1[lq - 1] = lineee
                    dic2[d][0] = dic2[d][0].replace(i, '')
            if dic2[d][0] not in head_list and len(re.findall('[\-\-\-\-]', dic2[d][0])) and len(
                    re.findall('\d\.\d', dic2[d][5])):
                print('merge', dic2[d])
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Chetti_N14512':
            dicA = dic1
            dic2 = dicA
            dic1 = {}
            lq = 1
            for d in dic2:
                if d > 1 and len(re.findall('^\d+\s?\D?\s?\w+', dic2[d][0])):
                    print('SNoHead', dic2[d])
                    a, b = re.split('^\d+\s?\D?\s?', dic2[d][0], maxsplit=1)
                    #print('mm', a)
                    #print('nn', b)
                    dic2[d][0] = b
                if dic2[d][0]=='HARMACY':
                   dic2[d][0]='PHARMACY'
                dic1[lq] = dic2[d]
                lq += 1
    if hospital == 'RGStone_N2899':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:

            if len(re.findall('\.\d+\s\d+\.\d+', dic2[d][2])) and dic2[d][3]==' ':
                print('RateQty', dic2[d])
                a, b = re.split('\s', dic2[d][2], maxsplit=1)
                dic2[d][2] = a
                dic2[d][3] = b
            if len(re.findall('\d+\.\d+\s\D?\d+\.\d', dic2[d][3])) and dic2[d][4]==' ':
                print('Qtyamount', dic2[d])
                a, b = re.split('\s', dic2[d][3], maxsplit=1)
                dic2[d][3] = a
                dic2[d][4] = b
            if d>1 and dic2[d][0] in head_list and dic2[d-1].count(' ')==5:
                print('add sbt',dic2[d])
                dic2[d-1][2]='Total for General SURGERIES'
            dic1[lq] = dic2[d]
            lq += 1
    if hospital =='Guru_N1499-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d+\.\d+\s\w+', dic2[d][5])) == 1:
                print('if date in 5th index')
                text = dic2[d][5]
                matchdate = re.search(r'\d+\.\d+',text)
                dic2[d][5] = matchdate.group()




            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Guru_N1499':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d+\s\d+\s?',dic2[d][0])):
                print('splittttt',dic2[d])
                a, b = re.split('\s\d+\s?', dic2[d][0])
                dic2[d][0] = a
            if d > 1 and d < len(dic2) and dic2[d][0].__contains__("SubTotal For PATHOLOGY") and dic2[d+1].count(' ')==1:
                print('fdsfsdfse',dic2[d])
                dic2[d+1]= ['HGT',' ',' ',' ',' ',' ']
                lq+=1

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'mpct_N15237-pharma':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\s([A-Z])\w+',dic2[d][5]))==1 and len(dic2[d][5].split())>1:
                text = dic2[d][5]
                matchrate = re.search(r'\s([A-Z])\w+', text)
                dic2[d][5] = text.replace(matchrate.group(), '')
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'mpct_N15237':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d\/\d{2}\/\d',dic2[d][1]))==1 and len(dic2[d][1].split())>1:
                text = dic2[d][1]
                matchrate = re.search(r'\d{1,}\/\d{1,}\/\d{1,}', text)
                dic2[d][1] = matchrate.group()
                dic2[d][2] = text.replace(matchrate.group(), '')
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Institute_N10034' or hospital == 'n.mwadia_N1886':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][0] =='Services':
                dic2[d][0] = ' '
            if dic2[d][0] =='Hadiology Investigation Charges':
                dic2[d][0] = 'Radiology Investigation Charges'
            if dic2[d][0] =='Plagnostics Services':
                dic2[d][0] = 'Diagnostics Services'
            if dic2[d][0] =='Services Total' or dic2[d][0] == 'Items Total :' or dic2[d][0] == 'Items Total':
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if len(re.findall('\d\/\d{2}\/\d',dic2[d][0]))==1 or len(re.findall('\d\/\d\s\d\/\d',dic2[d][0]))==1 :
                print('dlalssl',dic2[d])
                text = dic2[d][0]
                matchrate = re.search(r'\d{1,}\/\d{1,}\/\d{1,}|\d\/\d\s\d\/\d', text)
                dic2[d][1] = matchrate.group()
                dic2[d][0] = text.replace(matchrate.group(), '')
            if len(dic2[d][2].split())==2:
                a,b = dic2[d][2].split()
                dic2[d][2] = a
            if dic2[d][0] == 'Total' and len(dic2[d][4].split())==2:
                a,b = dic2[d][4].split()
                dic2[d][4] = a
                dic2[d][5] = b
            if dic2[d][0] not in head_list and dic2[d][0] not in src_dc['merge_set'] and dic2[d].count(' ')==5:
                dic2[d][0] = ' '
            if dic2[d][0] == ' ' and dic2[d].count(' ')==4 and dic2[d+1][0] in head_list:
                dic2[d][0] = 'Total'
            if dic2[d][4]!=' ' and dic2[d].count(' ')==5:
                dic2[d][4] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Vedant_N14369':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])

            if len(re.findall('\d\s\d+\.\d', dic2[d][2])):
                print('qty rate', dic2[d])
                a, b = re.split('\s', dic2[d][2], maxsplit=1)
                print('aaa', a)
                print('bbb', b)
                dic2[d][3] = ' '
                dic2[d][2] = a
                dic2[d][3] = b
            if d > 1 and len(re.findall('\d+\.\d+\s\d+\.\d+', dic2[d][3])):
                a, b = re.split('\s', dic2[d][3], maxsplit=1)
                print('aaa', a)
                print('bbb', b)
                dic2[d][3] = a
            if d>1 and dic2[d][0] in head_list and dic2[d].count(' ')==3:
                dic2[d+1][3]= dic2[d][3]
                dic2[d+1][5]=dic2[d][5]
                dic2[d][3]=' '
                dic2[d][5]=' '

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Chellaram_N16894':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:

            if len(re.findall('\D?\d.\d+\s\d+\D?\d+\.\d+', dic2[d][3])) == 1 and dic2[d][4] == ' ':
                print('Rate qty merge', dic2[d])
                text = dic2[d][3]
                if len(re.findall('\D?\d.\d+\s\d+\D?\d+\.\d+', dic2[d][3])) == 1:
                    matchqty = re.search(r'\D?\d.\d+\s', text)
                    # if len(re.findall('\d+\s?\D?\d+\s\d{1,2}\D?\s?\d+', dic2[d][2])) == 1:
                    matchrate = re.search(r'\d+\D?\d+\.\d+', text)

                dic2[d][3] = matchqty.group()
                dic2[d][4] = matchrate.group()
            if len(re.findall('\D?\d.\d+\s\d+\D?\d+\.\d+', dic2[d][3])) == 1 and dic2[d][4] != ' ':
                print('Rate qty merge', dic2[d])
                text = dic2[d][3]
                if len(re.findall('\D?\d.\d+\s\d+\D?\d+\.\d+', dic2[d][3])) == 1:
                    matchqty = re.search(r'\D?\d.\d+\s', text)
                # if len(re.findall('\d+\s?\D?\d+\s\d{1,2}\D?\s?\d+', dic2[d][2])) == 1:
                dic2[d][3] = matchqty.group()

            dic1[lq] = dic2[d]
            lq += 1
        dic1_a = dic2
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            print('ddd==', dic2[d])
            if d > 1 and dic2[d][0] != ' ' and dic2[d][5] != ' ' and dic2[d].count(' ') == 4 and dic2[d + 1][0] == sbt:
                dic2[d][5] = ' '
                dic2[d - 1][0] = dic2[d - 1][0] + dic2[d][0]
                dic2[d][0] = ' '
            if len(re.findall('\d\.\d', dic2[d][5])) == 2 and len(dic2[d][5].split()) > 1:
                print('if amount and sbt merge')
                a, b = dic2[d][5].split(' ', 1)
                dic2[d][5] = b
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Vyhospital_N14429':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('^\d{1,}\.\s',dic2[d][1]))==1:
                dic2[d][1] = re.sub('^\d{1,}\.\s','',dic2[d][1])
            if len(re.findall('\d{1,}\-\d{1,}\-\d',dic2[d][1]))>1:
                dic2[d][1] = ' '
            if dic2[d][4]=='Sub Total':
                dic2[d][4]=' '
            if dic2[d][4].__contains__('Day(s)'):
                dic2[d][4] = dic2[d][4].replace('Day(s)','')
            if len(re.findall('\d{1,}\-\d{1,}\-\d',dic2[d][1]))==1 and dic2[d][3]!=' ':
                dic2[d][1]=dic2[d][3]
                dic2[d][3] = ' '
            if dic2[d][3].__contains__('Admission'):
                dic2[d][1] = dic2[d][3]
                dic2[d][3] = ' '
            if dic2[d][5] =='***':
                dic2[d][5] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'SRV_N16098':
        # dic2 = dic1
        # dic1 = {}
        # lq = 1
        # for d in dic2:
        #     nevv = copy.deepcopy(dic2[d])
        #     nv_thd = nevv[2].strip('. ')
        #     nv_fur = nevv[3].strip(' HV HV HW HV')
        #     nv_fiv = nevv[5].strip(' HV HV HW HV')
        #     nevv.pop(2)
        #     nevv.insert(2, nv_thd)
        #     nevv.pop(3)
        #     nevv.insert(3, nv_fur)
        #     nevv.pop(5)
        #     nevv.insert(5, nv_fiv)
        #     dic1[lq] = nevv
        #     lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddd==', dic2[d])
            if dic2[d][2] == 'sub Total':
                dic2[d][2] = 'Sub Total'
            if d > 1 and d < len(dic2) and len(re.findall('\w{3}', dic2[d][0])) == 1 and len(
                    re.findall('\d{2}\.\d{2}', dic2[d][5])) == 1 and len(re.findall('\d{2}', dic2[d - 1][0])) == 1 and \
                    len(re.findall('\d{3}\.\d{2}', dic2[d - 1][3])) == 1 and len(
                re.findall('\d{1}', dic2[d - 1][2])) == 1 and dic2[d].count(' ') == 2 and dic2[d - 1].count(' ') == 2:
                print('for 220100771513 ECG')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if d > 1 and d < len(dic2) and len(re.findall('\w{1}', dic2[d][2])) == 1 and (
                    len(re.findall('\d{2}\.\d{2}', dic2[d][5])) == 1 or len(
                re.findall('\d{3}\.\d{2}', dic2[d][5])) == 1) and (
                    len(re.findall('\d\s\w{3}', dic2[d - 1][0])) == 1 or len(
                re.findall('\w{6}', dic2[d - 1][0])) == 1) and \
                    len(re.findall('\d{3}\.\d{2}', dic2[d - 1][3])) == 1 and len(re.findall('\w', dic2[d][0])) == 0 and \
                    dic2[d].count(' ') == 3 and dic2[d - 1].count(' ') == 2:
                print('for 220202481302 3 HGT')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if d > 1 and d < len(dic2) and len(
                    re.findall('\w{3}\s\w{7}\s\w\s\w{3}\s\w{2}\.\s\w{3}\d\s\w{7}', dic2[d][0])) == 1 and len(
                re.findall('\d{4}\.\d{2}', dic2[d][3])) == 1 and len(
                re.findall('\d{4}\.\d{2}', dic2[d][5])) == 1 and \
                    dic2[d].count(' ') == 2 and 'BED CHARGES' in dic2[d][0]:
                print('for 220202488465 bed charges missing')
                dic2[d][0] = dic2[d][0].replace('BED CHARGES', '')
                listnw = ['BED CHARGES', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if dic2[d][0] != ' ' and (len(re.findall('\d{2}', dic2[d][0].split()[0])) == 1 or len(
                    re.findall('\d', dic2[d][0].split()[0])) == 1) and dic2[d].count(' ') >= 2:
                print('for removing snos in 0th index')
                text = dic2[d][0]
                if len(re.findall('\d{2}', dic2[d][0].split()[0])) == 1:
                    matchsno = re.search(r'\d{2}', text)
                elif len(re.findall('\d', dic2[d][0].split()[0])) == 1:
                    matchsno = re.search(r'\d', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
                dic2[d][0] = dic2[d][0].replace(dic2[d][0][0], '', 1)

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Mallige_N0897':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][0] == "|OT Charges":
                dic2[d][0] = "OT Charges"
            if d > 1 and len(re.findall('^\d+\s?\w+', dic2[d][0])) and dic2[d].count(' ') == 5:
                print('SNoHead', dic2[d])
                a, b = re.split('^\d+\s?', dic2[d][0], maxsplit=1)
                # print('mm', a)
                # print('nn', b)
                dic2[d][0] = b
            if len(re.findall('\d{2}\-?\w{3}\-\d{4}', dic2[d][0])):
                print('date perti')
                text = dic2[d][0]
                matchdate = re.search(r'\d{2}\-?\w{3}\-\d{4}', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')

            elif len(re.findall('\D+\d{4}', dic2[d][0])):
                print('date perti')
                text = dic2[d][0]
                matchdate = re.search(r'\D+\d{4}', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')

            if dic2[d][5] == "100500.00":
                dic2[d][5] = ' '

            if d > 1 and d < len(dic2) and len(re.findall('\d{2}\-?\w{3}\-\d{4}', dic2[d][0])) and dic2[d + 1][
                0] != ' ' and dic2[d + 1].count(' ') == 5:
                print('add===', dic2[d], dic2[d + 1])
                # dic2[d +1][0] = dic2[d + 1][1]
                # print('rrr===',dic2[d],dic2[d + 1])
                dic2[d][1] = dic2[d][1] + ' ' + dic2[d + 1][0]
                print('zzz===', dic2[d], dic2[d + 1])
                dic2[d + 1][0] = ' '
                dic2[d + 1][1] = ' '

            dic1[lq] = dic2[d]
            lq += 1

            # if hospital =='St_isabel_N2354':
    if hospital == 'National_N0420':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd11==', dic2[d])
            if len(re.findall('\d{2}\/\d{2}\/\d{4}\s?\D+\d+\D+\d+', dic2[d][1])) == 1 or len(
                    re.findall('\d{2}\/\d{2}\/\d{4}\s?\d+\D+', dic2[d][1])) == 1 or len(
                    re.findall('\d{2}\/\d{2}\/\d{4}\s?\d+', dic2[d][1])) == 1 or len(
                    re.findall('\d{2}\/\d{2}\/\d{4}\s?\D+', dic2[d][1])) == 1 and (
                    dic2[d][2] == ' ' or dic2[d][2] != ' ') and len(dic2[d][1].split()) > 1:
                print('if date and particulars merge')
                text = dic2[d][1]
                matchdate = re.search(r'\d{2}\/\d{2}\/\d{4}', text)
                dic2[d][1] = matchdate.group()
                dic2[d][2] = text.replace(matchdate.group(), '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital =='st_philomenas_N0938-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if  len(re.findall('^\d{1,2}\s', dic2[d][0])) and dic2[d].count(' ')>=1:
                print('SNo Perti',dic2[d])
                a, b = re.split('^\d{1,2}\s', dic2[d][0], maxsplit=1)
                print('aa', a)
                print('bb', b)
                dic2[d][0] = dic2[d][1].replace(a, '')
                dic2[d][0] = b
            if len(re.findall('\D+\s\w',dic2[d][0])) and dic2[d].count(' ')<=3:
                print('merge', dic2[d])
                a, b = re.split('\s', dic2[d][0], maxsplit=1)
                print('aa', a)
                print('bb', b)
                dic2[d][1] = b
                dic2[d][0] = a
            if d>1 and dic2[d][0].__contains__('GST') and dic2[d].count(' ')==4:
                dic2[d][1] = dic2[d][0]
                dic2[d][0] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital =='st_philomenas_N0938':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            for i in head_list :
                if i in dic2[d][0]and dic2[d].count(' ')>=3:
                    print('PROFILEEE')
                    lineee = [i, ' ', ' ', ' ', ' ', ' ']
                    dic1[lq] = dic2[d]
                    lq+=1
                    dic1[lq-1] =lineee
                    dic2[d][0] = dic2[d][0].replace(i,' ')
            if  len(re.findall('\D\s?\d\D\d+\D',dic2[d][0])) and dic2[d].count(' ')>=3:
                dic2[d][2] = dic2[d][0]
                dic2[d][0] = ' '
            if  dic2[d][1] == ' ' and dic2[d][2] == ' ' and len(re.findall('\d\D?\d\/\d{2}\/\d{2}\s\d{2}\s?\:\s?\d{2}', dic2[d][0])) and len(re.findall('\w{6}', dic2[d][0])):
                print('for 110100501554 date code parti merged', dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\w{6}', text)
                matchdate = re.search(r'\d\D?\d\/\d{2}\/\d{2}\s\d{2}\s?\:\s?\d{2}', text)
                dic2[d][2] = dic2[d][0]
                dic2[d].pop(0)
                dic2[d].insert(0, matchdate.group())
                dic2[d].pop(1)
                dic2[d].insert(1, matchcode.group())
                dic2[d][2] = dic2[d][2].replace(matchdate.group(), "")
                dic2[d][2] = dic2[d][2].replace(matchcode.group(), "")



            dic1[lq] = dic2[d]
            lq +=1
    if hospital == 'Ils_N2847':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # if dic2[d][5]!=' ' and dic2[d].count(' ')==5:
            #     dic2[d][4] = 'Subtotal'
            if len(re.findall('\d\.\d',dic2[d][2]))==2 and len(dic2[d][2].split())==2:
                a,b = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = b
            if len(re.findall('\d\.\d',dic2[d][3]))==2 and len(dic2[d][3].split())==2:
                a,b = dic2[d][3].split()
                dic2[d][3] = a
            if len(re.findall('\.',dic2[d][0]))>2:
                dic2[d][0] = ' '
            if dic2[d][0] not in head_list  and dic2[d][0]!=' ' and dic2[d].count(' ')==5:
                print(' ksksks',dic2[d])
                # dic2[d+1][0] = dic2[d][0]+' '+dic2[d+1][0]
                dic2[d][0] = ' '
            if len(re.findall('\d\/\d{2}\/\d', dic2[d][1])) == 0:
                dic2[d][1] = ' '
            if len(re.findall('\d\/\d{2}\/\d', dic2[d][1])) == 1:
                text = dic2[d][1]
                matchrate = re.search(r'\d{1,}\/\d{2}\/\d{1,}', text)
                dic2[d][1] = matchrate.group()
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Bhagwanmahavir_N13068':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d+\,\d+\.\d+', dic2[d][4])) == 1 and dic2[d][5] == ' ':
                print('if rate qty together wuth no space in 2nd index')
                text = dic2[d][4]
                if len(re.findall('\d+\,\d+\.\d+', dic2[d][4])) == 1:
                    matchrate = re.search(r'\d+\,\d+\.\d+', text)
                elif len(re.findall('\d+\.\d+\.\d+', dic2[d][4])) == 1:
                    matchrate = re.search(r'\d+\.\d+\.\d+', text)

                dic2[d][5] = matchrate.group()
                dic2[d][4] = text.replace(matchrate.group(), '')
            if len(re.findall('\d+\.\d+\.\d+', dic2[d][4])) == 1 and dic2[d][5] == ' ':
                print('if rate qty together with no space in 2nd index')
                text = dic2[d][4]
                if len(re.findall('\d+\.\d+\.\d+', dic2[d][4])) == 1:
                    matchrate = re.search(r'\d+\.\d+\.\d+', text)
                elif len(re.findall('\d+\.\d+\.\d+', dic2[d][4])) == 1:
                    matchrate = re.search(r'\d+\.\d+\.\d+', text)
                dic2[d][5] = matchrate.group()
                dic2[d][4] = text.replace(matchrate.group(), '')
            if len(re.findall('\d+\,\d+', dic2[d][4])) == 1 and dic2[d][5] == ' ':
                print('if rate qty together wuth no space in 2nd index')
                text = dic2[d][4]
                if len(re.findall('\d+\,\d+', dic2[d][4])) == 1:
                    matchrate = re.search(r'\d+\,\d+', text)
                elif len(re.findall('\d+\,\d+', dic2[d][4])) == 1:
                    matchrate = re.search(r'\d+\,\d+', text)
                dic2[d][5] = matchrate.group()
                dic2[d][4] = text.replace(matchrate.group(), '')
            if len(re.findall('\d+\.\d+', dic2[d][4])) == 1 and dic2[d][5] == ' ':
                print('if rate qty together with no space in 2nd index')
                text = dic2[d][4]
                if len(re.findall('\d+\.\d+', dic2[d][4])) == 1:
                    matchrate = re.search(r'\d+\.\d+', text)
                elif len(re.findall('\d+\.\d+', dic2[d][4])) == 1:
                    matchrate = re.search(r'\d+\.\d+', text)
                dic2[d][5] = matchrate.group()
                dic2[d][4] = text.replace(matchrate.group(), '')
            if len(re.findall('\s+', dic2[d][4])) == 1 or len(re.findall('\s', dic2[d][1])) == 2 or len(re.findall('\s+', dic2[d][1])) == 3:
                print('to remove sr no and space')
                text = dic2[d][4]
                if len(re.findall('\s+', dic2[d][4])) == 3:
                    matchsrno = re.search(r'\s', text)
                elif len(re.findall('\s', dic2[d][4])) == 1:
                    matchsrno = re.search(r'\s', text)
                elif len(re.findall('\s', dic2[d][4])) == 2:
                    matchsrno = re.search(r'\s', text)
                dic2[d][4] = dic2[d][4].replace(matchsrno.group(), '')
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Bhagwanmahavir_N13068-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if len(re.findall('\d+\,\d+\.\d+', dic2[d][4])) == 1 and dic2[d][5] == ' ':
                print('if rate qty together wuth no space in 2nd index')
                text = dic2[d][4]
                if len(re.findall('\d+\,\d+\.\d+', dic2[d][4])) == 1:
                    matchrate = re.search(r'\d+\,\d+\.\d+', text)
                elif len(re.findall('\d+\.\d+\.\d+', dic2[d][4])) == 1:
                    matchrate = re.search(r'\d+\.\d+\.\d+', text)

                dic2[d][5] = matchrate.group()
                dic2[d][4] = text.replace(matchrate.group(), ' ')
            if len(re.findall('\d+\.\d+\.\d+', dic2[d][4])) == 1 and dic2[d][5] == ' ':
                print('if rate qty together wuth no space in 2nd index')
                text = dic2[d][4]
                if len(re.findall('\d+\.\d+\.\d+', dic2[d][4])) == 1:
                    matchrate = re.search(r'\d+\.\d+\.\d+', text)
                elif len(re.findall('\d+\.\d+\.\d+', dic2[d][4])) == 1:
                    matchrate = re.search(r'\d+\.\d+\.\d+', text)
                dic2[d][5] = matchrate.group()
                dic2[d][4] = text.replace(matchrate.group(), '')
            if len(re.findall('\-\d+\.\d+', dic2[d][4])) == 1 and dic2[d][5] == ' ':
                print('if rate qty together wuth no space in 2nd index')
                text = dic2[d][4]
                if len(re.findall('\-\d+\.\d+', dic2[d][4])) == 1:
                    matchrate = re.search(r'\-\d+\.\d+', text)
                elif len(re.findall('\-\d+\.\d+', dic2[d][4])) == 1:
                    matchrate = re.search(r'\-\d+\.\d+', text)
                dic2[d][5] = matchrate.group()
                dic2[d][4] = text.replace(matchrate.group(), '')
            if len(re.findall('\d+\.\d+', dic2[d][4])) == 1 and dic2[d][5] == ' ':
                print('if rate qty together wuth no space in 2nd index')
                text = dic2[d][4]
                if len(re.findall('\d+\.\d+', dic2[d][4])) == 1:
                    matchrate = re.search(r'\d+\.\d+', text)
                elif len(re.findall('\d+\.\d+', dic2[d][4])) == 1:
                    matchrate = re.search(r'\d+\.\d+', text)
                dic2[d][5] = matchrate.group()
                dic2[d][4] = text.replace(matchrate.group(), ' ')
            if len(re.findall('\d+\-\w+\-\d+', dic2[d][0])) == 1 and dic2[d][1] == ' ':
                print('if rate qty together wuth no space in 2nd index')
                text = dic2[d][0]
                if len(re.findall('\d+\-\w+\-\d+', dic2[d][0])) == 1:
                    matchrate = re.search(r'\d+\-\w+\-\d+', text)
                elif len(re.findall('\d+\-\w+\-\d+', dic2[d][0])) == 1:
                    matchrate = re.search(r'\d+\-\w+\-\d+', text)

                dic2[d][1] = matchrate.group()
                dic2[d][0] = text.replace(matchrate.group(), '')
            if len(re.findall('\d{2}\-\w{3}\-\d{2}\s', dic2[d][1])):
                print('date Perti', dic2[d])
                a, b = re.split('\s', dic2[d][1], maxsplit=1)
                print('aa', a)
                print('bb', b)
                dic2[d][1] = dic2[d][2].replace(b, '')
                dic2[d][1] = a
                dic2[d][2] = b
            if len(re.findall('\d+\-\w{3}\-\d{2}\s', dic2[d][1])):
                print('date Perti', dic2[d])
                a, b = re.split('\s', dic2[d][1], maxsplit=1)
                print('aa', a)
                print('bb', b)
                dic2[d][1] = dic2[d][2].replace(b, '')
                dic2[d][1] = a
                dic2[d][2] = b
            if len(re.findall('\w{3}\-\d{2}', dic2[d][2])) == 1 and dic2[d][3] == ' ':
                print('if date batch together with no space in 2nd index')
                text = dic2[d][2]
                if len(re.findall('\w{3}\-\d{2}', dic2[d][1])) == 1:
                    matchrate = re.search(r'\w{3}\-\d{2}', text)
                elif len(re.findall('\w{3}\-\d{2}', dic2[d][1])) == 1:
                    matchrate = re.search(r'\w{3}\-\d{2}', text)

                dic2[d][3] = matchrate.group()
                dic2[d][2] = text.replace(matchrate.group(), '')
            if len(re.findall('\d+\,\d+\.\d+', dic2[d][4])) == 1 and len(dic2[d][4].split()) == 1 and dic2[d][5] == '':
                print('if rate qty together wuth no space in 2nd index')
                dic2[d][5] = dic2[d][4]
                dic2[d][4] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Sterling_N0562_pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd11==', dic2[d])
            if len(re.findall('\d{2}\/\d{2}\/\d{4}\s?\D+\d+', dic2[d][0])) and dic2[d].count(' ') == 0:
                print('to remove extra value', dic2[d])
                text = dic2[d][0]
                matchsno = re.search(r'\s?\D+\d+', text)
                dic2[d][0] = text.replace(matchsno.group(), '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'krims_N1828':
        dic2 = dic1
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            # if f>2 and f<fn and len(dic2[d][3])>3 and dic2[d].count(' ')==5 and ss.join(dic2[d]).__contains__('SAC')==False and len(re.findall('\d\s?\.\s?\d',dic2[d+1][5]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][5]))==0 and len(dic2[d-1][1])>20 and dic2[d].count(' ')==5:
            #     print('vvvvvvv',dic2[d])
            #     dic1[lq-1] = opr1(dic2[d-1],dic2[d],src_dc)

            if len(re.findall('\d+\D\d+\D\d+\D\d+', dic2[d][3])) == 1 and dic2[d][5] == ' ':
                print('for spliting 5th index in rate and amount are together')
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][5] = b

            if len(re.findall('\d\D+', dic2[d][4])) and dic2[d].count(' ') == 1:
                print('to remove extra value', dic2[d])
                text = dic2[d][4]
                matchsno = re.search(r'\D+', text)
                dic2[d][4] = text.replace(matchsno.group(), '')

            if d > 1 and d < len(dic2) and len(re.findall('\d{2}\-\d{2}\-\d{4}', dic2[d][0])) and dic2[d + 1][
                0] == ' ' and dic2[d][0] != ' ' and dic2[d + 1].count(' ') >= 2 and dic2[d].count(' ') >= 2:
                print('add===', dic2[d], dic2[d + 1])
                # dic2[d +1][0] = dic2[d + 1][1]
                # print('rrr===',dic2[d],dic2[d + 1])
                dic2[d][1] = dic2[d][1] + ' ' + dic2[d + 1][1]
                print('zzz===', dic2[d], dic2[d + 1])
                dic2[d + 1][0] = ' '
                dic2[d + 1][1] = ' '

                dic2[d][3] = dic2[d][3] + ' ' + dic2[d + 1][3]
                print('zzz===', dic2[d], dic2[d + 1])
                dic2[d + 1][3] = ' '

                dic2[d][5] = dic2[d][5] + ' ' + dic2[d + 1][5]
                print('zzz===', dic2[d], dic2[d + 1])
                dic2[d + 1][5] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Somaiya_N15103' :
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d{1,2}\/\d{1,2}\/\d{1,4}\s', dic2[d][0])) == 1  and dic2[d][0].count(' ')>=1:
                # print('dateeee',dic2[d])
                text = dic2[d][0]
                matchdate = re.search(r'^\d+\/\d+\/\d+', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(),'')
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Somaiya1_N15103':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d{1,2}\/\d{1,2}\/\d{1,4}\s', dic2[d][0])) == 1  and dic2[d][0].count(' ')>=2:
                # print('dateeee',dic2[d])
                text = dic2[d][0]
                matchdate = re.search(r'^\d+\/\d+\/\d+', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(),'')
            if d > 1 and d < len(dic2) and len(re.findall('\d{1,2}\/\d{1,2}\/\d{1,4}', dic2[d - 1][0])) and dic2[d - 1].count(' ') == 3:
                print('Merge', dic2[d - 1], dic2[d])
                tty1 = opr1(dic2[d], dic2[d - 1], src_dc)
                dic1[lq - 1] = tty1
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if d > 1 and d < len(dic2) and len(re.findall('\d{2}', dic2[d - 1][0])) and dic2[d - 1].count(' ') == 3:
                print('Merge', dic2[d - 1], dic2[d])
                tty1 = opr1(dic2[d], dic2[d - 1], src_dc)
                dic1[lq - 1] = tty1
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Somaiya_N15103-pharma' or hospital == 'Somaiya1_N15103-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d\/\d{2}\/\d',dic2[d][0]))==1 and dic2[d].count(' ')==5:
                dic2[d][0] = ' '
            if len(re.findall('\d\.\d',dic2[d][2]))==2 and len(dic2[d][2].split())>=2:
                a,b = dic2[d][2].split(' ',1)
                dic2[d][2] = a
                dic2[d][3] = b
            if len(re.findall('\d\.\d',dic2[d][3]))==2 and len(dic2[d][3].split())>=2:
                a,b = dic2[d][3].split(' ',1)
                dic2[d][3] = a
            if len(dic2[d][2].split()) >= 2:
                a, b = dic2[d][2].split(' ', 1)
                dic2[d][2] = a
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Cloudnine_N12572':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if len(dic2[d][3].split()) == 2 and len(re.findall('\d+\.\d+\s?\d+\.\d+', dic2[d][3])) == 1 and dic2[d][
                4] == ' ':
                print('if rate and qty together')
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b

            if len(re.findall('\d+\.\d+\s?\d\.\d+', dic2[d][4])) == 1 or len(
                    re.findall('\d+\.\d+\s?\d+\.\d+', dic2[d][4])) == 1 or len(
                    re.findall('\d+\.\d+\s?\d', dic2[d][4])) == 1 and (
                    dic2[d][3] == ' ' or dic2[d][3] != ' ') and len(dic2[d][4].split()) > 1:
                print('if rate and qty merge')
                text = dic2[d][4]
                matchdate = re.search(r'\d+\.\d+', text)
                dic2[d][3] = matchdate.group()
                dic2[d][4] = text.replace(matchdate.group(), '')

                # if len(re.findall('\d+\.\d+\s?\d\.\d+', dic2[d][3])) == 1 and (
            #         dic2[d][4] == ' ' or dic2[d][4] != ' ') and len(dic2[d][3].split()) > 1:
            #     print('if rate and qty merge')
            #     text = dic2[d][3]
            #     matchdate = re.search(r'\d+\.\d+', text)
            #     dic2[d][3] = matchdate.group()
            #     dic2[d][4] = text.replace(matchdate.group(), '')

            # if len(re.findall('\D+\d+\D+\d\D+\d+', dic2[d][0])) == 1 and (
            #         dic2[d][1] == ' ' or dic2[d][1] != ' ') and len(dic2[d][0].split()) > 1:
            #     print('if rate and qty merge')
            #     text = dic2[d][0]
            #     matchdate = re.search(r'\D+\d+\D+\d\D+', text)
            #     dic2[d][0] = matchdate.group()
            #     dic2[d][1] = text.replace(matchdate.group(), '')

            # if len(re.findall('\D+\d\D+\d+\D+\d+', dic2[d][0])) == 1 and (
            #         dic2[d][1] == ' ' or dic2[d][1] != ' ') and len(dic2[d][0].split()) > 1:
            #     print('if rate and qty merge')
            #     text = dic2[d][0]
            #     matchdate = re.search(r'\D+\d\D+\d+\D+', text)
            #     dic2[d][0] = matchdate.group()
            #     dic2[d][1] = text.replace(matchdate.group(), '')

            if d > 1 and d < len(dic2) and dic2[d][0] != ' ' and dic2[d + 1][1] == ' ' and dic2[d].count(' ') >= 0 and \
                    dic2[d + 1].count(' ') >= 4:
                print('add===', dic2[d], dic2[d + 1])
                dic2[d + 1][5] = ' '
                dic2[d + 1][1] = ' '

            if d > 1 and d < len(dic2) and dic2[d][0] == ' ' and dic2[d + 1][1] == ' ' and dic2[d].count(' ') == 6 and \
                    dic2[d + 1].count(' ') >= 4:
                print('add===', dic2[d], dic2[d + 1])
                dic2[d + 1][5] = ' '
                dic2[d + 1][1] = ' '

            if d > 1 and d < len(dic2) and dic2[d][0].__contains__('Administrative Charges') and dic2[d + 1][
                1] == ' ' and dic2[d].count(' ') == 5 and dic2[d + 1].count(' ') >= 2:
                print('add===', dic2[d], dic2[d + 1])
                dic2[d][2] = dic2[d][2] + ' ' + dic2[d + 1][2]
                dic2[d + 1][2] = ' '

            if len(re.findall('\d+\s?\d{2}\-\d{2}\-\d{4}|\d+\s?\d{2}\-\d{2}\s?\d{4}', dic2[d][2])) and dic2[d].count(
                    ' ') >= 1:
                print('to remove extra value', dic2[d])
                text = dic2[d][2]
                matchsno = re.search(r'\d+', text)
                dic2[d][2] = text.replace(matchsno.group(), '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'asian_N0043':

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('Data', dic2[d])
            if d > 1 and dic2[d][1] == ' ' and len(re.findall('\d\-\d{2}\-\d{4}\s\w{13}', dic2[d][0])):
                print('date des', dic2[d])
                a, b = re.split('\s', dic2[d][0], maxsplit=1)
                print('mm', a)
                print('nn', b)
                dic2[d][0] = a
                dic2[d][1] = b
            if d > 1 and dic2[d][2] == ' ' and len(re.findall('\w{13}\s\w+', dic2[d][1])):
                print('date des', dic2[d])
                a, b = re.split('\s', dic2[d][1], maxsplit=1)
                print('mm', a)
                print('nn', b)
                dic2[d][1] = a
                dic2[d][2] = b
            if d > 1 and dic2[d][5] == ' ' and len(re.findall('\d\.\d+\s\d\D?\d+\.\d', dic2[d][4])):
                print('date des', dic2[d])
                a, b = re.split('\s', dic2[d][4], maxsplit=1)
                print('mm', a)
                print('nn', b)
                dic2[d][4] = a
                dic2[d][5] = b
            if d > 1 and dic2[d][1] == ' ' and len(re.findall('\w{13}\s\w+', dic2[d][2])):
                print('desservice', dic2[d])
                a, b = re.split('\s', dic2[d][2], maxsplit=1)
                print('mm', a)
                print('nn', b)
                dic2[d][1] = a
                dic2[d][2] = b

            if d > 1 and dic2[d][4] == ' ' and len(re.findall('\d\.\d+\s\d?\D?\d+\.\d', dic2[d][5])):
                print('4index blank', dic2[d])
                a, b = re.split('\s', dic2[d][5], maxsplit=1)
                print('mm', a)
                print('nn', b)
                dic2[d][5].replace(a, '')
                dic2[d][4] = a
                dic2[d][5] = b
            if d > 1 and dic2[d][4] != ' ' and len(re.findall('\d\.\d+\s\d+\D\s?\d+|\d\.\d+\s\D?\d+', dic2[d][5])):
                print('4index not blank', dic2[d])
                a, b = re.split('\s', dic2[d][5], maxsplit=1)
                print('mm', a)
                print('nn', b)
                dic2[d][5] = b
            if d > 1 and len(re.findall('\w+\s\w+\s\w+', dic2[d][1])) and dic2[d][2] != ' ':
                dic2[d][2] = dic2[d][1] + ' ' + dic2[d][2]
                dic2[d][1] = ' '
            dic1[lq] = dic2[d]

            lq += 1
    if hospital == 'Kalra_N0402':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:

            if len(re.findall(
                    '\d+\/\d+\/\d+\s\-\s\d+\-\d+\/\d+\D+|\d+\/\d+\/\d+\s\-\s\d+\:\d+\/\d+\D+|\d+\/\d+\/\d+\D+\d+\s\d+\/\d+\D+',
                    dic2[d][0])) == 1 and (
                    dic2[d][1] == ' ' or dic2[d][1] != ' ') and len(dic2[d][0].split()) > 1:
                print('if date and particulars merge')
                text = dic2[d][0]
                matchdate = re.search(
                    r'\d+\/\d+\/\d+\s\-\s\d+\-\d+\/\d+|\d+\/\d+\/\d+\s\-\s\d+\:\d+\/\d+|\d+\/\d+\/\d+\D+\d+\s\d+\/\d+',
                    text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')

            if d > 1 and d < len(dic2) and dic2[d + 1][0].__contains__('INVESTIGATIONS') and dic2[d + 1][0] != ' ' and \
                    dic2[d][0] != ' ' and dic2[d + 1].count(' ') == 5 and dic2[d].count(' ') == 5:
                #         print('add===',dic2[d],dic2[d + 1])
                # dic2[d +1][0] = dic2[d + 1][1]
                #        # print('rrr===',dic2[d],dic2[d + 1])gastrlogy
                dic2[d + 1][0] = dic2[d + 1][0] + ' ' + dic2[d][0]
                #         print('zzz===',dic2[d],dic2[d +1])
                dic2[d][0] = ' '
            #        dic2[d + 1][1] = ' '

            # if d > 1 and d < len(dic2) and  dic2[d][0] != ' '  and dic2[d +1 ][0] == ' ' and  dic2[d + 1].count(' ') == 6 and  dic2[d].count(' ') == 5:
            #         print('add===',dic2[d],dic2[d + 1])
            #        # dic2[d +1][0] = dic2[d + 1][1]
            #        # print('rrr===',dic2[d],dic2[d + 1])
            #         dic2[d + 1][0] = dic2[d + 1][0] + ' ' + dic2[d][0]
            #         print('zzz===',dic2[d],dic2[d +1])
            #         dic2[d][0] = ' '
            # dic2[d + 1][1] = ' '
            #
            if dic2[d][3].__contains__('Total') and dic2[d].count(' ') >= 2:
                dic2[d][3] = ' '
                dic2[d][5] = ' '

            if dic2[d][0].__contains__('INTERVENTIONAL CARDIOLOGY') and dic2[d][3] != ' ' and dic2[d][5] != ' ' and \
                    dic2[d].count(' ') == 3:
                dic2[d][3] = ' '
                dic2[d][5] = ' '

            if dic2[d][0].__contains__('CARDIOLOGY INVESTIGATIONS') and dic2[d][3] != ' ' and dic2[d][5] != ' ' and \
                    dic2[d].count(' ') == 3:
                dic2[d][3] = ' '
                dic2[d][5] = ' '

            if d > 1 and d < len(dic2) and dic2[d][5] != ' ' and dic2[d + 1][0] in head_list and dic2[d].count(
                    ' ') == 5:
                dic2[d][5] = ' '
            #       dic2[d][5] = ' '

            if dic2[d][0] == "INTERVENTIONAL CARDIOLOGY,":
                dic2[d][0] = "INTERVENTIONAL CARDIOLOGY"

            if dic2[d][0] == "INVESTIGATIONS GASTROENTEROLOGY":
                dic2[d][0] = "GASTROENTEROLOGY INVESTIGATIONS"

            if dic2[d][4] == '106,100.00':
                dic2[d][4] = ' '

            if dic2[d][4] == '59,009.00':
                dic2[d][4] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Noble_N1377':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd11==', dic2[d])
            if len(re.findall('\d+\D\d+\.\d+\s?\d+\.\d+|\s+\d+\.\d+', dic2[d][4])) == 1 and (
                    dic2[d][5] == ' ' or dic2[d][5] != ' ') and len(dic2[d][4].split()) > 1:
                print('if date and particulars merge')
                text = dic2[d][4]
                matchdate = re.search(r'\d+\D\d+\.\d+|\d+\D\d+\s\d+', text)
                dic2[d][4] = matchdate.group()
                dic2[d][5] = text.replace(matchdate.group(), '')

            if len(re.findall('\d+\D+', dic2[d][0])) == 1 and len(dic2[d][0].split()[0]) >= 1:
                print('to remove sno')
                text = dic2[d][0]
                matchsno = re.search(r'\d+', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')

            if dic2[d][0].__contains__('EUA (PROCEDURE CHARGES)') and dic2[d][5] == ' ' and dic2[d].count(' ') == 5:
                dic2[d][5] = '10000'

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'navrang_N3390':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d+\/?\s?\:?\d+\s?\/?\:?\d+', dic2[d][0])) == 1  and dic2[d][0].count(' ')>=1 and dic2[d][1]==' ':
                print('dateeee',dic2[d])
                text = dic2[d][0]
                matchdate = re.search(r'\d{1,2}\/?\s?\:?\d{1,2}\s?\/?\:?\d+', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(),'')
                dic2[d][1] = dic2[d][1].strip()
            if len(re.findall('\d+\/?\s?\:?\d\s?\d\s?\/?\:?\d+', dic2[d][0])) == 1  and dic2[d][0].count(' ')>=1 and dic2[d][1]==' ':
                print('dateeee',dic2[d])
                text = dic2[d][0]
                matchdate = re.search(r'\d+\/?\s?\:?\d\s?\d\s?\/?\:?\d+', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(),'')
                dic2[d][1] = dic2[d][1].strip()
            if dic2[d][1] in head_list and dic2[d].count(' ')==5:
                dic2[d][0] = dic2[d][1]
                dic2[d][1] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'prasad_N1358':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if d > 1 and d < len(dic2) and len(re.findall('\d+\/\d+\/\d+', dic2[d][0])) and dic2[d + 1][4] != ' ' and \
                    dic2[d + 1][5] != ' ' and dic2[d + 1].count(' ') >= 3:
                print('add===', dic2[d], dic2[d + 1])
                dic2[d + 1][4] = ' '
                dic2[d + 1][5] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'prasad_N13582_daycare':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][0] != ' ' and dic2[d][1] == ' ' and dic2[d][4] != ' ' and dic2[d][5] != ' ' and dic2[d].count(
                    ' ') >= 2:
                print('add===', dic2[d])
                # dic2[d +1][0] = dic2[d + 1][1]
                # print('rrr===',dic2[d],dic2[d + 1])
                # dic2[d ][1] = dic2[d][1] + ' ' + dic2[d + 1][0]
                # print('zzz===',dic2[d],dic2[d +1])
                dic2[d][1] = dic2[d][0]
                dic2[d][0] = ' '

            if d > 1 and d < len(dic2) and len(re.findall('\d+\D+\d+\D+\d+', dic2[d][0])) and dic2[d].count(' ') == 5:
                dic2[d][0] = ' '

                # if d > 1 and d < len(dic2) and dic2[d][0] in head_list and dic2[d + 1][0] != ' ' and dic2[d + 1].count(' ') == 5:
            #     dic2[d + 1][0] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Iclinix_N16167':
        print('mmmmmmmmmmmmm')
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d == 1 and dic2[d][0] != 'Head':
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = ['Head', ' ', ' ', ' ', ' ', ' ']
            if d == len(dic2) and dic2[d][1] not in sbt:
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Healthway_N15806-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('nddd==', dic2[d])
            if dic2[d][0] == "Bill No :'":
                dic2[d][0] = 'Bill No :'
            if dic2[d][1] == 'ECOSPRIN 75 MG TAB':
                dic2[d][1] = 'ECOSPRIN75 MG TAB'
            if len(dic2[d][1].split()) >= 1 and dic2[d][2] == ' ' and len(re.findall('\d+\w{2}\d+', dic2[d][1])) == 1 and dic2[d][4] == ' ':
                print('rate  in unit')
                text = dic2[d][1]
                if len(re.findall('\d+\w{2}\d+', dic2[d][1])) == 1:
                    matchrate = re.search(r'\d+\w{2}\d+', text)
                elif len(re.findall('\d+\w{2}\d+', dic2[d][1])) == 1:
                    matchrate = re.search(r'\d+\w{2}\d+', text)
                elif len(re.findall('\d+\w{2}\d+', dic2[d][1])) == 1:
                    matchrate = re.search(r'\d+\w{2}\d+', text)
                dic2[d][1] = dic2[d][1].replace(matchrate.group(), ' ')
                dic2[d][2] = matchrate.group()
            if d > 1 and dic2[d][0] != head_list and dic2[d][1] == ' ' and len(dic2[d][0].split()) == 1 and dic2[
                d].count(' ') < 2:
                dic2[d][1] == dic2[d][0]

                dic2[d][0] == ' '


            dic1[lq] = dic2[d]
            lq += 1
        dic2 = dic1
    if hospital == 'Samford_N16568':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1

        for d in dic2:
            if d > 1 and d < len(dic2) and len(re.findall('\d+\/\d+\/\d+', dic2[d][0])) and dic2[d + 1][4] != ' ' and dic2[d + 1][5] != ' ' and dic2[d + 1].count(' ') >= 3:
                print('add===', dic2[d], dic2[d + 1])
                dic2[d + 1][4] = ' '
                dic2[d + 1][5] = ' '
            if d > 1 and d < len(dic2) and len(re.findall('\d\.\d', dic2[d][2])) and dic2[d + 1][2] != ' ' and dic2[d + 1][5] != ' ' and dic2[d + 1].count(' ') >= 3:
                print('add===', dic2[d], dic2[d + 1])
                dic2[d + 1][2] = ' '
                dic2[d + 1][5] = ' '
            if d > 1 and d < len(dic2) and len(re.findall('\d\.\d', dic2[d][5])) and dic2[d + 1][5] != ' ' and dic2[d + 1][5] != ' ' and dic2[d + 1].count(' ') >= 5:
                print('add===', dic2[d], dic2[d + 1])
                dic2[d + 1][5] = ' '
            if dic2[d][5]!=' '  and dic2[d].count(' ')==5:
                print('dddddddddd',dic2[d])
                dic2[d][5]=' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'kamineni_N14469':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1

        for d in dic2:
            if dic2[d][4]!=' ' and len(re.findall('\w+\s?\w+',dic2[d][4])) == 1:
                dic2[d][4] = ' '
            if len(re.findall('\d+\/\d+\/\d+', dic2[d][2])) == 1 and dic2[d][0] != ' ' and len(re.findall('\d\.\d', dic2[d][5])) == 1:
                print('change 0th index to 2nd index')
                text = dic2[d][2]
                dic2[d][2] = dic2[d][0]
                dic2[d][0] = text
            if dic2[d][0]!=' ' and len(re.findall('\d\ \d+\/\d+\/\d+',dic2[d][0])) == 1 and len(dic2[d][0].split()[0]) < 3:
                print('to remove sno')
                text = dic2[d][0]
                matchsno = re.search(r'\d ',text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(),'')
            if len(dic2[d][4].split()) == 2 and len(re.findall('\d+\.\d',dic2[d][4]))==2:
                a, b = dic2[d][4].split()
                dic2[d][3] = a
                dic2[d][4] = b

            if len(re.findall('\d+\D\d+\s?\d+\D\d+',dic2[d][4])) and dic2[d][0]!=' ' and dic2[d][4]!=' ' and dic2[d].count('') == 2:
                text = dic2[d][4]
                matchsno = re.search(r'\d+\D\d+',text)
                dic2[d][4] = text.replace(matchsno.group(),'')
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == "AIMS_N13444":
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==',dic2[d])
            if len(re.findall('\d{1,}\.\d{1,}', dic2[d][3]))==1:
                text = dic2[d][3]
                matchoperator = re.search(r'\d{1,}\.\d{1,}',text)
                dic2[d][3] = matchoperator.group()
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == "Jain_N0398":
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==',dic2[d])
            if d > 1 and d < len(dic2) and 'TOTAL' in dic2[d][3] and dic2[d+1][0] not in head_list:
                # dic2[d][3] = 'total'
                print('yess',dic2[d])
                dic2[d][3] = dic2[d][3].lower()
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'gopinath_N4750':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd11==', dic2[d])
            if len(re.findall('\d+\.\d+\D+\d+\.\d+', dic2[d][3])) == 1 and (
                    dic2[d][4] == ' ' or dic2[d][4] != ' ') and len(dic2[d][3].split()) > 1:
                print('if date and particulars merge')
                text = dic2[d][3]
                matchdate = re.search(r'\d+\.\d+', text)
                dic2[d][3] = matchdate.group()
                dic2[d][4] = text.replace(matchdate.group(), '')

            if len(re.findall('\D\s\d+.\d+', dic2[d][4])) and dic2[d].count(' ') >= 1:
                print('to remove extra value', dic2[d])
                text = dic2[d][4]
                matchsno = re.search(r'\D\s', text)
                dic2[d][4] = text.replace(matchsno.group(), '')

            if dic2[d][0] != ' ' and len(re.findall('\d+\D+\d+\/\d+\/\d+', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()[0]) <= 3:
                print('to remove sno')
                text = dic2[d][0]
                matchsno = re.search(r'\d+\D+', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Shankara_N16938':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(dic2[d][5].split())==2:
                a,b = dic2[d][5].split()
                dic2[d][5] = b
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == "RG Stone_N10421":
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==',dic2[d])
            if len(dic2[d][2].split())==2 and dic2[d].count(' ')<=2:
                print("spliting rate and qty",dic2[d])
                a,b = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = b

                # dic2[d][3] = 'total'
                print('yess',dic2[d])
                dic2[d][3] = dic2[d][3].lower()
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == "Ernakulam_N1127":
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] in head_list and dic2[d].count(" ") <= 4:
                print('yess', dic2[d])
                dic2[d][0] = dic2[d][0].lower()

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'prasad_N3814':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd11==', dic2[d])
            if len(re.findall('\d+\-\w+\-\d+\D+\d+', dic2[d][0])) == 1 and (
                    dic2[d][1] == ' ' or dic2[d][1] != ' ') and len(dic2[d][0].split()) > 1:
                print('if date and particulars merge')
                text = dic2[d][0]
                matchdate = re.search(r'\d+\-\w+\-\d+', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Highland_N16635':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][0] in head_list:
                print('if d in head_list and d-1 in head_list')
                dic2[d][0] = dic2[d][0] + dic2[d][0][-1]

            if d > 1 and d < len(dic2) and dic2[d][0].__contains__('medicine charges') and dic2[d + 1][5] != ' ' and \
                    dic2[d].count(' ') == 5:
                dic2[d][5] = dic2[d + 1][5]
                dic2[d + 1][5] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'sparsh_N3168':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd===',dic2[d])
            if d>1 and d<len(dic2) and len(re.findall('\d\-\d{2}\-\d',dic2[d-1][0])) and dic2[d].count(' ')==5 and dic2[d][2]!=' ':
                print('for merge line issue')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue

            if dic2[d][0]=="SERVICE CHAR257 Saheed Nagar, Bhab":
                dic2[d][0]="SERVICE CHARGES"
            if dic2[d][2]=="NABH Accredited Hospital":
                dic2[d][2]=' '
            if dic2[d][2]=="Bhabaneswar-751007 Ph. : +91 674 2540183 / 188 / 189, 6626666 : Fax : $91 674 3585860":
                dic2[d][2]=' '
            if dic2[d][2] == "Email : info@sparshhospitals.com ; CIN : U85110OR2007PTC009323 ; GSTIN : 21AAKCS8540CTZL":
                dic2[d][2] = ' '
            if dic2[d][0]=="PHARSPARANGESHOSPITALS & CRITICAL CARE PRIVATE LIMITED Total Rs. 56606.83/-":
                dic2[d][0]="PHARMACY CHARGES"
            if dic2[d][0]=="Note: Free home collection for lab investigation and free home delivery of medicine within Bhubaneswar city limits.":
                dic2[d][0]=" "
            if dic2[d][1]=="A/407, Saheed Nagar, Bhubaneswar-751007 Ph. : +91 674 2540183 / 188 / 189, 6626666 : Fax : +91 674 2545860-":
                dic2[d][1]=" "
            dic1[lq] = dic2[d]
            lq += 1
    return dic1
def pre_peronailse_at_basic_ext(dic1,src_dc,head_list,sbt,noc,hospital):
    if hospital == 'srch':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd==', dic2[d])
            if dic2[d][0] == 'SPEECH, LANGUAGE & HEARING':
                dic2[d][0] = 'SPEECH LANGUAGE & HEARING'
            if dic2[d][2].__contains__('CHENNAI') or dic2[d][2].__contains__('CHANDRA HOS'):
                dic2[d].pop(2)
                dic2[d].insert(2, ' ')
            if dic2[d][1] != ' ' and dic2[d][2] == ' ' and len(re.findall('^\d+\/\d+\/\d+\s', dic2[d][1])) == 1:
                print('date parti together in 1st indx')
                text = dic2[d][1]
                matchdate = re.search(r'^\d+\/\d+\/\d+\s', text)
                dic2[d][1] = matchdate.group()
                dic2[d][2] = text.replace(matchdate.group(), '')
                dic2[d][2] = dic2[d][2].strip()
            if dic2[d][1] != ' ' and dic2[d][2] != ' ' and len(re.findall('^\d+\/\d+\/\d+\s\d+', dic2[d][1])) == 1 and \
                    dic2[d][4] == ' ':
                print('date Qty together in 1st indx')
                text = dic2[d][1]
                matchdate = re.search(r'^\d+\/\d+\/\d+\s', text)
                dic2[d][1] = matchdate.group()
                dic2[d][4] = text.replace(matchdate.group(), '')
                dic2[d][4] = dic2[d][4].strip()
            if len(re.findall('^\d+\s', dic2[d][2])) == 1 and dic2[d][4] == ' ':
                print('yessssssssss for qty in 2nd indx')
                text = dic2[d][2]
                matchqty = re.search(r'^\d+\s', text)
                dic2[d][4] = matchqty.group()
                dic2[d][2] = dic2[d][2].replace(matchqty.group(), '')
            if len(re.findall('^\d\s?\d\/\d\s?\d\/\d+\s', dic2[d][0])) == 1 and len(dic2[d][0].split()) >= 1:
                print('for room charges box with cgst sgst')
                text = dic2[d][0]
                matchdate = re.search(r'^\d\s?\d\/\d\s?\d\/\d+\s', text)
                dic2[d][0] = matchdate.group()
                if dic2[d][1] != ' ':
                    dic2[d][1] = text.replace(matchdate.group(), '') + ' ' + dic2[d][1]
                else:
                    dic2[d][1] = text.replace(matchdate.group(), '')
                dic2[d][1] = dic2[d][1].strip()
                dic2[d][3] = dic2[d][2]
                dic2[d][2] = dic2[d][1]
            if dic2[d][1] != ' ' and dic2[d][2] != ' ' and len(re.findall('\d+\.\d+', dic2[d][2])) >= 1 and dic2[d][
                3] != ' ':
                print('for room charges changing indexes if rate cgst in 2nd indx')
                dic2[d][3] = dic2[d][2]
                dic2[d][2] = dic2[d][1]
            if dic2[d][2] != ' ' and len(re.findall('\d+\s\d+\D\d+\.\d+\s\d+\.\d+', dic2[d][2])) == 1:
                print('if qty rate in 2nd indx')
                text = dic2[d][2]
                matchqtyrate = re.search(r'\d+\s\d+\D\d+\.\d+\s\d+\.\d+', text)
                dic2[d][3] = matchqtyrate.group()
                dic2[d][2] = dic2[d][2].replace(matchqtyrate.group(), '')
                dic2[d][2] = dic2[d][2].strip()
            if dic2[d][3] != ' ' and (len(re.findall('^\d+\s\d+\D\d+\.\d+\s\d+\.\d+', dic2[d][3])) == 1 or len(
                    re.findall('^\D+\s\d+\D\d+\.\d+\s\d+\.\d+', dic2[d][3])) == 1 or \
                                      len(re.findall('^\d+\s\d+\.\d+\s\d+\.\d+', dic2[d][3])) == 1 or len(
                        re.findall('^\d+\s\d+\D\d+\s\d+\.\d+', dic2[d][3])) == 1 or \
                                      len(re.findall('^\D+\s\d+\.\d+\s\d+\.\d+', dic2[d][3])) == 1):
                print('qty rate in 3rd indx for room charges with cgst')
                text = dic2[d][3].split()
                dic2[d][3] = text[1]
                dic2[d][4] = text[0]
            if dic2[d][3] != ' ' and (len(re.findall('^\d+\s\d+\D\d+\.\d+', dic2[d][3])) == 1 or len(
                    re.findall('^\D+\s\d+\D\d+\.\d+', dic2[d][3])) == 1 or \
                                      len(re.findall('^\d+\s\d+\.\d+', dic2[d][3])) == 1 or len(
                        re.findall('^\d+\s\d+\D\d+', dic2[d][3])) == 1 or \
                                      len(re.findall('^\D+\s\d+\.\d+', dic2[d][3])) == 1) and dic2[d].count(' ') <= 2:
                print('qty rate in 3rd indx for room charges without cgst')
                text = dic2[d][3].split()
                dic2[d][3] = text[1]
                dic2[d][4] = text[0]
            if dic2[d][3] != ' ' and len(dic2[d][3].split()) >= 2 and len(
                    re.findall('^\d+\s\d+\.\d+', dic2[d][3])) == 0 and len(re.findall('\d+\.\d+', dic2[d][3])) >= 1 and \
                    len(re.findall('^\d+\,\s\d+\.\d+', dic2[d][3])) == 0:
                print('Only rate in 3rd indx with cgst for room charges')
                text = dic2[d][3].split()
                dic2[d][3] = text[0]
            if d > 1 and len(re.findall('\d+\/\d+\/\d+', dic2[d][0])) == 1 and len(dic2[d][0].split()) == 1 and dic2[d][
                1] != ' ' and dic2[d][5] == ' ' and \
                    dic2[d][3] != ' ' and dic2[d][4] != ' ' and len(dic2[d][3].split()) <= 1 and len(
                dic2[d][4].split()) <= 1:
                print('for room charges box without cgst sgst')
                dic2[d][2] = dic2[d][1]
                dic2[d][5] = dic2[d][4]
                dic2[d][4] = ' '

            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'CHRISTIAN':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd===', dic2[d])
            if dic2[d][0] == 'Surgery name & Type' and dic2[d][5] == 'Amount':
                dic2[d][5] = ' '
            if dic2[d][2] == 'DRUG RETURNS' and dic2[d].count(' ') == 5:
                dic2[d][0] = dic2[d][2]
                dic2[d][2] = ' '
            if len(re.findall('\d{2}\-\d{2}\-\d{2}', dic2[d][0])) == 1 and len(
                    re.findall('\d{2}\-\d{2}\-\d{2}', dic2[d][1])) == 1 and dic2[d][1] in dic2[d][0]:
                print('if 1st index in 0th index')
                dic2[d][1] = ' '
            if len(dic2[d][0].split()) >= 3 and dic2[d][1] == ' ' and dic2[d][2] == ' ' and len(
                    re.findall('\d{2}\-\d{2}\-\d{2}', dic2[d][0])) == 1:
                print('fir date code and parti together in 0th index')
                text = dic2[d][0]
                if len(re.findall('\D\d{4}', dic2[d][0])) == 1:
                    matchcode = re.search(r'\D\d{4}', text)
                elif len(re.findall('\d{5}', dic2[d][0])) == 1:
                    matchcode = re.search(r'\d{5}', text)
                elif len(re.findall('\d\D\d{3}', dic2[d][0])) == 1:
                    matchcode = re.search(r'\d\D\d{3}', text)
                elif len(re.findall('\D{2}\d{3}', dic2[d][0].split()[0])) == 1:
                    matchcode = re.search(r'\D{2}\d{3}', dic2[d][0].split()[0])
                matchdate = re.search(r'\d{2}\-\d{2}\-\d{2}', text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = matchdate.group()
                dic2[d][2] = text.replace(matchcode.group(), '')
                dic2[d][2] = dic2[d][2].replace(matchdate.group(), '')
            if len(dic2[d][0].split()) <= 3 and dic2[d][1] == ' ' and dic2[d][2] != ' ' and len(
                    re.findall('\d{2}\-\d{2}\-\d{2}', dic2[d][0])) == 1:
                print('for date code together in 0th index')
                text = dic2[d][0]
                matchdate = re.search(r'\d{2}\-\d{2}\-\d{2}', text)
                dic2[d][1] = matchdate.group()
                dic2[d][0] = dic2[d][0].replace(matchdate.group(), '')
            if len(dic2[d][0].split()) >= 2 and dic2[d][1] == ' ' and dic2[d][2] == ' ' and len(
                    re.findall('\d{2}\/\d{2}\/\d{2}', dic2[d][0])) == 1:
                print('for date(with slash ie pharmacy) and parti together in 0th index')
                text = dic2[d][0]
                matchdate = re.search(r'\d{2}\/\d{2}\/\d{2}', text)
                dic2[d][0] = matchdate.group()
                dic2[d][2] = text.replace(matchdate.group(), '')
            if dic2[d][0] in dic2[d][1] and len(re.findall('\d{2}\-\d{2}\-\d{2}', dic2[d][1])) == 1 and len(
                    dic2[d][1].split()) >= 3 and dic2[d][2] == ' ':
                print('for date and parti in 1st index and code in 1st index')
                text = dic2[d][1]
                matchdate = re.search(r'\d{2}\-\d{2}\-\d{2}', text)
                dic2[d][1] = matchdate.group()
                dic2[d][2] = text.replace(dic2[d][0], '')
                dic2[d][2] = dic2[d][2].replace(matchdate.group(), '')
            if dic2[d][0] not in dic2[d][1] and len(re.findall('\d{2}\-\d{2}\-\d{2}', dic2[d][1])) == 1 and len(
                    dic2[d][1].split()) >= 2 and dic2[d][2] == ' ':
                print('for date and parti in 1st index and code not in 1st index')
                text = dic2[d][1]
                matchdate = re.search(r'\d{2}\-\d{2}\-\d{2}', text)
                dic2[d][1] = matchdate.group()
                dic2[d][2] = text.replace(dic2[d][0], '')
                dic2[d][2] = dic2[d][2].replace(matchdate.group(), '')
            if len(re.findall('\d{2}\-\d{2}\-\d{2}', dic2[d][1])) == 1 and len(dic2[d][1].split()) >= 2 and dic2[d][
                2] == ' ' and dic2[d][0] == ' ':
                print('for only date and parti in 1st index')
                text = dic2[d][1]
                matchdate = re.search(r'\d{2}\-\d{2}\-\d{2}', text)
                dic2[d][1] = matchdate.group()
                dic2[d][2] = text.replace(matchdate.group(), '')
            if (len(re.findall('\d{2}\-\d{2}\-\d{2}', dic2[d][1])) == 1 or len(
                    re.findall('\d{1}\-\d{2}\-\d{2}', dic2[d][1])) == 1) and len(dic2[d][1].split()) >= 2 and dic2[d][
                2] == ' ' and dic2[d][0] != ' ':
                print('for only date and parti in 1st index with 0th index not null')
                text = dic2[d][1]
                if len(re.findall('\d{2}\-\d{2}\-\d{2}', dic2[d][1])) == 1:
                    matchdate = re.search(r'\d{2}\-\d{2}\-\d{2}', text)
                elif len(re.findall('\d{1}\-\d{2}\-\d{2}', dic2[d][1])) == 1:
                    matchdate = re.search(r'\d{1}\-\d{2}\-\d{2}', text)
                dic2[d][1] = matchdate.group()
                dic2[d][2] = text.replace(matchdate.group(), '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'hiranandani':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd==', dic2[d])
            if dic2[d][0] == 'LABORATORY MAJOR CODE' and dic2[d][2] == '99931':
                dic2[d][0] = 'LABORATORY MAJOR CODE 99931'
                dic2[d][2] = ' '
            if dic2[d][5] in dic2[d][6] and len(dic2[d][6].split()) == 2 and dic2[d][5] != ' ':
                print('if 5th index value is in 6th index')
                dic2[d][6] = dic2[d][6].replace(dic2[d][5], '')
                dic2[d][6] = dic2[d][6].replace(' ', '')
            if len(re.findall('\d{2}\-\d{2}\-\d{4}', dic2[d][0])) == 1 and dic2[d][1] == ' ' and len(
                    dic2[d][0].split()) >= 2:
                print('for date in 0th index')
                text = dic2[d][0]
                matchdate = re.search(r'\d{2}\-\d{2}\-\d{4}', text)
                dic2[d][1] = matchdate.group()
                dic2[d][0] = dic2[d][0].replace(matchdate.group(), '')
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'reliance':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][2] == 'Consultation Subtotall':
                dic2[d][2] = 'Consultation Subtotal'
            if dic2[d][1] == dic2[d][2]:
                dic2[d][2] = ' '
            if (len(re.findall('\d{4}\/\d{2}\:', dic2[d][1])) == 1 or len(
                    re.findall('\d{4}\/\s\d{2}\:', dic2[d][1])) == 1) and dic2[d][2] != ' ':
                print('for accomodation changing particular index')
                dic2[d][0] = dic2[d][0] + '-' + dic2[d][1]
                dic2[d][1] = dic2[d][2]
                dic2[d][2] = ' '
            # if len(re.findall('\d\.\d{2}', dic2[d][5])) == 1 and dic2[d][4] == ' ' and dic2[d][3] == ' ' and dic2[d][
            #     2] != ' ': commented will see later
            #     print('for package exclusions  changing particular index')
            #     dic2[d][1] = dic2[d][2]
            #     dic2[d][2] = ' '
            if dic2[d][0].__contains__('Statement') and dic2[d][0].__contains__('Reference'):
                # print('to change medical consumable 0th index to 1st index')
                dic2[d][1] = dic2[d][0]
                dic2[d][0] = ' '
            if d > 1 and len(re.findall('\d\.\d', dic2[d][4])) == 1 and len(
                    re.findall('\d\.\d', dic2[d][5])) == 1 and len(re.findall('\d\.\d', dic2[d - 1][4])) == 0 and \
                    len(re.findall('\d\.\d', dic2[d - 1][5])) == 0 and (
                    dic2[d].count(' ') == 2 or dic2[d].count(' ') == 3) and dic2[d - 1].count(' ') == 4:
                print('for adding mismatched lines')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ', ' ']
            if dic2[d][2] == dic2[d][3] and len(
                    re.findall('\d{2}\s?\.\s?\d{2}\.\d{4}\/\d{2}\:\d{2}', dic2[d][2])) == 1 and len(
                re.findall('\d{2}\s?\.\s?\d{2}\.\d{4}\/\d{2}\:\d{2}', dic2[d][3])) == 1:
                print('if 2nd and 3rd index same with datetime val')
                dic2[d][3] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'reliance_1':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] != ' ' and len(re.findall('\d+\.\d+\.\d+\/\d+\:\d+\s\d+\.\d+\.\d+\/\d+\:\d+', dic2[d][0])) == 1 and len(dic2[d][0].split())>= 3:
                print('for accomodation date and parti in 0th index')
                text = dic2[d][0]
                if len(re.findall('\d+\.\d+\.\d+\/\d+\:\d+\s\d+\.\d+\.\d+\/\d+\:\d+', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d+\.\d+\.\d+\/\d+\:\d+\s\d+\.\d+\.\d+\/\d+\:\d+', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '').replace(' ', '', 1)
            if dic2[d][0] != ' ' and len(re.findall('\d+\.\d+\.\d+\/\d+\:\d+', dic2[d][0])) == 1 and len(dic2[d][0].split())>= 2:
                print('for date and parti in 0th index')
                text = dic2[d][0]
                if len(re.findall('\d+\.\d+\.\d+\/\d+\:\d+', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d+\.\d+\.\d+\/\d+\:\d+', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '').replace(' ','',1)
            if dic2[d][4]!= ' ' and len(re.findall('\d+\/\d+', dic2[d][4])) == 1:
                dic2[d][3] = dic2[d][4]
            if dic2[d][2]!= ' ' and dic2[d][2].__contains__('at Actual'):
                dic2[d][2] = dic2[d][2].replace('at Actual','Subtotal')
            if dic2[d][2]!= ' ' and  dic2[d][2].__contains__('Yes'):
                dic2[d][2] = dic2[d][2].replace('Yes',' ')
            if dic2[d][2]!= ' ' and dic2[d][2].__contains__('No'):
                dic2[d][2] = dic2[d][2].replace('No',' ')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'reliance_daycare':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if d > 1 and dic2[d][0] == ' ' and dic2[d - 1][0] != ' ' and dic2[d][1] != ' ' and dic2[d - 1][1] != ' ' and \
                    dic2[d][5] != ' ' and dic2[d - 1][5] == ' ' and \
                    dic2[d].count(' ') == 3 and dic2[d - 1].count(' ') == 3:
                print('if 2 lines divided d 3, d-1 3')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue

            dic1[lq] = dic2[d]
            lq += 1
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd11==', dic2[d])
            if d==1 and dic2[d][0] in head_list:
                listnw = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq-1] = listnw
                dic2[d][0] = ' '
            if d>1 and dic2[d][0] in head_list:
                listnw = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq+=1
                dic1[lq-1] = listnw
                dic2[d][0] = ' '

            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'SIMS':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] != ' ' and (len(re.findall('\d{2}', dic2[d][0].split()[0])) == 1 or len(
                    re.findall('\d', dic2[d][0].split()[0])) == 1) and dic2[d].count(' ') >= 2:
                print('for removing snos in 0th index')
                text = dic2[d][0]
                if len(re.findall('\d{2}', dic2[d][0].split()[0])) == 1:
                    matchsno = re.search(r'\d{2}', text)
                elif len(re.findall('\d', dic2[d][0].split()[0])) == 1:
                    matchsno = re.search(r'\d', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
                dic2[d][0] = dic2[d][0].replace(dic2[d][0][0], '', 1)
            if dic2[d][0] == 'MICROBIOLOGY, SEROLOGY & MOLECULAR BIOLOGY':
                dic2[d][0] = 'MICROBIOLOGY SEROLOGY & MOLECULAR BIOLOGY'

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd011==', dic2[d])
            if dic2[d][0] != ' ' and (len(re.findall('\d+\s\*\s\d+', dic2[d][0])) == 1 or len(
                    re.findall('\d+\s\*\s.?\d+', dic2[d][0])) == 1) and dic2[d].count(' ') >= 2:
                print('for rate qty in 0th indx')
                text = dic2[d][0]
                if len(re.findall('\d+\s\*\s\d+', dic2[d][0])) == 1:
                    matchrateqty = re.search(r'\d+\s\*\s\d+', text)
                elif len(re.findall('\d+\s\*\s.?\d+', dic2[d][0])) == 1:
                    matchrateqty = re.search(r'\d+\s\*\s.?\d+', text)
                dic2[d][3] = matchrateqty.group()
                dic2[d][0] = dic2[d][0].replace(matchrateqty.group(), '')
            if len(dic2[d][3].split()) == 3 and '*' in dic2[d][3]:
                a, b, c = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = c

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'SIMS-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00', dic2[d])
            if dic2[d][0] != ' ' and dic2[d][1] != ' ' and dic2[d][1] in dic2[d][0]:
                dic2[d][0] = dic2[d][0].replace(dic2[d][1], ' ')
            if dic2[d][0] == dic2[d][1]:
                dic2[d][0] = ' '
            if dic2[d][2] == dic2[d][3]:
                dic2[d][2] = ' '
            if dic2[d][0] == 'issues' or dic2[d][0] == 'Issues' or dic2[d][0] == 'ssues':
                dic2[d][0] = 'Pharmacy'
            if dic2[d][0] == 'Returns' or dic2[d][0] == 'returns' or dic2[d][0] == '-Returns':
                dic2[d][0] = 'Pharmacy Returns'

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'QRG':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] == 'Administration Charges Charges':
                dic2[d][0] = 'Administration Charges'
            if dic2[d][2].__contains__('Return '):
                dic2[d][2] = dic2[d][2].replace('Return ', '')
            if (len(re.findall('\d+\/\d{2}\/\d{4}\s?\d{2}\:\d{2}\s?\-\s?\w{4}\/\d{6}', dic2[d][0])) == 1 or len(
                    re.findall('\d+\/\d{2}\/\d{4}\s?\d{2}\:\d{2}\s?\-\s?\w{8}\/\d{6}', dic2[d][0])) == 1 or len(
                    re.findall('\d+\/\d{2}\/\d{4}\s?\d{2}\:\d{2}\s?\-\s?\w{8}\/\d{3}', dic2[d][0])) == 1) and dic2[
                d].count(' ') >= 1 and \
                    len(re.findall('\d\s?\.\s?\d', dic2[d][5])) == 1 and dic2[d][1] == ' ':
                print('date particular merge')
                text = dic2[d][0]
                if len(re.findall('\d+\/\d{2}\/\d{4}\s?\d{2}\:\d{2}\s?\-\s?\w{4}\/\d{6}', dic2[d][0])) == 1:
                    matchDate = re.search(r'\d+\/\d{2}\/\d{4}\s?\d{2}\:\d{2}\s?\-\s?\w{4}\/\d{6}', text)
                elif len(re.findall('\d+\/\d{2}\/\d{4}\s?\d{2}\:\d{2}\s?\-\s?\w{8}\/\d{6}', dic2[d][0])) == 1:
                    matchDate = re.search(r'\d+\/\d{2}\/\d{4}\s?\d{2}\:\d{2}\s?\-\s?\w{8}\/\d{6}', text)
                elif len(re.findall('\d+\/\d{2}\/\d{4}\s?\d{2}\:\d{2}\s?\-\s?\w{8}\/\d{3}', dic2[d][0])) == 1:
                    matchDate = re.search(r'\d+\/\d{2}\/\d{4}\s?\d{2}\:\d{2}\s?\-\s?\w{8}\/\d{3}', text)
                dic2[d][0] = matchDate.group()
                dic2[d][1] = text.replace(matchDate.group(), "")
                if dic2[d][1][0] == ' ':
                    print('remove 1st space')
                    dic2[d][1] = dic2[d][1].replace(dic2[d][1][0], '')
            if dic2[d][3] in dic2[d][2] and len(re.findall('\d\s?\.\s?\d', dic2[d][3])) == 1 and len(
                    re.findall('\d\s?\.\s?\d', dic2[d][2])) == 2:
                print('if qty is present 2 times (with rate and in qty)')
                dic2[d][3] = ' '

            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'action':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if len(dic2[d][3].split()) == 2 and len(re.findall('\d\s?\.\s?\d', dic2[d][3])) == 2 and dic2[d][4] == ' ':
                print('if rate and qty together')
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if len(re.findall('^\D?\d+\s?\/\d\s?\d\s?\/\d+', dic2[d][0])) == 1 and (
                    dic2[d][1] == ' ' or dic2[d][1] in dic2[d][0]) and dic2[d][0] != ' ' and len(
                    dic2[d][0].split()) >= 2 and \
                    dic2[d].count(' ') <= 3:
                print('date, parti')
                text = dic2[d][0]
                if len(re.findall('^\D?\d+\s?\/\d\s?\d\s?\/\d+', dic2[d][0])) == 1:
                    matchdate = re.search(r'^\D?\d+\s?\/\d\s?\d\s?\/\d+', dic2[d][0])
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'bombay':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] == 'RAY':
                dic2[d][0] = 'X RAY'
            if dic2[d][0] == 'EQP. UTIL CHRGS(MAJOR':
                dic2[d][0] = 'EQP. UTIL CHRGS(MAJOR)'
            if dic2[d][0] == 'EQP. UTIL CHRGS(MINOR':
                dic2[d][0] = 'EQP. UTIL CHRGS(MINOR)'
            if dic2[d][0] == 'EQP, UTIL CHRGS(MAJ OR)':
                dic2[d][0] = 'EQP. UTIL CHRGS(MAJOR)'
            if d == 1 and d < len(dic2) and dic2[d][0] not in head_list and dic2[d + 1][0] in head_list:
                dic2[d][0] = ' '
            if dic2[d][2] == 'ERATION THEATRE CI' and len(re.findall('\d{3}\.\d{2}', dic2[d][4])) == 1 and dic2[
                d].count(' ') == 6:
                dic2[d][2] = 'Total For OPERATION THEATRE CHARGES'
            if d > 1 and d < len(dic2) and dic2[d][0] == 'SURCHARGE' and dic2[d].count(' ') == 7 and dic2[d - 1][
                5] == '00' and dic2[d - 1].count(' ') == 7:
                dic2[d - 1][1] = 'Total For ROOM CHARGES'
            if (len(re.findall('\d\/\d{2}\/\d{4}', dic2[d][0])) == 1 or len(
                    re.findall('\d\/\d{2}\/\d{3}', dic2[d][0])) == 1) and dic2[d][5] == ' ' and dic2[d][
                6] == ' ' and len(dic2[d][4].split()) == 3 and (
                    len(re.findall('\d\.\d', dic2[d][4].split()[0])) == 1 or len(
                    re.findall('\d\,\d', dic2[d][4].split()[0])) == 1):
                print('4,5,6 index merge')
                a, b, c = dic2[d][4].split()
                dic2[d][4] = a
                dic2[d][5] = b
                dic2[d][6] = c
            if len(dic2[d][4].split()) == 2 and len(re.findall('\d\.\d', dic2[d][4])) == 1 and len(
                    re.findall('\d{10}', dic2[d][4])) == 1 and dic2[d][5] == ' ':
                print('4,5 index merge')
                a, b = dic2[d][4].split()
                dic2[d][4] = a
                dic2[d][5] = b
            if len(dic2[d][0].split()) > 2 and dic2[d][1] == ' ' and len(
                    re.findall('\d\/\d{2}\/\d{4}', dic2[d][0].split()[0])) == 1:
                print('0 and 1st index merge')
                text = dic2[d][0]
                matchdate = re.search(r'\d{2}\/\d{2}\/\d{4}', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'bombay-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][1] == '- .. . .':
                dic2[d][1] = ' '
            if dic2[d][0] != ' ' and len(re.findall('\d+', dic2[d][0])) == 1 and dic2[d].count(' ') >= 4:
                dic2[d][0] = ' '
            if dic2[d][0] != ' ' and len(re.findall('\d+\-\w{3}\-\d+', dic2[d][0])) == 1 and dic2[d].count(' ') >= 4:
                dic2[d][0] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='jaypee':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if dic2[d][0] == 'Investigation .':
                dic2[d][0] = 'Investigation'
            if dic2[d][0] == 'Consumables .' or dic2[d][0] == 'onsumables':
                dic2[d][0] = 'Consumables'
            if dic2[d][0] == 'consultation':
                dic2[d][0] = 'Consultation'
            if dic2[d][0] == 'Imacing':
                dic2[d][0] = 'Imaging'
            if d>1 and d<len(dic2) and len(re.findall('\d{3}\.\d{2}', dic2[d][2])) == 1 and len(re.findall('\d{3}\.\d{2}', dic2[d][4])) == 1 and len(re.findall('\d{3}\.\d{2}', dic2[d-1][2])) == 0 and len(re.findall('\d{3}\.\d{2}', dic2[d-1][4])) == 0 and \
                    len(re.findall('\D{8}\s\d{4}\s\d\D\s\.\.\.\.\s\-\s\D\d{8}', dic2[d-1][0])) == 1 and dic2[d].count(' ')==3 and dic2[d-1].count(' ')==4:
                print('for BABY OF PUJA OMVEER RAWAT  FBB1 Tegaderm 1610 3M .... - R01080913 - 01/09/2021')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ', ' ']
            if d>3 and d<len(dic2)+3 and (len(re.findall('\D{5}\s\D{9}\s\|\s\D{2}\.\s\D{6}\s\D{5}\s\/\D{2}\.\s\D{5}\s\D{4}', dic2[d][0])) == 1 or len(re.findall('\D{12}\s\(\D{7}\)\s\.\.\.\.', dic2[d][0])) == 1 or len(re.findall('\D{7}\s\D{8}\s\D\/\D\s\D{6}\,\s\d\D{2}\s\d{3}\'\D\s\(\D{4}\)', dic2[d][0])) == 1 or
                                          len(re.findall('\D{6}\s\D{7}\s\D{7}\s\D{4}\s\D{6}\s\d{2}\s\D\d\s\d{2}', dic2[d][0])) == 1 or len(re.findall('\D{5}\s\D{6}\s\D\-\D{5}\s\d{2}\'\D\s\D{4}\s\D\s\(\D{7}\)\s\.\.', dic2[d][0])) == 1) and dic2[d].count(' ')==3 and dic2[d+1].count(' ')==4 and \
                    (len(re.findall('\D\d{2}\.\d{2}', dic2[d][2])) == 1 or len(re.findall('\d\.\d', dic2[d][2])) == 1) and dic2[d][1] != ' ' and dic2[d+1][1]==' ':
                print("for 220100648719 SERUM POTASSIUM | Dr. and Respirometer (Romsons) .... and Syringe Dispovan W/O Needle, 2MI and Unolok Syringe Injecta With Needle 20 M1 25 and Adult Diaper D-Magna 10's Pack M (Romsons) ..,")
                dic2[d][4] = dic2[d+1][4]
                dic2[d+1][4] = ' '
            if d>1 and d<len(dic2) and len(re.findall('\D{5}\s\D{4}\s\D{7}\s\D{3}\-\D{3}\s\D{7}', dic2[d][0])) == 1 and dic2[d].count(' ')==5 and len(re.findall('\d\.\d', dic2[d+1][2])) == 1 and dic2[d+1].count(' ')==4:
                print('for 220100648719 Vaccu Suck Suction Set-Sid Romsons')
                dic2[d+1][4] = dic2[d+2][4]
                dic2[d+2][2] = dic2[d+3][2]
                dic2[d+2][1] = dic2[d+3][1]
            if d>3 and d<len(dic2)+3 and len(re.findall('\d\.\d', dic2[d][4])) == 1 and len(re.findall('\D{5}\s\D{6}\s\;\s\D{2}\.\s\D{6}\s\D{5}\s\/\D{2}\.\s\D{5}\s\D{4}', dic2[d-1][0])) == 1 and dic2[d].count(' ')==3 and \
                    dic2[d-1].count(' ')==5:
                print('for 220100648719 SERUM SODIUM ; Dr')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if d>3 and d<len(dic2) and len(re.findall('\D{3}\s\D{4}\s\D{4}\s\|\s\D{2}\.\s\D{6}\s\D{5}\s\/\D{2}\.\s\D{5}\s\D{4}', dic2[d][0])) == 1 and len(re.findall('\d\.\d', dic2[d][2])) == 1 and dic2[d].count(' ')==3 and \
                    dic2[d+1].count(' ')==4 and len(re.findall('\d\.\d', dic2[d+1][4])) == 1:
                print('for 220100648719 CBC WITH DIFF | Dr. Sanjay Gupta ')
                dic2[d][4] = dic2[d+1][4]
                dic2[d+1][4] = ' '
                dic2[d+2][4] = dic2[d+3][4]
                dic2[d+3][4] = ' '
            if d>1 and d<len(dic2) and len(re.findall('\D{4}\.\s\D{7}\s\D{5}\s\d{3}\D{3}\d{3}\D{2}\(\D{4}\s\D{8}\)', dic2[d][0])) == 1 and len(re.findall('\d\.\d', dic2[d][4])) == 2 and \
                    len(dic2[d][4].split()) == 2 and dic2[d].count(' ')==2 and dic2[d-1].count(' ')==3:
                print('for 220100648719 Disp. Trolley Cover 140cmX150cm(Apex Surgical)')
                a,b = dic2[d][4].split()
                dic2[d-1][4] = a
                dic2[d][4] = b
            if d>1 and d<len(dic2) and len(re.findall('\D{2}\s\D{3}\s\[\D{6}\]\s\D{7}\s\.\.\.\s\d', dic2[d][0])) == 1 and len(re.findall('\d\.\d', dic2[d][4])) == 1 and len(re.findall('\d\.\d', dic2[d][2])) == 1 and \
                    dic2[d][1] == ' ' and len(re.findall('\d\-\d{2}\-\d{4}', dic2[d-1][1])) == 1:
                print('for 220100648719 IV Set [Vented] Romsons ... 1')
                dic2[d][1] = dic2[d-1][1]
                dic2[d-1][1] = ' '
            if d>11 and d<len(dic2)+12 and len(re.findall('\D{3}\s\D{4}\s\D{5}\s\d{3}\D\d{3}\D{2}\s\(\D{8}\)\s\,\.\.\d', dic2[d][0])) == 1 and dic2[d].count(' ')==4 and dic2[d-1].count(' ')==2:
                print('for 220100648719 Bed Bath Wipes 320X240mm (Medicare) ,..1')
                dic2[d-1][4] = dic2[d][4]
                dic2[d][4] = ' '
                dic2[d+2][4] = dic2[d+3][4]
                dic2[d+3][4] = ' '
                dic2[d+4][4] = dic2[d+5][4]
                dic2[d+5][4] = ' '
                dic2[d+6][4] = dic2[d+7][4]
                dic2[d+7][4] = ' '
                dic2[d+8][4] = dic2[d+9][4]
                dic2[d+9][4] = ' '
                dic2[d+10][4] = dic2[d+11][4].split()[0]
                dic2[d+11][4] = dic2[d+11][4].split()[1]
            if d>10 and d<len(dic2)+10 and len(re.findall('\D{9}\s\d\s\D{2}\s\D\'\D{2}\.\d{2}\'\D\s\(\D{10}\)\s\D{5}', dic2[d][0])) == 1 and dic2[d].count(' ')==3 and dic2[d-1].count(' ')==5:
                print('for 220100648719 Amlopress 5 ma T')
                dic2[d][4] = dic2[d+1][4]
                dic2[d+1][4] = dic2[d+2][4]
                dic2[d+2][4] = ' '
                dic2[d+3][4] = dic2[d+4][4]
                dic2[d+4][4] = ' '
                dic2[d+4][2] = dic2[d+5][2]
                dic2[d+5][2] = ' '
                dic2[d+4][4] = dic2[d+6][4]
                dic2[d+6][4] = ' '
                dic2[d+7][4] = dic2[d+8][4]
                dic2[d+8][4] = ' '
            if d>5 and d<len(dic2)+5 and len(re.findall('\D{8}\s\d{2}\D{2}\s\D{3}\s\(\D{12}\)\s\D{5}\s\.\D{9}\,\d{2}\s\D{2}', dic2[d][0])) == 1 and dic2[d].count(' ')==4 and dic2[d-1].count(' ')==3 and dic2[d+1].count(' ')==3:
                print('for 220100648719 Pantored 40mg Ini (Pantaprozole) Zymes .Injection,40 mg')
                dic2[d-1][4] = dic2[d][4]
                dic2[d][4] = ' '
                dic2[d+1][4] = dic2[d+2][4]
                dic2[d+1][3] = ' '
                dic2[d+2][4] = ' '
                dic2[d+3][4] = dic2[d+4][4]
                dic2[d+4][4] = ' '
                dic2[d+3][3] = ' '
                dic2[d+5][4] = dic2[d+6][4]
                dic2[d+6][4] = ' '
                dic2[d+6][1] = dic2[d+7][1]
                dic2[d+6][2] = dic2[d+7][2]
                dic2[d+6][4] = dic2[d+7][4]
                dic2[d+7][1] = dic2[d+8][1]
                dic2[d+7][2] = dic2[d+8][2]
                dic2[d+7][4] = dic2[d+9][4]
                dic2[d+8][1] = ' '
                dic2[d+8][2] = ' '
            if d>7 and d<len(dic2)+7 and len(re.findall('\D{7}\s\d{3}\D{2}\s\D{2}\s\(\D{11}\)\s\D{6}\s\,\D{9}\,\s\d{4}\s\D{2}', dic2[d][0])) == 1 and dic2[d].count(' ')==2 and dic2[d-1].count(' ')==4 and dic2[d+1].count(' ')==4:
                print('for 220100648719 Cachpar 100mi IV (Paracetamol) Cachet ,Injection, 1000 mg')
                dic2[d-1][1] = dic2[d][1]
                dic2[d-1][2] = dic2[d][2]
                dic2[d-1][4] = dic2[d][4]
                dic2[d][1] = dic2[d+1][1]
                dic2[d][2] = dic2[d+1][2]
                dic2[d][4] = dic2[d+2][4]
                dic2[d+1][1] = ' '
                dic2[d+1][2] = ' '
                dic2[d+2][2] = dic2[d+3][2]
                dic2[d+2][4] = dic2[d+3][4]
                dic2[d+3][1] = dic2[d+4][1]
                dic2[d+3][2] = dic2[d+4][2]
                dic2[d+3][4] = dic2[d+5][4]
                dic2[d+4][1] = ' '
                dic2[d+4][2] = ' '
                dic2[d+5][2] = dic2[d+6][2]
                dic2[d+5][4] = dic2[d+6][4]
                dic2[d+6][2] = ' '
                dic2[d+6][4] = ' '


            dic1[lq]=dic2[d]
            lq +=1
    if hospital == 'care':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][7] == 'S {NR)' or dic2[d][7] == '...':
                dic2[d][7] = ' '
            if dic2[d][8] == '.. . . .... .;':
                dic2[d][8] = ' '
            if dic2[d][0] == '. . .':
                dic2[d][0] = ' '
            if dic2[d][2] == "AL . NO' 1/0100490034" or dic2[d][2] == 'Final Bill' or dic2[d][2] == '. .. . .' or \
                    dic2[d][2] == "AL . NO' 1/0700490034":
                dic2[d][2] = ' '
            if dic2[d][0] == 'HEMISTRY':
                dic2[d][0] = 'BIO CHEMISTRY'
            if dic2[d][3] == 'ToLal' or dic2[d][3] == 'ota' or dic2[d][3] == 'ToLa' or dic2[d][3] == 'otg':
                dic2[d][3] = 'Total'
            if dic2[d][0] == '-.. HISTOPATHOLOGY':
                dic2[d][0] = 'HISTOPATHOLOGY'
            if len(dic2[d][4].split()) == 2 and len(re.findall('\d\.\d', dic2[d][4])) == 2:
                print('if rate and com amt together')
                a, b = dic2[d][4].split()
                dic2[d][4] = a
                dic2[d][5] = b
            if (len(re.findall('\d\-\d{2}\-\d{4}', dic2[d][0])) == 1 or len(
                    re.findall('\D{2}\-\d{2}\-\d{4}', dic2[d][0])) == 1 or len(
                    re.findall('\d{2}\-\w{2}\-\d{4}', dic2[d][0])) == 1) and len(dic2[d][0].split()) > 1 and dic2[d][
                0] != ' ' and dic2[d][1] == ' ':
                print('if date code together')
                text = dic2[d][0]
                if len(re.findall('\d{2}\-\d{2}\-\d{4}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\-\d{2}\-\d{4}', text)
                elif len(re.findall('\d\-\d{2}\-\d{4}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d\-\d{2}\-\d{4}', text)
                elif len(re.findall('\D{2}\-\d{2}\-\d{4}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\D{2}\-\d{2}\-\d{4}', text)
                elif len(re.findall('\d{2}\-\w{2}\-\d{4}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\-\w{2}\-\d{4}', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')
            if len(re.findall('\d\s', dic2[d][1])) == 1 or len(re.findall('\d{2}\s', dic2[d][1])) == 1:
                print('to remove sr no and space')
                text = dic2[d][1]
                if len(re.findall('\d{2}\s', dic2[d][1])) == 1:
                    matchsrno = re.search(r'\d{2}\s', text)
                elif len(re.findall('\d\s', dic2[d][1])) == 1:
                    matchsrno = re.search(r'\d\s', text)
                dic2[d][1] = dic2[d][1].replace(matchsrno.group(), '')

            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'rainbow':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if d > 1 and d < len(dic2) and dic2[d][0] == 'CHARGES' and dic2[d + 1][0] == 'BIOCHEMISTRY':
                dic2[d][0] = 'INVESTIGATION CHARGES'
            if d > 1 and dic2[d][0] == 'BLOOD BANK' and dic2[d - 1][2].__contains__('Total') and 'Total' not in \
                    dic2[d - 2][2] and 'Total' not in dic2[d - 2][3]:
                dic2[d][0] = 'Blood Bank'
            if dic2[d][4] == 'W H' or dic2[d][4] == '-. .' or dic2[d][4] == 'W N' or dic2[d][4] == ' H W':
                print('removeee')
                dic2[d][4] = ' '
            if dic2[d][0] != ' ' and len(re.findall('^\d+\.?\s', dic2[d][0])) == 1 and len(dic2[d][0].split()[0]) <= 3:
                # print('to remove sno and brackets')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
                dic2[d][0] = dic2[d][0].strip()
            if dic2[d][1] != ' ' and dic2[d][1].__contains__('Total'):
                dic2[d][2] = dic2[d][1]
                dic2[d][1] = ' '
            if d > 1 and d < len(dic2) and dic2[d][0] in src_dc['merge_set'].split(',') and dic2[d - 1][2].__contains__(
                    'Total'):
                print('d in merge_set and d-1 total')
                dic2[d - 1][2] = dic2[d - 1][2].replace('Total', 'SUBTOTAL')
            for i in src_dc['merge_set'].split(','):
                if d > 1 and i in dic2[d][0] and dic2[d - 1][2].__contains__('Tota') and len(
                        dic2[d][0].split()) >= 2 and dic2[d].count(' ') != 5:
                    print('if subhead and line merged')
                    listnw = [i, ' ', ' ', ' ', ' ', ' ']
                    dic2[d][0] = dic2[d][0].replace(i, '')
                    dic1[lq] = dic2[d]
                    dic1[lq - 1] = dic2[d]
                    lq += 1
                    dic1[lq - 1] = listnw
            if dic2[d][2] != ' ' and dic2[d][3] != ' ' and dic2[d][2] == dic2[d][3]:
                dic2[d][3] = ' '
            if dic2[d][5] != ' ' and dic2[d][4] != ' ' and dic2[d][4] == dic2[d][5]:
                dic2[d][4] = ' '
            if dic2[d][5] != ' ' and dic2[d][4] != ' ' and dic2[d][5] in dic2[d][4]:
                print('if amt in 4th indx')
                dic2[d][4] = dic2[d][4].replace(dic2[d][5], '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'rainbow1':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][2] in head_list:
                dic2[d][0] = dic2[d][2]
                dic2[d][2] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'rainbow_daycare':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if d == 1 and dic2[d][0] != 'Head':
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = ['Head', ' ', ' ', ' ', ' ', ' ']
            if dic2[d][0].__contains__('Procedure') and len(re.findall('^\d+\s?\w{2}\s\w{9}', dic2[d][0])) == 1:
                print('for 1st and wnd Procedure in 0th indx ie parti and procedure in 0th indx')
                text = dic2[d][0]
                matchprocedure = re.search(r'^\d+\s?\w{2}\s\w{9}', text)
                dic2[d][0] = matchprocedure.group()
                dic2[d][1] = text.replace(matchprocedure.group(), '')
                dic2[d][1] = dic2[d][1].strip()

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'metro':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if len(re.findall('\d\.\d', dic2[d][3])) == 1 and len(dic2[d][3].split()) == 1:
                print('if rate in empty expiry section', dic2[d])
                dic2[d][4] = dic2[d][3]
                dic2[d][3] = ' '
            if dic2[d][0] != ' ' and (len(re.findall('\d{2}\/\w{3}\/\d{4}\s', dic2[d][0])) == 1 or len(
                    re.findall('\d\/\w{3}\/\d{4}\s', dic2[d][0])) == 1) and len(dic2[d][0].split()) >= 2:
                print('date parti together in 0yh index', dic2[d])
                text = dic2[d][0]
                if len(re.findall('\d{2}\/\w{3}\/\d{4}\s', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\/\w{3}\/\d{4}\s', text)
                elif len(re.findall('\d\/\w{3}\/\d{4}\s', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d\/\w{3}\/\d{4}\s', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')
            if dic2[d][0] != ' ' and (len(re.findall('\d+\-\d+\-\d+\s', dic2[d][0])) == 1 or len(
                    re.findall('\d\/\w{3}\/\d{4}\s', dic2[d][0])) == 1) and len(dic2[d][0].split()) >= 2:
                print('date parti together in 0yh index', dic2[d])
                text = dic2[d][0]
                if len(re.findall('\d+\-\d+\-\d+\s', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d+\-\d+\-\d+\s', text)
                elif len(re.findall('\d\/\w{3}\/\d{4}\s', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d\/\w{3}\/\d{4}\s', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')
            if (len(re.findall('\d{2}\.\d{2}', dic2[d][2])) == 1 or len(
                    re.findall('\d{3}\.\d{2}', dic2[d][2])) == 1 or len(
                re.findall('\d{3}\.\d{1}', dic2[d][2])) == 1) and len(dic2[d][2].split()) >= 2:
                print('rate in batch section', dic2[d])
                text = dic2[d][2]
                if len(re.findall('\d{3}\.\d{2}', dic2[d][2])) == 1:
                    matchrate = re.search(r'\d{3}\.\d{2}', text)
                elif len(re.findall('\d{3}\.\d{1}', dic2[d][2])) == 1:
                    matchrate = re.search(r'\d{3}\.\d{1}', text)
                elif len(re.findall('\d{2}\.\d{2}', dic2[d][2])) == 1:
                    matchrate = re.search(r'\d{2}\.\d{2}', text)
                dic2[d][4] = matchrate.group()
                dic2[d][2] = text.replace(matchrate.group(), '')
            if (len(re.findall('\d{2}\.\d{2}', dic2[d][3])) == 1 or len(
                    re.findall('\d{3}\.\d{2}', dic2[d][3])) == 1 or len(
                re.findall('\d{3}\.\d{1}', dic2[d][3])) == 1) and len(dic2[d][3].split()) >= 2:
                print('rate in expriy section', dic2[d])
                text = dic2[d][3]
                if len(re.findall('\d{3}\.\d{2}', dic2[d][3])) == 1:
                    matchrate = re.search(r'\d{3}\.\d{2}', text)
                elif len(re.findall('\d{3}\.\d{1}', dic2[d][3])) == 1:
                    matchrate = re.search(r'\d{3}\.\d{1}', text)
                elif len(re.findall('\d{2}\.\d{2}', dic2[d][3])) == 1:
                    matchrate = re.search(r'\d{2}\.\d{2}', text)
                dic2[d][4] = matchrate.group()
                dic2[d][3] = text.replace(matchrate.group(), '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'mazumdarbangalore':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if d>1 and d<len(dic2) and len(re.findall('\d\-\d{2}\-\d{4}', dic2[d][1])) == 1  and (len(re.findall('\d\-\d{2}\-\d{4}', dic2[d-1][1])) == 1 or len(re.findall('\d\s\d{2}\-\d{4}', dic2[d-1][1])) == 1) and \
                    (len(re.findall('\d\.\d', dic2[d-1][4])) == 1 or len(re.findall('\d\s\d', dic2[d-1][4])) == 1) and (len(re.findall('\d\.\d', dic2[d-1][5])) == 1 or len(re.findall('\d\.\d{3}\.\d', dic2[d-1][5])) == 1) and dic2[d].count(' ')==5 and dic2[d-1].count(' ')<=4:
                print('for date in 1st index with empty spaces in its list')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if len(dic2[d][2].split()) == 3 and len(re.findall('\d\s\d{2}\,\d{3}\.\d{2}\s\d{2}\,\d{3}\.\d{2}', dic2[d][2])) == 1 and dic2[d][3] == ' ' and dic2[d][4] == ' ':
                print('for 220100575941 1 11,526.00 10,142.88')
                a,b,c = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = b
                dic2[d][4] = c
            if len(dic2[d][4].split()) == 2 and dic2[d][5] == ' ' and len(re.findall('\d\.\d', dic2[d][4])) == 2:
                print('if rate and amount together')
                a,b = dic2[d][4].split()
                dic2[d][4] = a
                dic2[d][5] = b
            if dic2[d][0] == 'Patient Name : Mr Ganeshan D. (10010000120025)' and dic2[d][1] == 'Bill No':
                dic2[d][0] = ' '
                dic2[d][1] = ' '
                dic2[d][2] = ' '

            if dic2[d][3]!= ' ':
                # print('for removing MRP')
                dic2[d][3] = ' '

            dic1[lq]=dic2[d]
            lq +=1
    if hospital == 'Narayana_N14358':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if dic2[d][5].__contains__('Tota'):
                dic2[d][5]=' '
            if dic2[d][5]!=' ' and dic2[d].count(' ')==5:
                dic2[d][5]=' '
            if dic2[d][0] == '1.':
                dic2[d][0] = ' '
            if len(re.findall('^\d{1,}\.?\s',dic2[d][0]))==1 and dic2[d].count(' ')<=3:
                print('removing sno', dic2[d])
                dic2[d][0]=re.sub('^\d{1,}\.?\s','',dic2[d][0])
            if len(dic2[d][4].split())>=2:
                print('splitingg',dic2[d])
                text=dic2[d][4].split()
                dic2[d][4]=text[0]
                dic2[d][5]=text[1]
            if len(dic2[d][5].split())>=2:
                print('splitingg',dic2[d])
                text=dic2[d][5].split()
                dic2[d][5]=text[0]
                #dic2[d][5]=text[1]
            if dic2[d][0].__contains__('Consultation') and dic2[d][5]!=' ' and dic2[d][4]!=' ':
                dic2[d+1][1] = dic2[d][1]
                dic2[d + 1][4] = dic2[d][4]
                dic2[d + 1][5] = dic2[d][5]
                dic2[d][1]=' '
                dic2[d][4]=' '
                dic2[d][5]=' '
            if len(dic2[d][2].split()) == 4 and dic2[d][4] == ' ' and dic2[d][5] == ' ':
                print('if qty Mrp and rate and amount together')
                # a,b,c,d = dic2[d][3].split()
                text = dic2[d][2]
                dic2[d][2] = text.split()[0]
                dic2[d][3] = text.split()[1]
                dic2[d][4] = text.split()[2]
                dic2[d][5] = text.split()[3]
            # if len(dic2[d][3].split())<=3:
            #     print('splitingg',dic2[d])
            #     a,b,c=dic2[d][3].split()
            #     dic2[d][3]=a
            #     dic2[d][4]=b
            #     dic2[d][5]=c
            # if len(dic2[d][2].split())==4:
            #     print('splitingg',dic2[d])
            #     a,b,c,d=dic2[d][2].split()
            #     dic2[d][2]=a
            #     dic2[d][3]=b
            #     dic2[d][4]=c
            #     dic2[d][5]=d
            if len(re.findall('\d{1,2}\-\d+\-\d{4}', dic2[d][0])) == 1 and dic2[d][1]==' ' and len(dic2[d][0].split()[0])>=2  and dic2[d][0] not in head_list:
                print('if Date and particulars together',dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\d{1,2}\-\d+\-\d{4}',text)
                dic2[d][1] = matchcode.group()
                dic2[d][0] = text.replace(matchcode.group(), '')
            dic1[lq] = dic2[d]
            lq +=1
    if hospital=='Breach':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if dic2[d][0] == 'DELIVERY CHARGES' and len(re.findall('\d\/\d{2}\/\d{2}', dic2[d][2])) == 1 and len(re.findall('\d\.\d', dic2[d][5])) == 1:
                dic2[d][0] = 'DELIVERY CHARGESS'
            if dic2[d][0]!=' ' and (len(re.findall('\d', dic2[d][0].split()[0])) == 1 or len(re.findall('\d{2}', dic2[d][0].split()[0])) == 1):
                a = dic2[d][0].split()[0]
                if dic2[d][0].replace(a,'').replace(' ','',1) in head_list:
                    print('removing serial number together with parti', dic2[d])
                    dic2[d][0] = dic2[d][0].replace(a,'').replace(' ','',1)
            if len(dic2[d][2].split()) == 3 and len(re.findall('\d\/\d{2}\/\d{2}', dic2[d][2])) == 1 and (len(re.findall('\d\.\d', dic2[d][2])) == 1 or len(re.findall('\d\.\d', dic2[d][2])) == 2):
                print('if date qty rate together',dic2[d])
                a,b,c = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = b
                dic2[d][4] = c
            if len(dic2[d][3].split()) == 2 and len(re.findall('\d\.\d', dic2[d][3])) == 1:
                print('for qty rate togther in 3rd index')
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if len(dic2[d][2].split()) == 2 and len(re.findall('\d\/\d{2}\/\d{2}', dic2[d][2])) == 1 and len(re.findall('\s\d', dic2[d][2])) == 1:
                print('for date qty togther in 2nd index')
                a, b = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = b



            dic1[lq]=dic2[d]
            lq +=1
    if hospital == 'Bellevue':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] == 'M.R.':
                dic2[d][0] = 'M.R.I'
            if d <= 2 and len(re.findall('\d\/\d{2}\/\d{4}\s\d', dic2[d][3])) == 1 and dic2[d].count(' ') <= 6:
                print('removing 1st line ')
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ', ' ']
            if dic2[d][1] == '- - -':
                dic2[d][1] = ' '
            if dic2[d][2] == '- - -':
                dic2[d][2] = ' '
            if dic2[d][0] == '- - -':
                dic2[d][0] = ' '
            if dic2[d][6].__contains__('- - - -'):
                dic2[d][6] = ' '
            if dic2[d][3].__contains__('Donate Organs') or dic2[d][3].__contains__('TORT CF HET'):
                dic2[d][3] = ' '
            if dic2[d][4].__contains__('- - -') or dic2[d][4].__contains__('For BELLE VUE CLINIC'):
                dic2[d][4] = ' '
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1].count(' ') >= 4 and dic2[d].count(' ') > 5:
                print('for removing extra values before Header')
                dic2[d - 1][3] = ' '
            if d > 1 and d < len(dic2) and dic2[d][3] == 'UNILATERAL (EXCLUDING IMPLANTS) (Sput)' and len(
                    re.findall('\d\.\d', dic2[d][6])):
                dic2[d][3] = ' '
            if dic2[d][3].__contains__('PHARMACY (ISSUES)') or dic2[d][3].__contains__('RETURNS'):
                dic2[d][6] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Bellevue-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] == 'ales':
                dic2[d][0] = 'Sales'
            if dic2[d][0] == 'OT PHARMACY 2020' or dic2[d][0] == 'OT PHARMACY 2021' or dic2[d][0].__contains__(
                    'OT PHARMACY'):
                dic2[d][0] = 'OT PHARMACY'
            if dic2[d][5] == 'BILL TOTAL' and len(re.findall('\d\.\d', dic2[d][7])) == 1:
                print('removing bill total and its value')
                dic2[d][5] = ' '
                dic2[d][7] = ' '
            if dic2[d][0] == 'Sales':
                dic2[d][0] = 'Pharmacy'
            if dic2[d][0] == 'Sales Returns' or dic2[d][0] == 'ales Returns':
                dic2[d][0] = 'Pharmacy Returns'
            if len(dic2[d][5].split()) == 2 and len(re.findall('\d\.\d', dic2[d][5])) == 1 and dic2[d][6] == ' ':
                print('if qty rate togethr in 5 th index')
                a, b = dic2[d][5].split()
                dic2[d][5] = a
                dic2[d][6] = b

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'star':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            # print(dic2)

            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'kailash_backup':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] == 'Investigations &, Imaging' or dic2[d][0] == 'vestigations & Imaging':
                dic2[d][0] = 'Investigations & Imaging'
            if dic2[d][0] == 'mplant Charges':
                dic2[d][0] = 'Implant Charges'
            if dic2[d][0] == 'Rackages Charges' or dic2[d][0] == 'ackages Charges':
                dic2[d][0] = 'Packages Charges'
            if dic2[d][0] == 'Hargiac Consumable':
                dic2[d][0] = 'Cardiac Consumable'
            if dic2[d][5].__contains__('Page'):
                dic2[d][5] = ' '
            if dic2[d][3] != ' ' and dic2[d][4] != ' ' and len(re.findall('\d\.\d', dic2[d][3])) == 2 and dic2[d][4] in \
                    dic2[d][3] and len(dic2[d][3].split()) == 2:
                # print('if rate qty in 3rd indx and rate in 4th indx')
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if dic2[d][3] != ' ' and dic2[d][4] == ' ' and len(re.findall('\d\.\d', dic2[d][3])) >= 2 and len(
                    dic2[d][3].split()) == 2:
                # print('if rate qty in 3rd indx and 4th indx empty')
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if dic2[d][2] == ' ' and len(dic2[d][0].split()) >= 3 and (len(
                    re.findall('\d\/\w{3}\/\d{3}', dic2[d][0])) == 1 or len(
                re.findall('\d\/\w{3}\s?\d{3}', dic2[d][0])) == 1) and dic2[d][0].__contains__('('):
                print('if date code parti together')
                text = dic2[d][0]
                if len(re.findall('\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\:\D{2}\d{2}\-\d{3}\D\)', dic2[d][0])) == 1:
                    matchdatecode = re.search(r'\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\:\D{2}\d{2}\-\d{3}\D\)', text)
                elif len(re.findall('\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\s\D{2}\:\D{2}\d{2}\-\d{3}\D\)',
                                    dic2[d][0])) == 1:
                    matchdatecode = re.search(r'\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\s\D{2}\:\D{2}\d{2}\-\d{3}\D\)',
                                              text)
                elif len(re.findall('\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\:\D{5}\-\d{4}\-\d{2}', dic2[d][0])) == 1:
                    matchdatecode = re.search(r'\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\:\D{5}\-\d{4}\-\d{2}', text)
                elif len(re.findall('\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\:\D{2}\d{2}\-\d{4}\D\)',
                                    dic2[d][0])) == 1:
                    matchdatecode = re.search(r'\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\:\D{2}\d{2}\-\d{4}\D\)', text)
                elif len(re.findall('\d?\s?\d{2}\/\w{3}\/\d{4}\/\(\D{3}\.\s\D{2}\:\/\D{4}\-\d{4}\-\d{2}',
                                    dic2[d][0])) == 1:
                    matchdatecode = re.search(r'\d?\s?\d{2}\/\w{3}\/\d{4}\/\(\D{3}\.\s\D{2}\:\/\D{4}\-\d{4}\-\d{2}',
                                              text)
                elif len(re.findall('\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\:\D{2}\d{2}\-\d{4}', dic2[d][0])) == 1:
                    matchdatecode = re.search(r'\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\:\D{2}\d{2}\-\d{4}', text)
                elif len(re.findall('\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\:\D{5}\-\d{4}\-\d{2}', dic2[d][0])) == 1:
                    matchdatecode = re.search(r'\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\:\D{5}\-\d{4}\-\d{2}', text)
                elif len(re.findall('\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\s\D{2}\:\D{5}\-\d{4}\-\d{2}',
                                    dic2[d][0])) == 1:
                    matchdatecode = re.search(r'\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\s\D{2}\:\D{5}\-\d{4}\-\d{2}', text)
                elif len(re.findall('\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\s\D{2}\:\D{2}\d{2}\-\d{4}\D\)',
                                    dic2[d][0])) == 1:
                    matchdatecode = re.search(r'\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\s\D{2}\:\D{2}\d{2}\-\d{4}\D\)',
                                              text)
                elif len(re.findall('\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\.\D{2}\d{2}\-\d{4}\D\)',
                                    dic2[d][0])) == 1:
                    matchdatecode = re.search(r'\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\.\D{2}\d{2}\-\d{4}\D\)', text)
                elif len(re.findall('\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\:\D{5}\-\d{3}\)\-\d{3}\D{4}',
                                    dic2[d][0])) == 1:
                    matchdatecode = re.search(r'\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\:\D{5}\-\d{3}\)\-\d{3}\D{4}',
                                              text)
                elif len(re.findall('\d?\s?\d+\/\w+\/\d+\s?\(?\D+\.\D+\:\D+\s\D+', dic2[d][0])) == 1:
                    matchdatecode = re.search(r'\d?\s?\d+\/\w+\/\d+\s?\(?\D+\.\D+\:\D+\s\D+', text)
                elif len(re.findall('\d?\s?\d+\/\w+\/\d+\s?\(?\D+\.\D+\:\D+\d+\/\D+\d+\-\d+\D', dic2[d][0])) == 1:
                    matchdatecode = re.search(r'\d?\s?\d+\/\w+\/\d+\s?\(?\D+\.\D+\:\D+\d+\/\D+\d+\-\d+\D', text)
                elif len(re.findall('\D?\s?\D?\s\d+\/\w+\/\d+\s?\(?\D+\.\D+\:\D+\d+\-\d+\)?', dic2[d][0])) == 1:
                    matchdatecode = re.search(r'\D?\s?\D?\s\d+\/\w+\/\d+\s?\(?\D+\.\D+\:\D+\d+\-\d+\)?', text)
                elif len(re.findall('\d\s?\d+\/\w+\s?\d+\s?\(?\D+\.\D+\:\D+\d+\-\d+\)?', dic2[d][0])) == 1:
                    matchdatecode = re.search(r'\d\s?\d+\/\w+\s?\d+\s?\(?\D+\.\D+\:\D+\d+\-\d+\)?', text)
                elif len(re.findall('\d+\/\w+\/\d+\s?\(?\D+\.\D+\:\D+\d+\-\d+\)?', dic2[d][0])) == 1:
                    matchdatecode = re.search(r'\d+\/\w+\/\d+\s?\(?\D+\.\D+\:\D+\d+\-\d+\)?', text)
                elif len(re.findall('\d+\/\w+\/\d+\s?\(?\D+\.\D+\:\D+\)', dic2[d][0])) == 1:
                    matchdatecode = re.search(r'\d+\/\w+\/\d+\s?\(?\D+\.\D+\:\D+\)', text)
                dic2[d][0] = matchdatecode.group()
                dic2[d][2] = text.replace(matchdatecode.group(), '')
            if dic2[d][2] == ' ' and len(dic2[d][1].split()) >= 2 and len(
                    re.findall('\d\/\w{3}\/\d{3}', dic2[d][0])) == 1 and (
                    len(re.findall('\(\D{3}\.\D{2}\:', dic2[d][1])) == 1 or len(
                re.findall('\(\D{3}\.\s\D{2}\:', dic2[d][1])) == 1):
                print('if code parti together')
                text = dic2[d][1]
                if len(re.findall('\(\D{3}\.\s?\D{2}\:\D{5}\-\d{4}\-\d{2}', dic2[d][1])) == 1:
                    matchcode = re.search(r'\(\D{3}\.\s?\D{2}\:\D{5}\-\d{4}\-\d{2}', text)
                elif len(re.findall('\(\D{3}\.\D{2}\:\D{2}\s\D{3}\s\D{4}', dic2[d][1])) == 1:
                    matchcode = re.search(r'\(\D{3}\.\D{2}\:\D{2}\s\D{3}\s\D{4}', text)
                elif len(re.findall('\(\D{3}\.\s\D{2}\:\D{2}\s\D{3}\s\D{4}', dic2[d][1])) == 1:
                    matchcode = re.search(r'\(\D{3}\.\s\D{2}\:\D{2}\s\D{3}\s\D{4}', text)
                elif len(re.findall('\(\D{3}\.\s\D{2}\:\D{2}\d{2}\-\d{3}', dic2[d][1])) == 1:
                    matchcode = re.search(r'\(\D{3}\.\s\D{2}\:\D{2}\d{2}\-\d{3}', text)
                elif len(re.findall('\(\D{3}\.\D{2}\:\D{2}\d{2}\-\d{4}\D\)', dic2[d][1])) == 1:
                    matchcode = re.search(r'\(\D{3}\.\D{2}\:\D{2}\d{2}\-\d{4}\D\)', text)
                elif len(re.findall('\(\D{3}\.\s\D{2}\:\/\D{4}\-\d{4}\-\d{2}\D{5}\-', dic2[d][1])) == 1:
                    matchcode = re.search(r'\(\D{3}\.\s\D{2}\:\/\D{4}\-\d{4}\-\d{2}\D{5}\-', text)
                elif len(re.findall('\(\D{3}\.\s\D{2}\:\D{4}\/\-\d{4}\-\d{2}\D{5}\-', dic2[d][1])) == 1:
                    matchcode = re.search(r'\(\D{3}\.\s\D{2}\:\D{4}\/\-\d{4}\-\d{2}\D{5}\-', text)
                elif len(re.findall('\(\D{3}\.\s\D{2}\:\D{5}\-\d{4}\-\d{3}\D{4}\-', dic2[d][1])) == 1:
                    matchcode = re.search(r'\(\D{3}\.\s\D{2}\:\D{5}\-\d{4}\-\d{3}\D{4}\-', text)
                elif len(re.findall('\(\D+\.\s?\D+\:\D+\d+\-\d+\D+\)\s', dic2[d][1])) == 1:
                    matchcode = re.search(r'\(\D+\.\s?\D+\:\D+\d+\-\d+\D+\)\s', text)
                elif len(re.findall('\(\D+\.\s\D+\:\D\d+\/\D+\d+\-\d+\D\s', dic2[d][1])) == 1:
                    matchcode = re.search(r'\(\D+\.\s\D+\:\D\d+\/\D+\d+\-\d+\D\s', text)
                dic2[d][1] = matchcode.group()
                dic2[d][2] = text.replace(matchcode.group(), '')
            if dic2[d][3] != ' ' and dic2[d][4] != ' ' and len(dic2[d][3].split()) >= 2 and len(
                    re.findall('\d\.\d', dic2[d][3])) >= 2 and \
                    dic2[d][3].split()[-1] == dic2[d][4]:
                print('if Rate, QTy in 3rd indx and Qty in 4th indx')
                text = dic2[d][3].split()
                dic2[d][3] = dic2[d][3].replace(dic2[d][3].split()[-1], '')
                dic2[d][3] = dic2[d][3].strip()

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'kailash':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] == 'Investigations &, Imaging' or dic2[d][0] == 'vestigations & Imaging' or dic2[d][
                0] == 'investigations & Imaging' or dic2[d][0] == 'tuvestigations & Imaging':
                dic2[d][0] = 'Investigations & Imaging'
            if dic2[d][5].__contains__('Page'):
                dic2[d][5] = ' '
            if dic2[d][0] == '1 0':
                dic2[d][0] = ' '
            if dic2[d][0] == '12/Nov/2022 (Sch.No:*':
                dic2[d][0] = '12/Nov/2022'
            if dic2[d][3] != ' ' and dic2[d][4] != ' ' and len(re.findall('\d\.\d', dic2[d][3])) == 2 and dic2[d][4] in \
                    dic2[d][3] and len(dic2[d][3].split()) == 2:
                # print('if rate qty in 3rd indx and rate in 4th indx')
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if dic2[d][3] != ' ' and dic2[d][4] == ' ' and len(re.findall('\d\.\d', dic2[d][3])) >= 2 and len(
                    dic2[d][3].split()) == 2:
                # print('if rate qty in 3rd indx and 4th indx empty')
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if dic2[d][1] == '(Sch.No:KS22-3262 ) LEUKO DEPLETED PRBC (BY BUFFY COAT) (Mandatory':
                dic2[d][0] = dic2[d-1][0]
                dic2[d-1][0] = ' '
                dic2[d][1] = '(Sch.No:KS22-3262 )'
                dic2[d][2] = 'LEUKO DEPLETED PRBC (BY BUFFY COAT) (Mandatory'
            if dic2[d][0] == '29/Oct/2022 to 29/Oct/2022 (Sch.No:KS22-32PRBC (PACKED RED BLOOD CELL) (Mandatory Replacement':
                dic2[d][0] = '29/Oct/2022 to 29/Oct/2022'
                dic2[d][1] = '(Sch.No:KS22-32PRBC'
                dic2[d][2] = '(PACKED RED BLOOD CELL) (Mandatory Replacement'
            if dic2[d][0] == '2 08/Nov/2022 (Sch. No:P58/KR08-46520% Extra Charges of X-ray (10PM to 6AM)':
                dic2[d][0] = '2 08/Nov/2022'
                dic2[d][1] = '(Sch. No:P58/KR08-46520%'
                dic2[d][2] = 'Extra Charges of X-ray (10PM to 6AM)'
            if dic2[d][0] != ' ' and '(Sch' in dic2[d][0] and dic2[d][1]==' ' and dic2[d][2]!=' ' and ')' in dic2[d][0]:
                print('if date, code in 0th indx')
                text = dic2[d][0]
                start_point = '('
                end_point = ')'
                start_index = dic2[d][0].find(start_point) + len(start_point)
                print('startindx', start_index)
                end_index = dic2[d][0].find(end_point)
                print('startindx', end_index)
                words_between = dic2[d][0][start_index-1:end_index+1]
                print('words_between', words_between)
                dic2[d][1] = words_between
                dic2[d][0] = dic2[d][0].replace(words_between,'').strip()
            if (dic2[d][0] != ' ' or dic2[d][0]==' ') and '(Sch' in dic2[d][1] and dic2[d][1]!=' ' and dic2[d][2]==' ' and ')' in dic2[d][1]:
                print('if  code, parti in 1st indx')
                text = dic2[d][1]
                start_point = '('
                end_point = ')'
                start_index = dic2[d][1].find(start_point) + len(start_point)
                print('startindx', start_index)
                end_index = dic2[d][1].find(end_point)
                print('startindx', end_index)
                words_between = dic2[d][1][start_index-1:end_index+1]
                print('words_between', words_between)
                dic2[d][1] = words_between
                dic2[d][2] = text.replace(words_between,'').strip()
            if dic2[d][0] != ' ' and '(Sch' in dic2[d][0] and dic2[d][1]==' ' and dic2[d][2]==' ' and ')' in dic2[d][0]:
                print('if date code parti in 0th indx')
                text = dic2[d][0]
                start_point = '('
                end_point = ')'
                start_index = dic2[d][0].find(start_point) + len(start_point)
                print('startindx', start_index)
                end_index = dic2[d][0].find(end_point)
                print('startindx', end_index)
                words_between = dic2[d][0][start_index-1:end_index+1]
                print('words_between', words_between)
                dic2[d][1] = words_between
                if len(re.findall('^\d+?\s?\d+\/\D+\/\d+', dic2[d][0])) == 1:
                    matchdate = re.search(r'^\d+?\s?\d+\/\D+\/\d+',text)
                dic2[d][0] = matchdate.group()
                dic2[d][2] = text.replace(words_between,'').replace(dic2[d][0],'').strip()
            if dic2[d][0] != ' ' and '(Sch' in dic2[d][0] and dic2[d][1]==' ' and dic2[d][2]==' ' and 'govt' in dic2[d][0]:
                print('if date code parti in 0th indx with govt')
                text = dic2[d][0]
                start_point = '('
                end_point = 'ovt.'
                start_index = dic2[d][0].find(start_point) + len(start_point)
                print('startindx', start_index)
                end_index = dic2[d][0].find(end_point)
                print('startindx', end_index)
                words_between = dic2[d][0][start_index-1:end_index+4]
                print('words_between', words_between)
                dic2[d][1] = words_between
                if len(re.findall('^\d+?\s?\d+\/\D+\/\d+', dic2[d][0])) == 1:
                    matchdate = re.search(r'^\d+?\s?\d+\/\D+\/\d+',text)
                dic2[d][0] = matchdate.group()
                dic2[d][2] = text.replace(words_between,'').replace(dic2[d][0],'').strip()
            if dic2[d][0]!=' ' and dic2[d][1]==' ' and dic2[d][2]!=' ' and ('(' not in dic2[d][0] or ')' not in dic2[d][0]) and len(dic2[d][0].split())>=3 and 'Sch' in dic2[d][0]:
                print('if date code in 0th indx with as per govt')
                text = dic2[d][0]
                if len(re.findall('^\d+?\s?\d+\/\D+\/\d+', dic2[d][0])) == 1:
                    matchdate = re.search(r'^\d+?\s?\d+\/\D+\/\d+',text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(),'').strip()
            # if dic2[d][2] == ' ' and len(dic2[d][0].split()) >= 4 and (len(
            #         re.findall('\d\/\w{3}\/\d{3}', dic2[d][0])) == 1 or len(
            #     re.findall('\d\/\w{3}\s?\d{3}', dic2[d][0])) == 1) and dic2[d][0].__contains__('('):
            #     print('if date code parti together')
            #     text = dic2[d][0]
            #     if len(re.findall('\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\:\D{2}\d{2}\-\d{3}\D\)', dic2[d][0])) == 1:
            #         matchdatecode = re.search(r'\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\:\D{2}\d{2}\-\d{3}\D\)', text)
            #     elif len(re.findall('\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\s\D{2}\:\D{2}\d{2}\-\d{3}\D\)',
            #                         dic2[d][0])) == 1:
            #         matchdatecode = re.search(r'\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\s\D{2}\:\D{2}\d{2}\-\d{3}\D\)',
            #                                   text)
            #     elif len(re.findall('\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\:\D{5}\-\d{4}\-\d{2}', dic2[d][0])) == 1:
            #         matchdatecode = re.search(r'\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\:\D{5}\-\d{4}\-\d{2}', text)
            #     elif len(re.findall('\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\:\D{2}\d{2}\-\d{4}\D\)',
            #                         dic2[d][0])) == 1:
            #         matchdatecode = re.search(r'\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\:\D{2}\d{2}\-\d{4}\D\)', text)
            #     elif len(re.findall('\d?\s?\d{2}\/\w{3}\/\d{4}\/\(\D{3}\.\s\D{2}\:\/\D{4}\-\d{4}\-\d{2}',
            #                         dic2[d][0])) == 1:
            #         matchdatecode = re.search(r'\d?\s?\d{2}\/\w{3}\/\d{4}\/\(\D{3}\.\s\D{2}\:\/\D{4}\-\d{4}\-\d{2}',
            #                                   text)
            #     elif len(re.findall('\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\:\D{2}\d{2}\-\d{4}', dic2[d][0])) == 1:
            #         matchdatecode = re.search(r'\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\:\D{2}\d{2}\-\d{4}', text)
            #     elif len(re.findall('\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\:\D{5}\-\d{4}\-\d{2}', dic2[d][0])) == 1:
            #         matchdatecode = re.search(r'\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\:\D{5}\-\d{4}\-\d{2}', text)
            #     elif len(re.findall('\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\s\D{2}\:\D{5}\-\d{4}\-\d{2}',
            #                         dic2[d][0])) == 1:
            #         matchdatecode = re.search(r'\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\s\D{2}\:\D{5}\-\d{4}\-\d{2}', text)
            #     elif len(re.findall('\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\s\D{2}\:\D{2}\d{2}\-\d{4}\D\)',
            #                         dic2[d][0])) == 1:
            #         matchdatecode = re.search(r'\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\s\D{2}\:\D{2}\d{2}\-\d{4}\D\)',
            #                                   text)
            #     elif len(re.findall('\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\.\D{2}\d{2}\-\d{4}\D\)',
            #                         dic2[d][0])) == 1:
            #         matchdatecode = re.search(r'\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\.\D{2}\d{2}\-\d{4}\D\)', text)
            #     elif len(re.findall('\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\:\D{5}\-\d{3}\)\-\d{3}\D{4}',
            #                         dic2[d][0])) == 1:
            #         matchdatecode = re.search(r'\d?\s?\d{2}\/\w{3}\/\d{4}\s\(\D{3}\.\D{2}\:\D{5}\-\d{3}\)\-\d{3}\D{4}',
            #                                   text)
            #     elif len(re.findall('\d?\s?\d+\/\w+\/\d+\s?\(?\D+\.\D+\:\D+\s\D+', dic2[d][0])) == 1:
            #         matchdatecode = re.search(r'\d?\s?\d+\/\w+\/\d+\s?\(?\D+\.\D+\:\D+\s\D+', text)
            #     elif len(re.findall('\d?\s?\d+\/\w+\/\d+\s?\(?\D+\.\D+\:\D+\d+\/\D+\d+\-\d+\D', dic2[d][0])) == 1:
            #         matchdatecode = re.search(r'\d?\s?\d+\/\w+\/\d+\s?\(?\D+\.\D+\:\D+\d+\/\D+\d+\-\d+\D', text)
            #     elif len(re.findall('\D?\s?\D?\s\d+\/\w+\/\d+\s?\(?\D+\.\D+\:\D+\d+\-\d+\)?', dic2[d][0])) == 1:
            #         matchdatecode = re.search(r'\D?\s?\D?\s\d+\/\w+\/\d+\s?\(?\D+\.\D+\:\D+\d+\-\d+\)?', text)
            #     elif len(re.findall('\d\s?\d+\/\w+\s?\d+\s?\(?\D+\.\D+\:\D+\d+\-\d+\)?', dic2[d][0])) == 1:
            #         matchdatecode = re.search(r'\d\s?\d+\/\w+\s?\d+\s?\(?\D+\.\D+\:\D+\d+\-\d+\)?', text)
            #     elif len(re.findall('\d+\/\w+\/\d+\s?\(?\D+\.\D+\:\D+\d+\-\d+\)?', dic2[d][0])) == 1:
            #         matchdatecode = re.search(r'\d+\/\w+\/\d+\s?\(?\D+\.\D+\:\D+\d+\-\d+\)?', text)
            #     elif len(re.findall('\d+\/\w+\/\d+\s?\(?\D+\.\D+\:\D+\)', dic2[d][0])) == 1:
            #         matchdatecode = re.search(r'\d+\/\w+\/\d+\s?\(?\D+\.\D+\:\D+\)', text)
            #     dic2[d][0] = matchdatecode.group()
            #     dic2[d][2] = text.replace(matchdatecode.group(), '')
            # if dic2[d][2] == ' ' and len(dic2[d][1].split()) >= 2 and len(
            #         re.findall('\d\/\w{3}\/\d{3}', dic2[d][0])) == 1 and (
            #         len(re.findall('\(\D{3}\.\D{2}\:', dic2[d][1])) == 1 or len(
            #     re.findall('\(\D{3}\.\s\D{2}\:', dic2[d][1])) == 1):
            #     print('if code parti together')
            #     text = dic2[d][1]
            #     if len(re.findall('\(\D{3}\.\s?\D{2}\:\D{5}\-\d{4}\-\d{2}', dic2[d][1])) == 1:
            #         matchcode = re.search(r'\(\D{3}\.\s?\D{2}\:\D{5}\-\d{4}\-\d{2}', text)
            #     elif len(re.findall('\(\D{3}\.\D{2}\:\D{2}\s\D{3}\s\D{4}', dic2[d][1])) == 1:
            #         matchcode = re.search(r'\(\D{3}\.\D{2}\:\D{2}\s\D{3}\s\D{4}', text)
            #     elif len(re.findall('\(\D{3}\.\s\D{2}\:\D{2}\s\D{3}\s\D{4}', dic2[d][1])) == 1:
            #         matchcode = re.search(r'\(\D{3}\.\s\D{2}\:\D{2}\s\D{3}\s\D{4}', text)
            #     elif len(re.findall('\(\D{3}\.\s\D{2}\:\D{2}\d{2}\-\d{3}', dic2[d][1])) == 1:
            #         matchcode = re.search(r'\(\D{3}\.\s\D{2}\:\D{2}\d{2}\-\d{3}', text)
            #     elif len(re.findall('\(\D{3}\.\D{2}\:\D{2}\d{2}\-\d{4}\D\)', dic2[d][1])) == 1:
            #         matchcode = re.search(r'\(\D{3}\.\D{2}\:\D{2}\d{2}\-\d{4}\D\)', text)
            #     elif len(re.findall('\(\D{3}\.\s\D{2}\:\/\D{4}\-\d{4}\-\d{2}\D{5}\-', dic2[d][1])) == 1:
            #         matchcode = re.search(r'\(\D{3}\.\s\D{2}\:\/\D{4}\-\d{4}\-\d{2}\D{5}\-', text)
            #     elif len(re.findall('\(\D{3}\.\s\D{2}\:\D{4}\/\-\d{4}\-\d{2}\D{5}\-', dic2[d][1])) == 1:
            #         matchcode = re.search(r'\(\D{3}\.\s\D{2}\:\D{4}\/\-\d{4}\-\d{2}\D{5}\-', text)
            #     elif len(re.findall('\(\D{3}\.\s\D{2}\:\D{5}\-\d{4}\-\d{3}\D{4}\-', dic2[d][1])) == 1:
            #         matchcode = re.search(r'\(\D{3}\.\s\D{2}\:\D{5}\-\d{4}\-\d{3}\D{4}\-', text)
            #     elif len(re.findall('\(\D+\.\s?\D+\:\D+\d+\-\d+\D+\)\s', dic2[d][1])) == 1:
            #         matchcode = re.search(r'\(\D+\.\s?\D+\:\D+\d+\-\d+\D+\)\s', text)
            #     elif len(re.findall('\(\D+\.\s\D+\:\D\d+\/\D+\d+\-\d+\D\s', dic2[d][1])) == 1:
            #         matchcode = re.search(r'\(\D+\.\s\D+\:\D\d+\/\D+\d+\-\d+\D\s', text)
            #     elif len(re.findall('\(\D+\.\s?\D+\:\D+\d+\-\d+', dic2[d][1])) == 1:
            #         matchcode = re.search(r'\(\D+\.\s?\D+\:\D+\d+\-\d+\s', text)
            #     dic2[d][1] = matchcode.group()
            #     dic2[d][2] = text.replace(matchcode.group(), '')
            if dic2[d][3] != ' ' and dic2[d][4] != ' ' and len(dic2[d][3].split()) >= 2 and len(
                    re.findall('\d\.\d', dic2[d][3])) >= 2 and \
                    dic2[d][3].split()[-1] == dic2[d][4]:
                print('if Rate, QTy in 3rd indx and Qty in 4th indx')
                text = dic2[d][3].split()
                dic2[d][3] = dic2[d][3].replace(dic2[d][3].split()[-1], '')
                dic2[d][3] = dic2[d][3].strip()

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'kailash-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if len(re.findall('\d\/\D{3}\/\d{4}', dic2[d][0])) == 1 and dic2[d].count(' ') >= 6:
                print('removing date')
                dic2[d][0] = ' '
            if len(re.findall('\d\/\d{3}', dic2[d][0])) == 1 and len(re.findall('\D\d{2}\/\d{2}', dic2[d][1])) == 1 and \
                    dic2[d].count(' ') >= 6:
                print('removing date and its code')
                dic2[d][0] = ' '
                dic2[d][1] = ' '
            if d > 1 and d < len(dic2) and len(re.findall('\D{6}\s\d\.\d\s\D{9}', dic2[d][0])) == 1 and len(
                    re.findall('\d{2}\D\d{4}\D{2}', dic2[d][2])) == 1 and len(
                    re.findall('\d{2}\.\d{2}', dic2[d][7])) == 1 and dic2[d][8] == ' ' and dic2[d].count(' ') == 2 and \
                    len(re.findall('\d{3}\.\d{2}', dic2[d - 1][8])) == 1 and dic2[d - 1].count(' ') == 8:
                print('for 220100571202 GLOVES 7.5 SURGICARE')
                dic2[d][8] = dic2[d - 1][8]
                dic2[d - 1][8] = ' '

            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'woodlands':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] == 'DOCTOR FEES -' or dic2[d][0] == 'DOCTOR FEES' or dic2[d][0] == 'DOCTOR FEES - ':
                dic2[d][0] = 'DOCTOR FEES - IP'
            if dic2[d][0] == 'DOCTOR FEES' and dic2[d][1] == 'IP':
                dic2[d][0] = 'DOCTOR FEES - IP'
            if dic2[d][0] == 'ADMISSION/ REGISTRATION FEES -':
                dic2[d][0] = 'ADMISSION/ REGISTRATION FEES - IP'
            if dic2[d][0] == 'DOCTOR FIXED SURGICAL FEES' or dic2[d][0] == 'DOCTOR FIXED SURGICAL FEES -':
                dic2[d][0] = 'DOCTOR FIXED SURGICAL FEES - IP'
            if dic2[d][0] == 'T Consumables':
                dic2[d][0] = 'OT Consumables'
            if dic2[d][0] == 'T PROCEDURE':
                dic2[d][0] = 'OT PROCEDURE'
            if dic2[d][0] == 'MEDICAL RECORDS FEES' or dic2[d][0] == 'MEDICAL RECORDS FEES -':
                dic2[d][0] = 'MEDICAL RECORDS FEES - IP'
            if dic2[d][0] == dic2[d][1]:
                dic2[d][0] = ' '
            if dic2[d][1] in dic2[d][0] and dic2[d][0] != ' ' and dic2[d][1] != ' ' and dic2[d][0] not in head_list:
                print('if date and particular are merged and 1st index not empty')
                dic2[d][0] = dic2[d][0].replace(dic2[d][1], '')
            if (dic2[d][1] == ' ' or dic2[d][1] in dic2[d][0] or dic2[d][0] in dic2[d][1]) and len(
                    re.findall('^[0-3]?[0-9].[0-3]?[0-9].(?:[0-9]{2})?[0-9]{2}', dic2[d][0])) == 1:
                print('first division of date and particulars')
                text = dic2[d][0]
                if len(re.findall('^[0-3]?[0-9].[0-3]?[0-9].(?:[0-9]{2})?[0-9]{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'^[0-3]?[0-9].[0-3]?[0-9].(?:[0-9]{2})?[0-9]{2}', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')
            if (dic2[d][1] == ' ' or dic2[d][1] in dic2[d][0] or dic2[d][0] in dic2[d][1]) and (
                    len(re.findall('\d{5}\/\d{2}', dic2[d][0])) == 1 or len(
                    re.findall('\d{4}\/\d{2}', dic2[d][0])) == 1 or len(
                    re.findall('\w{2}\/\w{2}\/\D{2}', dic2[d][0])) == 1 or \
                    len(re.findall('\w{1}\/\d{2}\/\d{2}', dic2[d][0])) == 1 or len(
                re.findall('\d{2}\/\d{2}\/\d\D', dic2[d][0])) == 1 or len(
                re.findall('\d\D\d\-\d{3}', dic2[d][0])) == 1 or len(
                re.findall('\d\s\d{2}\s\d\D', dic2[d][0])) == 1 or len(
                re.findall('\D\d\s\d{2}\/\d{2}', dic2[d][0])) == 1 or len(
                re.findall('\d{2}\/\d{2}', dic2[d][0])) == 1 or len(
                re.findall('\d{2}\s\d\.\d\/\d{2}', dic2[d][0])) == 1 or \
                    len(re.findall('\D\d\/\d{2}', dic2[d][0])) == 1 or len(
                re.findall('\d{1}\/\d{2}', dic2[d][0])) == 1) and len(dic2[d][0].split()) >= 2:
                print('second division of date and particulars')
                text = dic2[d][0]
                if len(re.findall('\w{2}\/\w{2}\/\D{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\w{2}\/\w{2}\/\D{2}', text)
                elif len(re.findall('\w{1}\/\d{2}\/\d{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\w{1}\/\d{2}\/\d{2}', text)
                elif len(re.findall('\d{2}\/\d{2}\/\d\D', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\/\d{2}\/\d\D', text)
                elif len(re.findall('\d\D\d\-\d{3}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d\D\d\-\d{3}', text)
                elif len(re.findall('\d\s\d{2}\s\d\D', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d\s\d{2}\s\d\D', text)
                elif len(re.findall('\D\d\s\d{2}\/\d{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\D\d\s\d{2}\/\d{2}', text)
                elif len(re.findall('\d{2}\s\d\.\d\/\d{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\s\d\.\d\/\d{2}', text)
                elif len(re.findall('\d{5}\/\d{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{5}\/\d{2}', text)
                elif len(re.findall('\d{4}\/\d{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{4}\/\d{2}', text)
                elif len(re.findall('\d{2}\/\d{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\/\d{2}', text)
                elif len(re.findall('\D\d\/\d{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\D\d\/\d{2}', text)
                elif len(re.findall('\d{1}\/\d{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{1}\/\d{2}', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')
            if dic2[d][2] != ' ' and dic2[d][3] != ' ' and dic2[d][3] in dic2[d][2]:
                print('if 3rd index in 2nd index')
                text = dic2[d][3]
                dic2[d][2] = dic2[d][2].replace(text, ' ')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='woodlands-pharma':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if dic2[d][1].__contains__('Non-Admissible Total'):
                dic2[d][1] = 'Subtotal'
            if d==len(dic2) and dic2[d][1] == 'Subtotal' and dic2[d-1][1] == 'Subtotal':
                print('removing extra subtotal')
                dic2[d][1] = ' '


            dic1[lq]=dic2[d]
            lq +=1
    if hospital=='aster':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if dic2[d][0] == 'ICAL SUP' or dic2[d][0] == 'AL SUPPORT SERVICES' or dic2[d][0] == 'CAL SUP' or dic2[d][0] == 'CAL SUPPORT SERVICES':
                dic2[d][0] = 'CLINICAL SUPPORT SERVICES'
            if dic2[d][0] == 'GENERAL SURG':
                dic2[d][0] = 'GENERAL SURGERY PACKAGE'
            if dic2[d][0] == 'OTHER LAB SE':
                dic2[d][0] = 'OTHER LAB SERVICES'
            if dic2[d][1] == dic2[d][2]:
                dic2[d][1] = ' '
            if dic2[d][0] == 'HARGES':
                dic2[d][0] = 'BED CHARGES'
            if (dic2[d][0] == 'PHARMACY' or dic2[d][0] == 'OT DRUGS') and dic2[d][7] == ' ':
                print('removing extra same headers')
                dic2[d][0] = ' '
            if d>1 and d<len(dic2) and dic2[d][0] in src_dc['merge_set'] and len(re.findall('\d\s?\.\s?\d', dic2[d][7])) == 1 and len(re.findall('\d\s?\.\s?\d', dic2[d-1][7])) == 0:
                print('adding last value to header if it is present in merge_set val')
                dic2[d-1][7] = dic2[d][7]
                dic2[d][7] = ' '
            if len(re.findall('\d\/\d{2}\/\d{2}\s', dic2[d][0])) == 1 and len(dic2[d][0].split()) >= 3 and dic2[d][1] == ' ' and dic2[d][2] == ' ' and len(re.findall('\D{3}\d{5}', dic2[d][0])) == 0:
                print('if date parti together in pharmacy')
                text = dic2[d][0]
                if len(re.findall('\d{2}\/\d{2}\/\d{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\/\d{2}\/\d{2}',text)
                elif len(re.findall('\d\/\d{2}\/\d{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d\/\d{2}\/\d{2}',text)
                dic2[d][0] = matchdate.group()
                dic2[d][2] = text.replace(matchdate.group(),'')
                dic2[d][2] = dic2[d][2].replace(dic2[d][2][0],'',1)
            if len(re.findall('\d\/\d{2}\/\d{2}\s', dic2[d][0])) == 1 and len(dic2[d][0].split()) >= 3 and len(re.findall('\D{3}\d{5}', dic2[d][0])) == 1 and dic2[d][1] == ' ' and dic2[d][2] == ' ':
                print('if date code parti together')
                text = dic2[d][0]
                if len(re.findall('\d{2}\/\d{2}\/\d{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\/\d{2}\/\d{2}',text)
                if len(re.findall('\D{3}\d{5}', dic2[d][0])) == 1:
                    matchcode = re.search(r'\D{3}\d{5}',text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = matchcode.group()
                dic2[d][2] = text.replace(matchdate.group(),'')
                dic2[d][2] = dic2[d][2].replace(matchcode.group(),'')
                dic2[d][2] = dic2[d][2].replace(dic2[d][2][0], '',1)
            if len(re.findall('\d\/\d{2}\/\d{2}\s', dic2[d][0])) == 1 and len(dic2[d][0].split()) == 2 and len(re.findall('\D{2}\d{2}', dic2[d][0])) == 1 and dic2[d][1] == ' ' and dic2[d][2]!=' ':
                print('if date code together')
                text = dic2[d][0]
                if len(re.findall('\d{2}\/\d{2}\/\d{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\/\d{2}\/\d{2}',text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(),'')
                dic2[d][1] = dic2[d][1].replace(dic2[d][1][0],'',1)



            dic1[lq]=dic2[d]
            lq +=1
    if hospital == 'aster1':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][2].__contains__('ACTIVE'):
                dic2[d][2] = dic2[d][2].replace('ACTIVE', 'Subtotal')
            if dic2[d][2].__contains__('PARTIAL RETURN'):
                dic2[d][2] = dic2[d][2].replace('PARTIAL RETURN', 'Subtotal')
            if dic2[d][0].__contains__('Account Head:'):
                dic2[d][0] = dic2[d][0].replace('Account Head:', '')
                dic2[d][0] = dic2[d][0].replace(' ', '', 1)
            if dic2[d][2].__contains__('Sponser Name') or dic2[d][2].__contains__('Sponsor Name'):
                dic2[d][2] = ' '
            if dic2[d][5].__contains__('Bed No:'):
                dic2[d][5] = ' '
            if dic2[d][2] == ' ' and (len(re.findall('\d{2}\/\d{2}\/\d{4}\s', dic2[d][1])) == 1 or len(
                    re.findall('\d+\/\d+\/\d+\s', dic2[d][1])) == 1) and len(dic2[d][1].split()) >= 2:
                # print('if date and parti together in 1st index')
                text = dic2[d][1]
                if len(re.findall('\d{2}\/\d{2}\/\d{4}', dic2[d][1])) == 1:
                    matchdate = re.search(r'\d{2}\/\d{2}\/\d{4}', text)
                elif len(re.findall('\d+\/\d+\/\d+', dic2[d][1])) == 1:
                    matchdate = re.search(r'\d+\/\d+\/\d+', text)
                dic2[d][1] = matchdate.group()
                dic2[d][2] = text.replace(matchdate.group(), '')
                dic2[d][2] = dic2[d][2].replace(dic2[d][2][0], '', 1)
            if dic2[d][5] != ' ' and len(dic2[d][5].split()) == 2 and len(re.findall('\d\.\d', dic2[d][5])) == 2:
                print('if 5th indx amt and discount are together')
                a, b = dic2[d][5].split()
                dic2[d][5] = a
                dic2[d][6] = b

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='bhailal':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if dic2[d][0] == '. .' or dic2[d][0] == 'Bhailal Amin Marg, Gorwa,':
                dic2[d][0] = ' '
            if dic2[d][0] == '4 ration Ch':
                dic2[d][0] = 'Operation Charges'
            if dic2[d][1] == '. . .. ... . . .' or dic2[d][1] == '- . .. ..':
                dic2[d][1] = ' '
            if dic2[d][0] == '2 Accomodation Charges':
                dic2[d][0] = 'Accomodation Charges'
            if len(dic2[d][2].split()) == 2 and len(re.findall('\d\.\d', dic2[d][2])) == 2:
                print('splitting rate and amount vals if together')
                a,b = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = b
            if dic2[d][2]!= ' ' and dic2[d][3]!=' ' and len(re.findall('\d\s?\.\s?\d', dic2[d][2])) == 1 and len(re.findall('\d\s?\.\s?\d', dic2[d][3])) == 1 and dic2[d][4] == ' ' and dic2[d][5] == ' ':
                print('changing values from 1st 2nd and 3rd index to 4th, 5th , 3rd index')
                dic2[d][4] = dic2[d][2]
                dic2[d][5] = dic2[d][3]
                dic2[d][2] = ' '
                dic2[d][3] = dic2[d][1]
                dic2[d][1] = ' '
            if dic2[d][0] !=' ' and (len(re.findall('\d{2}', dic2[d][0].split()[0])) == 1 or len(re.findall('\d', dic2[d][0].split()[0])) == 1) and dic2[d].count(' ') >= 3:
                print('for removing snos in 0th index')
                text = dic2[d][0]
                if len(re.findall('\d{2}', dic2[d][0].split()[0])) == 1:
                    matchsno = re.search(r'\d{2}', text)
                elif len(re.findall('\d', dic2[d][0].split()[0])) == 1:
                    matchsno = re.search(r'\d', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
                dic2[d][0] = dic2[d][0].replace(dic2[d][0][0],'',1)
            if dic2[d][0] == '| Radiology Charges':
                dic2[d][0] = 'Radiology Charges'
            if dic2[d][0] == '| Procedure Charges':
                dic2[d][0] = 'Procedure Charges'
            if dic2[d][0] == '| Anaesthesia Charges':
                dic2[d][0] = 'Anaesthesia Charges'
            if dic2[d][0] == '. Consultation Charges':
                dic2[d][0] = 'Consultation Charges'
            if d>1 and d<len(dic2) and len(re.findall('\d{3}\.\d{2}', dic2[d][5])) == 1 and len(re.findall('\D{2}\s\D{12}\s\D{4}', dic2[d-1][0])) == 1 and dic2[d-1][0] == 'IP Registration Fees' and \
                    dic2[d].count(' ')==5 and dic2[d-1].count(' ')==5:
                print('for IP Registration Fees')
                dic2[d-1][5] = dic2[d][5]
                dic2[d][5] = ' '
            if d>1 and len(re.findall('\D{12}\s\D{7}', dic2[d][0])) == 1 and len(re.findall('\D{2}\s\D{12}\s\D{4}', dic2[d-1][0])) == 1 and dic2[d][0] == 'Accomodation Charges' and dic2[d-1][0] == 'IP Registration Fees':
                print('for IP registration adding empty line to make head_to_head sbt work')
                listnw = [' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq+=1
                dic1[lq - 1] = listnw



            dic1[lq]=dic2[d]
            lq +=1
    if hospital=='bhailal1':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if d>1 and d<len(dic2) and dic2[d][0]  == dic2[d-1][0] and dic2[d].count(' ')<3 and dic2[d-1].count(' ')>=4:
                # print('if header and line item are same adding s to line item')
                dic2[d][0] = dic2[d][0]+'s'
            if dic2[d][0].__contains__('Total'):
                dic2[d][0] = dic2[d][0].replace('Total','TOTAL')
            if dic2[d][0] == '2.. .. . Name . ". .':
                dic2[d][0] = ' '
            if dic2[d][0].__contains__('Bhailal'):
                dic2[d][0] = ' '
            if dic2[d][0].__contains__('Vadodara') or dic2[d][0].__contains__('vadodara'):
                dic2[d][0] = ' '
            if dic2[d][0].__contains__('baghospital'):
                dic2[d][0] = ' '
            if dic2[d][1].__contains__('Page'):
                dic2[d][1] = ' '
            if d>1 and d<len(dic2) and len(re.findall('\D{6}\s\D{7}', dic2[d][0])) == 1 and dic2[d][0] == 'Triage Charges' and len(re.findall('\D{13}\s\D{7}', dic2[d-1][0])) == 1 and dic2[d-1][0] == 'Miscellaneous Charges' and \
                   dic2[d].count(' ')==5 and dic2[d-1].count(' ')==2 and len(re.findall('\d{2}\-\D{3}\-\d{2}', dic2[d-1][1])) == 1 and len(re.findall('\d{3}', dic2[d-1][3])) == 1 and len(re.findall('\d{3}', dic2[d-1][5])) == 1:
                # print('for 220202127834 Miscellaneous Charges')
                dic2[d][1] = dic2[d-1][1]
                dic2[d][3] = dic2[d-1][3]
                dic2[d][5] = dic2[d-1][5]
                dic2[d-1][1] = ' '
                dic2[d-1][3] = ' '
                dic2[d-1][5] = ' '
            if d>1 and d<len(dic2) and len(re.findall('\D{8}\s\D{6}\s\D{3}\.\.\.\.\.', dic2[d][0])) == 1 and len(re.findall('\d{2}\-\w{3}\-\d{2}', dic2[d][1])) == 1 and dic2[d][3] == ' ' and dic2[d][5] == ' ' and \
                    len(re.findall('\d{4}', dic2[d-1][3])) == 1 and len(re.findall('\d{4}', dic2[d-1][5])) == 1 and dic2[d].count(' ')==4 and dic2[d-1].count(' ')==4:
                print('for 220202127834 Surgical Biopsy Big......')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if (len(re.findall('\d{2}\s\-\s\d{3}', dic2[d][5])) == 1 or len(re.findall('\d{3}\s\-\s\d{2}', dic2[d][5])) == 1 or len(re.findall('\d{2}\s\-\s\d{2}', dic2[d][5])) == 1) and len(dic2[d][5].split()) >=3:
                # print('removing ref num from 5th index')
                text = dic2[d][5]
                if len(re.findall('\d{3}\s\-\s\d{2}', dic2[d][5])) == 1:
                    matchref = re.search(r'\d{3}\s\-\s\d{2}',text)
                elif len(re.findall('\d{2}\s\-\s\d{3}', dic2[d][5])) == 1:
                    matchref = re.search(r'\d{2}\s\-\s\d{3}',text)
                elif len(re.findall('\d{2}\s\-\s\d{2}', dic2[d][5])) == 1:
                    matchref = re.search(r'\d{2}\s\-\s\d{2}',text)
                dic2[d][5] = text.replace(matchref.group(),'')
            if d>1 and d<len(dic2) and len(re.findall('\D{8}', dic2[d][0])) == 1  and len(re.findall('\D{2}\s\D{2}\.\s\D{6}\s\D{6}\,\s\D{2}\s\D{2}\.\s\D{4}\s\D{4}', dic2[d-1][0])) == 1 and len(re.findall('\d{4}', dic2[d][5])) == 1 and \
                      dic2[d].count(' ')==4 and dic2[d-1].count(' ')==4:
                # print('for 220202002767 package charges adding total')
                listnw = [' ', ' ', ' ', 'Total', ' ', dic2[d-1][5]]
                dic2[d-1][5] = ' '
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d>1 and d<len(dic2) and len(re.findall('\D{12}\s\D{7}\s\D{5}\s\D{5}\s\-\s\D{6}\s\D{11}', dic2[d][0])) == 1 and dic2[d][0].__contains__('Consultation Charges'):
                # print('for 220202099402 adding Consultation Charges')
                listnw = ['Consultation Charges', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq+=1
                dic1[lq-1] = listnw
                dic2[d][0] = dic2[d][0].replace('Consultation Charges','')
            if d>3 and d<len(dic2)+3 and len(re.findall('\D{9}\s\D{7}\_\s\D{11}\s\D{3}\s\D{7}\s\D{4}\s\[\D{7}\]', dic2[d][0])) == 1 and dic2[d][0].__contains__('Operation Charges'):
                # print('for 220202099402 adding peration Charges')
                listnw = ['Operation Charges', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq+=1
                dic1[lq-1] = listnw
                dic2[d][0] = dic2[d][0].replace('Operation Charges','')
                dic2[d+2][3] = 'Total'
            if d>2 and d<len(dic2)+2 and len(re.findall('\D{5}\s\D{5}\/\D{6}\s\D{5}', dic2[d][0])) == 1 and len(re.findall('\d{3}\-\w{3}\-\d{2}', dic2[d][1])) == 1 and len(re.findall('\d{3}', dic2[d][3])) == 1 and len(re.findall('\d{3}', dic2[d][5])) == 1 and \
                   dic2[d].count(' ')==2 and dic2[d+1].count(' ')==5 and dic2[d+2][0] == 'Medicine':
                # print('for 220202127834 adding total to BAGH Rasoi (Additional Serving)')
                dic2[d+1][2] = 'Total'
            if dic2[d][5] == '-. . ... .':
                dic2[d][5] = ' '
            if dic2[d][0] == '-... . ... --.._. . ..' or dic2[d][0] == '(0265) 677/255 6222' or dic2[d][0] == '.. ..':
                dic2[d][0] = ' '


            dic1[lq]=dic2[d]
            lq +=1
    if hospital=='Holyspirit':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('d00=',dic2[d])
            if dic2[d][6].__contains__('Page'):
                dic2[d][6] = ' '
            if dic2[d][3] == dic2[d][4]:
                # print('if 3rd and 4th ndex are same')
                dic2[d][4] = ' '
            if dic2[d][0].__contains__('Ward') and len(re.findall('\d\s\D{3}\s\d', dic2[d][2])) >= 1:
                print('for bed charges')
                dic2[d][2] = dic2[d][0]
                dic2[d][3] = ' '
            if len(re.findall('\d\s\D{3}\s\d', dic2[d][2])) >= 1:
                print('for bed charges')
                dic2[d][2] = dic2[d][1]
                dic2[d][3] = ' '
            if dic2[d][1].__contains__('Ward') and len(re.findall('\d\s\D{3}\s\d', dic2[d][2])) >= 1:
                print('for exchanging parti and date with in bed charges')
                date = dic2[d][2]
                dic2[d][2] = dic2[d][1]
                dic2[d][1] = date
                dic2[d][3] = ' '
            if len(re.findall('\d\s\D{3}\s\d', dic2[d][0])) == 1 and (dic2[d][1] == ' ' or dic2[d][1] !=' '):
                print('if request no and date together')
                text = dic2[d][0]
                if len(re.findall('\d{2}\s\D{3}\s\d{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\s\D{3}\s\d{2}',text)
                elif len(re.findall('\d{2}\s\D{3}\s\d', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\s\D{3}\s\d',text)
                dic2[d][1] = matchdate.group()
                dic2[d][0] = text.replace(matchdate.group(),'')


            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'wockhardt':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][3] != ' ' or dic2[d][4] != ' ' or dic2[d][2] != ' ':
                dic2[d][3] = ' '
                dic2[d][4] = ' '
                dic2[d][2] = ' '
            if d > 1 and dic2[d][0].__contains__('TOTAL BILL') and 'Total' not in dic2[d - 1][0]:
                dic2[d][0] = 'Total'
            if dic2[d][0] in head_list and dic2[d][7]!=' ' and 'Total' not in dic2[d][0]:
                dic2[d][0] = dic2[d][0]+' '+'Total'
            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd11==', dic2[d])
            if dic2[d][0] == 'OP/IP PACKAGE TOTAL':
                dic2[d][0] = dic2[d][0].replace('TOTAL', 'Total')
            if dic2[d][0] == 'OP/IP Package':
                dic2[d][0] = 'OP/IP Packages'
            if dic2[d][0] == 'esthetist Fee':
                dic2[d][0] = 'Anesthetist Fee'
            if dic2[d][0] == '|Bed Rentals':
                dic2[d][0] = 'Bed Rentals'
            if dic2[d][0] == '|Investigation':
                dic2[d][0] = 'Investigation'
            if dic2[d][0] == '|External Services':
                dic2[d][0] = 'External Services'
            if dic2[d][0] == '|Pharmacy':
                dic2[d][0] = 'Pharmacy'
            if dic2[d][0] == '|Anaesthesia Charge':
                dic2[d][0] = 'Anaesthesia Charge'
            if dic2[d][0] == '|OP IP Procedures':
                dic2[d][0] = 'OP IP Procedures'
            if dic2[d][0] == 'OP IP Procedures T':
                dic2[d][0] = 'OP IP Procedures Total'
            if dic2[d][0] == '|Pharmacy':
                dic2[d][0] = 'Pharmacy'
            if dic2[d][0] == '|Consumables':
                dic2[d][0] = 'Consumables'
            if dic2[d][0] == 'mables':
                dic2[d][0] = 'Consumables'
            if dic2[d][0] != ' ' and dic2[d][1] == ' ' and dic2[d][0] != 'Total' and len(
                    dic2[d][0].split()) >= 2 and len(re.findall('\d+\/\d+\/\d+\s\d+\:\d+\s?\w+', dic2[d][0])) == 1:
                print('if date, parti togther and in 0th')
                text = dic2[d][0]
                if len(re.findall('\d+\/\d+\/\d+\s\d+\:\d+\s?\w+', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d+\/\d+\/\d+\s\d+\:\d+\s?\w+', text)
                dic2[d][1] = matchdate.group()
                dic2[d][0] = text.replace(matchdate.group(), '')
            if d > 3 and d < len(dic2) + 3 and dic2[d][0] == 'Associate Co-' and dic2[d + 1][0] == 'surgeon surgeon' and \
                    dic2[d + 2][0] == 'charge' and dic2[d][7] == ' ':
                dic2[d][0] = 'Associate Co-surgeon surgeon charge'
                dic2[d + 1][0] = ' '
                dic2[d + 2][0] = ' '
            if d > 3 and d < len(dic2) + 3 and dic2[d][0] == 'Associate Co-' and dic2[d + 1][0] == 'surgeon surgeon' and \
                    dic2[d + 2][0] == 'charge' and dic2[d][7] != ' ':
                dic2[d][0] = 'Associate Co-surgeon surgeon charge Total'
                dic2[d + 1][0] = ' '
                dic2[d + 2][0] = ' '
            if d > 1 and d < len(dic2) and dic2[d][0] in head_list and dic2[d + 1][0] == 'Total':
                dic2[d][0] = dic2[d][0] + dic2[d + 1][0]
                dic2[d + 1][0] = ' '
            if dic2[d][0] == 'total' and dic2[d].count(' ') == 7:
                dic2[d][0] = 'Total'
            if d > 1 and dic2[d][0] == 'Total' and dic2[d].count(' ') == 7 and dic2[d - 1].count(' ') == 6 and len(
                    re.findall('\d\.\d', dic2[d - 1][7])) == 1:
                print('if total is in separate line')
                dic2[d - 1][0] = dic2[d - 1][0] + ' ' + dic2[d][0]
                dic2[d][0] = ' '
            if len(dic2[d][6].split()) == 2 and len(re.findall('\d\.\d', dic2[d][6])) == 2 and dic2[d][5] == ' ':
                print('if qty rate togeter in 5th index')
                a, b = dic2[d][6].split()
                dic2[d][5] = a
                dic2[d][6] = b
            if d > 1 and d < len(dic2) and len(re.findall('\d\/\d{2}\/\d{4}', dic2[d][1])) == 1 and len(
                    re.findall('\d\.\d', dic2[d - 1][6])) == 1 and len(re.findall('\d\.\d', dic2[d - 1][7])) == 1 and \
                    len(re.findall('\d\.\d', dic2[d][6])) == 0 and len(re.findall('\d\.\d', dic2[d][7])) == 0 and dic2[
                d].count(' ') == 6 and (dic2[d - 1].count(' ') == 5 or dic2[d - 1].count(' ') == 4) and len(
                re.findall('\d\/\d{2}\/\d{4}', dic2[d - 1][1])) == 0:
                print('if date is misplaced in d with 6,5or4 spaces')
                dic2[d - 1][1] = dic2[d][1]
                dic2[d][1] = ' '
            if d > 1 and d < len(dic2) and len(re.findall('\d\/\d{2}\/\d{4}', dic2[d][1])) == 0 and len(
                    re.findall('\d\.\d', dic2[d - 1][6])) == 1 and len(re.findall('\d\.\d', dic2[d - 1][7])) == 0 and \
                    len(re.findall('\d\.\d', dic2[d][6])) == 0 and len(re.findall('\d\.\d', dic2[d][7])) == 1 and dic2[
                d].count(' ') == 6 and dic2[d - 1].count(' ') == 5 and len(
                re.findall('\d\/\d{2}\/\d{4}', dic2[d - 1][1])) == 1:
                print('if amt misplaced in d with 6,5 spaces')
                dic2[d - 1][7] = dic2[d][7]
                dic2[d][7] = ' '
            if d > 1 and d < len(dic2) and len(re.findall('\d\/\d{2}\/\d{4}', dic2[d][1])) == 1 and len(
                    re.findall('\d\.\d', dic2[d - 1][6])) == 1 and len(re.findall('\d\.\d', dic2[d - 1][7])) == 0 and \
                    len(re.findall('\d\.\d', dic2[d][6])) == 0 and len(re.findall('\d\.\d', dic2[d][7])) == 1 and dic2[
                d].count(' ') == 5 and dic2[d - 1].count(' ') == 5 and len(
                re.findall('\d\/\d{2}\/\d{4}', dic2[d - 1][1])) == 0:
                print('if date, amount is misplaced in d with 5,5 spaces')
                dic2[d - 1][1] = dic2[d][1]
                dic2[d - 1][7] = dic2[d][7]
                dic2[d][1] = ' '
                dic2[d][7] = ' '
            if d > 1 and d < len(dic2) and len(re.findall('\d\/\d{2}\/\d{4}', dic2[d][1])) == 1 and len(
                    re.findall('\d\.\d', dic2[d - 1][6])) == 1 and len(re.findall('\d\.\d', dic2[d - 1][7])) == 1 and \
                    len(re.findall('\d\.\d', dic2[d][6])) == 0 and len(re.findall('\d\.\d', dic2[d][7])) == 0 and dic2[
                d].count(' ') == 7 and (dic2[d - 1].count(' ') == 5 or dic2[d - 1].count(' ') == 4) and len(
                re.findall('\d\/\d{2}\/\d{4}', dic2[d - 1][1])) == 0:
                print('if date is misplaced in d with 7,5 spaces')
                dic2[d - 1][1] = dic2[d][1]
                dic2[d][1] = ' '
            if d > 1 and d < len(dic2) and len(re.findall('\d\/\d{2}\/\d{4}', dic2[d][1])) == 1 and len(
                    re.findall('\d\.\d', dic2[d - 1][6])) == 1 and len(re.findall('\d\.\d', dic2[d - 1][7])) == 0 and \
                    len(re.findall('\d\.\d', dic2[d][6])) == 0 and len(re.findall('\d\.\d', dic2[d][7])) == 1 and dic2[
                d].count(' ') == 5 and dic2[d - 1].count(' ') == 6 and len(
                re.findall('\d\/\d{2}\/\d{4}', dic2[d - 1][1])) == 0:
                print('if date, amount is misplaced in d with 5,6 spaces')
                dic2[d - 1][1] = dic2[d][1]
                dic2[d - 1][7] = dic2[d][7]
                dic2[d][1] = ' '
                dic2[d][7] = ' '
            if d > 1 and d < len(dic2) and len(re.findall('\d\/\d{2}\/\d{4}', dic2[d][1])) == 1 and len(
                    re.findall('\d\.\d', dic2[d - 1][6])) == 1 and len(re.findall('\d\.\d', dic2[d - 1][7])) == 0 and \
                    len(re.findall('\d\.\d', dic2[d][6])) == 0 and len(re.findall('\d\.\d', dic2[d][7])) == 1 and dic2[
                d].count(' ') == 6 and dic2[d - 1].count(' ') == 6 and len(
                re.findall('\d\/\d{2}\/\d{4}', dic2[d - 1][1])) == 0:
                print('if date, amount is misplaced in d with 6,6 spaces')
                dic2[d - 1][1] = dic2[d][1]
                dic2[d - 1][7] = dic2[d][7]
                dic2[d][1] = ' '
                dic2[d][7] = ' '
            if d > 1 and d < len(dic2) and len(re.findall('\d\/\d{2}\/\d{4}', dic2[d][1])) == 1 and len(
                    re.findall('\d\.\d', dic2[d - 1][6])) == 0 and len(re.findall('\d\.\d', dic2[d - 1][7])) == 1 and \
                    len(re.findall('\d\.\d', dic2[d][6])) == 1 and len(re.findall('\d\.\d', dic2[d][7])) == 0 and dic2[
                d].count(' ') == 5 and dic2[d - 1].count(' ') == 6 and len(
                re.findall('\d\/\d{2}\/\d{4}', dic2[d - 1][1])) == 0:
                print('if date, amount is misplaced in d with 5,6 spaces')
                dic2[d - 1][1] = dic2[d][1]
                dic2[d - 1][6] = dic2[d][6]
                dic2[d][1] = ' '
                dic2[d][6] = ' '
            if d > 1 and d < len(dic2) and len(re.findall('\d\/\d{2}\/\d{4}', dic2[d][1])) == 1 and len(
                    re.findall('\d\.\d', dic2[d - 1][6])) == 0 and len(re.findall('\d\.\d', dic2[d - 1][7])) == 0 and \
                    len(re.findall('\d\.\d', dic2[d][6])) == 1 and len(re.findall('\d\.\d', dic2[d][7])) == 1 and dic2[
                d].count(' ') == 5 and dic2[d - 1].count(' ') == 6 and len(
                re.findall('\d\/\d{2}\/\d{4}', dic2[d - 1][1])) == 0:
                print('if date, amount is misplaced in d with 5,6 spaces')
                dic2[d - 1][1] = dic2[d][1]
                dic2[d - 1][6] = dic2[d][6]
                dic2[d - 1][7] = dic2[d][7]
                dic2[d][1] = ' '
                dic2[d][7] = ' '
                dic2[d][6] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'wockhardt1':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if d > 1 and dic2[d][0] == dic2[d - 1][0] and dic2[d - 1][0] in head_list:
                dic2[d][0] = dic2[d][0] + 's'
            if d > 1 and d < len(dic2) and len(re.findall('\D{7}\s\D{9}\s\d\s\D{2}', dic2[d][0])) == 1 and len(
                    re.findall('\d{2}\/\d{2}\/\d{4}\s\d\:\d{2}\:\d{2}\D{6}', dic2[d][2])) == 1 and len(
                re.findall('\d{5}\D', dic2[d][4])) == 1 and \
                    len(re.findall('\d{2}\-\d{2}\-\d{4}', dic2[d][5])) == 1 and len(
                re.findall('\d{4}\.\d{2}', dic2[d][7])) == 1 and len(
                re.findall('\d{4}\.\d{2}', dic2[d][8])) == 1 and len(
                re.findall('\D{2}\/\D{2}\s\D{15}', dic2[d - 1][5])) == 1 and \
                    len(re.findall('\d{5}\.\d{1}', dic2[d - 1][8])) == 1 and dic2[d].count(' ') == 2 and dic2[
                d - 1].count(' ') == 7:
                print('for 220201999074 adding pharmacy')
                listnw = ['Pharmacy', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'wockhardt2':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] != ' ' and dic2[d][1] == ' ' and dic2[d][0] != 'Total' and len(
                    dic2[d][0].split()) >= 2 and len(re.findall('\d+\/\d+\/\d+\s\d+\:\d+\s?\w+', dic2[d][0])) == 1:
                print('if date, parti togther and in 0th')
                text = dic2[d][0]
                if len(re.findall('\d+\/\d+\/\d+\s\d+\:\d+\s?\w+', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d+\/\d+\/\d+\s\d+\:\d+\s?\w+', text)
                dic2[d][1] = matchdate.group()
                dic2[d][0] = text.replace(matchdate.group(), '')
            if d > 1 and d < len(dic2) and dic2[d][0] + ' ' + dic2[d + 1][0] in head_list:
                dic2[d][0] = dic2[d][0] + ' ' + dic2[d + 1][0]
                dic2[d + 1][0] = ' '
            if d > 1 and d < len(dic2) and len(re.findall('\d\/\d{2}\/\d{4}', dic2[d][1])) == 1 and len(
                    re.findall('\d\.\d', dic2[d][3])) == 1 and len(re.findall('\d\.\d', dic2[d - 1][4])) == 1 and \
                    len(re.findall('\d\.\d', dic2[d - 1][5])) == 1 and dic2[d].count(' ') == 3 and dic2[d - 1].count(
                ' ') == 2 and len(re.findall('\d\.\d', dic2[d - 1][3])) == 0:
                print('if rate and date is misplaced in d')
                dic2[d - 1][1] = dic2[d][1]
                dic2[d - 1][3] = dic2[d][3]
                dic2[d][1] = ' '
                dic2[d][3] = ' '
            if d > 1 and d < len(dic2) and len(re.findall('\d\.\d', dic2[d][3])) == 1 and len(
                    re.findall('\d\.\d', dic2[d][5])) == 1 and len(re.findall('\d\.\d', dic2[d][4])) == 1 and len(
                re.findall('\d\/\d{2}\/\d{4}', dic2[d - 1][1])) == 1 and \
                    len(re.findall('\d\.\d', dic2[d - 1][5])) == 0 and dic2[d].count(' ') == 3 and dic2[d - 1].count(
                ' ') == 4 and len(re.findall('\d\.\d', dic2[d - 1][3])) == 0 and len(
                re.findall('\d\.\d', dic2[d - 1][4])) == 0:
                print('if rate,discount,amount misplaced in d and d-1 vals are empty')
                dic2[d - 1][5] = dic2[d][5]
                dic2[d - 1][3] = dic2[d][3]
                dic2[d - 1][4] = dic2[d][4]
                dic2[d][3] = ' '
                dic2[d][5] = ' '
                dic2[d][4] = ' '
            if d > 1 and d < len(dic2) and len(re.findall('\d\.\d', dic2[d][3])) == 1 and len(
                    re.findall('\d\.\d', dic2[d][5])) == 1 and len(
                re.findall('\d\/\d{2}\/\d{4}', dic2[d - 1][1])) == 1 and \
                    len(re.findall('\d\.\d', dic2[d - 1][5])) == 0 and dic2[d].count(' ') == 4 and dic2[d - 1].count(
                ' ') == 3 and len(re.findall('\d\.\d', dic2[d - 1][3])) == 0:
                print('if discount is misplaced in d-1 and rate, amount is in d')
                dic2[d - 1][5] = dic2[d][5]
                dic2[d - 1][3] = dic2[d][3]
                dic2[d][3] = ' '
                dic2[d][5] = ' '
            if d > 1 and d < len(dic2) and len(re.findall('\d\.\d', dic2[d][3])) == 1 and len(
                    re.findall('\d\.\d', dic2[d][5])) == 1 and len(re.findall('\d\.\d', dic2[d][4])) == 1 and len(
                    re.findall('\d\/\d{2}\/\d{4}', dic2[d][1])) == 1 and \
                    len(re.findall('\d\.\d', dic2[d - 1][5])) == 0 and dic2[d].count(' ') == 2 and dic2[d - 1].count(
                ' ') == 5 and len(re.findall('\d\.\d', dic2[d - 1][3])) == 0 and len(
                re.findall('\d\.\d', dic2[d - 1][4])) == 0:
                print('if date, rate,discount,amount misplaced in d and d-1 vals are empty')
                dic2[d - 1][1] = dic2[d][1]
                dic2[d - 1][5] = dic2[d][5]
                dic2[d - 1][3] = dic2[d][3]
                dic2[d - 1][4] = dic2[d][4]
                dic2[d][1] = ' '
                dic2[d][3] = ' '
                dic2[d][5] = ' '
                dic2[d][4] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'akash':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if d>1 and dic2[d][0] == 'Consultations' and dic2[d-1][0] == 'Physiotherapy':
                dic2[d-1][0] = dic2[d-1][0]+ ' ' + 'consultations'
                dic2[d][0] = ' '
            if d > 2 and dic2[d][0] in head_list and 'Sub Total' not in dic2[d - 1][2] and 'Sub Total' not in \
                    dic2[d - 2][2]:
                dic2[d][0] = dic2[d][0].lower()

            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'rubygeneral':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] == 'IP CONSULTATION/ REGISTRAR' or dic2[d][0] == 'RADIOLOGY' or dic2[d][
                0] == 'IP CONSULTATION REGISTRAR' or dic2[d][0] == 'LABORATORY':
                dic2[d][0] = ' '
            if dic2[d][2] == 'IP DRUG SALE':
                dic2[d][2] = 'TOTAL IP DRUG SALE'
            if dic2[d][2] == 'AL MEDICINES':
                dic2[d][2] = 'TOTAL MEDICINES'
            if d > 1 and dic2[d][2].__contains__('TOTAL') and dic2[d - 1][2].__contains__('TOTAL') and dic2[d - 2][
                2].__contains__('TOTAL'):
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
                dic2[d - 1] = [' ', ' ', ' ', ' ', ' ', ' ']
            if d > 1 and len(re.findall('\d\.\d', dic2[d][2])) == 1 and dic2[d][3] == ' ':
                print('if rate in 2nd index')
                text = dic2[d][2]
                if len(re.findall('\d+\.\d+', text)) == 1:
                    matchrate = re.search(r'\d+\.\d+', text)
                dic2[d][3] = matchrate.group()
                dic2[d][2] = ' '
            if d > 1 and len(re.findall('\d{2}\-\D{3}\-\d{4}\s', dic2[d][0])) == 1 and dic2[d][1] == ' ':
                print('if date parti together')
                text = dic2[d][0]
                if len(re.findall('\d{2}\-\D{3}\-\d{4}\s', text)) == 1:
                    matchdate = re.search(r'\d{2}\-\D{3}\-\d{4}\s', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')
            if dic2[d][2] != ' ' and dic2[d][3] == ' ' and len(dic2[d][2].split()) >= 2 and len(
                    re.findall('\d\.\d', dic2[d][2])) == 2:
                print('if QTy rate in 2nd indx')
                text = dic2[d][2].split()
                dic2[d][2] = text[0]
                dic2[d][3] = text[-1]
            if dic2[d][2] == ' ' and dic2[d][3] != ' ' and len(dic2[d][3].split()) >= 2 and len(
                    re.findall('\d\.\d', dic2[d][3])) == 2:
                print('if QTy rate in 3rd indx')
                text = dic2[d][3].split()
                dic2[d][2] = text[0]
                dic2[d][3] = text[-1]
            if dic2[d][2] != ' ' and dic2[d][3] != ' ' and len(dic2[d][3].split()[0]) == dic2[d][2]:
                print('if QTy in 2nd indx and Qty, rate in 3rd indx')
                text = dic2[d][3].split()
                dic2[d][3] = text[-1]
            if dic2[d][0] != ' ' and len(re.findall('\d+\-\w+\-\d+\s?\d+\:\d+\s?\w{2}', dic2[d][1])) == 1:
                print('for date in 1st indx of Bed charges')
                text = dic2[d][1]
                matchdate = re.search(r'\d+\-\w+\-\d+\s?\d+\:\d+\s?\w{2}', text)
                dic2[d][0] = dic2[d][0] + ' ' + matchdate.group()
                dic2[d][1] = dic2[d][1].replace(matchdate.group(), '')
            if dic2[d][2] != ' ' and len(dic2[d][2].split()) >= 2 and (
                    len(re.findall('\d+\s?\.\s?\d+', dic2[d][2])) == 1 or len(
                    re.findall('\d+\s\d+$', dic2[d][2])) == 1) and \
                    len(re.findall('\d+\-\w+\-\d+', dic2[d][1])) == 1:
                print('for bed charges rate')
                text = dic2[d][2]
                if len(re.findall('\d+\s?\.\s?\d+', dic2[d][2])) == 1:
                    matchrate = re.search(r'\d+\s?\.\s?\d+', text)
                elif len(re.findall('\d+\s\d+$', dic2[d][2])) == 1:
                    matchrate = re.search(r'\d+\s\d+$', text)
                dic2[d][3] = matchrate.group()
                dic2[d][2] = dic2[d][2].replace(matchrate.group(), '')
            if dic2[d][2] != ' ' and len(dic2[d][2].split()) >= 2 and (
                    len(re.findall('\d+\s?\.\s?\d+', dic2[d][2])) == 1 or len(
                    re.findall('\d+\s\d+$', dic2[d][2])) == 1):
                print('Qty with date in 2nd indx')
                text = dic2[d][2]
                if len(re.findall('\d+\s?\.\s?\d+', dic2[d][2])) == 1:
                    matchqty = re.search(r'\d+\s?\.\s?\d+', text)
                elif len(re.findall('\d+\s\d+$', dic2[d][2])) == 1:
                    matchqty = re.search(r'\d+\s\d+$', text)
                dic2[d][2] = matchqty.group()
            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd11==', dic2[d])
            if dic2[d][2] != ' ' and len(dic2[d][2]) >= 6 and 'TOTA' not in dic2[d][2]:
                dic2[d][2] = ' '
            if d > 1 and dic2[d][2].__contains__('TOTAL') and dic2[d - 1][2].__contains__('TOTAL'):
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if ((len(re.findall('\d\s\d', dic2[d][5])) == 1 and len(re.findall('\s', dic2[d][5])) == 1 and len(
                    re.findall('\d\.\d', dic2[d][5])) == 0) or (
                    len(re.findall('\d\s\d', dic2[d][3])) == 1 and len(re.findall('\s', dic2[d][3])) == 1 and len(
                    re.findall('\d\.\d', dic2[d][3])) == 0)):
                print('if only 1 spaces are there in amt and rate ')
                if len(re.findall('\d\s\d', dic2[d][5])) == 1 and len(re.findall('\s', dic2[d][5])) == 1:
                    dic2[d][5] = dic2[d][5].replace(' ', '.')
                if len(re.findall('\d\s\d', dic2[d][3])) == 1 and len(re.findall('\s', dic2[d][3])) == 1:
                    dic2[d][3] = dic2[d][3].replace(' ', '.')

            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'kamakshi':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] == 'Description' or dic2[d][0] == 'Total' or dic2[d][0] == 'No' or dic2[d][0].__contains__(
                    'Sum of NonMedicalItems'):
                dic2[d][0] = ' '
            if dic2[d][5] == 'Pharmacy':
                dic2[d][5] = ' '
            if dic2[d][0].__contains__('LAB') and dic2[d].count(' ') <= 3:
                dic2[d][0] = dic2[d][0].replace('LAB', 'lab')
                dic2[d][1] = dic2[d][0]
            if dic2[d][0] == 'Treatment Charges':
                dic2[d][0] = ' '
            for i in head_list:
                if i in dic2[d][0] and i != 'Surgery/Intervention':
                    dic2[d][0] = i
            if dic2[d][0].__contains__('Surgery/Intervention') and dic2[d][0].__contains__('Description') and dic2[d][
                0] != ' ':
                dic2[d][0] = dic2[d][0].replace('Description', '')
                dic2[d][2:] = [' ', ' ', ' ', ' ']
            if dic2[d][2] == 'UnitPrice' or dic2[d][3] == 'Quantity' or dic2[d][5] == 'Amour':
                dic2[d][2] = ' '
                dic2[d][3] = ' '
                dic2[d][5] = ' '
            if len(re.findall('\d\/\d{2}\/\d{4}', dic2[d][2])) == 1 and len(re.findall('\d\.\d', dic2[d][3])) == 1:
                dic2[d][2] = dic2[d][3]
                dic2[d][3] = ' '
            if len(dic2[d][3].split()) == 3 and len(re.findall('\d\/\d{2}\/\d{4}', dic2[d][2])) >= 1:
                print('if rate qty amt together in 3rd index in room charges')
                dic2[d][1] = dic2[d][2]
                a, b, c = dic2[d][3].split()
                dic2[d][2] = a
                dic2[d][3] = b
                dic2[d][5] = c
            if len(dic2[d][5].split()) == 2 and dic2[d][3] == ' ':
                print('if qty,amount together in 5th index room charges')
                a, b = dic2[d][5].split()
                dic2[d][3] = a
                dic2[d][5] = b
            if len(dic2[d][3].split()) == 2:
                print('if qty,amount together in 5th index room charges')
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][5] = b
            if len(dic2[d][5].split()) == 2 and dic2[d][3] != ' ' and dic2[d][2] != ' ':
                print('if amt captured twice in 5th index')
                a, b = dic2[d][5].split()
                dic2[d][5] = b
            if dic2[d][2] != ' ' and len(re.findall('\d+\.\d+', dic2[d][2])) == 1 and len(
                    re.findall('\D+\/\d+', dic2[d][2])) == 1:
                # print('changings qty, unitprice indexes in pharmacy')
                text = dic2[d][2]
                if len(re.findall('\d+\.\d+', dic2[d][2])) == 1:
                    matchqty = re.search(r'\d+\.\d+', text)
                dic2[d][2] = dic2[d][3]
                dic2[d][3] = matchqty.group()
            if len(re.findall('\d{2}\/\d{2}\/\d{4}', dic2[d][2])) == 1 and len(re.findall('\d\.\d', dic2[d][2])) == 1:
                print('date in 2nd index')
                text = dic2[d][2]
                if len(re.findall('\d{2}\/\d{2}\/\d{4}', dic2[d][2])) == 1:
                    matchdate = re.search(r'\d{2}\/\d{2}\/\d{4}', text)
                dic2[d][2] = dic2[d][2].replace(matchdate.group(), '')
            if dic2[d][0] != ' ' and len(re.findall('\d+\.\d+', dic2[d][0])) == 1 and dic2[d][1] in dic2[d][0] and len(
                    re.findall('\d+\.\d+', dic2[d][1])) == 1 and \
                    dic2[d][0] not in dic2[d][1]:
                print('for syrgery btreakup cases')
                dic2[d][0] = dic2[d][0].replace(dic2[d][1], '').replace(' ', '', 3)
                dic2[d][2] = dic2[d][1]
                dic2[d][5] = dic2[d][1]
                dic2[d][1] = ' '
            if dic2[d][1] in dic2[d][0]:
                dic2[d][1] = ' '
            if dic2[d][0] == 'LAB' and dic2[d].count(' ') != 5:
                print('if lab is causing issue in head_list')
                dic2[d][0] = ' '

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd11==', dic2[d])

            if dic2[d][2] == dic2[d][3] and dic2[d][2] != ' ' and dic2[d][3] != ' ':
                dic2[d][3] = ' '
            if dic2[d][5] != ' ' and len(dic2[d][5].split()) == 2 and len(re.findall('\d\.\d', dic2[d][5])) == 2:
                a, b = dic2[d][5].split()
                dic2[d][5] = b
            if dic2[d][2] != ' ' and len(dic2[d][2].split()) >= 2 and len(
                    re.findall('\d+\/\d+\/\d+\s\d+\/\d+\/\d+', dic2[d][2])) == 1 and dic2[d][1] == ' ':
                print('if date in rate indx for rooom chargee line')
                text = dic2[d][2]
                if len(re.findall('\d+\/\d+\/\d+\s\d+\/\d+\/\d+', dic2[d][2])) == 1:
                    matchdate = re.search('\d+\/\d+\/\d+\s\d+\/\d+\/\d+', text)
                dic2[d][1] = matchdate.group()
                dic2[d][2] = text.replace(matchdate.group(), '')
            if dic2[d][0].__contains__('Surgery/Intervention') and (
                    len(re.findall('\d+\.\d+', dic2[d][0])) == 1 or len(re.findall('\d+\,\d+', dic2[d][0])) == 1):
                print('for surgery line item')
                text = dic2[d][0]
                if len(re.findall('\d+\.\d+', dic2[d][0])) == 1:
                    matchamt = re.search('\d+\.\d+', text)
                elif len(re.findall('\d+\,\d+', dic2[d][0])) == 1:
                    matchamt = re.search('\d+\,\d+', text)
                dic2[d][0] = 'Surgery/Intervention'
                dic2[d + 2][5] = matchamt.group()
                dic2[d + 2][2] = matchamt.group()
            if d > 2 and dic2[d][0].__contains__('Chief Surgeon Fee') and dic2[d - 1][0] != ' ' and dic2[d - 1].count(
                    ' ') == 5:
                dic2[d - 2][0] = dic2[d - 2][0] + ' ' + dic2[d - 1][0]
                dic2[d - 1][0] = ' '
            if d > 1 and (dic2[d].count(' ') == 3 or dic2[d].count(' ') == 2) and dic2[d - 1].count(' ') == 5 and \
                    dic2[d - 1][0] != ' ' and dic2[d][
                0] != ' ' and dic2[d][2] != ' ' and (dic2[d][3] == ' ' or dic2[d][3] != ' ') and dic2[d][5] != ' ' and \
                    dic2[d][1] == ' ' and \
                    dic2[d][4] == ' ' and dic2[d][0] not in head_list and dic2[d - 1][0] not in head_list and \
                    dic2[d - 1][0] != 'Description':
                print('if lines are divided')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'Sahyadri1':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][3] == dic2[d][4]:
                dic2[d][5] = ' '
            if dic2[d][4] == dic2[d][5].replace('*', ''):
                dic2[d][5] = dic2[d][4]
            if len(dic2[d][3].split()) == 3 and dic2[d][4].replace(' ', '') in dic2[d][3]:
                # print('if qty number and rate together')
                a, b, c = dic2[d][3].split()
                dic2[d][3] = a
            if len(dic2[d][3].split()) == 4 and dic2[d][4] == ' ' and dic2[d][5] == ' ':
                print('if qty number and rate and amount together')
                # a,b,c,d = dic2[d][3].split()
                text = dic2[d][3]
                dic2[d][3] = text.split()[0]
                dic2[d][4] = text.split()[2]
                dic2[d][5] = text.split()[3]
            if len(dic2[d][4].split()) == 2 and dic2[d][5].replace('*', '') in dic2[d][4] and len(
                    re.findall('\d\.\d', dic2[d][4])) <= 2:
                print('if rate and amount are together')
                a, b = dic2[d][4].split()
                dic2[d][4] = a
                dic2[d][5] = b
            if len(dic2[d][4].split()) == 2 and dic2[d][5] in dic2[d][4] and len(re.findall('\d\.\d', dic2[d][4])) <= 2:
                print('if rate and amount are together')
                a, b = dic2[d][4].split()
                dic2[d][4] = a
                dic2[d][5] = b
            if dic2[d][3].__contains__('No'):
                dic2[d][3] = dic2[d][3].replace('No', ' ')
            if dic2[d][3].__contains__('Day'):
                dic2[d][3] = dic2[d][3].replace('Day', ' ')

            if ' ' in dic2[d][3] and dic2[d][3] != ' ':
                dic2[d][3] = dic2[d][3].replace(' ', '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Sahyadri1-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][3] == dic2[d][4]:
                dic2[d][4] = ' '
            if len(dic2[d][3].split()) == 3 and dic2[d][4] == ' ':
                # print('if qty number and rate together')
                a, b, c = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = c
            if len(dic2[d][2].split()) == 3 and dic2[d][3] == ' ' and len(re.findall('\D{3}\-\d', dic2[d][2])) == 1:
                print('if expdate and qty number together')
                a, b, c = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = b
            if len(dic2[d][4].split()) == 2 and len(re.findall('\d\.\d', dic2[d][4])) == 1 and len(
                    re.findall('\d\,', dic2[d][4].split()[0])) == 0 and dic2[d][4] != dic2[d][5]:
                print('if qty and rate together')
                a, b = dic2[d][4].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if dic2[d][3].__contains__('Number'):
                dic2[d][3] = dic2[d][3].replace('Number', ' ')
            if dic2[d][3].__contains__('ML'):
                dic2[d][3] = dic2[d][3].replace('ML', ' ')
            if dic2[d][3].__contains__('Kit'):
                dic2[d][3] = dic2[d][3].replace('Kit', ' ')
            if dic2[d][3].__contains__('Strip'):
                dic2[d][3] = dic2[d][3].replace('Strip', ' ')
            if dic2[d][3].__contains__('Bottle'):
                dic2[d][3] = dic2[d][3].replace('Bottle', ' ')
            if len(dic2[d][5].split()) == 2 and dic2[d][5] != ' ' and (
                    dic2[d][5].split()[0] == '0.00' or dic2[d][5].split()[0] == '0.0' or dic2[d][5].split()[0] == '0' or
                    dic2[d][5].split()[0] == '0.OC'):
                print('if conc and net together')
                a, b = dic2[d][5].split()
                dic2[d][5] = b
            if len(dic2[d][5].split()) == 3 and len(re.findall('\d\.\d', dic2[d][5])) == 2:
                a, b, c = dic2[d][5].split()
                dic2[d][5] = b + c
            if dic2[d][5].__contains__('*'):
                dic2[d][5] = dic2[d][5].replace('*', '')
            if dic2[d][5].__contains__('- -') or dic2[d][5].__contains__('---'):
                dic2[d][5] = ' '
            if len(dic2[d][4].split()) == 2 and dic2[d][5] == ' ' and len(re.findall('\d\.\d', dic2[d][4])) == 2:
                print('if 4th and 5th index together in 4th index')
                a, b = dic2[d][4].split()
                dic2[d][4] = a
                dic2[d][5] = b
            if ' ' in dic2[d][3] and dic2[d][3] != ' ':
                dic2[d][3] = dic2[d][3].replace(' ', '')
            if d > 1 and d < len(dic2) and (len(re.findall('\D{6}', dic2[d][0])) == 1 or len(
                    re.findall('\D{8}\s\(\D{8}\)', dic2[d][0])) == 1 or len(
                re.findall('\D{7}\s\(\D{2}\)', dic2[d][0])) == 1 or len(
                re.findall('\D{8}\s\(\D{8}\)', dic2[d][0])) == 1 or len(
                re.findall('\D{9}', dic2[d][0])) == 1) and len(re.findall('\d\/\d{2}\/\d', dic2[d][1])) == 1 and (
                    len(re.findall('\D{7}\s\D\s\(\d{3}\D\d{2}\)\D{2}\s\d{2}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{2}\s\d\.\d\%\s\d{3}\D{2}\s\D\.\s\D\.', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{7}\s\d{2}\D{2}\s\D{7}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{5}\s\D{2}\s\d\D{3}\s\D{4}', dic2[d - 1][0])) == 1) and len(
                re.findall('\d\.\d', dic2[d - 1][5])) == 1 and \
                    dic2[d].count(' ') >= 3 and dic2[d - 1].count(' ') <= 2:
                print('for 220100769407 with d>=3 and d-1<=2')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if d > 1 and d < len(dic2) and (len(re.findall('\D{7}\s\(\D{2}\)', dic2[d][0])) == 1 or len(
                    re.findall('\D{8}\s\(\D{4}\s\D{2}\s\d{3}\)', dic2[d][0])) == 1 or len(
                re.findall('\w{7}\)', dic2[d][0])) == 1) and len(
                re.findall('\d\/\d{2}\/\d', dic2[d - 1][1])) == 1 and (
                    len(re.findall('\D{7}\s\d{2}\D{2}\s\D{7}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{6}\s\D{11}\s\(\D\)', dic2[d - 1][0])) == 1 or len(
                re.findall('\D\.\s\D\s\D{3}\s\D{10}', dic2[d - 1][0])) == 1) and len(
                re.findall('\d\.\d', dic2[d][5])) == 1 and \
                    dic2[d].count(' ') >= 2 and dic2[d - 1].count(' ') <= 3:
                print('for 220100769407 with d>=2 and d-1<=3')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if d > 1 and d < len(dic2) and (len(re.findall('\D{8}\s\(\D{8}\)', dic2[d][0])) == 1 or len(
                    re.findall('\(\D{9}\)\s\D{2}\s\d{2}\s\(\D{2}\)', dic2[d][0])) == 1) and len(
                re.findall('\d\/\d{2}\/\d', dic2[d][1])) == 1 and (
                    len(re.findall('\D{3}\s\d\.\d\%\s\d{3}\D{2}\s\D\.\s\D\.', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{7}\s\D{3}\s\D{6}', dic2[d - 1][0])) == 1) and len(
                re.findall('\d\.\d', dic2[d][5])) == 1 and \
                    dic2[d].count(' ') <= 2 and dic2[d - 1].count(' ') >= 3:
                print('for 220100769407 with d<=2 and d-1>=2')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if d > 1 and (len(re.findall('\d{2}\s\D{6}', dic2[d][0])) == 1) and len(
                    re.findall('\d\/\d{2}\/\d', dic2[d - 1][1])) == 1 and (
                    len(re.findall('\D{5}\s\D{7}\s\D\d\s\d{3}\D{2}', dic2[d - 1][0])) == 1) and len(
                re.findall('\d\.\d', dic2[d][5])) == 1 and \
                    dic2[d].count(' ') >= 3 and dic2[d - 1].count(' ') <= 2:
                print('for 220100769407 with 4th index replaced in d-1 4th index')
                dic2[d - 1][4] = dic2[d][4]
                dic2[d][4] = ' '
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if d > 1 and (
                    len(re.findall('\D{6}', dic2[d][0])) == 1 or len(re.findall('\D{9}', dic2[d][0])) == 1 or dic2[d][
                0] == ' ' or len(re.findall('\(\D{2}\)', dic2[d][0])) == 1 or len(
                re.findall('\D{7}\)\s\D{2}\s\d\.\d\%\s\d{3}\D{2}\s\D\.\D', dic2[d][0])) == 1 or len(
                re.findall('\D{8}\)\s\D{5}\s\D{8}\s\D{5}\s\D{5}', dic2[d][0])) == 1 or len(
                re.findall('\D{9}\s\(\D{8}\)', dic2[d][0])) == 1 or len(
                re.findall('\(\D{5}\)', dic2[d][0])) == 1 or len(
                re.findall('\d{2}\D{2}\s\D{9}', dic2[d][0])) == 1 or len(
                re.findall('\d{2}\s\D{6}', dic2[d][0])) == 1 or len(re.findall('\D{8}', dic2[d][0])) == 1) and (
                    len(re.findall('\d\/\d{2}\/\d', dic2[d - 1][1])) == 0 or len(
                re.findall('\d\/\d{2}\/\d', dic2[d - 1][1])) == 1) and (
                    len(re.findall('\D{5}\s\D\(\d{2}\D\d{3}\)\D{2}\s\d{2}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{8}\s\d{3}\D{2}\s\d\D{2}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{7}\s\D{2}\s\d{2}\D{2}\s\d\D{2}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{8}\s\D\s\D{3}\s\(\d{4}\)\s\d', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{7}\s\d\D{2}\s\D{7}\s\D{7}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{8}\s\d{2}\D{2}\s\d\D{2}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{2}\s\d\.\d\%\s\d{3}\D{2}\s\D\.\s\D', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{11}\s\D{7}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{8}\s\D{8}\s\d\D{2}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{6}\s\d{2}\D\s\D\s\d\s\d\/\d', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{3}\s\d\%\s\D{4}\s\D{10}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{8}\s\(\d{2}\D\d{3}\D\d{2}\)\D{2}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{8}\s\d\.\d\D{2}\s\d\D{2}', dic2[d - 1][0])) == 1) and len(
                re.findall('\d\.\d', dic2[d][5])) == 1 and \
                    dic2[d].count(' ') >= 3 and dic2[d - 1].count(' ') <= 2:
                print('for 220100769407 with 5th index replaced in d-1 5th index')
                dic2[d - 1][5] = dic2[d][5]
                dic2[d][5] = ' '
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if d > 1 and d < len(dic2) and len(re.findall('\d\.\d', dic2[d][5])) == 1 and len(
                    re.findall('\d\/\d{2}\/\d', dic2[d - 1][1])) == 1 and (
                    len(re.findall('\D{8}\s\d{3}\D{2}\s\d{2}\s\D{6}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{7}\s\d{2}\D{2}\s\D{7}\s\D{7}\s\(\D{2}\)', dic2[d - 1][0])) == 1) and len(
                re.findall('\d\.\d', dic2[d - 1][5])) == 0 and \
                    dic2[d].count(' ') >= 3 and dic2[d - 1].count(' ') <= 2:
                print('for 220100769407 if d contains 4,5th index and d-1 contains 1,2,3,4 index')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if len(dic2[d][4].split()) == 3 and len(re.findall('\d\.\d', dic2[d][4])) == 1:
                a, b, c = dic2[d][4].split()
                dic2[d][4] = b + c
            if d > 1 and len(re.findall('\w+', dic2[d][0])) and dic2[d - 1][0] in head_list and dic2[d].count(' ') == 5:
                print('line merge', dic2[d])
                dic2[d + 1][0] = dic2[d][0] + dic2[d + 1][0]
                dic2[d][0] = ' '

            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'Sahyadri-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][3] == dic2[d][4]:
                dic2[d][4] = ' '
            if len(dic2[d][3].split()) == 3 and dic2[d][4] == ' ':
                # print('if qty number and rate together')
                a, b, c = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = c
            if len(dic2[d][2].split()) == 3 and dic2[d][3] == ' ' and len(re.findall('\D{3}\-\d', dic2[d][2])) == 1:
                print('if expdate and qty number together')
                a, b, c = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = b
            if len(dic2[d][4].split()) == 2 and len(re.findall('\d\.\d', dic2[d][4])) == 1 and len(
                    re.findall('\d\,', dic2[d][4].split()[0])) == 0 and dic2[d][4] != dic2[d][5]:
                print('if qty and rate together')
                a, b = dic2[d][4].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if dic2[d][3].__contains__('Number'):
                dic2[d][3] = dic2[d][3].replace('Number', ' ')
            if dic2[d][3].__contains__('ML'):
                dic2[d][3] = dic2[d][3].replace('ML', ' ')
            if dic2[d][3].__contains__('Kit'):
                dic2[d][3] = dic2[d][3].replace('Kit', ' ')
            if dic2[d][3].__contains__('Strip'):
                dic2[d][3] = dic2[d][3].replace('Strip', ' ')
            if dic2[d][3].__contains__('Bottle'):
                dic2[d][3] = dic2[d][3].replace('Bottle', ' ')
            if len(dic2[d][5].split()) == 2 and dic2[d][5] != ' ' and (
                    dic2[d][5].split()[0] == '0.00' or dic2[d][5].split()[0] == '0.0' or dic2[d][5].split()[0] == '0' or
                    dic2[d][5].split()[0] == '0.OC'):
                print('if conc and net together')
                a, b = dic2[d][5].split()
                dic2[d][5] = b
            if len(dic2[d][5].split()) == 3 and len(re.findall('\d\.\d', dic2[d][5])) == 2:
                a, b, c = dic2[d][5].split()
                dic2[d][5] = b + c
            if dic2[d][5].__contains__('*'):
                dic2[d][5] = dic2[d][5].replace('*', '')
            if dic2[d][5].__contains__('- -') or dic2[d][5].__contains__('---'):
                dic2[d][5] = ' '
            if len(dic2[d][4].split()) == 2 and dic2[d][5] == ' ' and len(re.findall('\d\.\d', dic2[d][4])) == 2:
                print('if 4th and 5th index together in 4th index')
                a, b = dic2[d][4].split()
                dic2[d][4] = a
                dic2[d][5] = b
            if ' ' in dic2[d][3] and dic2[d][3] != ' ':
                dic2[d][3] = dic2[d][3].replace(' ', '')
            if d > 1 and d < len(dic2) and (len(re.findall('\D{6}', dic2[d][0])) == 1 or len(
                    re.findall('\D{8}\s\(\D{8}\)', dic2[d][0])) == 1 or len(
                re.findall('\D{7}\s\(\D{2}\)', dic2[d][0])) == 1 or len(
                re.findall('\D{8}\s\(\D{8}\)', dic2[d][0])) == 1 or len(
                re.findall('\D{9}', dic2[d][0])) == 1) and len(re.findall('\d\/\d{2}\/\d', dic2[d][1])) == 1 and (
                    len(re.findall('\D{7}\s\D\s\(\d{3}\D\d{2}\)\D{2}\s\d{2}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{2}\s\d\.\d\%\s\d{3}\D{2}\s\D\.\s\D\.', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{7}\s\d{2}\D{2}\s\D{7}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{5}\s\D{2}\s\d\D{3}\s\D{4}', dic2[d - 1][0])) == 1) and len(
                re.findall('\d\.\d', dic2[d - 1][5])) == 1 and \
                    dic2[d].count(' ') >= 3 and dic2[d - 1].count(' ') <= 2:
                print('for 220100769407 with d>=3 and d-1<=2')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if d > 1 and d < len(dic2) and (len(re.findall('\D{7}\s\(\D{2}\)', dic2[d][0])) == 1 or len(
                    re.findall('\D{8}\s\(\D{4}\s\D{2}\s\d{3}\)', dic2[d][0])) == 1 or len(
                re.findall('\w{7}\)', dic2[d][0])) == 1) and len(
                re.findall('\d\/\d{2}\/\d', dic2[d - 1][1])) == 1 and (
                    len(re.findall('\D{7}\s\d{2}\D{2}\s\D{7}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{6}\s\D{11}\s\(\D\)', dic2[d - 1][0])) == 1 or len(
                re.findall('\D\.\s\D\s\D{3}\s\D{10}', dic2[d - 1][0])) == 1) and len(
                re.findall('\d\.\d', dic2[d][5])) == 1 and \
                    dic2[d].count(' ') >= 2 and dic2[d - 1].count(' ') <= 3:
                print('for 220100769407 with d>=2 and d-1<=3')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if d > 1 and d < len(dic2) and (len(re.findall('\D{8}\s\(\D{8}\)', dic2[d][0])) == 1 or len(
                    re.findall('\(\D{9}\)\s\D{2}\s\d{2}\s\(\D{2}\)', dic2[d][0])) == 1) and len(
                re.findall('\d\/\d{2}\/\d', dic2[d][1])) == 1 and (
                    len(re.findall('\D{3}\s\d\.\d\%\s\d{3}\D{2}\s\D\.\s\D\.', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{7}\s\D{3}\s\D{6}', dic2[d - 1][0])) == 1) and len(
                re.findall('\d\.\d', dic2[d][5])) == 1 and \
                    dic2[d].count(' ') <= 2 and dic2[d - 1].count(' ') >= 3:
                print('for 220100769407 with d<=2 and d-1>=2')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if d > 1 and (len(re.findall('\d{2}\s\D{6}', dic2[d][0])) == 1) and len(
                    re.findall('\d\/\d{2}\/\d', dic2[d - 1][1])) == 1 and (
                    len(re.findall('\D{5}\s\D{7}\s\D\d\s\d{3}\D{2}', dic2[d - 1][0])) == 1) and len(
                re.findall('\d\.\d', dic2[d][5])) == 1 and \
                    dic2[d].count(' ') >= 3 and dic2[d - 1].count(' ') <= 2:
                print('for 220100769407 with 4th index replaced in d-1 4th index')
                dic2[d - 1][4] = dic2[d][4]
                dic2[d][4] = ' '
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if d > 1 and (
                    len(re.findall('\D{6}', dic2[d][0])) == 1 or len(re.findall('\D{9}', dic2[d][0])) == 1 or dic2[d][
                0] == ' ' or len(re.findall('\(\D{2}\)', dic2[d][0])) == 1 or len(
                re.findall('\D{7}\)\s\D{2}\s\d\.\d\%\s\d{3}\D{2}\s\D\.\D', dic2[d][0])) == 1 or len(
                re.findall('\D{8}\)\s\D{5}\s\D{8}\s\D{5}\s\D{5}', dic2[d][0])) == 1 or len(
                re.findall('\D{9}\s\(\D{8}\)', dic2[d][0])) == 1 or len(
                re.findall('\(\D{5}\)', dic2[d][0])) == 1 or len(
                re.findall('\d{2}\D{2}\s\D{9}', dic2[d][0])) == 1 or len(
                re.findall('\d{2}\s\D{6}', dic2[d][0])) == 1 or len(re.findall('\D{8}', dic2[d][0])) == 1) and (
                    len(re.findall('\d\/\d{2}\/\d', dic2[d - 1][1])) == 0 or len(
                re.findall('\d\/\d{2}\/\d', dic2[d - 1][1])) == 1) and (
                    len(re.findall('\D{5}\s\D\(\d{2}\D\d{3}\)\D{2}\s\d{2}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{8}\s\d{3}\D{2}\s\d\D{2}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{7}\s\D{2}\s\d{2}\D{2}\s\d\D{2}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{8}\s\D\s\D{3}\s\(\d{4}\)\s\d', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{7}\s\d\D{2}\s\D{7}\s\D{7}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{8}\s\d{2}\D{2}\s\d\D{2}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{2}\s\d\.\d\%\s\d{3}\D{2}\s\D\.\s\D', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{11}\s\D{7}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{8}\s\D{8}\s\d\D{2}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{6}\s\d{2}\D\s\D\s\d\s\d\/\d', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{3}\s\d\%\s\D{4}\s\D{10}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{8}\s\(\d{2}\D\d{3}\D\d{2}\)\D{2}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{8}\s\d\.\d\D{2}\s\d\D{2}', dic2[d - 1][0])) == 1) and len(
                re.findall('\d\.\d', dic2[d][5])) == 1 and \
                    dic2[d].count(' ') >= 3 and dic2[d - 1].count(' ') <= 2:
                print('for 220100769407 with 5th index replaced in d-1 5th index')
                dic2[d - 1][5] = dic2[d][5]
                dic2[d][5] = ' '
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if d > 1 and d < len(dic2) and len(re.findall('\d\.\d', dic2[d][5])) == 1 and len(
                    re.findall('\d\/\d{2}\/\d', dic2[d - 1][1])) == 1 and (
                    len(re.findall('\D{8}\s\d{3}\D{2}\s\d{2}\s\D{6}', dic2[d - 1][0])) == 1 or len(
                re.findall('\D{7}\s\d{2}\D{2}\s\D{7}\s\D{7}\s\(\D{2}\)', dic2[d - 1][0])) == 1) and len(
                re.findall('\d\.\d', dic2[d - 1][5])) == 0 and \
                    dic2[d].count(' ') >= 3 and dic2[d - 1].count(' ') <= 2:
                print('for 220100769407 if d contains 4,5th index and d-1 contains 1,2,3,4 index')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if len(dic2[d][4].split()) == 3 and len(re.findall('\d\.\d', dic2[d][4])) == 1:
                a, b, c = dic2[d][4].split()
                dic2[d][4] = b + c
            if d > 1 and len(re.findall('\w+', dic2[d][0])) and dic2[d - 1][0] in head_list and dic2[d].count(' ') == 5:
                print('line mergeeeeee', dic2[d])
                dic2[d + 1][0] = dic2[d][0] + dic2[d + 1][0]
                dic2[d][0] = ' '

            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'Billroth':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][1] == 'ORATORY INVESTIGATIONS':
                dic2[d][1] = 'LABORATORY INVESTIGATIONS'
            if d > 1 and d < len(dic2) and dic2[d][1] + ' ' + dic2[d + 1][1] in head_list:
                dic2[d][1] = dic2[d][1] + ' ' + dic2[d + 1][1]
                dic2[d + 1][1] = ' '
            for i in head_list:
                if i == dic2[d][1] and dic2[d].count(' ') >= 4:
                    print('change header from header from 1 to 0 indx')
                    dic2[d][0] = i
                    dic2[d][1] = ' '
            if dic2[d][0] != ' ' and dic2[d][0] in head_list and dic2[d].count(' ') <= 3:
                print('if header is line item')
                dic2[d][0] = dic2[d][0].lower()
            for i in src_dc['merge_set'].split(','):
                if i == dic2[d][1] and dic2[d].count(' ') >= 4:
                    print('change header from mergeset from 1 to 0 indx')
                    dic2[d][0] = i
                    dic2[d][1] = ' '

            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'Columbia':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if d>1 and dic2[d][0] == 'CONSULTATION' and dic2[d-1][0] == 'SPECIALIST':
                dic2[d][0] = dic2[d][0].lower()
            if d>1 and dic2[d][0] == 'Consultation' and dic2[d+1][0].__contains__('Specialist IP'):
                dic2[d+1][0] = dic2[d][0]+dic2[d+1][0]
                dic2[d][0] = ' '
            if len(re.findall('\d\/\d{2}\/\d{4}', dic2[d][0])) == 1 or len(
                    re.findall('\d\/\d{2}\/\d{3}', dic2[d][0])) == 1:
                dic2[d][0] = ' '
            if dic2[d][2] == '1 00':
                dic2[d][2] = '1.00'
            if len(re.findall('\d\s\d', dic2[d][2])) == 1 and len(re.findall('\d\s\d{2}\.\d', dic2[d][2])) == 0:
                dic2[d][2] = dic2[d][2].replace(' ', '.')
            if len(re.findall('\d\,\d', dic2[d][2])) == 1:
                dic2[d][2] = dic2[d][2].replace(',', '.')
            if dic2[d][2] == 'sub Total':
                dic2[d][2] = 'Sub Total'
            if dic2[d][4].__contains__('@') or dic2[d][4].__contains__('%'):
                dic2[d][4] = ' '
            if dic2[d][5].__contains__('@') or dic2[d][5].__contains__('%'):
                dic2[d][5] = ' '
            if d > 1 and d < len(dic2) and len(re.findall('\d\/\d{2}\/\d{3}', dic2[d][1])) == 1 and len(
                    re.findall('\w{2}', dic2[d][2])) == 1 and len(re.findall('\d\.\d', dic2[d][3])) == 1 and \
                    len(re.findall('\w{2}\)\;\s\w{7}', dic2[d - 1][0])) == 1 and dic2[d].count(' ') == 1 and dic2[
                d - 1].count(' ') == 5:
                print('for 220100787250 MM); KOMSONS')
                dic2[d][2] = '4.00'
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if d > 1 and d < len(dic2) and len(re.findall('\d\/\d{2}\/\d{3}', dic2[d][1])) == 1 and len(
                    re.findall('\w{2}', dic2[d][2])) == 1 and len(re.findall('\d\.\d', dic2[d][3])) == 1 and \
                    len(re.findall('\w{7}', dic2[d - 1][0])) == 1 and dic2[d].count(' ') == 1 and dic2[d - 1].count(
                ' ') == 5:
                print('for 220202442261 POLYMED')
                dic2[d][2] = '1.00'
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if d > 1 and d < len(dic2) and dic2[d - 1][3] == ' ' and dic2[d - 1][4] == ' ' and dic2[d - 1][5] == ' ' and \
                    dic2[d - 1].count(' ') == 3 and dic2[d].count(' ') <= 3 and dic2[d - 1][2] != ' ' and len(
                    re.findall('\d\.\d', dic2[d][2])) == 0:
                print('if d-1 with 3 spaces and d with <=3 space')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if d > 1 and d < len(dic2) and dic2[d - 1][3] == ' ' and dic2[d - 1][4] == ' ' and dic2[d - 1][5] == ' ' and \
                    dic2[d - 1][1] == ' ' and dic2[d - 1].count(' ') == 4 and dic2[d].count(' ') <= 2 and len(
                    re.findall('\d\.\d', dic2[d][2])) == 0:
                print('if d-1 with 4 spaces and d with <=2 space')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if d > 1 and d < len(dic2) and len(re.findall('\w{7}\(\w{7}', dic2[d][0])) == 1 and len(
                    re.findall('\(\d{2}\.\d{2}\)', dic2[d][2])) == 1 and len(
                    re.findall('\w{7}\s\w{2}', dic2[d - 1][0])) == 1 and \
                    len(re.findall('\w{4}\s\w{5}', dic2[d - 1][2])) == 1 and len(
                re.findall('\d{3}\.\d{2}', dic2[d - 1][3])) == 1 and dic2[d].count(' ') == 1 and dic2[d - 1].count(
                ' ') == 2:
                print('with d 1 space and d-1 ==2 spaces qty misplaced in d')
                dic2[d - 1][2] = dic2[d][2]
                dic2[d][2] = ' '
            if d > 1 and d < len(dic2) and (
                    len(re.findall('\(\w{9}\)', dic2[d][0])) == 1 or len(re.findall('\w{9}', dic2[d][0])) == 1) and len(
                    re.findall('\w{2}', dic2[d][2])) == 1 and (
                    len(re.findall('\w{4}\s\w{5}', dic2[d - 1][0])) == 1 or len(
                    re.findall('\d\s\w{5}\s\w{2}', dic2[d - 1][0])) == 1) and \
                    len(re.findall('\d\.\d', dic2[d - 1][2])) == 1 and len(
                re.findall('\d{3}\.\d{2}', dic2[d][3])) == 1 and dic2[d].count(' ') == 1 and dic2[d - 1].count(
                ' ') == 2:
                print('with d 1 space and d-1 ==2 spaces and d[3] == 1')
                dic2[d - 1][3] = dic2[d][3]
                dic2[d][3] = ' '
            if d > 1 and d < len(dic2) and len(re.findall('\w{9}\;', dic2[d][0])) == 1 and len(
                    re.findall('\w{4}\s\w{4}\s\d\.\d\s\w{2}', dic2[d][2])) == 1 and len(
                    re.findall('\d\s\w{7}\;\s\d\w{2}\;', dic2[d - 1][0])) == 1 and \
                    len(re.findall('\d{3}\.\d{2}', dic2[d - 1][3])) == 1 and dic2[d].count(' ') == 1 and dic2[
                d - 1].count(' ') == 3:
                print('with d 1 space and d-1 ==3 spaces qty misplaced in d')
                dic2[d - 1][2] = dic2[d][2]
                dic2[d][2] = ' '
            if d > 1 and d < len(dic2) and len(re.findall('\w{7}', dic2[d][0])) == 1 and len(
                    re.findall('\d\.\d', dic2[d][2])) == 1 and len(re.findall('\d\s\w{10}', dic2[d - 1][0])) == 1 and \
                    len(re.findall('\d{3}\.\d{2}', dic2[d - 1][3])) == 1 and dic2[d].count(' ') == 2 and dic2[
                d - 1].count(' ') == 1:
                print('with d 2 space and d-1 ==1 spaces qty misplaced in d')
                dic2[d - 1][2] = dic2[d][2]
                dic2[d][2] = ' '
            if d > 1 and d < len(dic2) and len(re.findall('\(\w{11}\)', dic2[d][0])) == 1 and len(
                    re.findall('\w{4}\s\w{1}', dic2[d][2])) == 1 and len(
                    re.findall('\d\s\w{5}\s\d{2}\w{2}\s\w{6}', dic2[d - 1][0])) == 1 and \
                    len(re.findall('\d\.\d', dic2[d - 1][2])) == 1 and dic2[d].count(' ') == 3 and dic2[d - 1].count(
                ' ') == 1 and dic2[d - 1][3] == ' ':
                print('with d 3 space and d-1 ==1 space')
                dic2[d - 1][3] = dic2[d][3]
                dic2[d][3] = ' '
            if d > 1 and d < len(dic2) and len(re.findall('\d\w{2}\s\-\s\d{2}\w{3}', dic2[d][0])) == 1 and len(
                    re.findall('\d\.\d', dic2[d][2])) == 1 and len(
                    re.findall('\d\s\w{4}\s\w{5}\s\d\w{2}', dic2[d - 1][0])) == 1 and \
                    len(re.findall('\d\.\d', dic2[d - 1][3])) == 1 and dic2[d].count(' ') == 2 and dic2[d - 1].count(
                ' ') == 3 and dic2[d - 1][2] == ' ':
                print('with d 2 space and d-1 ==3 space and qty misplaced')
                dic2[d - 1][2] = dic2[d][2]
                dic2[d][2] = ' '
            if d > 1 and d < len(dic2) and len(re.findall('\w{6}', dic2[d][0])) == 1 and len(
                    re.findall('\d\.\d{2}', dic2[d][2])) == 1 and len(
                    re.findall('\w{5}\s\w{7}\s', dic2[d - 1][0])) == 1 and \
                    len(re.findall('\d\.\d', dic2[d - 1][2])) == 0 and dic2[d].count(' ') == 4 and dic2[d - 1].count(
                ' ') == 5:
                print('for 220202482397 RENAL PROFILE *')
                dic2[d - 1][2] = dic2[d][2]
                dic2[d][2] = ' '
            if d > 1 and d < len(dic2) and len(re.findall('\w{5}\:\w{12}', dic2[d][0])) == 1 and len(
                    re.findall('\d{5}\.\d{2}', dic2[d][4])) == 1 and len(
                    re.findall('\d{2}\,\d{3}\.\d{2}', dic2[d][5])) == 1 and \
                    len(re.findall('\d\.\d', dic2[d + 1][2])) == 0 and dic2[d].count(' ') == 3 and dic2[d + 1].count(
                ' ') == 5:
                print('for 220202482397 Tract:Cholecystect')
                dic2[d][2] = '1.00'
                dic2[d][3] = dic2[d][4]
            if dic2[d][2] != ' ' and dic2[d][3] != ' ' and len(re.findall('\d\.\d', dic2[d][2])) == 0 and len(
                    re.findall('\.\d{2}', dic2[d][2])) == 0 and len(re.findall('\d\s\d{2}', dic2[d][2])) == 0 and len(
                    re.findall('\d\.\d', dic2[d][3])) == 1 and 'Sub Total' not in dic2[d][2]:
                print('with no digit dot digit in 2nd index and  3rd index not empty in first loop', dic2[d])
                dic2[d][2] = dic2[d][2] + '1.00'
            if dic2[d][2] == ' ' and dic2[d][3] != ' ' and len(
                    re.findall('\d\.\d', dic2[d][3])) == 1 and 'Sub Total' not in dic2[d][2] and dic2[d].count(
                    ' ') <= 2:
                print('with empty space in 2nd index and  3rd index not empty in first loop', dic2[d])
                dic2[d][2] = '1.00'

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd111==', dic2[d])
            if dic2[d][2] != ' ' and dic2[d][3] != ' ' and len(re.findall('\d\.\d', dic2[d][2])) == 0 and len(
                    re.findall('\.\d{2}', dic2[d][2])) == 0 and len(re.findall('\d\s\d{2}', dic2[d][2])) == 0 and len(
                    re.findall('\d\.\d', dic2[d][3])) == 1 and 'Sub Total' not in dic2[d][2]:
                print('with no digit dot digit in 2nd index and  3rd index not empty in second loop', dic2[d])
                dic2[d][2] = dic2[d][2] + '1.00'
            if d>1 and d<len(dic2)-2 and dic2[d][0]!= ' ' and dic2[d+1][0]== ' ' and dic2[d][0] in head_list and dic2[d+1].count(' ')==6 and dic2[d].count(' ')==5 and \
                    dic2[d+2] not in head_list and dic2[d+2]!= ' ' and dic2[d+2].count(' ')>=4 and dic2[d+2][2]== ' ':
                print('Header and line merge with d count 5, d+1 count 6, d+2 count >=4 and d+2[2]== empty')
                # written for saltlake pdf 220202524500
                dic2[d+3][0] = dic2[d+2][0]+' '+dic2[d+3][0]
                dic2[d+2][0] = ' '

            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'golden-jaipur':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if len(dic2[d][2].split()) == 2 and len(re.findall('\d\.\d', dic2[d][2])) == 2 and (
                    dic2[d][3] == ' ' or dic2[d][3] in dic2[d][2]):
                print('if 2nd index have rate and qty merged')
                a, b = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = b
            if len(dic2[d][3].split()) == 2 and len(re.findall('\d\.\d', dic2[d][3])) == 2 and dic2[d][2] == ' ':
                print('if 3rd index have rate and qty merged')
                a, b = dic2[d][3].split()
                dic2[d][2] = a
                dic2[d][3] = b
            if dic2[d][2] in dic2[d][3] and len(re.findall('\d\.\d', dic2[d][2])) == 1 and len(
                    re.findall('\d\.\d', dic2[d][3])) == 2:
                print('if rate in qty ')
                dic2[d][3] = dic2[d][3].replace(dic2[d][2], '')

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd11==', dic2[d])
            if dic2[d][2] != ' ' and len(dic2[d][2].split()) >= 2 and 'Total' not in dic2[d][2]:
                text = dic2[d][2].split()
                dic2[d][3] = text[-1]
                dic2[d][2] = text[0]

            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'Bethany':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if len(dic2[d][3].split()) >= 2:
                print('splitting qty and cgst vals')
                text = dic2[d][3].split()
                dic2[d][3] = text[0]
            if len(dic2[d][5].split()) == 2:
                print('splitting cgst and amt vals')
                text = dic2[d][5].split()
                dic2[d][4] = text[0]
                dic2[d][5] = text[1]
            if d>1 and dic2[d][2].__contains__('Package Value') and dic2[d][3]!= ' ':
                print('for package values')
                dic2[d-1][5] = dic2[d][3]
                dic2[d-1][3] = dic2[d][1]
                dic2[d][1] = ' '
                dic2[d][0] = ' '
                dic2[d][2] = ' '
                dic2[d][3] = ' '
            if dic2[d][1].__contains__('Package Class'):
                dic2[d][1] = dic2[d][1].replace('Package Class','')
            if d > 1 and dic2[d][2] != ' ' and dic2[d].count(' ') == 5 and dic2[d - 1][2] != ' ' and dic2[d - 1].count(
                    ' ') <= 2:
                print('merging occup in d with d-1 line')
                dic2[d - 1][2] = dic2[d - 1][2] + ' ' + dic2[d][2]
                dic2[d][2] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Bethany-pharma' or hospital=='Sterling_N0704-pharma' or hospital=='Surana_N4358-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if d > 1 and dic2[d][2] == ' ' and len(re.findall('\d\.\d', dic2[d][4])) == 1 and len(
                    re.findall('\d\.\d', dic2[d][5])) == 1 and dic2[d - 1][2] != ' ' and \
                    ('Total F' not in dic2[d - 1][0] or 'Total F' not in dic2[d][0]) and dic2[d].count(' ') <= 2 and \
                    dic2[d - 1].count(' ') <= 4:
                print('if two lines are separated by Total amount')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue

            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'Basavatarakam':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if len(re.findall('\.\s', dic2[d][3])) >= 1:
                text = dic2[d][3]
                matchspaceright = re.search(r'\.\s', text)
                print('matchhspaceright in 3rd index', matchspaceright.group())
                dic2[d][3] = text.replace(matchspaceright.group(), '.')
            if len(re.findall('\.\s', dic2[d][4])) >= 1:
                text = dic2[d][4]
                matchspaceright = re.search(r'\.\s', text)
                print('matchhspaceright in 4th index', matchspaceright.group())
                dic2[d][4] = text.replace(matchspaceright.group(), '.')
            if len(re.findall('\s\.', dic2[d][3])) >= 1:
                text = dic2[d][3]
                matchspaceleft = re.search(r'\s\.', text)
                print('matchhspaceleft in 3rd index', matchspaceleft.group())
                dic2[d][3] = text.replace(matchspaceleft.group(), '.')
            if len(re.findall('\s\.', dic2[d][4])) >= 1:
                text = dic2[d][4]
                matchspaceleft = re.search(r'\s\.', text)
                print('matchhspaceleft in 4th index', matchspaceleft.group())
                dic2[d][4] = text.replace(matchspaceleft.group(), '.')

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd11==', dic2[d])
            if d >= 1 and d < len(dic2) and dic2[d][0] != ' ' and dic2[d + 1][0] != ' ' and dic2[d][0] + dic2[d + 1][
                0] in head_list:
                print('in headlisttt')
                dic2[d][0] = dic2[d][0] + dic2[d + 1][0]
                dic2[d + 1][0] = ' '
            if d >= 1 and d < len(dic2) and dic2[d][0] != ' ' and dic2[d + 1][0] != ' ' and dic2[d][0] + ' ' + \
                    dic2[d + 1][0] in head_list:
                print('in headlisttt with space')
                dic2[d][0] = dic2[d][0] + ' ' + dic2[d + 1][0]
                dic2[d + 1][0] = ' '
            if dic2[d][1] != ' ' and len(re.findall('^\d+\.?\s', dic2[d][1])) == 1 and len(dic2[d][1].split()[0]) <= 4:
                print('to remove sno')
                text = dic2[d][1]
                matchsno = re.search(r'^\d+\.?\s', text)
                dic2[d][1] = dic2[d][1].replace(matchsno.group(), '')
                dic2[d][1] = dic2[d][1].strip()
            if dic2[d][2] != ' ' and len(dic2[d][2].split()) >= 1 and len(re.findall('\d\.\d', dic2[d][2])) == 1:
                print('if QTy, Tax rate  in 2nd indx')
                if len(dic2[d][2].split()) == 2:
                    text = dic2[d][2].split()
                    dic2[d][2] = text[0]
                elif len(dic2[d][2].split()) == 1 and len(re.findall('\d\.\d', dic2[d][2])) == 1:
                    dic2[d][2] = ' '
            if dic2[d][3] != ' ' and len(dic2[d][3].split()) >= 2 and len(re.findall('\d\.\d', dic2[d][3])) == 2:
                print('if Rate, gross amt  in 3rd indx')
                text = dic2[d][3].split()
                dic2[d][3] = text[0]
                dic2[d][4] = text[-1]
            if dic2[d][3] != ' ' and len(dic2[d][3].split()) >= 2 and len(re.findall('\d\.\d', dic2[d][3])) >= 2:
                print('if Rate, gross amt,Disc, Taxable,gst,net  in 3rd indx')
                text = dic2[d][3].split()
                dic2[d][3] = text[0]
                dic2[d][4] = text[1]
            if dic2[d][4] != ' ' and len(dic2[d][4].split()) >= 3 and len(re.findall('\d\.\d', dic2[d][4])) >= 3:
                print('if gross amt, disc, taxable, GST, Net in 4th indx')
                text = dic2[d][4].split()
                dic2[d][4] = text[0]
                dic2[d][5] = text[-1]

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Basavatarakam-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if d >= 1 and d < len(dic2) and dic2[d][4].__contains__('SUB') and dic2[d + 1][4] == 'TOTAL':
                dic2[d][4] = ' '
                dic2[d][5] = ' '
                dic2[d + 1][4] = ' '
                dic2[d + 1][5] = ' '
            if d >= 1 and d < len(dic2) and dic2[d][4].__contains__('SUB') and dic2[d][5] != ' ':
                dic2[d][4] = ' '
                dic2[d][5] = ' '
            if dic2[d][1] != ' ' and dic2[d][2] != ' ' and dic2[d][1] == dic2[d][2]:
                dic2[d][1] = ' '
            if dic2[d][3] != ' ' and dic2[d][4] != ' ' and len(re.findall('\d+\.\d+', dic2[d][3])) >= 1 and dic2[d][
                3] == dic2[d][4]:
                print('if 3rd indx and 4th indx are same with rate and amount values')
                dic2[d][3] = ' '
            if dic2[d][3] != ' ' and len(re.findall('\d+\.\d+', dic2[d][3])) >= 1 and dic2[d][4] == ' ' and dic2[d][
                5] != ' ':
                print('if page tilted and rate, amount values in QTy place')
                dic2[d][4] = dic2[d][3]
                dic2[d][3] = ' '
            if dic2[d][2] != ' ' and len(re.findall('\d+', dic2[d][2])) >= 1 and len(
                    dic2[d][2].split()[-1]) <= 2 and len(re.findall('\d+\.\d+$', dic2[d][2])) == 0:
                # print('if Qty with date')
                text = dic2[d][2].split()
                dic2[d][3] = text[-1]
                dic2[d][2] = dic2[d][2].replace(text[-1], '')
            if dic2[d][2] != ' ' and len(re.findall('\d+', dic2[d][2])) >= 1 and len(
                    re.findall('\d+\.\d+$', dic2[d][2])) == 1 and len(dic2[d][2].split()[-2]) <= 2:
                # print('if Qty mrp with date')
                text = dic2[d][2].split()
                dic2[d][4] = text[-1]
                dic2[d][3] = text[-2]
                dic2[d][2] = dic2[d][2].replace(text[-1], '').replace(text[-2], '')
            if dic2[d][2] != ' ' and len(re.findall('\d+', dic2[d][2])) >= 1 and len(
                    re.findall('\d\s\d+\.\d+\s\d+\.\d+$', dic2[d][2])) == 1 and len(dic2[d][2].split()) >= 4:
                # print('if Qty mrp amount with date')
                text = dic2[d][2].split()
                dic2[d][5] = text[-1]
                dic2[d][4] = text[-2]
                dic2[d][3] = text[-3]
                dic2[d][2] = dic2[d][2].replace(text[-1], '').replace(text[-2], '').replace(text[-3], '')
            if dic2[d][0] != ' ' and len(re.findall('\d+\s\d+\.\d+$', dic2[d][0])) == 1:
                # print('if QTy, mrp in 0th indx with dot and space extra')
                text = dic2[d][0]
                matchqtymrp = re.search(r'\d+\s\d+\.\d+$', text)
                dic2[d][3] = matchqtymrp.group()
                dic2[d][0] = dic2[d][0].replace(matchqtymrp.group(), '')
                dic2[d][0] = dic2[d][0].strip()
            if dic2[d][0] != ' ' and len(re.findall('\d+\s\d+\.\d+\s\d+\.\d+$', dic2[d][0])) == 1:
                # print('if QTy, mrp , amt in 0th indx with dot and space extra')
                text = dic2[d][0]
                matchqtymrpamt = re.search(r'\d+\s\d+\.\d+\s\d+\.\d+$', text)
                dic2[d][3] = matchqtymrpamt.group()
                dic2[d][0] = dic2[d][0].replace(matchqtymrpamt.group(), '')
                dic2[d][0] = dic2[d][0].strip()
            if dic2[d][3] != ' ' and len(dic2[d][3].split()) == 2 and len(re.findall('\d\.\d', dic2[d][3])) == 1:
                # print('if qTY , mrp  together in 3rd index')
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if dic2[d][3] != ' ' and len(dic2[d][3].split()) == 3 and len(re.findall('\d\.\d', dic2[d][3])) == 2:
                # print('if qTY , mrp amt  together in 3rd index')
                a, b, c = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
                dic2[d][5] = c
            if dic2[d][4] != ' ' and len(dic2[d][4].split()) >= 2 and len(re.findall('\d\.\d', dic2[d][4])) >= 2:
                # print('if MRP , amount if discount also  together in 4th index')
                text = dic2[d][4].split()
                dic2[d][4] = text[0]
                dic2[d][5] = text[1]
            if dic2[d][5] != ' ' and len(dic2[d][5].split()) >= 2 and len(re.findall('\d\.\d', dic2[d][5])) >= 2 and \
                    dic2[d][4] != ' ':
                # print('if amount, Disc, taxable  together in 5th index')
                text = dic2[d][5].split()
                dic2[d][5] = text[0]

            dic1[lq] = dic2[d]
            lq += 1

    if hospital=='dayanand' or hospital=='dayanand_daycare':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if len(re.findall('\d\s?\.\s?\d', dic2[d][5])) == 1 or len(re.findall('\d\s\d', dic2[d][5])) == 1 or len(re.findall('\d\.\D', dic2[d][5])) == 1 or len(re.findall('\d\s\D', dic2[d][5])) == 1 or len(re.findall('\d\s\d{2}\s\d{2}', dic2[d][5])) == 1 or len(re.findall('\d\s\d{3}\s\d{2}', dic2[d][5])) == 1:
                dic2[d][6] = dic2[d][5]
                dic2[d][5] = ' '
            if dic2[d][3].__contains__('No') or dic2[d][3].__contains__('NO'):
                dic2[d][3] = ' '
            if dic2[d][4].__contains__('No') or dic2[d][4].__contains__('NO') or dic2[d][4].__contains__('Vo'):
                dic2[d][4] = ' '
            if dic2[d][5] == 'SINGH BABRA' or dic2[d][5] == 'Dr. RAVINDER PAL':
                dic2[d][5] = ' '
            if dic2[d][0] == 'PHARMACY CHARGES 1cause OLLA' or dic2[d][0] == 'PHARMACY CHARGES med . Out':
                dic2[d][0] = 'PHARMACY CHARGES'
            if len(re.findall('\d\s?\.\s?\d', dic2[d][4])) == 1:
                dic2[d][6] = dic2[d][4]
                dic2[d][4] = ' '
            if dic2[d][1]!=' ' and len(re.findall('\d\s?\.\s?\d', dic2[d][1])) == 1:
                dic2[d][2] = dic2[d][1]
                dic2[d][1] = ' '
            if dic2[d][0] == 'NURSING CARE CHARGES' and (len(re.findall('\d\s?\.\s?\d', dic2[d][2])) == 1 or len(re.findall('\d\s?\.\s?\D', dic2[d][2])) == 1) and (len(re.findall('\d\s?\.\s?\d', dic2[d][6])) == 1 or len(re.findall('\d\s\d', dic2[d][6])) == 1):
                dic2[d][0] = dic2[d][0]+'s'
            if d>1 and d<len(dic2) and dic2[d][0] == dic2[d-1][0] and dic2[d-1][0] in head_list:
                print('adding extra s for same header')
                dic2[d][0] = dic2[d][0]+'s'
            if d>1 and d<len(dic2) and (len(re.findall('\D{5}\-\d{2}\s\D{2}\-\D{3}', dic2[d][0])) == 1 or len(re.findall('\D{6}\s\D{8}', dic2[d][0])) == 1 or len(re.findall('\d\,\d{2}\D{2}\,\s\d{2}\D{2}\,\s\d\/\d\s\D{6}\,\s\D{5}', dic2[d][0])) == 1 or len(re.findall('\(\d{2}\D{2}\)\s\D{3}\s\(\D{3}\s\D{4}', dic2[d][0])) == 1 or len(re.findall('\d\.\d\-\D{3}\s\(\D{3}\s\D{4}\-\d{8}', dic2[d][0])) == 1 or len(re.findall('\d\D\d\D\d\D{2}\s\D{3}\/\D{2}\-\D{2}\d{4}\s\-\s\D{3}', dic2[d][0])) == 1 or len(re.findall('\D{7}\s\D{4}\s\d\-\d{2}\s\D\s\d{2}\D{2}\s\D{5}', dic2[d][0])) == 1) and (len(re.findall('\d\.\d', dic2[d][6])) == 1 or len(re.findall('\d\s\d', dic2[d][6])) == 1) and (len(re.findall('\D{3}\s\D{10}\s\(\D{5}\)\D{7}', dic2[d-1][0])) == 1 or len(re.findall('\D{14}\s\D{6}\-', dic2[d-1][0])) == 1 or len(re.findall('\D{2}\d{3}\(\D{8}\,\s\d\-', dic2[d-1][0])) == 1 or len(re.findall('\D{2}\s\d{4}\s\D{7}\s\D{5}\s\d\.\d', dic2[d-1][0])) == 1 or len(re.findall('\D{2}\s\d{4}\s\D{7}\s\D{5}\s\d{2}\D{2}', dic2[d-1][0])) == 1 or len(re.findall('\D{10}\s\D{8}', dic2[d-1][0])) == 1 or len(re.findall('\D{2}\s\d{3}\s\D{3}\-\D{3}\s\D{6}\s\D{5}', dic2[d-1][0])) == 1) and (len(re.findall('\d\.\d', dic2[d-1][2])) == 1 or len(re.findall('\d\s\d', dic2[d-1][2])) == 1) and \
                    len(re.findall('\d\.\d', dic2[d-1][6])) == 0:
                print('for 220202062906 HBS AG+HIV+HCV (RAPID)[Panel],HISTOPATHOLOGY BIOPSY-')
                dic2[d-1][6] = dic2[d][6]
                dic2[d][6] = ' '
            if d>1 and d<len(dic2) and len(re.findall('\D{10}\s\D\-\d{4}\s\D{5}\s\(\D{5}\)\s\D{3}\s\D{4}\s\-\s\d{8}', dic2[d][0])) == 1 and len(re.findall('\D\-\d{2}\s\D{4}\s\D{4}\s\D{5}', dic2[d-1][0])) == 1 and \
                    len(re.findall('\d\s?\.\s?\d', dic2[d][2])) == 1 and len(re.findall('\d\s?\.\s?\d', dic2[d][6])) == 1 and len(re.findall('\d\s?\.\s?\d', dic2[d-1][2])) == 0 and len(re.findall('\d\s?\.\s?\d', dic2[d-1][5])) == 0 and \
                    dic2[d].count(' ')==4 and dic2[d-1].count(' ')==6:
                print('for 220202062906 N-95 FLAT FOLD STYLE')
                dic2[d-1][2] = dic2[d][2]
                dic2[d-1][6] = dic2[d][6]
                dic2[d][2] = ' '
                dic2[d][6] = ' '
            if d>1 and d<len(dic2) and len(re.findall('\D{9}\s\D{7}\s\D{4}\(\D{7}\)\s\D{8}\s\D{3}\s\D{7}\s\D{4}', dic2[d][0])) == 1 and len(re.findall('\d\s?\.\s?\d', dic2[d][2])) == 1 and \
                    len(re.findall('\d\s?\.\s?\d', dic2[d+1][2])) == 1 and len(re.findall('\d\s?\.\s?\d', dic2[d+1][4])) == 1:
                print('for 220202062906 VISITING FEE GENERAL WARD')
                text = dic2[d][0]
                if len(re.findall('\D{8}\s\D{3}\s\D{7}\s\D{4}', dic2[d][0])) == 1:
                    matchparti = re.search(r'\D{8}\s\D{3}\s\D{7}\s\D{4}',text)
                dic2[d+1][0] = matchparti.group()
                dic2[d][0] = text.replace(matchparti.group(),'')
            if d>1 and d<len(dic2) and len(re.findall('\D{7}', dic2[d][0])) == 1 and len(re.findall('\D{9}\s\D{11}', dic2[d-1][0])) == 1 and dic2[d-1].count(' ')==6 and \
                    len(re.findall('\d\.\d', dic2[d][2])) == 1 and len(re.findall('\d\.\d', dic2[d][6])) == 1 and dic2[d].count(' ')==4:
                print('for 220202089395 LACTATION COUNSELLING')
                dic2[d-1][2] = dic2[d][2]
                dic2[d-1][6] = dic2[d][6]
                dic2[d][2] = ' '
                dic2[d][6] = ' '
            if d>1 and d<len(dic2) and len(re.findall('\D{12}\s\D{7}', dic2[d][0])) == 1 and len(re.findall('\D{13}\s\D{3}', dic2[d-1][0])) == 1 and dic2[d][0] == 'OCCUPATIONAL THERAPY' and dic2[d-1][0] == 'PHYSIOTHERAPY AND':
                print('for H_26290_5618125213_14_57_16062020123045_compressed PHYSIOTHERAPY AND OCCUPATIONAL THERAPY')
                dic2[d][0] = 'PHYSIOTHERAPY AND OCCUPATIONAL THERAPY'
                dic2[d-1][0] = ' '
            if d>1 and (len(re.findall('\d\,\d{2}\D{2}\.\s\d{2}\D{2}\s\d\/\d\s\D{6}\,\s\D{5}', dic2[d][0])) == 1 or len(re.findall('\d\.\d\.\s\D\&\D\s\(\D{3}\s\D{4}\-\d{8}\)', dic2[d][0])) == 1) and (len(re.findall('\D{2}\d{3}\(\s\D{8}\,\d\-', dic2[d-1][0])) == 1 or len(re.findall('\D{2}\s\d{4}\s\D{7}\s\D{5}\s\d{2}\D{2}', dic2[d-1][0])) == 1)and dic2[d].count(' ')==5 and dic2[d-1].count(' ')==5:
                print('for H_26290_5618125213_14_57_16062020123045_compressed VP945( SURGIPRO,2- and NW 3336 ETHILON BLACK 45MM')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if d>1 and d<len(dic2) and len(re.findall('\D{4}\s\[\D{4}\]', dic2[d][0])) == 1 and dic2[d][0] in head_list and len(re.findall('\d\s\d{3}\s\d{2}', dic2[d-1][6])) == 1 and dic2[d-1][4] == ' ':
                print('for H_26290_5618125314_30_31_16062020131203_compressed (1) adding subtotal above XRAY [DMCH]')
                dic2[d-1][4] = 'Sub total'
            if d > 1 and d < len(dic2) and len(re.findall('\d\:\d', dic2[d][2])) == 1:
                dic2[d][2] = dic2[d][2].replace(':','.')




            dic1[lq]=dic2[d]
            lq +=1
    if hospital=='dayanand1':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])

            dic1[lq]=dic2[d]
            lq +=1
    if hospital == 'dayanand-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][3].__contains__('bage'):
                dic2[d][3] = dic2[d][3].replace('bage','')
            if dic2[d][3].__contains__('Price'):
                dic2[d][3] = dic2[d][3].replace('Price','')
            if dic2[d][1] == 'Code':
                dic2[d][1] = ' '
            if dic2[d][2] == 'Code':
                dic2[d][2] = ' '
            if len(re.findall('\.\s', dic2[d][3])) >= 1:
                text = dic2[d][3]
                matchspaceright = re.search(r'\.\s', text)
                print('matchhspaceright in 3rd index', matchspaceright.group())
                dic2[d][3] = text.replace(matchspaceright.group(), '.')
                print('after replacing', dic2[d][3])
            if len(re.findall('\s\.', dic2[d][3])) >= 1:
                text = dic2[d][3]
                matchspaceleft = re.search(r'\s\.', text)
                print('matchhspaceleft in 3rd index', matchspaceleft.group())
                dic2[d][3] = text.replace(matchspaceleft.group(), '.')
                print('after replacing', dic2[d][3])

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if len(re.findall('\d{2}\-\d{2}\-\d{2}\s\d{9}\/\d{2}', dic2[d][0])) == 1 or len(re.findall('\d{2}\-\d{2}\-\d{2}\s\d{4}\s\d{5}\/\d{2}', dic2[d][0])) == 1 or len(re.findall('\d{2}\-\d{2}\-\d{2}\s\d{9}\/\s\d{2}', dic2[d][0])) == 1 or \
                        len(re.findall('\d{2}\-\d{2}\-\.\s\d\s\d{4}\s\d{5}\/\d{2}', dic2[d][0])) == 1 or len(re.findall('\d{2}\-\d{2}\-\d{2}\s\d{4}\s\d{2}\:\/\d{2}', dic2[d][0])) == 1 or len(re.findall('\d\-\d{2}\-\d{2}\s\d{8}\/\d{2}', dic2[d][0])) == 1 or \
                        len(re.findall('\d{2}\s\d{2}\-\d{2}\s\d{8}\s\d\/\d{2}', dic2[d][0])) == 1 or len(re.findall('\d{2}\-\d{2}\-\d{2}\s\d{9}\/\s\/\d', dic2[d][0])) == 1 or len(re.findall('\d{2}\-\d{2}\-\d{2}\s\d{9}\/\s\:\s\:', dic2[d][0])) == 1 or \
                        len(re.findall('\d{2}\-\d{2}\-\d{2}\s\d{7}\.\d\/\d{2}', dic2[d][0])) == 1 or len(re.findall('\d{2}\-\d{2}\-\d{2}\s\d{9}\s\/\d{2}', dic2[d][0])) == 1:
                text = dic2[d][0]
                if len(re.findall('\d{2}\-\d{2}\-\d{2}\s\d{9}\/\d{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\-\d{2}\-\d{2}\s\d{9}\/\d{2}',text)
                elif len(re.findall('\d{2}\-\d{2}\-\d{2}\s\d{4}\s\d{5}\/\d{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\-\d{2}\-\d{2}\s\d{4}\s\d{5}\/\d{2}',text)
                elif len(re.findall('\d{2}\-\d{2}\-\d{2}\s\d{9}\/\s\d{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\-\d{2}\-\d{2}\s\d{9}\/\s\d{2}',text)
                elif len(re.findall('\d{2}\-\d{2}\-\.\s\d\s\d{4}\s\d{5}\/\d{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\-\d{2}\-\.\s\d\s\d{4}\s\d{5}\/\d{2}',text)
                elif len(re.findall('\d{2}\-\d{2}\-\d{4}\s\d{4}\s\d{2}\:\/\d{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\-\d{2}\-\d{4}\s\d{4}\s\d{2}\:\/\d{2}',text)
                elif len(re.findall('\d\-\d{2}\-\d{2}\s\d{8}\/\d{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d\-\d{2}\-\d{2}\s\d{8}\/\d{2}',text)
                elif len(re.findall('\d{2}\s\d{2}\-\d{2}\s\d{8}\s\d\/\d{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\s\d{2}\-\d{2}\s\d{8}\s\d\/\d{2}',text)
                elif len(re.findall('\d{2}\-\d{2}\-\d{2}\s\d{9}\/\s\/\d', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\-\d{2}\-\d{2}\s\d{9}\/\s\/\d',text)
                elif len(re.findall('\d{2}\-\d{2}\-\d{2}\s\d{9}\/\s\:\s\:', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\-\d{2}\-\d{2}\s\d{9}\/\s\:\s\:',text)
                elif len(re.findall('\d{2}\-\d{2}\-\d{2}\s\d{7}\.\d\/\d{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\-\d{2}\-\d{2}\s\d{7}\.\d\/\d{2}',text)
                elif len(re.findall('\d{2}\-\d{2}\-\d{2}\s\d{9}\s\/\d{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\-\d{2}\-\d{2}\s\d{9}\s\/\d{2}',text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(),'')
            if len(dic2[d][3].split())>=3 and len(re.findall('\d\.\d', dic2[d][3])) >= 3 and len(re.findall('\d\.\d{4}\.\d', dic2[d][3].split()[0])) == 0:
                print('if mrp and disc are not together we take 2nd index in rate')
                text = dic2[d][3].split()
                dic2[d][6] = text[-1]
                dic2[d][5] = text[-2]
                if len(text[2]) == 1:
                    dic2[d][4] = text[3]
                else:
                    dic2[d][4] = text[2]
            if len(dic2[d][3].split())>=3 and len(re.findall('\d\.\d', dic2[d][3])) >= 3 and len(re.findall('\d\.\d{4}\.\d', dic2[d][3].split()[0])) == 1:
                print('if mrp and disc are together we take 1st index in rate')
                text = dic2[d][3].split()
                dic2[d][6] = text[-1]
                dic2[d][5] = text[-2]
                dic2[d][4] = text[1]




            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'Gleneagles_GHC' or hospital == 'Gleneagles_GHC1' or hospital == 'Global' or hospital=='BGS_N0865':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][1] != ' ' and dic2[d][1].__contains__('of') and len(dic2[d][1].split()) == 3:
                dic2[d][1] = ' '
            if dic2[d][1].__contains__('of') and len(re.findall('\s\d+\s\w{2}\s\d+$', dic2[d][1])) == 1:
                print('if header merged with extra page of')
                text = dic2[d][1]
                matchextra = re.search(r'\s\d+\s\w{2}\s\d+$', text)
                dic2[d][1] = dic2[d][1].replace(matchextra.group(), '')
                dic2[d][1] = dic2[d][1].strip()

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd11==', dic2[d])
            if dic2[d][1] == 'ROOM RENT5 of 6' or dic2[d][1] == 'ROOM RI':
                dic2[d][1] = 'ROOM RENT'
            for i in head_list:
                if i == dic2[d][1] and dic2[d].count(' ')>=4:
                    dic2[d][0] = i
                    dic2[d][1] = ' '
                if d > 1 and d < len(dic2) and dic2[d][1] + ' ' + dic2[d + 1][1] == i and dic2[d].count(' ') >= 5 and \
                        dic2[d + 1].count(' ') >= 5:
                    dic2[d][0] = i
                    dic2[d][1] = ' '
                    dic2[d + 1][1] = ' '
            if d > 1 and len(re.findall('\d{2}\s\w{3}\s\d{4}', dic2[d][0])) == 1 and len(
                    re.findall('\d\.\d', dic2[d][5])) == 1 and \
                    dic2[d - 1][0] == ' ' and dic2[d - 1].count(' ') <= 2 and dic2[d].count(' ') == 4:
                print('if subtotal line is misplaced with date with 2,4 spaces')
                dic2[d - 1][0] = dic2[d][0]
                dic2[d][0] = ' '
            if dic2[d][2] != ' ' and dic2[d][3] != ' ' and dic2[d][2] == dic2[d][3]:
                print('if Unit price in 3rd and 2nd indx')
                dic2[d][2] = ' '
            if d > 1 and dic2[d][5] != ' ' and dic2[d].count(' ') == 3 and dic2[d][4] != ' ':
                print('if sbt values present in 4th, 5th indx with 1st indx not empty')
                dic2[d - 1][1] = dic2[d - 1][1] + ' ' + dic2[d][1]
                dic2[d][1] = ' '
                dic2[d][4] = ' '
                dic2[d][5] = ' '
            if d > 1 and dic2[d][5] != ' ' and dic2[d].count(' ') == 4:
                print('if sbt values present in 5th indx with 1st indx not empty')
                dic2[d - 1][1] = dic2[d - 1][1] + ' ' + dic2[d][1]
                dic2[d][1] = ' '
                dic2[d][5] = ' '

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd22==', dic2[d])
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][4] != ' ':
                print('for sbt value 4th indx not empty')
                dic2[d - 1][4] = ' '
            if len(re.findall('\d{2}\s\w{3}\s\d{4}', dic2[d][0])) == 1 and dic2[d][1] == ' ' and len(
                    dic2[d][0].split()) > 3:
                print('if date and particulars merge')
                text = dic2[d][0]
                matchdate = re.search(r'\d{2}\s\w{3}\s\d{4}', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')
            if len(dic2[d][4].split()) >= 2:
                print('yesss Qty amount in 4th indx')
                text = dic2[d][4]
                dic2[d][4] = text.split()[0]
            if len(dic2[d][5].split()) >= 2:
                print('yesss discount amount in 5th indx')
                text = dic2[d][5]
                dic2[d][5] = text.split()[1]

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Gleneagles_GHC-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            for i in head_list:
                if i == dic2[d][1] and dic2[d].count(' ') >= 5:
                    dic2[d][0] = i
                    dic2[d][1] = ' '
            if len(re.findall('^\d+\s', dic2[d][0])) == 1 and len(dic2[d][0].split()[0]) <= 3:
                # print('to remove sno')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
            if dic2[d][4] == ' ' and dic2[d][5] == ' ' and dic2[d][3] != ' ' and len(
                    re.findall('\d\s?\.\s?\d', dic2[d][3])) == 2:
                print('if qty,rate,amount together in 3rd index')
                a, b, c = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
                dic2[d][5] = c
            if dic2[d][4] != ' ' and dic2[d][5] == ' ' and dic2[d][3] != ' ' and len(
                    re.findall('\d\s?\.\s?\d', dic2[d][4])) == 2:
                print('if rate,amount together in 4th index')
                a, b = dic2[d][4].split()
                dic2[d][4] = a
                dic2[d][5] = b

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd11==', dic2[d])
            if len(re.findall('\d{2}\-\d{2}\-\d{4}', dic2[d][0])) == 1 and (
                    dic2[d][1] == ' ' or dic2[d][1] != ' ') and len(dic2[d][0].split()) > 3:
                print('if date and particulars merge')
                text = dic2[d][0]
                matchdate = re.search(r'\d{2}\-\d{2}\-\d{4}', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')

            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'Global-pharma' or hospital=='Global1-pharma' or hospital=='BGS_N0865-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            for i in head_list:
                if i == dic2[d][2]:
                    dic2[d][0] = i
                    dic2[d][2] = ' '
            if len(dic2[d][4].split()) == 3 and dic2[d][5] in dic2[d][4] and dic2[d][6] == ' ':
                a,b,c = dic2[d][4].split()
                dic2[d][4] = a
                dic2[d][5] = b
                dic2[d][6] = c
            if len(re.findall('\d\s\d{2}\-\d{2}\-\d{4}', dic2[d][0])) == 1 or len(re.findall('\d{2}\s\d{2}\-\d{2}\-\d{4}', dic2[d][0])) == 1 or len(re.findall('\d{3}\s\d{2}\-\d{2}\-\d{4}', dic2[d][0])) == 1:
                print('remove sno from date')
                text = dic2[d][0]
                if len(re.findall('\d{3}\s\d{2}\-\d{2}\-\d{4}', dic2[d][0])) == 1:
                    matchsno = re.search(r'\d{3}\s',text)
                elif len(re.findall('\d{2}\s\d{2}\-\d{2}\-\d{4}', dic2[d][0])) == 1:
                    matchsno = re.search(r'\d{2}\s',text)
                elif len(re.findall('\d\s\d{2}\-\d{2}\-\d{4}', dic2[d][0])) == 1:
                    matchsno = re.search(r'\d\s',text)
                dic2[d][0] = text.replace(matchsno.group(),'')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Global1':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if d>1 and d<len(dic2) and len(re.findall('\d{2}\/\d{2}\/\d{4}\s', dic2[d][0])) == 1 and len(dic2[d][0].split()) >= 2 and dic2[d][1] ==  ' ':
                print('for 220201933421 20/03/2020 | Admission Charges')
                text = dic2[d][0]
                if len(re.findall('\d{2}\/\d{2}\/\d{4}\s', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\/\d{2}\/\d{4}\s',text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(),'')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Global2':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if (len(re.findall('\d{2}\/\d{2}\/\d{4}\s\d{2}\:\d{2}', dic2[d][0])) == 1 or len(re.findall('\d{2}\/\d{2}\/\d{4}\s\d{1}\:\d{2}', dic2[d][0])) == 1) and dic2[d][1] == ' ':
                print('if date parti together')
                text = dic2[d][0]
                if len(re.findall('\d{2}\/\d{2}\/\d{4}\s\d{2}\:\d{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\/\d{2}\/\d{4}\s\d{2}\:\d{2}',text)
                elif len(re.findall('\d{2}\/\d{2}\/\d{4}\s\d{1}\:\d{2}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{2}\/\d{2}\/\d{4}\s\d{1}\:\d{2}',text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(),'')

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd11==', dic2[d])
            if len(re.findall('\d{3}\.\d{3}\,\d{3}\.\d{2}', dic2[d][3])) == 1  and dic2[d][5] == ' ':
                print('for ilovepdf_merged (70) 490.121,470.36')
                a,b = dic2[d][3].split(',')
                dic2[d][3] = a
                dic2[d][5] = b


            dic1[lq] = dic2[d]
            lq += 1

    if hospital=='venkateshwar':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if dic2[d][0] == 'RADIOLOGY....... . ... .. .':
                dic2[d][0] = 'RADIOLOGY'
            if dic2[d][0] == 'Drug':
                dic2[d][0] = 'Drugs'
            if dic2[d][1] == ': : :':
                dic2[d][1] = ' '
            if dic2[d][0].__contains__('IMPLANTS'):
                dic2[d][0] = 'IMPLANTS'
            if dic2[d][2] == dic2[d][3]:
                dic2[d][2] = ' '
            if len(re.findall('\d+\/?s?\d+\/?s?\d+\s?\d+\:?s?\D?\d+\)?\s?\,?\;?\-?\s?\d+\-?\s?\d+\/?s?\d+', dic2[d][0])) == 1 and (dic2[d][1]== ' ' or dic2[d][1]!= ' ') and len(dic2[d][0].split())>5:
                text = dic2[d][0]
                if len(re.findall('\d+\/?s?\d+\/?s?\d+\s?\d+\:?s?\D?\d+\)?\s?\,?\;?\-?\s?\d+\-?\s?\d+\/?s?\d+', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d+\/?s?\d+\/?s?\d+\s?\d+\:?s?\D?\d+\)?\s?\,?\;?\-?\s?\d+\-?\s?\d+\/?s?\d+',text)
                dic2[d][0] = matchdate.group()
                if dic2[d][1]!= ' ':
                    dic2[d][1] = text.replace(matchdate.group(),'')+dic2[d][1]
                if dic2[d][1] == ' ':
                    dic2[d][1] = text.replace(matchdate.group(),'')


            dic1[lq]=dic2[d]
            lq +=1

    if hospital=='sakra':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if dic2[d][0] in src_dc['merge_set']:
                dic2[d][4] = ' '
            if len(re.findall('^\d+\.?\s', dic2[d][0])) == 1 and len(dic2[d][0].split()[0])<=3:
                print('to remove sno')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\.?\s',text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(),'')
            if dic2[d][0] in head_list and dic2[d].count(' ')<=3 and dic2[d].count(' ')!=4:
                dic2[d][0] = dic2[d][0]+'s'
            if len(dic2[d][4].split())==2 and len(re.findall('\d\.\d', dic2[d][4])) == 1 and dic2[d][5]== ' ' and dic2[d][0] not in head_list:
                print('if qty amount together in 4th index')
                a,b = dic2[d][4].split()
                dic2[d][4] = a
                dic2[d][5] = b


            dic1[lq]=dic2[d]
            lq +=1

    if hospital=='adityabirla':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if len(re.findall('^\d+\.?\s', dic2[d][0])) == 1 and len(dic2[d][0].split()[0])<=3:
                print('to remove sno')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\.?\s',text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(),'')

            dic1[lq]=dic2[d]
            lq +=1

    if hospital == 'aster_rv':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd===', dic2[d])
            if dic2[d][2] == dic2[d][3] and len(re.findall('\d\.\d', dic2[d][2])) >= 1 and len(
                    re.findall('\d\.\d', dic2[d][3])) >= 1:
                dic2[d][2] = ' '
            if len(dic2[d][3].split()) == 2 and dic2[d][4] == ' ' and len(re.findall('\d\.\d', dic2[d][3])) == 2:
                print('with space in 3rd index')
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b

            dic1[lq] = dic2[d]
            lq += 1

    if hospital=='medicover':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if len(re.findall('^\w+\d+\.?/?\s', dic2[d][0])) == 1 and len(dic2[d][0].split()[0])>=2 and dic2[d][1]== ' ' and dic2[d][0] not in head_list:
                print('if code and particulars together')
                text = dic2[d][0]
                matchcode = re.search(r'^\w+\d+\.?/?\s',text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(),'')
            if dic2[d][0] in src_dc['merge_set'] and dic2[d].count(' ') >= 4:
                dic2[d][5] = ' '
            if len(dic2[d][3].split()) == 3 and dic2[d][3].split()[1] == '*' and len(re.findall('\d\.\d', dic2[d][3])) == 1 and dic2[d][4] == ' ':
                print('if qty rate together with *')
                a,b,c = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = c
            if dic2[d][0] in head_list and dic2[d][1]!=' ':
                dic2[d][1]=' '

            dic1[lq]=dic2[d]
            lq +=1
    if hospital=='Mahatmagandhi_N12944':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if len(re.findall('\w+\d+\.?/?\s', dic2[d][0])) == 1 and len(dic2[d][0].split()[0])>=2 and dic2[d][1]== ' ' and dic2[d][0] not in head_list:
                print('if code and particulars together')
                text = dic2[d][0]
                matchcode = re.search(r'\w+\d+\.?/?\s',text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(),'')
            if dic2[d][0] in src_dc['merge_set'] and dic2[d].count(' ') >= 4:
                dic2[d][5] = ' '
            if len(dic2[d][3].split()) == 3 and dic2[d][3].split()[1] == '*' and len(re.findall('\d\.\d', dic2[d][3])) == 1 and dic2[d][4] == ' ':
                print('if qty rate together with *')
                a,b,c = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = c
            if dic2[d][0] in head_list and dic2[d][1]!=' ':
                dic2[d][1]=' '

            dic1[lq]=dic2[d]
            lq +=1

    if hospital=='medicover1':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if len(re.findall('\w+\d+\.?/?\s', dic2[d][0])) == 1 and len(dic2[d][0].split()[0])>=2 and dic2[d][1]== ' ' and dic2[d][0] not in head_list:
                print('if code and particulars together')
                text = dic2[d][0]
                matchcode = re.search(r'\w+\d+\.?/?\s',text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(),'')
            if dic2[d][0] in src_dc['merge_set'] and dic2[d].count(' ') >= 4:
                dic2[d][5] = ' '
            if len(re.findall('\d\.\d', dic2[d][3])) == 1 and len(re.findall('\d\-\w{3}\-\d', dic2[d][1])) >= 1:
                print('for packgae details line items')
                dic2[d][4] = dic2[d][3]
                dic2[d][3] = ' '
            if (len(re.findall('\d\-\w{3}\-\d', dic2[d][1])) >= 1 or len(re.findall('\d\-\w{3}\.\d', dic2[d][1])) == 1):
                text = dic2[d][1]
                if len(re.findall('\d{2}\-\w{3}\-\d{2}\s\d{2}\-\w{3}\.\d{2}', dic2[d][1])) == 1:
                    matchdate = re.search(r'\d{2}\-\w{3}\-\d{2}\s\d{2}\-\w{3}\.\d{2}', text)
                elif len(re.findall('\d{2}\-\w{3}\-\d{2}\s\d{2}\-\w{3}\-\d{2}', dic2[d][1])) == 1:
                    matchdate = re.search(r'\d{2}\-\w{3}\-\d{2}\s\d{2}\-\w{3}\-\d{2}', text)
                elif len(re.findall('\d\-\w{3}\-\d', dic2[d][1])) >= 1:
                    matchdate = re.search(r'\d{2}\-\w{3}\-\d{2}',text)
                elif len(re.findall('\d\-\w{3}\.\d', dic2[d][1])) == 1:
                    matchdate = re.search(r'\d{2}\-\w{3}\.\d{2}', text)
                dic2[d][1] = text.replace(matchdate.group(),'')
                dic2[d][1] = dic2[d][1].replace(' ','',1)




            dic1[lq]=dic2[d]
            lq +=1

    if hospital == 'vijaya_chennai':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if d > 1 and dic2[d].count(' ') == 5 and dic2[d - 1].count(' ') <= 4 and (
                    len(re.findall('\d+\/\d+\/\d+', dic2[d][1])) == 1 or len(
                    re.findall('\d+\.\d+', dic2[d][1])) == 1 or len(
                    re.findall('\d+\/\d+\/\d+\s\w+\s\d+\/\d+\/\d+', dic2[d][1])) == 1):
                print('if lines are separated in pdf')
                dic2[d - 1][1] = dic2[d - 1][1] + ' ' + dic2[d][1]
                dic2[d][1] = ' '

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd11==', dic2[d])
            if len(re.findall('\d+\.?\s', dic2[d][0])) == 1 and len(dic2[d][0].split()) >= 2:
                print('to remove sno')
                text = dic2[d][0]
                matchsno = re.search(r'\d+\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
            if dic2[d][1] != ' ' and len(re.findall('\d+\/\d+\/\d+\s\w+\s\d+\/\d+\/\d+', dic2[d][1])) == 1 and len(
                    dic2[d][1].split()[0]) >= 3 and len(re.findall('\d+\/\d+\/\d+', dic2[d][1].split()[0])) == 1:
                print('2 Dates with To in middle and  Parti merge in 1st Index')
                text = dic2[d][1]
                matchdate = re.search(r'\d+\/\d+\/\d+\s\w+\s\d+\/\d+\/\d+', text)
                dic2[d][1] = matchdate.group()
                dic2[d][2] = text.replace(matchdate.group(), '')
                if 'To' in dic2[d][1]:
                    dic2[d][1] = dic2[d][1].replace('To', '-')
            if dic2[d][0] != ' ' and len(
                    re.findall('\d+\/\d+\/\d+\s\d+\:\d+\s\w+\s\d+\/\d+\/\d+\s\d+\:\d+', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()) >= 3:
                print('2 Dates with times and To in middle and  Parti merge in 0th Index for Room Tarrif')
                text = dic2[d][0]
                matchdate = re.search(r'\d+\/\d+\/\d+\s\d+\:\d+\s\w+\s\d+\/\d+\/\d+\s\d+\:\d+', text)
                dic2[d][0] = ' '
                dic2[d][1] = matchdate.group()
                dic2[d][2] = text.replace(matchdate.group(), '')
                if 'to' in dic2[d][1]:
                    dic2[d][1] = dic2[d][1].replace('to', '-')
            if dic2[d][1] != ' ' and len(re.findall('\d+\/\d+\/\d+\s', dic2[d][1])) == 1 and len(
                    dic2[d][1].split()[0]) >= 3 and len(
                    re.findall('\d+\/\d+\/\d+\s\-\s\d+\/\d+\/\d+', dic2[d][1])) != 1:
                print('Date Parti merge in 1st Index')
                text = dic2[d][1]
                matchdate = re.search(r'\d+\/\d+\/\d+\s', text)
                dic2[d][1] = matchdate.group()
                dic2[d][1] = dic2[d][1].replace(' ', '', -1)
                dic2[d][2] = text.replace(matchdate.group(), '')
            if dic2[d][2] != ' ' and len(re.findall('\d+\/\d+\/\d+\s', dic2[d][2])) == 1 and len(
                    dic2[d][2].split()[0]) >= 2:
                print('Date Parti merge in 2nd Index')
                text = dic2[d][2]
                matchdate = re.search(r'\d+\/\d+\/\d+\s', text)
                dic2[d][2] = text.replace(matchdate.group(), '')
            if d > 1 and dic2[d][1] != ' ' and len(re.findall('\d+\s\D\s\d+\.\d+', dic2[d][1])) == 1 and dic2[d - 1][
                1] != ' ' and dic2[d - 1][2] != ' ' and dic2[d].count(' ') == 5 and dic2[d - 1].count(' ') == 2:
                print('if qtyrate line is d and particulars line is d-1')
                dic2[d - 1][2] = dic2[d - 1][2] + dic2[d][1]
                dic2[d][1] = ' '
            if len(dic2[d][5].split()) <= 3 and len(re.findall('\d+\.\d+', dic2[d][5])) == 1:
                print('for investigation formats')
                text = dic2[d][5].split()
                dic2[d][5] = text[-1]
            if (d == 1 or d == 2) and ('Bill No' in dic2[d][0] or 'Bill Date' in dic2[d][1]) and (
                    len(re.findall('\d+\/\d+\/\d+', dic2[d][0])) == 1 or len(
                    re.findall('\d+\/\d+\/\d+', dic2[d][1])) == 1):
                print('for Investigation Cherges 2nd format')
                dic2[d] = ['INVESTIGATION CHARGES', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd22==', dic2[d])
            if len(re.findall('\d+\s\D\s\d+\.\d+', dic2[d][2])) == 1:
                print('if qty rate present in 2nd index')
                text = dic2[d][2]
                matchqtyrate = re.search(r'\d+\s\D\s\d+\.\d+', text)
                dic2[d][3] = matchqtyrate.group()
                dic2[d][2] = text.replace(matchqtyrate.group(), '')
            if len(dic2[d][3].split()) == 3 and len(re.findall('\d+\s\D\s\d+\.\d+', dic2[d][3])) == 1:
                print('if qty * rate is in 3rd index')
                a, b, c = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = c

            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'regency':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd==', dic2[d])
            if dic2[d][3] == dic2[d][4]:
                dic2[d][4] = ' '

            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'regency-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd==', dic2[d])
            if len(dic2[d][4].split()) == 2 and dic2[d][5] == ' ':
                a, b = dic2[d][4].split()
                dic2[d][4] = a
                dic2[d][5] = b
            if dic2[d][6] == '4670. 90 (4670. 00)':
                dic2[d][6] = '4670. 90'
                dic2[d][7] = '(4670. 00)'

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'care_hitechcity' or hospital == 'Ramkrishna' or hospital == 'care_banjarahills':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] == 'PLASTIC SURGERIES-HAND, UPPER SURGERY':
                dic2[d][0] = 'PLASTIC SURGERIES-HAND UPPER SURGERY'

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Rabindranath':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            if dic2[d][0] != ' ' and (len(re.findall('\d{2}', dic2[d][0].split()[0])) == 1 or len(
                    re.findall('\d', dic2[d][0].split()[0])) == 1) :
                print('for removing snos in 0th index')
                text = dic2[d][0]
                if len(re.findall('\d{2}', dic2[d][0].split()[0])) == 1:
                    matchsno = re.search(r'\d{2}', text)
                elif len(re.findall('\d', dic2[d][0].split()[0])) == 1:
                    matchsno = re.search(r'\d', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
                dic2[d][0] = dic2[d][0].replace(dic2[d][0][0], '', 1)
            if dic2[d][2]!=' ' and dic2[d].count(' ')==5:
                print('lineeee breakk',dic2[d])
                dic2[d][2]=' '
            if dic2[d][1]!=' ' and dic2[d].count(' ')==5:
                print('break',dic2[d])
                dic2[d-1][1]= dic2[d-1][1]+dic2[d][1]
                dic2[d][1]=' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'omega_N7843':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(dic2[d][3].split()) == 3 and dic2[d][3].split()[1] == '*' and len(
                    re.findall('\d\.\d', dic2[d][3])) == 1:
                print('if qty rate together with *')
                a, b, c = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = c
            if dic2[d][3].__contains__('*'):
                print('$$$$$$$$$', dic2[d])
                dic2[d][3] = dic2[d][3].replace('*', '')
            if dic2[d][4].__contains__('*'):
                dic2[d][4] = dic2[d][4].replace('*', '')
            if len(re.findall('\d{2}\-\w{3}\-\d{2}\s\w+', dic2[d][0])) and dic2[d][1].count(' ') == 1 and dic2[d][
                2] != ' ' and len(re.findall('\d\.\d', dic2[d][5])) == 1:
                print('mergeeeeee', dic2[d])
                a, b = dic2[d][0].split()
                dic2[d][0] = a
                dic2[d][1] = b
                # if dic2[d][0] in head_list and dic2[d].count(' ') == 3 and len(re.findall('\d\.\d', dic2[d][5])):
                # print('blooood bank', dic2[d])
                # dic2[d][4] = ' '
                # dic2[d][5] = ' '
                # if len(re.findall('\d{2}\-\w{3}\-\d{2}\s\w+', dic2[d][0]))  and len(re.findall('\d\.\d',dic2[d][5]))==1:
                # print('room chargessssss',dic2[d])
                dic2[d][1] = ' '
                # a, b = dic2[d][0].split()
                # dic2[d][0] = a
                # dic2[d][1] = b

            dic1[lq] = dic2[d]
            lq += 1
    # //////////////////////////
    if hospital == 'Dr_rela':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] == 'Service':
                dic2[d][0] = ' '
            if dic2[d][3] in dic2[d][4] and dic2[d][3] != ' ' and dic2[d][4] != ' ':
                dic2[d][4] = dic2[d][4].replace(dic2[d][3], '').replace(' ', '')
            if dic2[d][3].__contains__('('):
                dic2[d][3] = dic2[d][3].replace('(', '')
            if dic2[d][3].__contains__(')'):
                dic2[d][3] = dic2[d][3].replace(')', '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Instituteofliver':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][1] in head_list or dic2[d][1] in src_dc['merge_set']:
                dic2[d][1] = ' '
            if dic2[d][0] == 'Return' and dic2[d - 1][2].__contains__('Total'):
                print('Isssue', dic2[d])
                dic2[d - 1][2] = ' '
                dic2[d - 1][5] = ' '
            if dic2[d][0] == 'Return':
                dic2[d][0] = 'Pharmacy Return'
            if d > 1 and len(re.findall('^\d{1,2}\s?\D\s?\w+', dic2[d][0])):
                print('SNoHead', dic2[d])
                if d > 1 and len(re.findall('^\d{1,2}\s?\D\s?\w+', dic2[d][0])):
                    a, b = re.split('^\d{1,2}\s?', dic2[d][0], maxsplit=1)
                    print('mm', a)
                    print('nn', b)
                    dic2[d][0] = b
            '''for i in head_list :
                if i in dic2[d][0]and dic2[d].count(' ')<=3:
                    print('PROFILEEE')
                    lineee = [i, ' ', ' ', ' ', ' ', ' ']
                    dic1[lq] = dic2[d]
                    lq+=1
                    dic1[lq-1] =lineee
                    dic2[d][0] = dic2[d][0].replace(i,'')'''

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='MGM_Daycare':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('Data',dic2[d])
            for i in head_list :
                if i in dic2[d][0]and dic2[d].count(' ')<=3:
                    print('PROFILEEE')
                    lineee = [i, ' ', ' ', ' ', ' ', ' ']
                    dic1[lq] = dic2[d]
                    lq+=1
                    dic1[lq-1] =lineee
                    dic2[d][0] = dic2[d][0].replace(i,'')

            dic1[lq] = dic2[d]
            lq += 1

    if hospital=='lakeshore_kochi':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if d>1 and dic2[d][2] == 'Total' and dic2[d-1][2].__contains__('Category Total'):
                dic2[d][2] = ' '
            if d>1 and dic2[d][4] == 'Total' and dic2[d-1][3].__contains__('Category Total'):
                dic2[d][4] = ' '
            if dic2[d][3] != ' ' and 'Total' not in dic2[d][3]:
                dic2[d][3] = ' '
            # for returns below
            if (len(re.findall('\d+\/\d+\/\d+\s\d', dic2[d][4])) == 1 or len(re.findall('\d+\/\d+\/\d+', dic2[d][4])) == 1) and dic2[d][3] == ' ':
                dic2[d][2] = dic2[d][4]
                dic2[d][4] = ' '
            if len(dic2[d][5].split())==2 and dic2[d][4] == ' ' and len(re.findall('\d\.\d', dic2[d][5])) == 2:
                a,b = dic2[d][5].split()
                dic2[d][4] = a
                dic2[d][5] = '-'+b
            # #### returns above
            if dic2[d][0]!= ' ' and len(re.findall('^\d+\.?\s', dic2[d][0])) == 1 and len(dic2[d][0].split()[0])<=3:
                print('to remove sno')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\.?\s',text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(),'')
            if (len(re.findall('\d+\/\d+\/\d+\s\d', dic2[d][0])) == 1 or len(re.findall('\d+\/\d\s\d\d+\s\d', dic2[d][0])) == 1 or len(re.findall('\d+\/\d+\/\d{5}', dic2[d][0])) == 1 or len(re.findall('\d+\/\d+\/\d{4}\-', dic2[d][0])) == 1) and len(dic2[d][0].split())>=3 and dic2[d][2]== ' ':
                print('if date and parti merged')
                text = dic2[d][0]
                if len(re.findall('\d+\/\d+\/\d+\s\d', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d+\/\d+\/\d+\s\d',text)
                elif len(re.findall('\d+\/\d\s\d\/\d+\s\d', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d+\/\d\s\d\/\d+\s\d',text)
                elif len(re.findall('\d+\/\d+\/\d{5}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d+\/\d+\/\d{5}',text)
                elif len(re.findall('\d+\/\d+\/\d{4}\-', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d+\/\d+\/\d{4}\-',text)
                dic2[d][2] = matchdate.group()
                dic2[d][0] = text.replace(matchdate.group(),'')
            if d>2 and d<len(dic2)+2 and dic2[d][0] not in head_list and dic2[d-1][0] not in head_list and len(re.findall('\d+\/\d+\/\d+', dic2[d][2])) == 1 and len(re.findall('\d+\.\d+', dic2[d][4])) == 1 and len(re.findall('\d+\.\d+', dic2[d][5])) == 1 and \
                    dic2[d].count(' ')==3 and dic2[d-1].count(' ')==5 and dic2[d-2].count(' ')==5 and dic2[d][0]==' ':
                print('line divided in 3 lines')
                dic2[d-2][1:] = dic2[d][1:]
                dic2[d][1:] = [' ', ' ', ' ', ' ', ' ']
            if d>1 and dic2[d][0] not in head_list and dic2[d-1][0] not in head_list and (len(re.findall('\d+\/\d+\/\d+', dic2[d][2])) == 1 or len(re.findall('\d+\/\d+', dic2[d][2])) == 1 or len(re.findall('\w+', dic2[d][2])) >= 1) and (len(re.findall('\d+\.\d+', dic2[d][4])) == 1 or len(re.findall('\.\d+', dic2[d][4])) == 1) and (len(re.findall('\d+\.\d+', dic2[d][5])) == 1 or len(re.findall('\.\d+', dic2[d][5])) == 1) and \
                   dic2[d].count(' ')==2 and dic2[d-1].count(' ')==5 and len(dic2[d-1][0].split())>=3 and len(dic2[d][0].split())<=3:
                print('if 2 lines are separated with d count 2 and d-1 count 5')
                dic2[d-1][1:] = dic2[d][1:]
                dic2[d][1:] = [' ', ' ', ' ', ' ', ' ']
            if d>1 and dic2[d][0] not in head_list and dic2[d-1][0] not in head_list and len(re.findall('\d+\/\d+\/\d+', dic2[d][2])) == 1 and len(re.findall('\d+\.\d+', dic2[d][4])) == 1 and len(re.findall('\d+\.\d+', dic2[d][5])) == 1 and \
                   dic2[d].count(' ')==3 and dic2[d-1].count(' ')==5 and len(dic2[d-1][0].split())>=3 and dic2[d][0] == ' ':
                print('if 2 lines are separated with d count 3 and d-1 count 5 if dic2[d][0] == empty')
                dic2[d-1][1:] = dic2[d][1:]
                dic2[d][1:] = [' ', ' ', ' ', ' ', ' ']
            if d>1 and dic2[d][0] not in head_list and dic2[d-1][0] not in head_list and len(re.findall('\d+\/\d+\/\d+', dic2[d-1][2])) == 1 and len(re.findall('\d+\.\d+', dic2[d][4])) == 1 and len(re.findall('\d+\.\d+', dic2[d][5])) == 1 and \
                   dic2[d].count(' ')==3 and dic2[d-1].count(' ')==4 and len(dic2[d-1][0].split())>=3 and len(dic2[d][0].split())<=3:
                print('if 2 lines are separated with d count 3 and d-1 count 4 and date in d-1 2nd indx')
                scndindx = dic2[d-1][2]
                dic2[d-1][1:] = dic2[d][1:]
                dic2[d][1:] = [' ', ' ', ' ', ' ', ' ']
                dic2[d-1][2] = scndindx
            if d>1 and dic2[d][0] not in head_list and dic2[d-1][0] not in head_list and (len(re.findall('\d+\/\d+\/\d+', dic2[d][2])) == 1 or len(re.findall('\w+', dic2[d][2])) >= 1) and len(re.findall('\d+\.\d+', dic2[d-1][4])) == 1 and len(re.findall('\d+\.\d+', dic2[d-1][5])) == 1 and \
                   dic2[d].count(' ')==4 and dic2[d-1].count(' ')==3 and len(dic2[d-1][0].split())>=3 and len(dic2[d][0].split())<=3:
                print('if 2 lines are separated with d count 4 and d-1 count 3 and date in d 2nd indx')
                scndindx = dic2[d][2]
                dic2[d-1][2] = scndindx
                dic2[d][1:] = [' ', ' ', ' ', ' ', ' ']
            if d>1 and dic2[d][0] not in head_list and dic2[d-1][0] not in head_list and (len(re.findall('\d+\/\d+\/\d+', dic2[d-1][2])) == 1 or len(re.findall('\w+', dic2[d-1][2])) >= 1) and len(re.findall('\d+\.\d+', dic2[d][4])) == 1 and len(re.findall('\d+\.\d+', dic2[d-1][5])) == 1 and \
                   dic2[d].count(' ')==4 and dic2[d-1].count(' ')==3 and len(dic2[d-1][0].split())>=3 and len(dic2[d][0].split())<=3:
                print('if 2 lines are separated with d count 4 and d-1 count 3 and date in d-1 2nd indx, rate in d 4th indx and amt in d-1 5th indx')
                rateindx = dic2[d][4]
                dic2[d-1][4] = rateindx
                dic2[d][1:] = [' ', ' ', ' ', ' ', ' ']
            if d>1 and dic2[d][0] not in head_list and dic2[d-1][0] not in head_list and (len(re.findall('\d+\/\d+\/\d+', dic2[d][2])) == 1 or len(re.findall('\w+', dic2[d][2])) >= 1) and len(re.findall('\d+\.\d+', dic2[d][4])) == 1 and len(re.findall('\d+\.\d+', dic2[d-1][5])) == 1 and \
                   dic2[d].count(' ')==3 and dic2[d-1].count(' ')==4 and len(dic2[d-1][0].split())>=3 and len(dic2[d][0].split())<=3:
                print('if 2 lines are separated with d count 3 and d-1 count 4 and date in d 2nd indx, rate in d 4th indx and amt d-1 5th indx')
                scndindx = dic2[d][2]
                dic2[d-1][2] = scndindx
                rateindx = dic2[d][4]
                dic2[d-1][4] = rateindx
                dic2[d][1:] = [' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='manipalhospital_N0477':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0]!= ' ' and len(re.findall('^\D?\d+?\.?\s', dic2[d][0])) == 1 and len(dic2[d][0].split()[0])<=3:
                print('to remove sno')
                text = dic2[d][0]
                matchsno = re.search(r'^\D?\d+?\.?\s',text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(),'')
                dic2[d][0] = dic2[d][0].strip()

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'HCG':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd==', dic2[d])
            if dic2[d][1].__contains__('Service Name'):
                dic2[d][1] = ' '
            if dic2[d][0] == 'No':
                dic2[d][0] = ' '
            if dic2[d][4] != ' ' and dic2[d][5] != ' ' and dic2[d][4] == dic2[d][5] and len(dic2[d][4].split()) == 1:
                dic2[d][4] = ' '
            if dic2[d][4] != ' ' and dic2[d][5] != ' ' and dic2[d][4] == dic2[d][5] and len(dic2[d][4].split()) == 2:
                print('if 4th and s5th same then 4th empty')
                dic2[d][4] = ' '
            if d > 1 and dic2[d][4] != ' ' and len(re.findall('\d+\D?\.?\d+', dic2[d][4])) >= 2 and dic2[d][
                4].__contains__('hr') and len(dic2[d][4].split()) >= 3:
                print('if hr min , rate, tarrif in 4th indx')
                text = dic2[d][4]
                matchratetarrif = re.search(r'\d+\D?\d+\D?\.?\d+\s\d+\D?\d+\D?\.?\d+', text)
                dic2[d][5] = matchratetarrif.group()
                dic2[d][4] = text.replace(matchratetarrif.group(), '')
            if dic2[d][4] != ' ' and dic2[d][5] == ' ' and (dic2[d][6] == ' ' or dic2[d][6] != ' ') and len(
                    re.findall('\d+\.\d+', dic2[d][4])) == 2 and \
                    len(dic2[d][4].split()) == 2:
                print('if rate and tarrif in qty 4th indx')
                dic2[d][5] = dic2[d][4]
                dic2[d][4] = ' '
            if dic2[d][5] != ' ' and (dic2[d][4] == ' ' or dic2[d][4] != ' ') and len(dic2[d][5].split()) == 2 and \
                    dic2[d][6] != ' ' and 'Total' not in dic2[d][5] and \
                    len(re.findall('\d+\.\d+', dic2[d][5])) == 1:
                print('Qty and unit price together in 5th indx == 4,5')
                a, b = dic2[d][5].split()
                dic2[d][4] = a
                dic2[d][5] = b
            if dic2[d][5] != ' ' and (dic2[d][6] == ' ' or dic2[d][6] != ' ') and len(
                    dic2[d][5].split()) == 2 and 'Total' not in dic2[d][5] and \
                    len(re.findall('\d+\.\d+', dic2[d][5])) == 2:
                print('unit price and tarrif in 5th indx == 5,6')
                a, b = dic2[d][5].split()
                dic2[d][5] = a
                dic2[d][6] = b
            if dic2[d][5] != ' ' and dic2[d][6] == ' ' and dic2[d][4] == ' ' and len(
                    dic2[d][5].split()) == 3 and 'Total' not in dic2[d][5] and \
                    (len(re.findall('\d+\.\d+', dic2[d][5])) == 2 or len(re.findall('\d+\D\d+', dic2[d][5])) >= 1):
                print('QTY, unit price and tarrif in 5th indx == 4,5,6')
                a, b, c = dic2[d][5].split()
                dic2[d][4] = a
                dic2[d][5] = b
                dic2[d][6] = c
            if dic2[d][4] != ' ' and len(dic2[d][4].split()) == 3 and 'Total' not in dic2[d][4] and \
                    len(re.findall('\d+\.\d+', dic2[d][4])) == 2:
                print('QTY, unit price and tarrif in 4th indx == 4,5,6')
                a, b, c = dic2[d][4].split()
                dic2[d][4] = a
                dic2[d][5] = b
                dic2[d][6] = c
            if dic2[d][4] != ' ' and (dic2[d][5] == ' ' or dic2[d][5] != ' ') and len(
                    dic2[d][4].split()) == 2 and 'Total' not in dic2[d][5] and \
                    len(re.findall('\d+\.\d+', dic2[d][4])) == 1:
                print('QTy, unit price in 4th indx == 4,5')
                a, b = dic2[d][4].split()
                dic2[d][4] = a
                dic2[d][5] = b
            if dic2[d][5] != ' ' and dic2[d][6] != ' ' and len(dic2[d][5].split()) == 2 and 'Total' not in dic2[d][
                5] and \
                    len(re.findall('\d+\.\d+', dic2[d][5])) == 2 and len(re.findall('\d+\.\d+', dic2[d][6])) == 1:
                print('unit price, tarrif in 5th indx and tarrif in 6th indx')
                a, b = dic2[d][5].split()
                dic2[d][5] = a
                dic2[d][6] = b
            if dic2[d][0] != ' ' and dic2[d][1] == ' ' and len(re.findall('\d+\s?\d+\s', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()) >= 2:
                print('if code and parti together with 5,6,8,9, digits')
                text = dic2[d][0]
                if len(re.findall('\d+\s?\d+\s', dic2[d][0])) == 1:
                    matchcode = re.search(r'\d+\s?\d+\s', text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(), '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'alchemist':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd==',dic2[d])
            if dic2[d][0]!= ' ' and dic2[d][0] not in head_list and dic2[d][5]!= ' ' and dic2[d].count(' ')==4:
                print('subheaders in 0th indx and its total removal')
                dic2[d][0] = ' '
                dic2[d][5] = ' '
            if dic2[d][1]!= ' ' and dic2[d][0]!=' ' and dic2[d][1] in src_dc['merge_set'] and dic2[d][0] == dic2[d][1]:
                print(' if subheader in 0th and 1st indx')
                dic2[d][0] = ' '
            for i in src_dc['merge_set'].split(','):
                if dic2[d][1]!= ' ' and i in dic2[d][1] and len(i)<len(dic2[d][1]) and dic2[d][5]!= ' ' and (dic2[d].count(' ')==3 or dic2[d].count(' ')==4):
                    print(' if sub header in 1st indx with other line item')
                    dic2[d][1] = dic2[d][1].replace(i,'')
                    dic2[d][5] = ' '
                if dic2[d][0] not in head_list and dic2[d][1]!= ' ' and i == dic2[d][1] and dic2[d].count(' ')!=5   and dic2[d][1]!=dic2[d][0]:
                    print('for subheaders , and its total removal')
                    dic2[d][5] = ' '
                    dic2[d][1] = ' '
            if d>1 and dic2[d][0]!= ' ' and dic2[d][1]!= ' ' and len(re.findall('\d+\/\d+', dic2[d][0])) <= 1 and dic2[d][5]!= ' ' and dic2[d].count(' ')==3:
                print('if extra amount is attached to line item')
                dic2[d][5] = ' '
            if d>=1 and d<len(dic2) and dic2[d][5]!= ' ' and len(re.findall('\d+', dic2[d][5])) == 1 and dic2[d].count(' ')==5 and dic2[d+1][0] in head_list:
                print('if only sbt amt is prst in 5th indx')
                dic2[d][5] = ' '
            if dic2[d][3]!=' '  and dic2[d][5]!= ' ' and len(dic2[d][5].split())>=2 and dic2[d][5].split()[0] == dic2[d][3]:
                # print('if qty in 3rd and 4th indx')
                text = dic2[d][5].split()
                dic2[d][5] = text[-1]
            if dic2[d][1]!= ' '  and len(re.findall('\d+\.\d+', dic2[d][1].split()[-1])) == 1 and dic2[d][2] == ' ' and dic2[d].count(' ')<=3:
                print('if rate with parti')
                text = dic2[d][1]
                if len(re.findall('\d+\.\d+', dic2[d][1].split()[-1])) == 1:
                    matchrate = re.search(r'\d+\.\d+',dic2[d][1].split()[-1])
                dic2[d][2] = matchrate.group()
                dic2[d][1] = text.replace(matchrate.group(),'')


            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Saroj_N0440':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] != ' ' and (len(re.findall('\d+\-\w+\-\d+', dic2[d][0])) == 1 or len(
                    re.findall('\d+\-\w+\.?\s?\d+', dic2[d][0])) == 1 or len(
                    re.findall('\d+\s?\.?\s?\w+\-\s?\d+', dic2[d][0])) == 1 or
                                      len(re.findall('\d+\.?\s?\w+\-\s?\d+', dic2[d][0])) == 1 or len(
                        re.findall('\d+\-\s?\w+\-\s?\d+', dic2[d][0])) == 1 or len(
                        re.findall('\d+\-\w+\s?\s\d+', dic2[d][0])) == 1 or len(
                        re.findall('\d+\-\w+\s?\-\d+', dic2[d][0])) == 1 or len(
                        re.findall('\d+\-\w+\s?\-\s?\d+', dic2[d][0])) == 1 or len(
                        re.findall('\d+\s\-\w+\s?\-\s?\d+', dic2[d][0])) == 1) and len(dic2[d][0].split()) >= 2 and (
                    dic2[d][1] == ' ' or dic2[d][1] != ' '):
                print('if date and parti merged')
                text = dic2[d][0]
                if len(re.findall('\d+\-\w+\-\d+', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d+\-\w+\-\d+', text)
                elif len(re.findall('\d+\-\w+\.?\s?\d+', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d+\-\s?\w+\.?\s?\d+', text)
                elif len(re.findall('\d+\.?\s?\w+\-\s?\d+', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d+\.?\s?\w+\-\s?\d+', text)
                elif len(re.findall('\d+\-\s?\w+\-\s?\d+', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d+\-\s?\w+\-\s?\d+', text)
                elif len(re.findall('\d+\s?\.?\s?\w+\-\s?\d+', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d+\s?\.?\s?\w+\-\s?\d+', text)
                elif len(re.findall('\d+\-\s?\w+\s?\-\d+', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d+\-\s?\w+\s?\-\d+', text)
                elif len(re.findall('\d+\-\w+\s?\-\s?\d+', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d+\-\w+\s?\-\s?\d+', text)
                elif len(re.findall('\d+\s\-\w+\s?\-\s?\d+', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d+\s\-\w+\s?\-\s?\d+', text)
                dic2[d][0] = matchdate.group()
                if dic2[d][0] == ' ':
                    dic2[d][1] = text.replace(matchdate.group(), '')
                else:
                    dic2[d][1] = text.replace(matchdate.group(), '') + dic2[d][1]
                dic2[d][1] = dic2[d][1].replace(' ', '', 1)
            if dic2[d][0] != ' ' and len(re.findall('^\d+\.?\s', dic2[d][0])) == 1 and len(dic2[d][0].split()[0]) <= 3:
                print('to remove sno')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
            if d>1 and d<len(dic2) and dic2[d].count(' ')==5 and dic2[d][5]!= ' ':
                print('for emoving sbt vals')
                dic2[d][5] = ' '
            if dic2[d][3].__contains__('Total') and dic2[d][5]!= ' ':
                dic2[d][3] = ' '
                dic2[d][5] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='ramaiahmemorial':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('ddddd',dic2[d])
            if dic2[d][0]=='---- Pharmacy':
                dic2[d][0]='Pharmacy'

            if d > 1 and d < len(dic2)  and dic2[d][0] in head_list and dic2[d][0]==dic2[d+1][0]:
                print('sub_head', dic2[d])
                dic2[d+1][0] = dic2[d+1][0].lower()
            if d > 1 and d < len(dic2) and dic2[d][0].__contains__('Pharmacy') and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic2[d+1][2]))==1:
                print('pharmacyy',dic2[d])
                dic2[d][0]='pharmacy'

            if len(re.findall('^\d{1,}',dic2[d][0]))==1 and dic2[d].count(' ')==5 or dic2[d].count(' ')==2:
                print('removing sno', dic2[d])
                dic2[d][0]=re.sub('^\d{1,2}\s','',dic2[d][0])
            for i in head_list:
                if d>1 and i in dic2[d][0] and dic2[d].count(' ')<=3 and dic2[d-1][2]=='Sub Total':
                    print('header with line',dic2[d][0])
                    newline =[i, ' ', ' ', ' ', ' ', ' ']
                    dic2[d][0]=dic2[d][0].replace(i,'')
                    dic1[lq]=dic2[d]
                    dic1[lq-1]=dic2[d-1]
                    lq+=1
                    dic1[lq-1]=newline

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'sparsh1':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('hellp',dic2[d])
            if len(re.findall('\d\.\d',dic2[d][5])) and dic2[d][1]!=' ' and dic2[d][1] not in sbt and dic2[d].count(' ')==4 and dic2[d+1].count(' ')==5:
                print('merging',dic2[d])
                dic2[d+1][5]=dic2[d][5]
                dic2[d][5]=' '
                dic2[d-1][1]=dic2[d-1][1] + ' ' + dic2[d][1]
                dic2[d][1]=' '
                dic2[d][2]='Subtotal'


            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='sparshhospital_N14752':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:

            if dic2[d][0] in head_list and dic2[d].count(' ')==2:
                print('issuesss',dic2[d])
                dic2[d+1][2]=dic2[d][2]
                dic2[d][2]=' '
                dic2[d + 1][4] = dic2[d][4]
                dic2[d][4] = ' '
                dic2[d+1][5]=dic2[d][5]
                dic2[d][5]=' '
                dic2[d+1][6]=dic2[d][6]
                dic2[d][6]=' '
                dic2[d+1][7]=dic2[d][7]
                dic2[d][7]=' '


            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'Chandan_N16310':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] == 'of':
                dic2[d][0] = ' '
            if dic2[d][0] != ' ' and len(re.findall('^\d+\.?\s', dic2[d][0])) == 1 and len(dic2[d][0].split()[0]) <= 3:
                print('to remove sno')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
            if dic2[d][0] != ' ' and len(re.findall('^\d+\.', dic2[d][0])) == 1 and dic2[d].count(' ') == 5:
                print('to remove sno')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\.', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
            if dic2[d][2] != ' ' and len(re.findall('[.]\s+[^0-9]*', dic2[d][2])) == 1 and len(
                    re.findall('\d+\.\d+', dic2[d][2])) == 0:
                dic2[d][2] = ' '
            if dic2[d][3] != ' ' and len(re.findall('[.]\s+[^0-9]*', dic2[d][3])) == 1 and len(
                    re.findall('\d+\.\d+', dic2[d][3])) == 0:
                dic2[d][3] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Virinchi_N14695':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('pbbb',dic2[d])
            if len(re.findall('^\d{1,}',dic2[d][0]))==1 and dic2[d][2]!=(' '):
                print('removing sno', dic2[d])
                dic2[d][0]=re.sub('^\d{1,2}\.\s','',dic2[d][0])
            if len(re.findall('\d\/\d{2}\/\d{1,}\s?',dic2[d][0])) and dic2[d][1]==' ':
                  print('seperating two columns',dic2[d])
                  a,b=dic2[d][0].split(' ',1)
                  dic2[d][0]=a
                  dic2[d][1]=b
            if len(dic2[d][2].split()) == 2 and len(re.findall('\d\.\d', dic2[d][2])) == 2:
                print('if 3rd index have rate and qty merged')
                a,b = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = b
            if len(re.findall('\d\.\d', dic2[d][2])) == 2 and dic2[d][3]==' ':
                print('merged qty',dic2[d])
                a,b=dic2[d][2].split('.00',1)
                dic2[d][3] = b
                dic2[d][2] = dic2[d][2].replace(b,'')
            if len(re.findall('\w+',dic2[d][1])) and dic2[d].count(' ')==5:
                print('split',dic2[d])
                dic2[d-1][1]=dic2[d-1][1]+dic2[d][1]
                dic2[d][1]=' '



            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Virinchi_N14695-pharma':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('pbbb',dic2[d])
            # if dic2[d][0].__contains__('Pharmacy') or dic2[d][0].__contains__('PHARMACY'):
            #     dic2[d][0]='Pharmacy'
            if dic2[d][0].__contains__('Pharmacy Returns'):
                dic2[d][0]='Pharmacy Returns'
            if len(re.findall('^\d{1,}',dic2[d][0]))==1 and dic2[d][3]!=(' '):
                print('removing sno', dic2[d])
                dic2[d][0]=re.sub('^\d{1,2}\.\s','',dic2[d][0])
            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Pranaam_N0091':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][5]!=' ' and (dic2[d][6] == ' ' or dic2[d][6] != ' ') and len(re.findall('\d+\.\d+', dic2[d][5])) == 2 and len(dic2[d][5].split())>=2:
                # print('if amt in 5th indx with gst amt')
                text = dic2[d][5].split()
                dic2[d][5] = text[0]
                dic2[d][6] = text[-1]
            if  dic2[d][5]!= ' ' and len(re.findall('\d+\.\d+', dic2[d][5])) == 1 and len(dic2[d][5].split())>=2:
                # print('splitting gsmt amt and code and assigning gst amt to 5th indx')
                text = dic2[d][5].split()
                dic2[d][5] = text[0]
            if  dic2[d][6]!= ' ' and dic2[d][5]!= ' ' and len(re.findall('\d+\.\d+', dic2[d][6])) == 1 and len(dic2[d][6].split())==2:
                # print('splitting code and amount in th indx and assigning amount to 6th indx')
                text = dic2[d][6].split()
                dic2[d][6] = text[-1]
            if  dic2[d][4]!= ' ' and len(re.findall('\d+\.\d+', dic2[d][4])) ==2 and len(dic2[d][4].split())==2:
                # print('splitting rate and gst % in 4th indx and assigning rate to 4th indx')
                text = dic2[d][4].split()
                dic2[d][4] = text[0]
            if  dic2[d][4]!= ' ' and len(re.findall('\d+\.\d+', dic2[d][4])) >= 2 and dic2[d][5] == ' ' and len(dic2[d][4].split())>=3:
                # print('splitting rate, gst %, gst amt, code in 4th indx and assigning rate to 4th indx and gst amt to 5th indx')
                text = dic2[d][4].split()
                dic2[d][4] = text[0]
                dic2[d][5] = text[2]

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Pranaam_N0091_1':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if d==1 and dic2[d][0] not in head_list and dic2[d].count(' ')<=4:
                print('add head')
                listnw = ['Head', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq-1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Pranaam_N0091_2':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0]!=' ' and 'Surgery' in dic2[d][0] and dic2[d].count(' ')==5:
                dic2[d][0] = 'Surgery'

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Delhi_N0383':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] in head_list and dic2[d].count(' ')!=5 and dic2[d].count(' ')<=4:
                dic2[d][1] = dic2[d][0]+'Subtotal'
                dic2[d][0] = ' '
            if dic2[d][0] != ' ' and len(re.findall('^\d+\.?\s', dic2[d][0])) == 1 and len(dic2[d][0].split()[0]) <= 3:
                print('to remove sno')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
            if dic2[d][4]!= ' ' and dic2[d][5]!= ' ' and len(re.findall('\d+\s?\.\s?\d+', dic2[d][4])) == 2 and dic2[d][5] in dic2[d][4]:
                print('if gst, amt together in 4th indx')
                dic2[d][4] = dic2[d][4].replace(dic2[d][5],'')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Deep_N13653':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] == '.. .. 3. ADMISSION CHARGES':
                dic2[d][0] = 'ADMISSION CHARGES'
            if dic2[d][0] != ' ' and len(re.findall('^\d+\.?\s', dic2[d][0])) == 1 and len(dic2[d][0].split()[0]) <= 3:
                print('to remove sno')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
            if  dic2[d][2]!= ' ' and len(re.findall('[.]\s+[^0-9]*', dic2[d][2])) == 1 and len(re.findall('\d+\.\d+', dic2[d][2])) == 0 and 'Total' not in dic2[d][2]:
                dic2[d][2] = ' '
            if  dic2[d][3]!= ' ' and len(re.findall('[.]\s+[^0-9]*', dic2[d][3])) == 1 and len(re.findall('\d+\.\d+', dic2[d][3])) == 0 and 'Total' not in dic2[d][3]:
                dic2[d][3] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='omnihospital_N12946':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if  dic2[d][4]!= ' ' and dic2[d][5]!= ' ' and len(re.findall('\d+\.\d+', dic2[d][4])) == 2 and dic2[d][5] in dic2[d][4]:
                print('if qty, amt in 4th indx and amt in 5th indx')
                text = dic2[d][4].split()
                dic2[d][4] = text[0]
                dic2[d][5] = text[-1]
            if (dic2[d][1].__contains__('Admission Cha') or dic2[d][1].__contains__('Admission Cha')) and dic2[d][2] == ' ':
                dic2[d][2] = dic2[d][1]

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='omnihospital_N12946_1':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] != ' ' and dic2[d][1] == ' ' and len(re.findall('\d+\-\d+\-\d+', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()) >= 2:
                print('splitting date and parti')
                text = dic2[d][0]
                matchdate = re.search(r'\d+\-\d+\-\d+', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')
                dic2[d][1] = dic2[d][1].replace(' ', '', 1)
            if dic2[d][0] != ' ' and dic2[d][1] == ' ' and len(re.findall('^\d+\/\d+\/\d+', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()) >= 2:
                print('splitting date and parti')
                text = dic2[d][0]
                matchdate = re.search(r'^\d+\/\d+\/\d+', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')
                dic2[d][1] = dic2[d][1].replace(' ', '', 1)

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'omni_hospital':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])



            if dic2[d][0].__contains__('www.omnihospitals') or dic2[d][0].__contains__('WWW.omnihospitalsin'):
                dic2[d][0]=' '
            if dic2[d][3].__contains__('Sub Total:'):
                dic2[d][3]=' '
            if dic2[d][4] != ' ' and dic2[d][5] != ' ' and len(re.findall('\d+\.\d+', dic2[d][4])) == 2 and dic2[d][
                5] in dic2[d][4]:
                print('if qty, amt in 4th indx and amt in 5th indx')
                text = dic2[d][4].split()
                dic2[d][4] = text[0]
                dic2[d][5] = text[-1]
            if (dic2[d][1].__contains__('Admission Cha') or dic2[d][1].__contains__('Admission Cha')) and dic2[d][
                2] == ' ':
                dic2[d][2] = dic2[d][1]
            if dic2[d][1].__contains__('Doctor Charges'):
                dic2[d][0] = dic2[d][1]
                dic2[d][1] = ' '
            if len(dic2[d][5].split()) == 2  and len(re.findall('\d\.\d', dic2[d][5])) == 1:
                print('if qty rate together with *')
                a,b= dic2[d][5].split()
                dic2[d][4] = a
                dic2[d][5] = b
            if len(dic2[d][4].split()) == 2  and len(re.findall('\d\.\d', dic2[d][4])) == 2:
                print('if qty rate together with *')
                a,b= dic2[d][4].split()
                dic2[d][4] = a
                dic2[d][5] = b
            if len(dic2[d][5].split()) == 2  and len(re.findall('\d\.\d', dic2[d][5])) == 2:
                print('if qty rate together with *')
                a,b= dic2[d][5].split()
                dic2[d][5] = b
                #dic2[d][5] = b
            if len(re.findall('\d{1,2}\-\d{2}\-\d{4}', dic2[d][0])) == 1 and len(dic2[d][0].split()[0]) >= 2 and \
                    dic2[d][0] not in head_list and dic2[d][1] == ' ':
                print('if code and particulars together', dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\d{1,2}\-\d{2}\-\d{4}', text)
                dic2[d][0] = matchcode.group()
                # dic2[d][0]=' '
                dic2[d][1] = text.replace(matchcode.group(), '')
            if len(re.findall('\d{2}\-\d{2}\-\d{4}', dic2[d][0])) == 1 and len(dic2[d][0].split()[0]) >= 2 and \
                    dic2[d][0] not in head_list and dic2[d][1]!= ' ':
                print('if date and description', dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\d{1,2}\-\d{2}\-\d{4}', text)
                dic2[d][0] = matchcode.group()
                # dic2[d][0]=' '
                #dic2[d][1] = text.replace(matchcode.group(), '')
            for i in head_list:
                if d>1 and d<len(dic2) and dic2[d][0]=="Doctor Charges":
                    # dic1[lq][] = dic2[d]
                    # dic1[lq + 1] = dic2[d + 1]
                    # lq += 1
                    # dic1[lq + 1][2] = dic1[lq+1][1]+" "+dic1[lq+1][2]
                    text = dic2[d][0]
                    dic2[d][0] = dic2[d][1]
                    dic2[d][1] = text
            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Bhandup_N16963' or hospital == 'siddhivinayak_N16078':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if d>1 and dic2[d][0] in head_list and dic2[d].count(' ')!=5:
                print('if header and line items are merged')
                listnw = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq+=1
                dic1[lq-1] = listnw
                dic2[d][0] = ' '
            if d>1 and d<len(dic2) and dic2[d][1]!= ' ' and dic2[d+1][1]!= ' ' and len(re.findall('\d+\.\d+\.\d+', dic2[d][1])) == 1 and \
                    len(re.findall('\d+\.\d+\.\d+', dic2[d+1][1])) == 1 and (dic2[d][1].__contains__('To') or dic2[d][1].__contains__('TO')) and dic2[d].count(' ')>=4 and dic2[d+1].count(' ')<=3 and \
                    'Sub Total' not in dic2[d][1]:
                print(' if date if divided with To in d')
                dic2[d][1] = dic2[d][1]+' '+dic2[d+1][1]
                dic2[d+1][1] = ' '
                if dic2[d][2]==' ':
                    dic2[d][2:] = dic2[d+1][2:]
                    dic2[d+1][2:] = [' ', ' ', ' ', ' ']
                else:
                    dic2[d][3:] = dic2[d + 1][3:]
                    dic2[d + 1][3:] = [' ', ' ', ' ']
            if d>1 and d<len(dic2) and dic2[d][1]!= ' ' and (dic2[d-1][1].__contains__('To') or dic2[d-1][1].__contains__('TO')) and dic2[d].count(' ')<=3 and dic2[d-1].count(' ')<=3 and \
                    'Sub Total' not in dic2[d-1][1]:
                print('if two lines divided with To')
                new_l = copy.deepcopy(opr1(dic2[d-1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if d>2 and d<len(dic2)-1 and dic2[d][2]!= ' ' and dic2[d][1] == ' ' and dic2[d+1][1]!= ' ' and dic2[d+1].count(' ')<=2 and dic2[d].count(' ')==5 and \
                    'Sub To' not in dic2[d][2] and dic2[d+2].count(' ')==5:
                print('for surgery 3 lines')
                dic2[d][1] = dic2[d+1][1]
                dic2[d+1][1] = ' '



            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Apollospectra_N7036':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] != ' ' and len(re.findall('^\d+\.?\s', dic2[d][0])) == 1 and len(dic2[d][0].split()[0]) <= 3:
                print('to remove sno')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
            if d>1 and dic2[d][0]!= ' ' and dic2[d][1] == ' ' and dic2[d-1][0].__contains__('Admission Charge'):
                dic2[d][1] = 'Admission Charge'
            if d>1 and dic2[d][0]!= ' ' and dic2[d][1] == ' ' and dic2[d-1][0].__contains__('EMR Charge'):
                dic2[d][1] = 'EMR Charge'

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Apollospectra_N7036_1':
        dic2 = dic1
        dic1 = {}
        lq = 1
        header = []
        for d in dic2:
            print('dd00==', dic2[d])
            if d==1 and dic2[d][0] in head_list and dic2[d].count(' ')!=5:
                print('for 1st header')
                listnw = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq-1] = listnw
                dic2[d][0] = ' '
            if d>1 and dic2[d][3]!= ' ' and dic2[d][5]!= ' ' and dic2[d-1][3] == ' ' and dic2[d-1][5] == ' ' and dic2[d].count(' ')<=3 and dic2[d-1].count(' ')>=4:
                print('if lines are divided with 4 d-1 and <=3 in d')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        header = []
        for d in dic2:
            print('dd11==', dic2[d])
            if dic2[d][0] in head_list:
                if dic2[d][0] not in header:
                    header.append(dic2[d][0])
                else:
                    dic2[d][0] = ' '
            if d>1 and dic2[d][0] in head_list and dic2[d].count(' ')!=5:
                print('for headers with line items')
                listnw = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq += 1
                dic1[lq-1] = listnw
                dic2[d][0] = ' '



            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Apollospectra_N7036_2':
        dic2 = dic1
        dic1 = {}
        lq = 1
        header = []
        for d in dic2:
            print('dd00==', dic2[d])
            if d==1 and dic2[d][0] not in head_list:
                print('for 1st header')
                listnw = ['Head', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq-1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Mayom_N9522':
        dic2 = dic1
        dic1 = {}
        lq = 1
        header = []
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] != ' ' and len(re.findall('^\d+\.?\s', dic2[d][0])) == 1 and len(dic2[d][0].split()[0]) <= 3:
                # print('to remove sno and brackets')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
                dic2[d][0] = dic2[d][0].strip()
            if dic2[d][0] != ' '  and len(re.findall('\(\d+\)?\]?', dic2[d][0])) == 1:
                # print('to remove brackets')
                text = dic2[d][0]
                matchcode = re.search(r'\(\d+\)?\]?',text)
                dic2[d][0] = dic2[d][0].replace(matchcode.group(),'')
                dic2[d][0] = dic2[d][0].strip()
            if  dic2[d][3]!=' ' and 'To' in dic2[d][3]:
                dic2[d][3] = 'Total'

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Mayom_N9522-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        header = []
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0].__contains__('ISSUE DETAIL'):
                dic2[d][0] = ' '
            if d>1 and dic2[d][0].__contains__('Bill') and dic2[d-1][0]==' ' and dic2[d-1][5]!= ' ':
                print('remove bill no amts in d-1')
                dic2[d-1][5] = ' '


            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='SGHS_N5327':
        dic2 = dic1
        dic1 = {}
        lq = 1
        header = []
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][2]!=' ' and  len(dic2[d][2].split()[0])>=6:
                # print('if 9999311 and rate, QTy merged in 2nd indx')
                text = dic2[d][2].split()
                dic2[d][2] = text[1]
                dic2[d][3] = text[-1]

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Apex_N16023':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] != ' ' and len(re.findall('^\d+\.?\s', dic2[d][0])) == 1 and len(dic2[d][0].split()[0]) <= 3:
                # print('to remove sno and brackets')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
                dic2[d][0] = dic2[d][0].strip()
            if d > 1 and dic2[d][0] != ' ' and len(re.findall('\d?\s?\d\-\w+\-\d+', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()) >= 2:
                # print('if header and date merged')
                text = dic2[d][0]
                matchdate = re.search(r'\d?\s?\d\-\w+\-\d+', text)
                dic2[d][0] = matchdate.group()
                text1 = text.replace(matchdate.group(), '')
                text1 = text1.strip()
                listnw = [text1, ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d >= 1 and d < len(dic2) and dic2[d][0] in head_list and dic2[d][2] != ' ' and dic2[d + 1][2] != ' ':
                print('if d[0] in head_list and d+1 line 2nd indx and d line 2ndx indx and divided')
                dic2[d + 1][2] = dic2[d][2] + ' ' + dic2[d + 1][2]

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd11==', dic2[d])
            if d > 1 and d < len(dic2) and dic2[d][0] + ' ' + dic2[d + 1][0] in head_list:
                # print('if header is in 2 lines d, d+1')
                dic2[d][0] = dic2[d][0] + ' ' + dic2[d + 1][0]
                dic2[d + 1][0] = ' '
            if d >= 1 and d < len(dic2) and dic2[d].count(' ') == 5 and dic2[d + 1].count(' ') <= 2 and dic2[d][
                2] != ' ' and dic2[d + 1][2] != ' ':
                print('if  and d+1 line 2nd indx and d line 2ndx indx and divided')
                dic2[d + 1][2] = dic2[d][2] + ' ' + dic2[d + 1][2]

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Signature_N17192':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if d == 1 and dic2[d][0] in head_list and dic2[d].count(' ') <= 2 and dic2[d][3] != ' ' and dic2[d][
                4] != ' ':
                # print('if header in first line')
                listnw = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
                dic2[d][0] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Signature_N17192_daycare':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] != ' ' and len(re.findall('^\d+\.?\s', dic2[d][0])) == 1 and len(dic2[d][0].split()[0]) <= 3:
                # print('to remove sno and brackets')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
                dic2[d][0] = dic2[d][0].strip()

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Bhagat_N3879':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            # if dic2[d][1]
            if d == 1 and dic2[d][1] == 'Admission' and dic2[d][5] != ' ':
                dic2[d][0] = dic2[d][1]
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = ['Admission Charges', ' ', ' ', ' ', ' ', ' ']
            if dic2[d][1] != ' ' and dic2[d][1] in head_list and dic2[d].count(' ') > 3:
                dic2[d][0] = dic2[d][1]
                dic2[d][1] = ' '
            if dic2[d][1] != ' ' and dic2[d][1] in src_dc['merge_set']:
                dic2[d][0] = dic2[d][1]
                dic2[d][1] = ' '
            if dic2[d][0] != ' ' and len(re.findall('\d+\/\w+\s?\/\d+', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()) >= 2:
                # print('if date and parti together')
                text = dic2[d][0]
                matchdate = re.search(r'\d+\/\w+\s?\/\d+', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')
                dic2[d][1] = dic2[d][1].strip()
            if dic2[d][0] != ' ' and len(re.findall('\d+\-\w+\s?\-\d+', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()) >= 2:
                # print('if date and parti together')
                text = dic2[d][0]
                matchdate = re.search(r'\d+\-\w+\s?\-\d+', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')
                dic2[d][1] = dic2[d][1].strip()

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Bhagat_N3879-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            # if dic2[d][1]
            if dic2[d][0] == 'Pharmacy,':
                dic2[d][0] = 'Pharmacy'
            if dic2[d][3] != ' ' and dic2[d][4] != ' ' and len(dic2[d][3].split()) == 2 and len(
                    re.findall('\d\.\d', dic2[d][3])) == 2:
                print('if rate, qty in 3td indx and qty in 4th indx')
                text = dic2[d][3].split()
                dic2[d][3] = text[0]
                dic2[d][4] = text[1]
            if dic2[d][3]!=' ' and dic2[d][4]== ' ' and len(dic2[d][3].split())==2 and len(re.findall('\d\.\d', dic2[d][3])) == 2:
                print('if rate, qty in 3td indx and qty in 4th indx')
                text = dic2[d][3].split()
                dic2[d][3] = text[0]
                dic2[d][4] = text[1]
            if dic2[d][3].__contains__('ICI'):
                dic2[d][3] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Sunshine_N10387' or hospital == 'Sunshine_N10387_1':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] == 'Doctor, Consultation':
                dic2[d][0] = 'Doctor Consultation'
            if dic2[d][0] != ' ' and dic2[d][1] == ' ' and len(re.findall('\d+\/\d+\/\d+', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()) >= 2:
                # print('to remove sno and brackets')
                text = dic2[d][0]
                matchdate = re.search(r'\d+\/\d+\/\d+', text)
                dic2[d][0] = dic2[d][0].replace(matchdate.group(), '')
                dic2[d][1] = matchdate.group()
            if d > 1 and d < len(dic2) and dic2[d][0] in head_list and dic2[d + 1][0] == dic2[d][0]:
                dic2[d + 1][0] = dic2[d + 1][0].upper()
            if dic2[d][0] != ' ' and dic2[d][0] in head_list and dic2[d][1] != ' ' and dic2[d].count(' ') <= 2:
                dic2[d][0] = dic2[d][0].upper()
            if dic2[d][0] in src_dc['merge_set'].split(',') and dic2[d][5] != ' ' and dic2[d].count(' ') == 4:
                dic2[d][5] = ' '
            if d > 1 and d < len(dic2) and dic2[d][0] in head_list and dic2[d].count(' ') == 5:
                print('if some extra lines have header in it')
                dic2[d][0] = dic2[d][0] + dic2[d][0][-1]

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Sunshine_N10387-pharma' or hospital == 'Sunshine_N10387_1-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if d == 1 and 'Item' in dic2[d][0] and 'Item Return' not in dic2[d][0] and 'Item Return' not in dic2[d + 1][
                0] and len(dic2[d][0].split()) >= 2:
                print('if Item merged with lines d==1')
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = ['Item', ' ', ' ', ' ', ' ', ' ']
                dic2[d][0] = dic2[d][0].replace('Item', '')
            if d > 1 and d < len(dic2) and 'Item' in dic2[d][0] and 'Item Return' not in dic2[d][
                0] and 'Item Return' not in dic2[d + 1][0] and len(dic2[d][0].split()) >= 2:
                print('if Item is merged with line d>1 ')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = ['Item', ' ', ' ', ' ', ' ', ' ']
                dic2[d][0] = dic2[d][0].replace('Item', '')
            if dic2[d][0] != ' ' and len(re.findall('^\d+\.?\s', dic2[d][0])) == 1 and len(dic2[d][0].split()[0]) <= 3:
                # print('to remove sno and brackets')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
                dic2[d][0] = dic2[d][0].strip()

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Sarvodaya_N2958':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] == '1 & D':
                dic2[d][0] = ' '
            if dic2[d][0] != ' ' and len(re.findall('^\d+\s?\,?\.?\s', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()[0]) <= 3:
                # print('to remove sno and brackets')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\s?\,?\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
                dic2[d][0] = dic2[d][0].strip()
            if dic2[d][2] != ' ' and len(re.findall('[.]\s+[^0-9]*', dic2[d][2])) == 1 and len(
                    re.findall('\d+\.\d+', dic2[d][2])) == 0:
                dic2[d][2] = ' '
            if dic2[d][4] != ' ' and len(re.findall('[.]\s+[^0-9]*', dic2[d][4])) == 1 and len(
                    re.findall('\d+\.\d+', dic2[d][4])) == 0:
                dic2[d][4] = ' '
            if dic2[d][3] != ' ' and len(re.findall('[.]\s+[^0-9]*', dic2[d][3])) == 1 and len(
                    re.findall('\d+\.\d+', dic2[d][3])) == 0:
                dic2[d][3] = ' '
            if dic2[d][5] != ' ' and len(re.findall('[.]\s+[^0-9]*', dic2[d][5])) == 1 and len(
                    re.findall('\d+\.\d+', dic2[d][5])) == 0:
                dic2[d][5] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Sarvodaya_N2958-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] != ' ' and dic2[d][0].__contains__('ISSUE') and dic2[d][0].__contains__('Type'):
                dic2[d][0] = 'Pharmacy'
            if dic2[d][0] != ' ' and dic2[d][0].__contains__('RETURN') and dic2[d][0].__contains__('Type'):
                dic2[d][0] = 'Pharmacy Return'
            if dic2[d][0].__contains__('RETURN'):
                dic2[d][0] = 'Pharmacy Return'
            if dic2[d][4] != ' ' and len(dic2[d][4].split()) >= 2:
                print('if amount, tax% and tax in 4th indx')
                text = dic2[d][4].split()
                dic2[d][4] = text[0]
                if dic2[d][5] == ' ':
                    dic2[d][5] = text[-1]
            if dic2[d][2] != ' ' and len(re.findall('[.]\s+[^0-9]*', dic2[d][2])) == 1 and len(
                    re.findall('\d+\.\d+', dic2[d][2])) == 0:
                dic2[d][2] = ' '
            if dic2[d][4] != ' ' and len(re.findall('[.]\s+[^0-9]*', dic2[d][4])) == 1 and len(
                    re.findall('\d+\.\d+', dic2[d][4])) == 0:
                dic2[d][4] = ' '
            if dic2[d][3] != ' ' and len(re.findall('[.]\s+[^0-9]*', dic2[d][3])) == 1 and len(
                    re.findall('\d+\.\d+', dic2[d][3])) == 0:
                dic2[d][3] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'rjnapollo_N17864':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] != ' ' and len(re.findall('^\d+\s?\,?\.?\s', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()[0]) <= 3:
                # print('to remove sno and brackets')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\s?\,?\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
                dic2[d][0] = dic2[d][0].strip()
            if d == 1 and dic2[d][2] == dic2[d][3] and len(dic2[d][2].split()) > 3:
                print('for garbage dates')
                dic2[d][2] = ' '
                dic2[d][3] = ' '
            if dic2[d][5] != ' ' and dic2[d][4] != ' ' and dic2[d][4] == dic2[d][5]:
                dic2[d][5] = ' '
            if dic2[d][2] != ' ' and dic2[d][3] != ' ' and dic2[d][2] == dic2[d][3]:
                dic2[d][3] = ' '
            # if dic2[d]
            if dic2[d][5] != ' ' and len(dic2[d][5].split()) == 2 and dic2[d][5].split()[0] == dic2[d][4]:
                print('if dis in 4th indx and dis, amt in 5th indx')
                text = dic2[d][5].split()
                dic2[d][5] = text[-1]
            if dic2[d][5] != ' ' and len(dic2[d][5].split()) >= 2:
                print('if Qty, dis in 4th indx and dis, amt in 5th indx')
                text = dic2[d][5].split()
                dic2[d][5] = text[-1]
            if dic2[d][4] != ' ' and len(dic2[d][4].split()) == 2 and dic2[d][5] == ' ':
                print('if dis, amt in 4th indx and amt not in 5th indx')
                text = dic2[d][4].split()
                dic2[d][4] = text[0]
                dic2[d][5] = text[-1]
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Kalyani_N0731':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][3].__contains__('Tot'):
                dic2[d][3] = 'Subtotal'
            if dic2[d][1] == 'MEDICINE' and dic2[d][2] == 'MEDICINE':
                dic2[d][1] = ' '
                dic2[d][2] = ' '
            if dic2[d][0] != ' ' and len(re.findall('^\d+\s?\,?\.?\s', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()[0]) <= 3:
                # print('to remove sno and brackets')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\s?\,?\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
                dic2[d][0] = dic2[d][0].strip()
            if d > 2 and 'MEDICINE' in dic2[d][0] and dic2[d][5] != ' ' and dic2[d].count(' ') == 4:
                listnw = ['MEDICINE', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
                dic2[d][0] = dic2[d][0] + 'S'
                dic2[d][3] = dic2[d][5]
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'apollo_N12340':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] != ' ' and len(re.findall('^\d+\s?\,?\.?\s', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()[0]) <= 3:
                # print('to remove sno and brackets')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\s?\,?\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
                dic2[d][0] = dic2[d][0].strip()

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Imax_N13295':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] != ' ' and len(re.findall('\d+\s?\.\s?\d+', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()[0]) >= 2 and dic2[d][2] == ' ':
                # print('if parti and qty in 0th indx')
                text = dic2[d][0]
                matchqty = re.search(r'\d+\s?\.\s?\d+', text)
                dic2[d][2] = matchqty.group()
                dic2[d][0] = dic2[d][0].replace(matchqty.group(), '')
                dic2[d][0] = dic2[d][0].strip()
            if dic2[d][3] != ' ' and len(re.findall('\d+\s?\.\s?\d+', dic2[d][3])) == 2 and len(
                    dic2[d][3].split()) == 2:
                # print('if comp amt, price together in 3rd indx')
                a, b = dic2[d][3].split()
                dic2[d][3] = b
            if dic2[d][4] != ' ' and len(re.findall('\d+\s?\.\s?\d+', dic2[d][4])) == 2 and len(
                    dic2[d][4].split()) == 2 and dic2[d][5] == ' ' and dic2[d].count(' ') == 5:
                # print('if amt, net amt together in 4th indx for total')
                a, b = dic2[d][4].split()
                dic2[d][4] = a
                dic2[d][5] = b
            if dic2[d][4] != ' ' and len(re.findall('\d+\s?\.\s?\d+', dic2[d][4])) == 2 and len(
                    dic2[d][4].split()) >= 2 and dic2[d][5] == ' ' and dic2[d].count(' ') <= 3:
                # print('if amt, net amt together with doctor name in 4th indx')
                text = dic2[d][4].split()
                dic2[d][4] = text[0]
                dic2[d][5] = text[1]
            if dic2[d][3] != ' ' and len(re.findall('\d+\s?\.\s?\d+', dic2[d][3])) > 2 and len(
                    dic2[d][3].split()) > 2 and dic2[d][4] == ' ' and dic2[d][5] == ' ':
                # print('if comp amt, price together in 3rd indx')
                text = dic2[d][3].split()
                dic2[d][3] = text[1]
                dic2[d][4] = text[2]
                dic2[d][5] = text[3]
            if d > 1 and dic2[d][0] in head_list and dic2[d].count(' ') == 5 and dic2[d - 1][4] != ' ' and dic2[d - 1][
                5] != ' ' and dic2[d - 1].count(' ') == 4:
                print('above header removing totals')
                dic2[d - 1][4] = ' '
                dic2[d - 1][5] = ' '
            if d == len(dic2) and dic2[d].count(' ') == 4 and dic2[d][4] != ' ' and dic2[d][5] != ' ':
                print('above header removing totals')
                dic2[d][4] = ' '
                dic2[d][5] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Imax_N13295_1':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] != ' ' and len(re.findall('^\d+\s?\,?\.?\s', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()[0]) <= 3:
                # print('to remove sno and brackets')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\s?\,?\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
                dic2[d][0] = dic2[d][0].strip()
            if dic2[d][4] != ' ' and len(re.findall('\d+\s?\.\s?\d+', dic2[d][4])) == 2 and len(
                    dic2[d][4].split()) == 2:
                # print('if rate, amt together in 4th indx')
                a, b = dic2[d][4].split()
                dic2[d][4] = a
                dic2[d][5] = b
            if d > 1 and d < len(dic2) and 'Sub Total' in dic2[d][3] and dic2[d + 1][0] not in head_list:
                print('if extra sbt is present')
                dic2[d][3] = ' '
                dic2[d][4] = ' '
                dic2[d][5] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Jaiprakash_N18187':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][4] != ' ' and dic2[d - 1].count(' ') >= 4:
                print('extra total')
                dic2[d - 1][4] = ' '
            if d > 1 and dic2[d][2] != ' ' and dic2[d][2].__contains__('Package Days') and dic2[d].count(
                    ' ') >= 3 and len(re.findall('\d+\.\d+', dic2[d][2])) == 1:
                # print('if amt with package for bedcharges')
                text = dic2[d][2]
                matchamt = re.search(r'\d+\.\d+', text)
                dic2[d - 1][3] = matchamt.group()
                dic2[d][2] = ' '
            if d > 1 and dic2[d][2] != ' ' and dic2[d][2].__contains__('Pkg') and dic2[d].count(' ') >= 3 and len(
                    re.findall('\d+\.\d+', dic2[d][2])) == 1:
                # print('if amt with pkg')
                text = dic2[d][2]
                matchamt = re.search(r'\d+\.\d+', text)
                dic2[d - 1][4] = matchamt.group()
                dic2[d][2] = ' '
            if dic2[d][1] != ' ' and len(re.findall('\d+\/\d+\/\d+', dic2[d][1])) >= 1 and len(
                    dic2[d][1].split()) >= 2 and 'From' not in dic2[d][1]:
                # print('if batchno expiry together in 1st indx')
                text = dic2[d][1]
                matchdate = re.search(r'\d+\/\d+\/\d+', text)
                dic2[d][1] = matchdate.group()

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd11==', dic2[d])
            if d > 1 and dic2[d][0] == ' ' and dic2[d][1] != ' ' and dic2[d][2] != ' ' and dic2[d][4] != ' ' and dic2[
                d].count(' ') <= 3 and \
                    dic2[d - 1][0] != ' ' and dic2[d - 1][1] != ' ' and dic2[d - 1].count(' ') == 4:
                print('if lines are divided with pkg')
                dic2[d][1] = ' '
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Kolekar_N13498':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] != ' ' and len(re.findall('^\d+\s?\,?\.?\s', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()[0]) <= 3:
                # print('to remove sno and brackets')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\s?\,?\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
                dic2[d][0] = dic2[d][0].strip()

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'apollocradle_N11090':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if d == 1 and dic2[d][0] in head_list and dic2[d].count(' ') != 5:
                print('for 1st header')
                listnw = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
                dic2[d][0] = ' '
            if dic2[d][2] != ' ' and len(dic2[d][2].split()) == 2 and len(re.findall('\d\.\d', dic2[d][2])) == 2 and \
                    dic2[d][3] != ' ':
                print('if qty rate together in 2nd indx')
                text = dic2[d][2].split()
                dic2[d][2] = text[0]
            if dic2[d][2] != ' ' and len(dic2[d][2].split()) == 2 and len(re.findall('\d\.\d', dic2[d][2])) == 2 and \
                    dic2[d][3] == ' ':
                print('if qty rate together in 2nd indx and 3rd indx empty')
                text = dic2[d][2].split()
                dic2[d][2] = text[0]
                dic2[d][3] = text[1]

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        header = []
        for d in dic2:
            print('dd11==', dic2[d])
            if dic2[d][0] in head_list:
                if dic2[d][0] not in header:
                    header.append(dic2[d][0])
                else:
                    dic2[d][0] = ' '
            if d > 1 and dic2[d][0] in head_list and dic2[d].count(' ') != 5:
                print('for headers with line items')
                listnw = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
                dic2[d][0] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'apollocradle_N11090_1':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][4] != ' ' and dic2[d][5] != ' ' and len(re.findall('\d+\.\d+', dic2[d][4])) == 2 and dic2[d][
                5] in dic2[d][4]:
                print('if qty, amt in 4th indx and amt in 5th indx')
                text = dic2[d][4].split()
                dic2[d][4] = text[0]
                dic2[d][5] = text[-1]
            if (dic2[d][1].__contains__('Admission Cha') or dic2[d][1].__contains__('Admission Cha')) and dic2[d][
                2] == ' ':
                dic2[d][2] = dic2[d][1]
            if (dic2[d][1].__contains__('EMR Charge') or dic2[d][1].__contains__('EMR Cha')) and dic2[d][2] == ' ':
                dic2[d][2] = dic2[d][1]
            if (dic2[d][1].__contains__('Round Off') or dic2[d][1].__contains__('Round Of')) and dic2[d][2] == ' ':
                dic2[d][2] = dic2[d][1]
            if dic2[d][1].__contains__('Registration') and dic2[d][2] == ' ':
                dic2[d][2] = dic2[d][1]

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Felix_N15239':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][1] != ' ' and dic2[d][2] != ' ' and dic2[d][1] == dic2[d][2]:
                dic2[d][2] = ' '
            if dic2[d][1] != ' ' and dic2[d][2] == ' ' and len(re.findall('^\w+\-\d+', dic2[d][1].split()[0])) == 1 and \
                    dic2[d].count(' ') <= 3 and len(dic2[d][1].split()) >= 2:
                print('if code and parti togther and in 1st indx')
                text = dic2[d][1]
                if len(re.findall('\w+\-\d+', dic2[d][1].split()[0])) == 1:
                    matchcode = re.search(r'\w+\-\d+', text.split()[0])
                dic2[d][1] = matchcode.group()
                dic2[d][2] = text.replace(matchcode.group(), '')
                dic2[d][2] = dic2[d][2].strip()
            if dic2[d][1] != ' ' and dic2[d][2] != ' ' and dic2[d][1] == dic2[d][2].split()[0] and len(
                    re.findall('\w+\-\d+', dic2[d][2].split()[0])) == 1 and \
                    dic2[d].count(' ') <= 3 and len(dic2[d][2].split()) >= 2:
                print('if code and parti togther and in 2nd indx')
                text = dic2[d][2]
                if len(re.findall('\w+\-\d+', dic2[d][2].split()[0])) == 1:
                    matchcode = re.search(r'\w+\-\d+', text.split()[0])
                dic2[d][2] = dic2[d][2].replace(matchcode.group(), '')
                dic2[d][2] = dic2[d][2].strip()
            if dic2[d][0] != ' ' and dic2[d][1] == ' ' and len(re.findall('^\d+\-\d+\-\d+', dic2[d][0])) == 1 and \
                    dic2[d].count(' ') <= 3 and len(dic2[d][0].split()) >= 2 and dic2[d][2] != ' ':
                print('if date and code togther and in 0th indx')
                text = dic2[d][0]
                if len(re.findall('^\d+\-\d+\-\d+', text)) == 1:
                    matchdate = re.search(r'^\d+\-\d+\-\d+', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')
                dic2[d][1] = dic2[d][1].strip()
            if dic2[d][3] != ' ' and dic2[d][4] == ' ' and len(dic2[d][3].split()) == 3 and len(
                    re.findall('\d+\s\d+\s\w+', dic2[d][3])) == 1:
                print('if rate qty together for room rnet')
                a, b, c = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b + ' ' + c

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Smt_N1586':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0].__contains__('PACKAGE') and dic2[d][2] == 'Operation Date':
                dic2[d][2] = ' '
            if d > 1 and dic2[d][0] != ' ' and dic2[d][1] == ' ' and dic2[d][2] != ' ' and dic2[d][5] != ' ' and \
                    dic2[d - 1][0] != ' ' and dic2[d - 1].count(' ') == 5 and \
                    len(re.findall('\d+\-\d+\-\d+', dic2[d][2])) == 1 and dic2[d].count(' ') <= 3:
                print('if 2 lines divided d<=3, d-1 5')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if d > 1 and dic2[d][0] == ' ' and dic2[d][1] == ' ' and dic2[d][2] != ' ' and dic2[d - 1][0] != ' ' and \
                    dic2[d - 1][1] != ' ' and dic2[d - 1][2] != ' ' and \
                    dic2[d].count(' ') == 3 and dic2[d - 1].count(' ') == 3 and len(
                re.findall('\d+\-\d+\-\d+', dic2[d - 1][0])) == 1 and len(
                re.findall('\w+\d+\s?\d+', dic2[d - 1][1])) == 1:
                print('if 2 lines divided d 3, d-1 3')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if d > 1 and dic2[d][0] == ' ' and dic2[d][1] == ' ' and dic2[d][2] == ' ' and dic2[d][3] == ' ' and \
                    dic2[d - 1][0] != ' ' and dic2[d - 1][1] != ' ' and dic2[d - 1][2] != ' ' and \
                    dic2[d].count(' ') == 4 and dic2[d - 1].count(' ') == 3 and len(
                re.findall('\d+\-\d+\-\d+', dic2[d - 1][0])) == 1 and len(
                re.findall('\w+\d+\s?\d+', dic2[d - 1][1])) == 1:
                print('if 2 lines divided d 4, d-1 3')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if d > 1 and dic2[d][0] == ' ' and dic2[d][1] == ' ' and dic2[d][2] != ' ' and dic2[d][3] == ' ' and \
                    dic2[d - 1][0] != ' ' and dic2[d - 1][1] != ' ' and dic2[d - 1][2] != ' ' and \
                    dic2[d].count(' ') == 4 and dic2[d - 1].count(' ') == 2 and len(
                re.findall('\d+\-\d+\-\d+', dic2[d - 1][0])) == 1 and len(
                re.findall('\w+\d+\s?\d+', dic2[d - 1][1])) == 1 and \
                    dic2[d - 1][4] != ' ':
                print('if 2 lines divided d 4, d-1 2')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue

            dic1[lq] = dic2[d]
            lq += 1

        bed_charges_found = False
        for d in dic1:
            print('hhhhhh', dic1[d])
            if dic1[d][0] == 'BED CHARGES' and dic1[d].count(' ') == 5:
                print('yes press')
                bed_charges_found = True
            elif bed_charges_found and dic1[d][0] != ' ' and dic1[d].count(' ') <= 3:
                dic1[d][0] = dic1[d][0] + ' ' + dic1[d][1]
            elif dic1[d][0] in head_list and dic1[d].count(' ') == 5 and bed_charges_found == True:
                print('found next header after bed charges')
                break
    if hospital == 'Dr.rao_N10644':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] in src_dc['merge_set'] and dic2[d][5] != ' ':
                dic2[d][5] = ' '
            if dic2[d][0] != ' ' and dic2[d][1] == ' ' and dic2[d][2] == ' ' and len(dic2[d][0].split()) >= 3 and len(
                    re.findall('\d+\/\d+\/\d+', dic2[d][0])) == 1 and \
                    len(re.findall('\w+\d+', dic2[d][0].split()[1])) == 1:
                print('if date code parti together in 0th indx')
                text = dic2[d][0]
                matchdate = re.search(r'\d+\/\d+\/\d+', text)
                matchcode = re.search(r'\w+\d+', text.split()[1])
                dic2[d][0] = matchdate.group()
                dic2[d][1] = matchcode.group()
                dic2[d][2] = text.replace(matchdate.group(), '').replace(matchcode.group(), '')
                dic2[d][2] = dic2[d][2].strip()
            if dic2[d][0] != ' ' and dic2[d][1] == ' ' and dic2[d][2] != ' ' and len(dic2[d][0].split()) >= 2 and len(
                    re.findall('\d+\/\d+\/\d+', dic2[d][0])) == 1:
                print('if date code together in 0th indx')
                text = dic2[d][0]
                matchdate = re.search(r'\d+\/\d+\/\d+', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Kamakshi_N1061':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][5] != ' ' and dic2[d - 1].count(' ') == 5 and dic2[
                d].count(' ') >= 4:
                print('if any extra total is present above headr')
                dic2[d - 1][5] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Rao_N11371':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] != ' ' and len(dic2[d][0].split()) >= 2 and len(
                    re.findall('\d+\/\d\s?\d\/\d+', dic2[d][0])) == 1:
                # print('if date parti together in 0th indx')
                text = dic2[d][0]
                matchdate = re.search(r'\d+\/\d\s?\d\/\d+', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')
                dic2[d][1] = dic2[d][1].strip()
            if dic2[d][0] != ' ' and len(re.findall('\d+\/\d+\/\d+', dic2[d][0])) == 0 and dic2[d].count(
                    ' ') >= 4 and 'Sub Total' not in dic2[d][0] and \
                    dic2[d][0] not in head_list:
                print('if any extra line is presnt in 0th indx')
                dic2[d][1] = dic2[d][0]
                dic2[d][0] = ' '
            if d > 1 and d < len(dic2) and dic2[d][0] == 'Package' and dic2[d + 1][0] in head_list:
                print('if package is presnet')
                dic2[d + 1][0] = dic2[d + 1][0].lower()

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Rao_N11371-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if d > 1 and d < len(dic2) and dic2[d][0] == ' ' and dic2[d - 1][0] != ' ' and dic2[d][1] != ' ' and \
                    dic2[d - 1][1] == ' ' and dic2[d].count(' ') <= 3 and dic2[d - 1].count(' ') >= 4:
                print('if lines divided d<=3 and-1>=4 ')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if d > 1 and d < len(dic2) and dic2[d][0] == ' ' and dic2[d - 1][0] != ' ' and dic2[d][1] != ' ' and \
                    dic2[d - 1][1] == ' ' and dic2[d].count(' ') == 5 and dic2[d - 1].count(' ') == 5:
                print('if lines divided d 5 d-1 5')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Rao_N11371_1':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][1] != ' ' and dic2[d][1] in head_list:
                dic2[d][0] = 'Subtotal' + ' ' + dic2[d][1]
                dic2[d][1] = ' '
            # if dic2[d][0]!= ' ' and dic2[d][1]==' '  and len(dic2[d][0].split())>=2 and len(re.findall('\d+\/\d+\/\d+', dic2[d][0])) == 1:
            #     # print('if date parti together in 0th indx')
            #     text = dic2[d][0]
            #     matchdate = re.search(r'\d+\/\d+\/\d+',text)
            #     dic2[d][0] = matchdate.group()
            #     dic2[d][1] = text.replace(matchdate.group(),'')
            #     dic2[d][1] = dic2[d][1].strip()

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Divya_N3993':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] != ' ' and len(re.findall('^\d+\s?\,?\.?\s', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()[0]) <= 3:
                # print('to remove sno and brackets')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\s?\,?\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
                dic2[d][0] = dic2[d][0].strip()
            if dic2[d][0] == 'XRay':
                dic2[d][0] = 'Xray'
            if dic2[d][3].__contains__('....') and len(re.findall('\d\.\d', dic2[d][3])) == 0:
                dic2[d][3] = ' '
            if dic2[d][4].__contains__('....') and len(re.findall('\d\.\d', dic2[d][4])) == 0:
                dic2[d][4] = ' '
            if dic2[d][3] != ' ' and len(re.findall('[.]\s+[^0-9]*', dic2[d][3])) == 1 and len(
                    re.findall('\d+\.\d+', dic2[d][3])) == 0 and len(re.findall('\w+', dic2[d][3])) == 0:
                dic2[d][3] = ' '
            if dic2[d][4] != ' ' and len(re.findall('[.]\s+[^0-9]*', dic2[d][4])) == 1 and len(
                    re.findall('\d+\.\d+', dic2[d][4])) == 0 and len(re.findall('\w+', dic2[d][4])) == 0:
                dic2[d][4] = ' '
            if dic2[d][5] != ' ' and len(re.findall('[.]\s+[^0-9]*', dic2[d][5])) == 1 and len(
                    re.findall('\d+\.\d+', dic2[d][5])) == 0 and len(re.findall('\w+', dic2[d][5])) == 0:
                dic2[d][5] = ' '
            if len(dic2[d][3]) >= 4 and dic2[d].count(' ') >= 3 and len(re.findall('\d\.\d', dic2[d][3])) == 0 and len(
                    re.findall('\w+', dic2[d][3])) >= 1:
                print('to add sbt')
                dic2[d][3] = dic2[d][3] + ' ' + 'Subtotal'
            if len(dic2[d][4]) >= 4 and dic2[d].count(' ') >= 4 and len(re.findall('\d\.\d', dic2[d][4])) == 0 and len(
                    re.findall('\w+', dic2[d][4])) >= 1:
                print('to add sbt')
                dic2[d][4] = dic2[d][4] + ' ' + 'Subtotal'

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Aster_N3405':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd===', dic2[d])
            if dic2[d][2] == dic2[d][3] and len(re.findall('\d\.\d', dic2[d][2])) >= 1 and len(
                    re.findall('\d\.\d', dic2[d][3])) >= 1:
                dic2[d][2] = ' '
            if len(dic2[d][3].split()) == 2 and dic2[d][4] == ' ' and len(re.findall('\d\.\d', dic2[d][3])) == 2:
                print('with space in 3rd index')
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Chandra_N4134':
        dic2 = dic1
        dic1 = {}
        lq = 1
        Header = []
        for d in dic2:
            print('ddddd===', dic2[d])
            if dic2[d][2] != ' ' and dic2[d][2] in head_list and (dic2[d][1] != ' ' or dic2[d][1] == ' ') and dic2[
                d].count(' ') >= 3:
                if dic2[d][2] not in Header:
                    Header.append(dic2[d][2])
                    dic2[d][0] = dic2[d][2]
                    dic2[d][2] = ' '
                    dic2[d][5] = ' '
                else:
                    dic2[d][2] = ' '
                    dic2[d][1] = ' '
                    dic2[d][5] = ' '
            if dic2[d][2] != ' ' and (
                    dic2[d][2].__contains__('Medicines and consumable') or dic2[d][2] == 'Pathology' or dic2[d][
                2] == 'X-Ray' or
                    dic2[d][2] == 'CT / MRI' or dic2[d][2] == 'Cardiology' or dic2[d][2] == 'Ultrasound'):
                dic2[d][5] = ' '

            dic1[lq] = dic2[d]
            lq += 1
        print('Headerr', Header)
    if hospital == 'Surana_N6086':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd===', dic2[d])
            if dic2[d][3] != ' ' and len(re.findall('\d\.\d', dic2[d][3])) == 2 and len(dic2[d][3].split()) == 2:
                print('if Rate, Qty Together in 3rd indx')
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if dic2[d][4] != ' ' and dic2[d][3] == ' ' and len(re.findall('\d\.\d', dic2[d][4])) == 2 and len(
                    dic2[d][4].split()) == 2:
                print('if Rate, Qty Together in 4th indx')
                a, b = dic2[d][4].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if dic2[d][1] != ' ' and dic2[d][3] == ' ' and dic2[d][4] == ' ' and len(
                    re.findall('\d\.\d', dic2[d][1])) == 2:
                print('if Rate, QTy with Parti')
                text = dic2[d][1].split()
                dic2[d][4] = text[-1]
                dic2[d][3] = text[-2]
                dic2[d][1] = dic2[d][1].replace(text[-1], '').replace(text[-2], '')
            if dic2[d][1] != ' ' and dic2[d][3] == ' ' and dic2[d][4] != ' ' and len(
                    re.findall('\d\.\d', dic2[d][1])) == 1:
                print('if Rate with Parti')
                text = dic2[d][1].split()
                dic2[d][3] = text[-1]
                dic2[d][1] = dic2[d][1].replace(text[-1], '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'motherhood_N16105' or hospital == 'apollocradle_N5547':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd===', dic2[d])
            if dic2[d][0] == 'DRUGS, CONSUMABLES & IMPLANTS':
                dic2[d][0] = 'DRUGS CONSUMABLES & IMPLANTS'
            if len(dic2[d][0].split()) > 4 and len(re.findall('\D+\d+?\/\d+', dic2[d][0])) >= 1 and \
                    (len(re.findall('\d\/\d+\/\d+\s\d+\:\d+\:\d+\s\-\s', dic2[d][0])) == 1 or len(
                        re.findall('\d+\/\d+\/\d+\s?\d+\:\d+\s\-\s\D+\d+?\/\d+', dic2[d][0])) == 1):
                print('dateparticularmerge', dic2[d])
                text = dic2[d][0]
                if len(re.findall('\d+\/\d+\/\d+\s?\d+\:\d+\:\d+\s\-\s\D+\d+?\/\d+', text)) == 1:
                    matchDatecode = re.search(r'\d+\/\d+\/\d+\s?\d+\:\d+\:\d+\s\-\s\D+\d+?\/\d+', text)
                elif len(re.findall('\d+\/\d+\/\d+\s?\d+\:\d+\:\d+\s\-\s\D+\d?\/\s?\d+\D?\d+', text)) == 1:
                    matchDatecode = re.search(r'\d+\/\d+\/\d+\s?\d+\:\d+\:\d+\s\-\s\D+\d?\/\s?\d+\D?\d+', text)
                elif len(re.findall('\d+\/\d+\/\d+\s?\d+\:\d+\s\-\s\D+\d+?\/\d+', text)) == 1:
                    matchDatecode = re.search(r'\d+\/\d+\/\d+\s?\d+\:\d+\s\-\s\D+\d+?\/\d+', text)
                dic2[d][0] = matchDatecode.group()
                dic2[d][1] = text.replace(matchDatecode.group(), " ")
                dic2[d][1] = dic2[d][1].strip()
            if dic2[d][4] == ' ' and len(re.findall('\d+\D\w+\s\d\.\d+', dic2[d][3])):
                print('rate perti merge')
                a, b = re.split('\s', dic2[d][3])
                dic2[d][3] = a
                dic2[d][4] = b
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Sight_N0382':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd===', dic2[d])
            if dic2[d][1] == 'ame':
                dic2[d][1] = ' '
            if d > 1 and d <= len(dic2) and dic2[d][3] != ' ' and dic2[d][5] != ' ' and dic2[d][4] == ' ' and dic2[d][
                0] == ' ' and dic2[d][1] != ' ':
                print('for removing totals')
                dic2[d][3] = ' '
                dic2[d][5] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'icare_N4346':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd===', dic2[d])
            if dic2[d][0] != ' ' and dic2[d][1] != ' ' and dic2[d][0] == dic2[d][1] and dic2[d][0].__contains__(
                    'Procedure'):
                dic2[d][1] = ' '
            if dic2[d][0] == ' ' and dic2[d][1].__contains__('Procedure Name'):
                dic2[d][0] = dic2[d][1]
                dic2[d][1] = ' '
            if d == 1 and dic2[d][0] != ' ' and dic2[d][0] != 'Head':
                print('for head')
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = ['Head', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Care_N0260':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd===', dic2[d])
            if dic2[d][3] != ' ' and dic2[d][4] != ' ' and dic2[d][3] == dic2[d][4]:
                dic2[d][4] = ' '
            if dic2[d][3] != ' ' and len(dic2[d][3].split()) == 2:
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if dic2[d][1] != ' ' and dic2[d][2] == ' ' and len(re.findall('^\d{6}', dic2[d][1])) == 1 and len(
                    dic2[d][1].split()) >= 2:
                print('code parti together in 1st indx')
                text = dic2[d][1]
                matchcode = re.search(r'^\d{6}', text)
                dic2[d][1] = matchcode.group()
                dic2[d][2] = re.sub(r'^\d{6}', '', text)

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Specialist_N16248':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd===', dic2[d])
            if d > 1 and dic2[d][0] in src_dc['merge_set'] and dic2[d - 1][0].__contains__('Total') and dic2[d - 1][
                5] != ' ':
                dic2[d - 1][0] = ' '
                dic2[d - 1][5] = ' '
            if d > 1 and dic2[d][0].__contains__('Total') and dic2[d - 1][0].__contains__('Total'):
                dic2[d - 1][0] = ' '
                dic2[d - 1][5] = ' '
            if d>1 and d<len(dic2) and dic2[d][0] == ' ' and dic2[d-1][0]!=' ' and dic2[d].count(' ') == 4 and dic2[d-1].count(' ')==4 and \
                    dic2[d][4]!=' ' and dic2[d][5]!=' ' and 'SEMI' in dic2[d-1][0]:
                print('lines dividing')
                dic2[d-1][4] = dic2[d][4]
                dic2[d-1][5] = dic2[d][5]
                dic2[d][4] = ' '
                dic2[d][5] = ' '
            if dic2[d][0] != ' ' and len(re.findall('^\d+\s?\,?\.?\s', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()[0]) <= 3:
                # print('to remove sno and brackets')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\s?\,?\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
                dic2[d][0] = dic2[d][0].strip()

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'apollo_N15141':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] != ' ' and len(re.findall('^\d+\.?\s', dic2[d][0])) == 1 and len(dic2[d][0].split()[0]) <= 3:
                print('to remove sno')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
            if d > 1 and dic2[d][0] != ' ' and dic2[d][1] == ' ' and dic2[d - 1][0].__contains__('Admission Charge'):
                dic2[d][1] = 'Admission Charge'
            if d > 1 and dic2[d][0] != ' ' and dic2[d][1] == ' ' and dic2[d - 1][0].__contains__('EMR Charge'):
                dic2[d][1] = 'EMR Charge'

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'apollo_N15141_1':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if d == 1 and dic2[d][0] in head_list and dic2[d].count(' ') != 5:
                print('for 1st header')
                listnw = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
                dic2[d][0] = ' '
            if dic2[d][0].__contains__('Inventory') or dic2[d][0].__contains__('Inventery') or dic2[d][0].__contains__(
                    'inventory'):
                dic2[d][0] = 'Inventory Item'
            if dic2[d][2] != ' ' and len(re.findall('\d+\.\d+\s\d+\D\d+\s\d{2}', dic2[d][2])) == 1:
                print('if Qty and rate with space together in 2nd indx')
                text = dic2[d][2].split()
                dic2[d][2] = text[0]
                dic2[d][3] = text[1] + '.' + text[2]
            if dic2[d][2] != ' ' and len(re.findall('\d+\s\d+\s\d+\D+\d+\.\d{2}', dic2[d][2])) == 1:
                print('if Qty with space and rate together in 2nd indx')
                text = dic2[d][2].split()
                dic2[d][2] = text[0] + '.' + text[1]
                dic2[d][3] = text[2]
            if dic2[d][2] != ' ' and len(dic2[d][2].split()) == 2 and len(re.findall('\d\.\D?\d', dic2[d][2])) >= 1 and \
                    dic2[d][3] != ' ':
                print('if qty rate together in 2nd indx')
                text = dic2[d][2].split()
                dic2[d][2] = text[0]
            if dic2[d][2] != ' ' and len(dic2[d][2].split()) == 2 and len(re.findall('\d\.\d', dic2[d][2])) >= 1 and \
                    dic2[d][3] == ' ':
                print('if qty rate together in 2nd indx and 3rd indx empty')
                text = dic2[d][2].split()
                dic2[d][2] = text[0]
                dic2[d][3] = text[1]

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        header = []
        for d in dic2:
            print('dd11==', dic2[d])
            if dic2[d][0] in head_list:
                if dic2[d][0] not in header:
                    header.append(dic2[d][0])
                else:
                    dic2[d][0] = ' '
            if (dic2[d][0] == 'Admission Charge' or dic2[d][0] == 'EMR Charge') and dic2[d][4] != ' ' and dic2[d][
                5] == ' ' and dic2[d].count(' ') == 4:
                dic2[d][5] = dic2[d][4]
            if dic2[d][5] != ' ' and len(re.findall('\d+\.\d+\.\d+', dic2[d][5])) == 1:
                dic2[d][5] = dic2[d][5].replace('.', ',', 1)
            if d > 1 and dic2[d][0] != ' ' and dic2[d][0] == 'Admission Charge':
                dic2[d][1] = dic2[d][0]
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = ['Admission Charge', ' ', ' ', ' ', ' ', ' ']
                dic2[d][0] = ' '
            if d > 1 and dic2[d][0] != ' ' and dic2[d][0] == 'EMR Charge':
                dic2[d][1] = dic2[d][0]
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = ['EMR Charge', ' ', ' ', ' ', ' ', ' ']
                dic2[d][0] = ' '
            if d > 1 and dic2[d][0] in head_list and dic2[d].count(' ') != 5:
                print('for headers with line items')
                listnw = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
                dic2[d][0] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'KMS_N2554':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd===', dic2[d])
            if dic2[d][5].__contains__('kauvery'):
                dic2[d][5] = ' '
            if dic2[d][3]!= ' ' and dic2[d][4]!= ' ' and dic2[d][3]==dic2[d][4]:
                # print('if rate in 3rd indx and 4th indx')
                dic2[d][4] = ' '
            if dic2[d][3]!= ' ' and dic2[d][4]!= ' ' and dic2[d][3] in dic2[d][4]:
                dic2[d][4] = dic2[d][4].replace(dic2[d][3],'')
                dic2[d][3] = dic2[d][3].strip()
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'bhagwan_N15792':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd===', dic2[d])
            if dic2[d][0] == 'PLASTIC, HAND&RECONS. SURG':
                dic2[d][0] = 'PLASTIC HAND&RECONS. SURG'
            if dic2[d][3]!= ' ' and len(dic2[d][3].split())==2:
                text = dic2[d][3].split()
                dic2[d][3] = text[0]
                dic2[d][4] = text[1]
            if dic2[d][5]!= ' ' and len(dic2[d][5].split())>=2:
                text = dic2[d][5].split()
                dic2[d][5] = text[-1]
            if dic2[d][0] != ' ' and len(re.findall('^\d+\-\d+\-\d+\s\d+\s', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()) >= 2 and dic2[d][1]==' ':
                # print('if Date, code, Parti together in 0th indx')
                text = dic2[d][0]
                matchdate = re.search(r'^\d+\-\d+\-\d+\s\d+', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(),'')
                dic2[d][1] = dic2[d][1].strip()
            if d>1 and d<len(dic2) and dic2[d][1]=='GENERAL' and dic2[d+1][1] == 'INSTRUMENTATIONS':
                dic2[d][1] = dic2[d][1]+' '+dic2[d+1][1]
                dic2[d+1][1] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'bhagwan_N15792-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if d > 1 and dic2[d][2] == ' ' and len(re.findall('\d\.\d', dic2[d][4])) == 1 and len(
                    re.findall('\d\.\d', dic2[d][5])) == 1 and dic2[d - 1][2] != ' ' and \
                    ('Total F' not in dic2[d - 1][0] or 'Total F' not in dic2[d][0]) and dic2[d].count(' ') <= 2 and \
                    dic2[d - 1].count(' ') <= 4:
                print('if two lines are separated by Total amount')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'icon_N1504':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] == 'A W ANGIOPLASTY':
                dic2[d][0] = 'ANGIOPLASTY'
            if dic2[d][0] != ' ' and len(re.findall('^\d+\s?\,?\.?\s', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()[0]) <= 3:
                # print('to remove sno and brackets')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\s?\,?\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
                dic2[d][0] = dic2[d][0].strip()
            if dic2[d][3]!= ' ' and len(dic2[d][3].split())==2 and dic2[d][2]!= ' ' and dic2[d][2] == dic2[d][3].split()[0]:
                print('if QTy is in 2nd indx and Qty, rate in 3rd indx')
                text = dic2[d][3].split()
                dic2[d][3] = text[-1]
            if dic2[d][3]!= ' ' and len(dic2[d][3].split())==2 and dic2[d][2]== ' ':
                print('if QTy not in 2nd indx and Qty, rate in 3rd indx')
                text = dic2[d][3].split()
                dic2[d][2] = text[0]
                dic2[d][3] = text[-1]


            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'icon_N1504_daycare':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] != ' ' and len(re.findall('^\d+\s?\,?\.?\s', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()[0]) <= 3:
                # print('to remove sno and brackets')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\s?\,?\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
                dic2[d][0] = dic2[d][0].strip()


            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Sankara_N2331':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][4] != ' ' and len(re.findall('^\d+\s?\.\s?\d+', dic2[d][4])) == 1 and len(
                    dic2[d][4].split()) >= 2:
                # print('to remove NOS from QTY and wth brackets')
                text = dic2[d][4]
                matchqty = re.search(r'^\d+\s?\.\s?\d+', text)
                dic2[d][4] = matchqty.group()
                dic2[d][4] = dic2[d][4].strip()


            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Brahma_N1458':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][1]!= ' ' and dic2[d][1] in head_list and dic2[d].count(' ')>=4:
                dic2[d][0] = dic2[d][1]
                dic2[d][1] = ' '
            if d>1 and d<len(dic2) and dic2[d][1]!= ' ' and dic2[d+1][1]!= ' ' and dic2[d][1]+' '+dic2[d+1][1] in head_list and dic2[d].count(' ')>=4 and dic2[d+1].count(' ')>=4:
                dic2[d][0] = dic2[d][1]+' '+dic2[d+1][1]
                dic2[d][1] = ' '
                dic2[d+1][1] = ' '
            if d>1 and dic2[d][0] in head_list and dic2[d-1][4]!= ' ' and dic2[d-1][5]!= ' ' and dic2[d-1].count(' ')==4:
                dic2[d-1][4] = ' '
                dic2[d-1][5] = ' '
            if d>1 and dic2[d][0] in head_list and dic2[d-1][4]== ' ' and dic2[d-1][5]!= ' ' and dic2[d-1].count(' ')==5:
                dic2[d-1][5] = ' '
            if dic2[d][2]!= ' ' and dic2[d][3]== ' ' and len(dic2[d][2].split())==2 and len(re.findall('\d+\s?\.\s?\d+', dic2[d][2])) >= 1:
                a,b = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = b

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'aj_N1035':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] == 'Service':
                dic2[d][0] = ' '
            if dic2[d][0].__contains__('Department') and dic2[d][5]==' ' and dic2[d][4]== ' ':
                dic2[d][0] = ' '
            if len(dic2[d][3])>=8 and dic2[d].count(' ')>=4:
                dic2[d][3] = ' '
            if d>1 and dic2[d][0] in head_list and dic2[d-1][5]!= ' ' and dic2[d-1].count(' ')==5:
                dic2[d-1][5] = ' '


            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'aj_N1035-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][3]!= ' ' and len(re.findall('\d+\s?\.\s?\d+', dic2[d][3])) == 1 and len(dic2[d][3].split())==2 and dic2[d][4] == ' ':
                print('if QTy rate in 3rd indx')
                text = dic2[d][3].split()
                dic2[d][3] = text[0]
                dic2[d][4] = text[1]
            if dic2[d][3]!=' ' and len(re.findall('\d+\s?\.\s?\d+', dic2[d][3])) == 1 and dic2[d][4] == ' ':
                print('if rate in 3rd indx')
                dic2[d][4] = dic2[d][3]
                dic2[d][3] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Kanchi_N13513':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd===', dic2[d])
            if dic2[d][0] == 'DRUGS, CONSUMABLES & IMPLANTS':
                dic2[d][0] = 'DRUGS CONSUMABLES & IMPLANTS'
            if len(dic2[d][0].split()) > 4 and len(re.findall('\D+\d+\/\d+', dic2[d][0])) >= 1 and \
                    len(re.findall('\d+\/\d+\/\d+\s\d+\:\d+\s\-\s', dic2[d][0])) == 1:
                print('date particular merge', dic2[d])
                text = dic2[d][0]
                if len(re.findall('\d+\/\d+\/\d+\s?\d+\:\d+\s\-\s\D+\d+\D?\d+?\/\d+', text)) == 1:
                    matchDatecode = re.search(r'\d+\/\d+\/\d+\s?\d+\:\d+\s\-\s\D+\d+\D?\d+?\/\d+', text)
                elif len(re.findall('\d+\/\d+\/\d+\s?\d+\:\d+\s\-\s\d+\D?\d+?\/\d+', text)) == 1:
                    matchDatecode = re.search(r'\d+\/\d+\/\d+\s?\d+\:\d+\s\-\s\d+\D?\d+?\/\d+', text)
                dic2[d][0] = matchDatecode.group()
                dic2[d][1] = text.replace(matchDatecode.group(), " ")
                dic2[d][1] = dic2[d][1].strip()
            if  dic2[d][4]!= ' ' and dic2[d][5]!= ' ' and dic2[d][4] == dic2[d][5]:
                dic2[d][4] = ' '
            if dic2[d][3]!= ' ' and dic2[d][4]== ' ' and len(dic2[d][3].split())==2 and len(re.findall('\d\.\d', dic2[d][3])) >= 1:
                print('if Rate, Qty in 3rd indx and 4th empty')
                a,b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if dic2[d][3]!= ' ' and dic2[d][4]!= ' ' and len(dic2[d][3].split())==2 and len(re.findall('\d\.\d', dic2[d][3])) >= 1:
                print('if Rate, Qty in 3rd indx and 4th not empty')
                a,b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Shukan_N15961':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd===', dic2[d])


            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Shukan_N15961-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd===', dic2[d])
            if dic2[d][2] == 'Sales':
                dic2[d][0] = 'Pharmacy'
            if dic2[d][2] == 'Sales Return':
                dic2[d][0] = 'Pharmacy Return'
            if dic2[d][0] != ' ' and len(re.findall('^\d+?\s?\d+\-\d+\-\d+', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()) >= 2 and dic2[d][1]==' ':
                # print('if Date Parti together in 0th indx')
                text = dic2[d][0]
                matchdate = re.search(r'^\d+?\s?\d+\-\d+\-\d+', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(),'')
                dic2[d][1] = dic2[d][1].strip()
            if dic2[d][2] != ' ' and len(re.findall('\d+\/\d+', dic2[d][2])) == 1:
                # print('if Date Qty together in 2nd indx')
                if len(dic2[d][2].split())>=2 and len(dic2[d][2].split()[-1])<=3:
                    text = dic2[d][2].split()
                    dic2[d][2] = text[-1]
                else:
                    dic2[d][2] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Vadamalayan_N2487':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd===', dic2[d])
            if dic2[d][0] == 'ANESTHISIA CHARGES:,':
                dic2[d][0] = 'ANESTHISIA CHARGES'
            if dic2[d][0] == 'X RAY # 1 1 15':
                dic2[d][0] = 'X RAY'
            if dic2[d][0] == ' ' and dic2[d][1]!= ' ' and len(dic2[d][1].split())>=4 and dic2[d].count(' ')<=3 and len(re.findall('\/?\-?\d', dic2[d][1])) >= 1:
                # print('if date parti together in 1st indx while date is not reading properly for \d\-\d\-\d')
                text = dic2[d][1]
                if len(re.findall('^\D+\:?\d+\s\d+\-\/\d+\-\d+', dic2[d][1])) == 1:
                    matchdate = re.search(r'^\D+\:?\d+\s\d+\-\/\d+\-\d+',text)
                elif len(re.findall('^\d+\:?\d+\s\d+\-\/\d+\-\d+', dic2[d][1])) == 1:
                    matchdate = re.search(r'^\d+\:?\d+\s\d+\-\/\d+\-\d+',text)
                elif len(re.findall('^\D+\:?\d+\s\d+\-\d+\-\d+', dic2[d][1])) == 1:
                    matchdate = re.search(r'^\D+\:?\d+\s\d+\-\d+\-\d+',text)
                elif len(re.findall('^\D+\s\D+\s\D+\-\/\d+\-\d+', dic2[d][1])) == 1:
                    matchdate = re.search(r'^\D+\s\D+\s\D+\-\/\d+\-\d+',text)
                elif len(re.findall('^\D+\s\D+\s\D+\-\d+\-\d+', dic2[d][1])) == 1:
                    matchdate = re.search(r'^\D+\s\D+\s\D+\-\d+\-\d+',text)
                elif len(re.findall('^\d+\D+\d+\s\d+\-\/\d+\-\d+', dic2[d][1])) == 1:
                    matchdate = re.search(r'^\d+\D+\d+\s\d+\-\/\d+\-\d+',text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = dic2[d][1].replace(matchdate.group(),'')
                dic2[d][1] = dic2[d][1].strip()
            if dic2[d][3]!=' ' and (dic2[d][4]==  ' ' or dic2[d][3].split()[-1]==dic2[d][4]) and len(dic2[d][3].split())==2 and len(re.findall('\d\.\d', dic2[d][3])) >= 1:
                # print('if Qty, Rate in 3rd indx and 4th empty')
                text = dic2[d][3].split()
                dic2[d][3] = text[0]
                dic2[d][4] = text[-1]
            if dic2[d][3]==' ' and dic2[d][4]!=  ' ' and dic2[d][5]!= ' ' and len(dic2[d][4].split())==2 and len(re.findall('\d\.\d', dic2[d][4])) >= 1:
                # print('if Qty is 3mpty in 3rd indx and qty, rate together in 4th indx')
                text = dic2[d][4].split()
                dic2[d][3] = text[0]
                dic2[d][4] = text[-1]
            if dic2[d][3]!= ' ' and dic2[d][4]!= ' ' and len(dic2[d][4].split())==2 and len(re.findall('\d\.\d', dic2[d][4])) >= 1 and \
                    dic2[d][4].split()[0] == dic2[d][3]:
                print('if QTy , Rate tgether in 4th indx and 3rd indx not empty')
                text = dic2[d][4].split()
                dic2[d][4] = text[1]
            if dic2[d][4]!= ' ' and dic2[d][5]!= ' ' and len(dic2[d][5].split())==2 and len(re.findall('\d\.\d', dic2[d][5])) >= 1 and \
                    dic2[d][5].split()[0] == dic2[d][4]:
                print('if Rate , Amount tgether in 5th indx and 4th indx not empty')
                text = dic2[d][5].split()
                dic2[d][5] = text[1]
            if d>1 and dic2[d][0] in head_list and dic2[d][3]!= ' ' and dic2[d][4]!= ' ' and dic2[d][5]!= ' ' and dic2[d+1][3]==' ' and dic2[d+1][4]== ' ' and \
                  dic2[d+1][5] == ' ' and dic2[d].count(' ')==2 and dic2[d+1].count(' ')==4:
                print('if qty, rate, amt in header line')
                dic2[d+1][3:] = dic2[d][3:]
                dic2[d][3:] = [' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'apollo_N8396':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd===', dic2[d])
            if d==1 and dic2[d][0]!= ' ' and dic2[d][0]!='Head':
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = ['Head', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Rubanhospital_N0330':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] != ' ' and len(re.findall('^\d+\-\w+\-\d+\s', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()) >= 2 and dic2[d][1] == ' ':
                # print('if Date, Parti together in 0th indx')
                text = dic2[d][0]
                matchdate = re.search(r'^\d+\-\w+\-\d+\s', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')
                dic2[d][1] = dic2[d][1].strip()
            if dic2[d][1] != ' ' and dic2[d][1].__contains__("TOTAL") and dic2[d].count(' ') <= 2:
                print('if line item contains total')
                dic2[d][1] = dic2[d][1].replace('TOTAL', 'total')
            if dic2[d][3] != ' ' and len(re.findall('[-]\s+[^0-9]*', dic2[d][3])) == 1 and len(
                    re.findall('\d+\.\d+', dic2[d][3])) == 0 and len(re.findall('\w+', dic2[d][3])) == 0:
                dic2[d][3] = ' '
            if dic2[d][4] != ' ' and len(re.findall('[-]\s+[^0-9]*', dic2[d][4])) == 1 and len(
                    re.findall('\d+\.\d+', dic2[d][4])) == 0 and len(re.findall('\w+', dic2[d][4])) == 0:
                dic2[d][4] = ' '
            if dic2[d][5] != ' ' and len(re.findall('[-]\s+[^0-9]*', dic2[d][5])) == 1 and len(
                    re.findall('\d+\.\d+', dic2[d][5])) == 0 and len(re.findall('\w+', dic2[d][5])) == 0:
                dic2[d][5] = ' '
            if dic2[d][0] != ' ' and dic2[d][1] != ' ' and len(re.findall('\d+\-\w+\-\d+', dic2[d][0])) == 1 and len(
                    re.findall('\d+\-\w+\-\d+', dic2[d][1])) == 1 and \
                    len(re.findall('\d+\.\d+', dic2[d][3])) == 1:
                print('for bed charges line')
                dic2[d][0] = dic2[d][0] + ' ' + dic2[d][1]
                dic2[d][1] = dic2[d][2]
                if len(re.findall('\d+\.\d+', dic2[d][3])) == 1:
                    matchrate = re.search(r'\d+\.\d+', dic2[d][3])
                    dic2[d][4] = matchrate.group()
                    dic2[d][3] = ' '
            if dic2[d][0] != ' ' and dic2[d][0].__contains__('No.'):
                dic2[d][0] = dic2[d][0].replace('No.', '')
                dic2[d][0] = dic2[d][0].strip()
            if dic2[d][0] != ' ' and dic2[d][0].__contains__('NO.'):
                dic2[d][0] = dic2[d][0].replace('NO.', '')
                dic2[d][0] = dic2[d][0].strip()
            if dic2[d][3] != ' ' and len(dic2[d][3].split()) >= 3 and 'TOTAL' not in dic2[d][3]:
                # print('if batch and QTy merged')
                text = dic2[d][3].split()
                dic2[d][3] = text[-1]
            if dic2[d][0] == 'P SALE':
                dic2[d][0] = 'IP SALE'
            if dic2[d][0] == 'P SALE RETURN':
                dic2[d][0] = 'IP SALE RETURN'
            if dic2[d][0] == 'P DRUG SALE RETURN':
                dic2[d][0] = 'IP DRUG SALE RETURN'

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'raheja':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if  dic2[d][0]!= ' ' and len(re.findall('[.]\s+[^0-9]*', dic2[d][0])) == 1 and len(re.findall('\w+', dic2[d][0])) == 0:
                print('dotss in 0th indx')
                dic2[d][0] = ' '
            if  dic2[d][1]!= ' ' and len(re.findall('[.]\s+[^0-9]*', dic2[d][1])) == 1 and len(re.findall('\w+', dic2[d][1])) == 0:
                print('dotss in 1st indx')
                dic2[d][1] = ' '
            if  dic2[d][2]!= ' ' and len(re.findall('[.]\s+[^0-9]*', dic2[d][2])) == 1 and len(re.findall('\w+', dic2[d][2])) == 0:
                print('dotss in 2nd indx')
                dic2[d][2] = ' '
            if  dic2[d][3]!= ' ' and (len(re.findall('[.]\s+[^0-9]*', dic2[d][3])) == 1 or len(re.findall('\D\s[.]\s+[^0-9]*', dic2[d][3])) == 1) and len(re.findall('\w{2,}', dic2[d][3])) == 0:
                print('dotss in 3rd indx')
                dic2[d][3] = ' '
            if  dic2[d][4]!= ' ' and len(re.findall('[.]\s+[^0-9]*', dic2[d][4])) == 1 and len(re.findall('\w+', dic2[d][4])) == 0:
                print('dotss in 4th indx')
                dic2[d][4] = ' '
            if  dic2[d][5]!= ' ' and len(re.findall('[.]\s+[^0-9]*', dic2[d][5])) == 1 and len(re.findall('\w+', dic2[d][5])) == 0:
                print('dotss in 5th indx')
                dic2[d][5] = ' '
            if dic2[d][0] in head_list and dic2[d][5]!=' ':
                dic2[d][5] = ' '
            if dic2[d][3]!=' ' and 'Sub Total' in dic2[d][3]:
                dic2[d][3] = ' '
                dic2[d][5] = ' '
            # if dic2[d][3] in src_dc['merge_set']:
            #     dic2[d][0] = dic2[d][3]
            #     dic2[d][3] = ' '

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd111==', dic2[d])

            for i in src_dc['merge_set'].split(','):
                if i[0].upper()+i[1:] in head_list and i[0].upper()+i[1:] in dic2[d][3]:
                    print('ii====.upper',i[0].upper()+i[1:])
                    print('headr and subheader same in 3rd indx')
                    dic2[d][3] = i.lower()
                if i in dic2[d][3] and (len(re.findall('[.]\s+[^0-9]*', dic2[d][3])) == 1 or len(re.findall(i+'\s\.', dic2[d][3])) == 1 or len(re.findall('\s-\s[.]\s+[^0-9]*', dic2[d][3])) == 1 or \
                        len(re.findall(i+'\.', dic2[d][3])) == 1 or len(re.findall('\s\D\s[.]\s+[^0-9]*', dic2[d][3])) == 1):
                    print('sub head with dots')
                    dic2[d][3] = i
                    dic2[d][0] = dic2[d][3]
                    dic2[d][3] = ' '
            if dic2[d][3]!=' ' and dic2[d][3] in src_dc['merge_set'] and dic2[d].count(' ')>=4:
                dic2[d][0] = dic2[d][3]
                dic2[d][3] = ' '
            if dic2[d][3]!=' ' and dic2[d][3].lower() in src_dc['merge_set'] and dic2[d].count(' ')>=4:
                dic2[d][0] = dic2[d][3].lower()
                dic2[d][3] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Sushrut_N1598':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('d00==',dic2[d])
            if dic2[d][1] in head_list and dic2[d].count(' ')>=4:
                dic2[d][0] = dic2[d][1]
                dic2[d][1] = ' '
            if dic2[d][5]!=' ' and len(dic2[d][5].split())>=2 and 'Pkg' not in dic2[d][3]:
                print('if Amount, dic,  in 5th indx')
                text = dic2[d][5].split()
                dic2[d][5] = text[-1]
            if dic2[d][3]!=' ' and len(dic2[d][3].split())>=3 and len(dic2[d][3].split()[0])<=2 and 'Pkg' not in dic2[d][3]:
                print('if Qty, rate, disc in 3rd indx')
                text = dic2[d][3].split()
                dic2[d][2] = text[0]
                dic2[d][3] = text[1]
                dic2[d][4] = text[-1]
            if dic2[d][3]!=' ' and len(dic2[d][3].split())==2 and len(dic2[d][3].split()[0])>=2 and 'Pkg' not in dic2[d][3]:
                print('if rate, disc in 3rd indx')
                text = dic2[d][3].split()
                dic2[d][3] = text[0]
                dic2[d][4] = text[-1]

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'LVPrasad_N0071':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('d00==',dic2[d])
            if dic2[d][0]!=' ' and len(dic2[d][0].split())<=5 and (len(re.findall('\d+', dic2[d][0].split()[-1])) == 1 or len(re.findall('\d+\s\d+', dic2[d][0])) == 1) and \
                    'approval' not in dic2[d][0] and len(dic2[d][0].split())>1:
                print('if Amount, dic,  in 5th indx')
                text = dic2[d][0].split()
                if len(re.findall('\d+\s\d+', dic2[d][0])) == 1:
                    print('if d space d')
                    dic2[d][5] = text[-2]+text[-1]
                    dic2[d][0] = dic2[d][0].replace(text[-1],'').replace(text[-2],'').strip()
                elif len(re.findall('\d+', dic2[d][0].split()[-1])) == 1 and len(re.findall('\d+\s\d+', dic2[d][0])) == 0:
                    print('if Only d')
                    dic2[d][5] = text[-1]
                    dic2[d][0] = dic2[d][0].replace(dic2[d][5],'')
                    dic2[d][0] = dic2[d][0].strip()
            if d>1 and d<len(dic2) and dic2[d][0]+' '+dic2[d+1][0] in head_list:
                dic2[d][0] = dic2[d][0]+' '+dic2[d+1][0]
                dic2[d+1][0] = ' '



            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('d00==', dic2[d])
            if len(dic2[d][0].split())==1 and len(re.findall('\d+', dic2[d][0])) == 1:
                dic2[d][0] = ' '
            if d>1 and d<=len(dic2) and dic2[d][0] in head_list and dic2[d].count(' ')>=3:
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq+=1
                dic1[lq-1] = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic2[d][0] = dic2[d][0].lower()

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Utkal_N16075':
        dic2 = dic1
        dic1 = {}
        dic3 = {}
        lq = 1
        for d in dic2:
            print('dd0000==', dic2[d])
            if dic2[d][1].__contains__("PROVISIONAL"):
                dic2[d][1] = ' '
            if dic2[d][0] == "PROVISIONAL BILL BREAK UP":
                dic2[d][0] = ' '
            if len(re.findall('\d+\.\d+', dic2[d][1])) == 1 and dic2[d][4]==' ' and dic2[d][5]!=' ':
                print('for bed charges')
                text = dic2[d][1]
                matchrate = re.search(r'\d+\.\d+',text)
                dic2[d][4] = matchrate.group()
                dic2[d][1] = dic2[d][1].replace(matchrate.group(),'')
            if len(re.findall('\d+', dic2[d][4])) == 1 and len(re.findall('\d+\.\d+', dic2[d][4])) == 0 and len(dic2[d][4])>=7:
                print('removing codes from 4th indx')
                dic2[d][4] = ' '
            if dic2[d][5]!= ' ' and len(re.findall('\w+\-\d+', dic2[d][5])) == 1:
                print('if date in 5th indx')
                text = dic2[d][5]
                matchdate = re.search(r'\w+\-\d+',text)
                dic2[d][5] = dic2[d][5].replace(matchdate.group(),'').strip()
            if dic2[d][5]!=' ' and len(dic2[d][5].split())==2 and len(dic2[d][5].split()[0])>=6 and len(re.findall('\d+\.\d+', dic2[d][5])) == 1:
                print('if code, amt in 5th place')
                text = dic2[d][5].split()
                dic2[d][5] = text[-1]
                dic2[d][5] = dic2[d][5].strip()
            if dic2[d][0] == 'Complete Bill':
                dic2[d][0] = ' '
            if dic2[d][0].__contains__('Complete Bill'):
                dic2[d][0] = dic2[d][0].replace('Complete Bill','').strip()
            if d==len(dic2) and dic2[d][0].__contains__('of') and dic2[d].count(' ')==4:
                dic2[d][0] = ' '
                dic2[d][5] = ' '

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        dic3 = {}
        lq = 1
        for d in dic2:
            print('dd1111==', dic2[d])
            if dic2[d][0] == "PROVISIONAL BILL BREAK UP":
                dic2[d][0] = ' '
            if dic2[d][0].__contains__('PROVISIONAL BILL BREAK UP'):
                dic2[d][0] = dic2[d][0].replace('PROVISIONAL BILL BREAK UP','').strip()
            if dic2[d][1]!=' ' and dic2[d][1] in head_list:
                dic2[d][0] = dic2[d][1]
                dic2[d][1] = ' '
            if dic2[d][5]!=' ' and len(dic2[d][5].split())==4 and len(re.findall('\d+\.\d+\s\d+\.\d+', dic2[d][5])) == 1:
                print('if only Qty, 0, rate , amount in 5th indx')
                text = dic2[d][5].split()
                dic2[d][5] = text[-1]
                dic2[d][4] = text[-2]
                dic2[d][3] = text[0]
            if dic2[d][5]!=' ' and len(dic2[d][5].split())==3 and len(re.findall('\d+\.\d+\s\d+\.\d+', dic2[d][5])) == 1:
                print('if only 0, rate , amount in 5th indx')
                text = dic2[d][5].split()
                dic2[d][5] = text[-1]
                dic2[d][4] = text[-2]
                dic2[d][3] = text[0]
            if dic2[d][5]!=' ' and len(dic2[d][5].split())==2 and len(re.findall('\d+\.\d+\s\d+\.\d+', dic2[d][5])) == 1:
                print('if only rate , amount in 5th indx')
                text = dic2[d][5].split()
                dic2[d][5] = text[-1]
                dic2[d][4] = text[0]
            if dic2[d][5]!=' ' and len(re.findall('\d+\.\d+\s\d+\s\d+\.\d+', dic2[d][5])) == 1:
                print('rate, Qty, amount in 5th indx')
                text = dic2[d][5].split()
                dic2[d][5] = text[-1]
                dic2[d][4] = text[0]
                dic2[d][3] = text[1]
            if dic2[d][5]!=' ' and len(re.findall('\d+\s\d+\.\d+', dic2[d][5])) == 1 and len(dic2[d][5].split()[0])<=2:
                print('Qty and amount in 5th indx')
                text = dic2[d][5].split()
                dic2[d][5] = text[-1]
                dic2[d][3] = text[0]
            if len(re.findall('\d+\/\d+\/\d+', dic2[d][1])) == 1 or len(re.findall('\w+\-\d+', dic2[d][1])) == 1:
                text = dic2[d][1]
                if len(re.findall('\d+\/\d+\/\d+', dic2[d][1])) == 1:
                    matchdate = re.search(r'\d+\/\d+\/\d+',text)
                elif len(re.findall('\w+\-\d+', dic2[d][1])) == 1:
                    matchdate = re.search(r'\w+\-\d+',text)
                dic2[d][1] = matchdate.group()
            if d>1 and d<len(dic2) and dic2[d][0] == 'ROOM CHARGES' and dic2[d+1][5]==' ' and dic2[d-1][5]!=' ':
                dic2[d][0] = dic2[d][0].lower()
            if d>1 and d<=len(dic2) and dic2[d][1]!=' ' and dic2[d][5]!=' ' and dic2[d].count(' ')==4 and dic2[d-1][0]!=' ' and dic2[d-1].count(' ')==5 and \
                    'TOTAL AMOUNT' not in dic2[d][1] and 'TOTAL AMOUNT' not in dic2[d-1][1]:
                print('lines divided d=4, d-1=5')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Tata_N15878':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('d00==',dic2[d])
            if 'Description' in dic2[d][3] and dic2[d][4] in head_list:
                print('desc in 3rd indx and head in 4th indx')
                dic2[d][0] = dic2[d][4]
                dic2[d][1:] = [' ', ' ', ' ', ' ', ' ']
            if 'Description' in dic2[d][3] and dic2[d][4] == ' ' and dic2[d][3].replace('Description:','').strip() in head_list:
                print('with desc in headlist in 3rd indx')
                dic2[d][0] = dic2[d][3].replace('Description:','').strip()
                dic2[d][1:] = [' ', ' ', ' ', ' ', ' ']
            if 'Description' in dic2[d][4] and dic2[d][4].replace('Description :','').strip() in head_list:
                print('with desc in headlist in 4th indx')
                dic2[d][0] = dic2[d][4].replace('Description :','').strip()
                dic2[d][1:] = [' ', ' ', ' ', ' ', ' ']
            if 'Description' in dic2[d][4] and dic2[d][4].replace('Description:','').strip() in head_list:
                print('with desc in headlist in 4th indx')
                dic2[d][0] = dic2[d][4].replace('Description:','').strip()
                dic2[d][1:] = [' ', ' ', ' ', ' ', ' ']
            if dic2[d][3]!=' ' and dic2[d][3] in head_list:
                dic2[d][0] = dic2[d][3]
                dic2[d][1:] = [' ', ' ', ' ', ' ', ' ']
            if dic2[d][4]!=' ' and dic2[d][4] in head_list:
                dic2[d][0] = dic2[d][4]
                dic2[d][1:] = [' ', ' ', ' ', ' ', ' ']
            if dic2[d][1]!=' ' and dic2[d][2]!=' ' and dic2[d][2] in dic2[d][1] and dic2[d][1] not in dic2[d][2] and len(dic2[d][1].split())>=2:
                print('if 2nd indx in 1st indx')
                dic2[d][1] = dic2[d][1].replace(dic2[d][2],'').strip()
            if dic2[d][1]!=' ' and dic2[d][2]!=' ' and dic2[d][1] == dic2[d][2]:
                print('if 1st indx and 2nd indx are same')
                dic2[d][1] = ' '
            if 'Sum' in dic2[d][0]:
                dic2[d][0] = 'Subtotal'

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Devi_N3046':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('d00==', dic2[d])
            if 'Date' in dic2[d][5]:
                dic2[d][5] = ' '
            if d>1 and d<=len(dic2) and dic2[d][0] in head_list and dic2[d].count(' ')>=3:
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq+=1
                dic1[lq-1] = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic2[d][0] = dic2[d][0].lower()

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Isha_N4843':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('d00==', dic2[d])
            if d==2 and dic2[d].count(' ')<=3 and 'GIPSA' in dic2[d][0]:
                print('for package')
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq-1] = ['Package', ' ', ' ', ' ', ' ', ' ']
            if d==2 and dic2[d].count(' ')<=3 and 'GIPSA' not in dic2[d][0] and 'GIPSA' not in dic2[d-1][0]:
                print('If only surgery lines are present')
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq+=1
                dic1[lq-1] = ['Surgery', ' ', ' ', ' ', ' ', ' ']
            if d>1 and dic2[d].count(' ')<=3 and 'GIPSA' not in dic2[d][0] and 'GIPSA' in dic2[d-1][0]:
                print('If after package surgery lines are present')
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq += 1
                dic1[lq - 1] = ['Surgery', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Ankura_N12127':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('d00==', dic2[d])
            if dic2[d][0]!=' ' and len(re.findall('\d+\-\d+\-\d+', dic2[d][0])) == 1 and dic2[d].count(' ')==5:
                dic2[d][0] =' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Ankura_N12127_1':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('d00==', dic2[d])
            if dic2[d][0]!=' ' and len(re.findall('\d+\-\d+\-\d+', dic2[d][0])) == 1 and dic2[d].count(' ')==7:
                dic2[d][0] =' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Ankura_N12127_2':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('d00==', dic2[d])
            if dic2[d][2] == 'Ad':
                dic2[d][2] = ' '
            if dic2[d][2] == 'A . 300.00 1200.00':
                dic2[d][2] = ' '
                dic2[d][3] = '300.00'
                dic2[d][4] = '1200.00'
            if dic2[d][2] == 'w w w 400.00 1200.00':
                dic2[d][2] = ' '
                dic2[d][3] = '400.00'
                dic2[d][4] = '1200.00'
            if 'Doctor Visits'  == dic2[d][2] or 'Returns' == dic2[d][2]:
                dic2[d][0] = dic2[d][2]
                dic2[d][2] = ' '
            if dic2[d][0]!=' ' and len(re.findall('\D+\s\d+\D?\s\d+\s\d+\:\d+\:\d+', dic2[d][0])) >= 1 and ',' in dic2[d][0]:
                dic2[d][0] = dic2[d][0].replace(',','').strip()
            if dic2[d][2]!=' ' and (len(re.findall('\d+\s?\.\s?\d+', dic2[d][2])) >= 1  or len(re.findall('\.\d+', dic2[d][2])) >= 1) and dic2[d][3]==' ' and dic2[d][4] == ' ' and len(dic2[d][2].split())>=2 and \
                    len(re.findall('\d+\-\d+', dic2[d][2])) == 1:
                print('for medicines')
                if len(dic2[d][2].split()) == 2:
                    text = dic2[d][2].split()
                    dic2[d][2] = ' '
                    dic2[d][3] = text[-1]
                if len(dic2[d][2].split()) == 3:
                    text = dic2[d][2].split()
                    dic2[d][2] = text[1]
                    dic2[d][3] = text[-1]
            if dic2[d][2]!=' ' and len(re.findall('\d+\.\d+', dic2[d][2])) == 1 and dic2[d][3]==' ' and dic2[d][4] == ' ' and len(dic2[d][2].split())==1:
                print('If only rate in 2nd indx')
                dic2[d][3] = dic2[d][2]
                dic2[d][2] = ' '
            if dic2[d][2]!=' ' and len(re.findall('\d+\.\d+', dic2[d][2])) >= 1 and dic2[d][3]==' ' and dic2[d][4] == ' ' and len(dic2[d][2].split())==3:
                print('if QTy, Rate, AMount in 2nd indx')
                text = dic2[d][2].split()
                dic2[d][2] = text[0]
                dic2[d][3] = text[1]
                dic2[d][4] = text[-1]
            if dic2[d][2]!=' ' and len(re.findall('\d+\.\d+', dic2[d][2])) == 1 and dic2[d][3]==' ' and dic2[d][4] == ' ' and len(dic2[d][2].split())==2:
                print('if Qty, Rate in 2nd indx')
                text = dic2[d][2].split()
                dic2[d][2] = text[0]
                dic2[d][3] = text[-1]
            if dic2[d][2]!=' ' and len(re.findall('\d+\.\d+', dic2[d][2])) == 2 and dic2[d][3]==' ' and dic2[d][4] == ' ' and len(dic2[d][2].split())==2:
                print('if (Rate, AMount) in 2nd indx')
                text = dic2[d][2].split()
                dic2[d][2] = ' '
                dic2[d][3] = text[0]
                dic2[d][4] = text[-1]

            if d>1 and dic2[d][0]!=' ' and dic2[d][0] in head_list and dic2[d].count(' ')==5 and dic2[d-1].count(' ')>=4 and dic2[d-1][5]!= ' ':
                dic2[d-1][5] = ' '
                dic2[d-1][3] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Eternal':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][1] in head_list and dic2[d].count(' ')<3:
                print('lenff',dic2[d])
                dic2[d][1] = dic2[d][1].lower()
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Indravati_N14341':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d+\s\w+', dic2[d][1])):
                print('code des', dic2[d])
                a, b = re.split('\d+\s', dic2[d][1], maxsplit=1)
                print('aa', a)
                print('bb', b)
                dic2[d][1] = dic2[d][1].replace(a, '')
                dic2[d][1] = b
            if d > 1 and len(re.findall('\d\-\d{2}\-\d{4}', dic2[d - 1][0])) and dic2[d - 1].count(' ') >= 2 and dic2[
                d] != ' ' and dic2[d].count(' ') >= 1:
                print('linebreak', dic2[d])
                tty1 = opr1(dic2[d - 1], dic2[d], src_dc)
                dic1[lq - 1] = tty1
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'kims_N1251':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('pbbb', dic2[d])
            if len(dic2[d][1].split()) == 2:
                a, b = dic2[d][1].split()
                dic2[d][1] = a
                dic2[d][2] = b
            # if dic2[d][0]=='Medicines*':
            #      dic2[d][0]='Medicines'
            if dic2[d][3] == 'rota':
                dic2[d][3] = 'Total'
            if dic2[d][0] in head_list and dic2[d].count(' ') < 4:
                print('yes', dic2[d])
                dic2[d][0] = dic2[d][0].lower()
            if len(re.findall('\*?\w+\s\@\s\d{2}\-\w+\-\d{4}', dic2[d][0])) and dic2[d].count(' ') == 5 and len(
                    dic2[d][0].split()) <= 3:
                print('removinggg date', dic2[d])
                dic2[d][0] = ' '
            if len(re.findall('\w+\s\@\s\d{2}\-\w+\-\d{4}', dic2[d][0])) and dic2[d].count(' ') == 5 and len(
                    dic2[d][0].split()) > 3:
                print('removing date in header', dic2[d])
                text = dic2[d][0]
                matchdate = re.search(r'\w+\s\@\s\d{2}\-\w+\-\d{4}', text)
                dic2[d][0] = text.replace(matchdate.group(), '')
                dic2[d][0] = dic2[d][0].replace(' ', '', -1)
                dic2[d][0] = dic2[d][0].replace('*', '', -1)
            # if dic2[d][0].__contains__(r'\w+\s\@\s\d{2}\-\w+\-\d{4}'):
            #     print('aaaaa',dic2[d])
            #     a, b = dic2[d][0].split('\w+\s\@',1)
            #     dic2[d][0] = a
            # if dic2[d][4].__contains__('NUMBER') or dic2[d][4].__contains__('BOTTLE') or dic2[d][4].__contains__('TABLET') \
            # or dic2[d][4].__contains__('TABLET')or dic2[d][4].__contains__('VIAL')or dic2[d][4].__contains__('VIAL')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='SRV_N16519':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            if len(re.findall('^\d{1,}', dic2[d][0])) == 1 and dic2[d].count(' ') == 5 or dic2[d].count(' ') == 2:
                print('removing sno', dic2[d])
                dic2[d][0] = re.sub('^\d{1,}\s', '', dic2[d][0])
            if d>1 and dic2[d][0]!=' ' and dic2[d][0] not in head_list and dic2[d].count(' ')==5:
                dic2[d-1][0]=dic2[d-1][0]+dic2[d][0]
                dic2[d][0]=' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Horizon_N18007':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('pbbb', dic2[d])
            if dic2[d][0] == 'MRD CHARGES- - - -':
                dic2[d][0] = 'MRD CHARGES'
            if dic2[d][0].__contains__('ROOM CHARGES- - - - - - -'):
                dic2[d][0] = 'ROOM CHARGES'
            if dic2[d][0].__contains__('REGISTRATION CHARGES- - -'):
                dic2[d][0] = 'REGISTRATION CHARGES'
            if dic2[d][0].__contains__('RADIOLOGY CHARGES- . . .'):
                dic2[d][0] = 'RADIOLOGY CHARGES'
            if dic2[d][0].__contains__('SURGERY CHARGES- - - . '):
                dic2[d][0] = 'SURGERY CHARGES'
            if dic2[d][0] == 'MISCELENIOUS CHARGES':
                dic2[d][0] = 'Miscelenious charges'
            if dic2[d][2].__contains__('Class') or dic2[d][4].__contains__('Charge'):
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ', ' ']
            if dic2[d][
                5] == '- . . . . . . . . . . . . . . . . ; - - - - - - - - - - - - - - - - - - . . REGISTRATION CHARGES (ONE TIME)':
                dic2[d][5] = 'REGISTRATION CHARGES (ONE TIME)'
            if dic2[d][5] == 'DELUXE  - - - - - - - - -':
                dic2[d][5] = 'DELUXE'

            if dic2[d][0] not in head_list and (len(re.findall('[.]\s+[^0-9]*', dic2[d][0])) == 1 or len(
                    re.findall('[-]\s+[^0-9]*', dic2[d][0])) == 1):
                print('merge', dic2[d])
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ', ' ']
            if dic2[d][0] not in head_list and (len(re.findall('[.]\s+[^0-9]*', dic2[d][1])) == 1 or len(
                    re.findall('[-]\s+[^0-9]*', dic2[d][1])) == 1):
                print('merge', dic2[d])
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ', ' ']
            if d > 1 and dic2[d].count(' ') >= 3 and (dic2[d][4] != ' ' or dic2[d][5] != ' '):
                print('line breaking', dic2[d])
                dic2[d - 1][4] = dic2[d - 1][4] + ' ' + dic2[d][4]
                dic2[d][4] = ' '
                dic2[d - 1][5] = dic2[d - 1][5] + dic2[d][5]
                dic2[d][5] = ' '
            # if dic2[d][5]=='BED CHARGES' and dic2[d][2]!=' ':
            #     text = dic2[d][5]
            #     dic2[d][5]=dic2[d][2]
            #     dic2[d][2]=text
            if len(re.findall('\d+\/\d+\/\d+', dic2[d][5])) >= 1:
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = ['Package', ' ', ' ', ' ', ' ', ' ', ' ']
            if len(re.findall('\d+\/\d+\/\d+', dic2[d][5])) >= 1 and dic2[d][1] != ' ':
                text = dic2[d][5]
                dic2[d][5] = dic2[d][1]
                dic2[d][1] = text
            if len(dic2[d][1].split()) == 3:
                a, b, c = dic2[d][1].split()
                dic2[d][1] = a
            if len(re.findall('\d{1,2}\/\d{2}\/\d{4}', dic2[d][1])) == 1 and len(dic2[d][1].split()[0]) >= 2 and \
                    dic2[d][0] not in head_list and dic2[d][2] == ' ':
                print('if code and particulars together', dic2[d])
                text = dic2[d][1]
                matchcode = re.search(r'\d{1,2}\/\d{2}\/\d{4}', text)
                dic2[d][1] = matchcode.group()
                # dic2[d][0]=' '
                dic2[d][2] = text.replace(matchcode.group(), '')
            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Horizon_N18007-pharma':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            if dic2[d][0].__contains__('Total') or dic2[d][0].__contains__('Tutal') or dic2[d][0].__contains__('Tolai'):
                dic2[d]=[' ', ' ', ' ', ' ', ' ', ' ']
            if dic2[d][0] != ' ' and len(
                    re.findall('\d{2}\/\d{2}\/\d{1,}\s\w+', dic2[d][2])) == 1:
                print('desdate', dic2[d])
                text = dic2[d][2]
                # matchcode = re.search('\D+\s\D+\w+\D+', dic2[d][0])
                matchdate = re.search('\d{2}\/\d{2}\/\d{1,}\s\w+', dic2[d][2])
                print('matchdaaaa', dic2[d])
                #dic2[d][0] = matchdate.group()
                dic2[d][2] = text.replace(matchdate.group(), '')
            if len(dic2[d][3].split())==2:
                print('splitingg',dic2[d])
                a,b=dic2[d][3].split()
                dic2[d][3]=a
                dic2[d][4]=b

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Srikara1_N13008':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if len(re.findall('\w+\d+\.?/?\s', dic2[d][0])) == 1 and len(dic2[d][0].split()[0])>=2 and dic2[d][1]== ' ' and dic2[d][0] not in head_list:
                print('if code and particulars together')
                text = dic2[d][0]
                matchcode = re.search(r'\w+\d+\.?/?\s',text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(),'')
            if (dic2[d][0] == 'Ward Charges' or dic2[d][0] == 'Professional Charges' or dic2[d][0] == 'Pharmacy Charges' or dic2[d][0] == 'Laboratory Charges' or dic2[d][0] == 'Procedure Charges' or \
                    dic2[d][0] == 'Service Charges' or dic2[d][0] == 'Consultation Charges' or dic2[d][0] == 'Investigation Charges' or dic2[d][0] == 'ward Charges') and len(re.findall('\d\s?\.\s?\d', dic2[d][5])) == 1:
                dic2[d] = [' ',' ',' ',' ',' ',' ']
            if len(re.findall('\d\.\d', dic2[d][3])) == 1 and len(re.findall('\d\-\w{3}\-\d', dic2[d][1])) >= 1:
                print('for packgae details line items')
                dic2[d][4] = dic2[d][3]
                dic2[d][3] = ' '
            if (len(re.findall('\d\-\w{3}\-\d', dic2[d][1])) >= 1 or len(re.findall('\d\-\w{3}\.\d', dic2[d][1])) == 1):
                text = dic2[d][1]
                if len(re.findall('\d{2}\-\w{3}\-\d{2}\s\d{2}\-\w{3}\.\d{2}', dic2[d][1])) == 1:
                    matchdate = re.search(r'\d{2}\-\w{3}\-\d{2}\s\d{2}\-\w{3}\.\d{2}', text)
                elif len(re.findall('\d{2}\-\w{3}\-\d{2}\s\d{2}\-\w{3}\-\d{2}', dic2[d][1])) == 1:
                    matchdate = re.search(r'\d{2}\-\w{3}\-\d{2}\s\d{2}\-\w{3}\-\d{2}', text)
                elif len(re.findall('\d\-\w{3}\-\d', dic2[d][1])) >= 1:
                    matchdate = re.search(r'\d{2}\-\w{3}\-\d{2}',text)
                elif len(re.findall('\d\-\w{3}\.\d', dic2[d][1])) == 1:
                    matchdate = re.search(r'\d{2}\-\w{3}\.\d{2}', text)
                dic2[d][1] = text.replace(matchdate.group(),'')
                dic2[d][1] = dic2[d][1].replace(' ','',1)
            if dic2[d][1]=='Service Name':
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']




            dic1[lq]=dic2[d]
            lq +=1
    if hospital=='Srikara_N13008':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if dic2[d][1]=='+91 40 4646 0000' or dic2[d][1]=='+91 40 2783 1111' or dic2[d][1]=='M: +91 90 1000 3000' or dic2[d][1]=="E: info@ srikarohospito's.com" or dic2[d][4]=='www. b/sikorahospitals':
                dic2[d][1]=' '
                dic2[d][4]=' '
            if len(re.findall('\w+\d+\.?/?\s', dic2[d][0])) == 1 and len(dic2[d][0].split()[0])>=2 and dic2[d][1]== ' ' and dic2[d][0] not in head_list:
                print('if code and particulars together')
                text = dic2[d][0]
                matchcode = re.search(r'\w+\d+\.?/?\s',text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(),'')
            if (dic2[d][0] == 'Ward Charges' or dic2[d][0]=='ward Charges' or dic2[d][0] == 'Professional Charges' or dic2[d][0] == 'Pharmacy Charges' or dic2[d][0] == 'Laboratory Charges' or dic2[d][0] == 'Procedure Charges' or \
                    dic2[d][0] == 'Service Charges' or dic2[d][0] == 'Consultation Charges' or dic2[d][0] == 'Investigation Charges' or dic2[d][0] == 'ward Charges' or dic2[d][0]=='Critical Care Charges' or dic2[d][0]=='OT Charges') and len(re.findall('\d\s?\.\s?\d', dic2[d][5])) == 1:
                dic2[d] = [' ',' ',' ',' ',' ',' ']
            if dic2[d][0]=='Pharmacy Charges'or dic2[d][0]=='Registration':
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if len(dic2[d][3].split()) == 3 and dic2[d][3].split()[1] == '*' and len(re.findall('\d\.\d', dic2[d][3])) == 1 and dic2[d][4] == ' ':
                print('if qty rate together with *')
                a,b,c = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = c
            if dic2[d][0] in head_list and dic2[d][1]!=' ':
                dic2[d][1]=' '


            dic1[lq]=dic2[d]
            lq +=1
    if hospital == 'waluj_N16687':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][2]==' ' and dic2[d][5]!=' ' and dic2[d][3]==' ':
                print('dummy qty',dic2[d])
                dic2[d][2] = '1'
            if len(re.findall('^\d{1,}\s',dic2[d][0]))==1:
                dic2[d][0] = re.sub('^\d{1,}\s','',dic2[d][0])
            if dic2[d][2] == ' ' and dic2[d][5] != ' ' and dic2[d][3]!=' ' and dic2[d][5]==dic2[d][3]:
                dic2[d][2] = '1'
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Vision_N16937':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][0]!=' ' and dic2[d].count(' ')==5:
                if dic2[d][0].__contains__('Rs.'):
                    print('hellllo',dic2[d])
                    a,b = dic2[d][0].split('Rs.')
                    dic2[d][0] = a.strip()
                    dic2[d][5] = b.strip()
            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='narinder_N2654':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            for i in head_list:
                if i in dic2[d][0] and dic2[d][1]!=' ':
                    print('Drug Billss',dic2[d])
                    dic2[d][1]=' '
                    dic2[d][2]=' '
            if  len(re.findall('^\d{1,}\s',dic2[d][0]))==1 and dic2[d].count(' ')==5:
                print('removing sno', dic2[d])
                dic2[d][0]=re.sub('^\d{1,2}\s','',dic2[d][0])
            if dic2[d][1]!=' ' and dic2[d].count(' ')==5:
                dic2[d-1][1]=dic2[d-1][1]+' '+dic2[d][1]
                dic2[d][1]=' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Vasavi_N15418':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            if len(dic2[d][3].split())==2:
                #print('splitingg',dic2[d])
                a,b=dic2[d][3].split()
                dic2[d][3]=a
                dic2[d][4]=b
            if dic2[d][0] != ' ' and len(re.findall('\d{2}\/\d{2}\/\d{4}\s\d{2}\:\d{2}\:\d{2}\s?\-\s?\w+\/\d{2}\-\w+', dic2[d][0])) == 1:
                print('desdate', dic2[d])
                text = dic2[d][0]
                # matchcode = re.search('\D+\s\D+\w+\D+', dic2[d][0])
                matchdate = re.search('\d{2}\/\d{2}\/\d{4}\s\d{2}\:\d{2}\:\d{2}\s?\-\s?\w+\/\d{2}\-\w+', dic2[d][0])
                print('matchdaaaa',dic2[d])
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')
            if d>1 and dic2[d][0] not in head_list and (dic2[d][0]!=' ' or dic2[d][1]!=' ') and dic2[d].count(' ')>=4:
            #     print('line break',dic2[d])
                 dic2[d-1][0]=dic2[d-1][0]+' '+dic2[d][0]
                 dic2[d - 1][1] = dic2[d - 1][1] + ' ' + dic2[d][1]
                 dic2[d][0]=' '
                 dic2[d][1]=' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Chennainational_N15220-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('[^a-z]\s\w+', dic2[d][3])):
                print('code des', dic2[d])
                a, b = re.split('\s', dic2[d][3], maxsplit=1)
                print('aa', a)
                print('bb', b)
                dic2[d][3] = dic2[d][3].replace(a, '')
                dic2[d][2] = a

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Chennainational_N15220':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\w+\s\w+', dic2[d][0])) and dic2[d][0] not in head_list:
                print('code des', dic2[d])
                a, b = re.split('\w+\s', dic2[d][0], maxsplit=1)
                print('aa', a)
                print('bb', b)
                dic2[d][0] = dic2[d][0].replace(b, '')
                dic2[d][1] = b

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Muruganhospitals_N16133':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if d > 1 and len(re.findall('^\d{1,2}\s?\D\s?\w+', dic2[d][0])) or len(
                    re.findall('^\d{3,4}\s?\D\s?\w+', dic2[d][0])):
                print('SNoHead', dic2[d])
                if d > 1 and len(re.findall('^\d{1,2}\s?\D\s?\w+', dic2[d][0])):
                    a, b = re.split('^\d{1,2}\s?\D\s?', dic2[d][0], maxsplit=1)
                    print('mm', a)
                    print('nn', b)
                    dic2[d][0] = b
                    dic2[d][0] = b
            if len(re.findall('\d{2}\/\d{2}\/\d{4}\s\w+', dic2[d][0])) and dic2[d].count(' ') >= 2:
                print('date des', dic2[d])
                a, b = re.split('\d{2}\/\d{2}\/\d{4}\s', dic2[d][0], maxsplit=1)
                dic2[d][0] = dic2[d][0].replace(b, '')
                dic2[d][1] = b
            if dic2[d][5].__contains__('- - -') or dic2[d][5].__contains__('. . . .'):
                dic2[d][5] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Surya_N15458':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][3] == dic2[d][4]:
                dic2[d][5] = ' '
            if dic2[d][4] == dic2[d][5].replace('*', ''):
                dic2[d][5] = dic2[d][4]
            if len(dic2[d][3].split()) == 3 and dic2[d][4].replace(' ', '') in dic2[d][3]:
                # print('if qty number and rate together')
                a, b, c = dic2[d][3].split()
                dic2[d][3] = a
            if len(dic2[d][3].split()) == 4 and dic2[d][4] == ' ' and dic2[d][5] == ' ':
                print('if qty number and rate and amount together')
                # a,b,c,d = dic2[d][3].split()
                text = dic2[d][3]
                dic2[d][3] = text.split()[0]
                dic2[d][4] = text.split()[2]
                dic2[d][5] = text.split()[3]
            if len(dic2[d][4].split()) == 2 and dic2[d][5].replace('*', '') in dic2[d][4] and len(
                    re.findall('\d\.\d', dic2[d][4])) <= 2:
                print('if rate and amount are together')
                a, b = dic2[d][4].split()
                dic2[d][4] = a
            if len(dic2[d][4].split()) == 2 and dic2[d][5] in dic2[d][4] and len(re.findall('\d\.\d', dic2[d][4])) <= 2:
                print('if rate and amount are together')
                a, b = dic2[d][4].split()
                dic2[d][4] = a
                dic2[d][5] = b
            if dic2[d][3].__contains__('No'):
                dic2[d][3] = dic2[d][3].replace('No', ' ')
            if dic2[d][3].__contains__('Day'):
                dic2[d][3] = dic2[d][3].replace('Day', ' ')

            if ' ' in dic2[d][3] and dic2[d][3] != ' ':
                dic2[d][3] = dic2[d][3].replace(' ', '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Narayana_N10855':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if len(re.findall('\w+\d+\.?\s', dic2[d][0])) == 1 and len(dic2[d][0].split()[0]) >= 2 and dic2[d][
                1] == ' ' and dic2[d][0] not in head_list:
                print('if code and particulars together')
                text = dic2[d][0]
                matchcode = re.search(r'\w+\d+\.?/?\s', text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(), '')
            if (dic2[d][0] == 'Ward Charges' or dic2[d][0] == 'Professional Charges' or dic2[d][
                0] == 'Pharmacy Charges' or dic2[d][0] == 'Laboratory Charges' or dic2[d][0] == 'Procedure Charges' or \
                    dic2[d][0] == 'Service Charges' or dic2[d][0] == 'Consultation Charges' or dic2[d][
                        0] == 'Investigation Charges' or dic2[d][0] == 'ward Charges' or dic2[d][
                        0] == 'Dietitian Charges' or dic2[d][0] == 'Nursing Charge'):
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if len(dic2[d][3].split()) == 3 and dic2[d][3].split()[1] == '*' and len(
                    re.findall('\d\.\d', dic2[d][3])) == 1 and dic2[d][4] == ' ':
                print('if qty rate together with *')
                a, b, c = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = c
            if len(re.findall('\d{2}\-\w+\-\d{2}\s\D+', dic2[d][0])) and dic2[d].count(' ') >= 0:
                text1 = dic2[d][0]
                matchdate = re.search(r'\d{2}\-\w+\-\d{2}', text1)

                dic2[d][0] = text1.replace(matchdate.group(), '')
            if len(re.findall('\d\-\w+\-\d{2}', dic2[d][0])) and dic2[d].count(' ') >= 0:
                print('remove date', dic2[d])
                dic2[d][0] = ' '
            if len(re.findall('\w+\d+\.?\s', dic2[d][1])) and dic2[d][0] == ' ' and dic2[d][0] not in head_list:
                print('if code and particulars together')
                text = dic2[d][1]
                matchcode = re.search(r'\w+\d+\.?\s', text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(), '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='cims':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            if dic2[d][0]=='(Total Charges],.-':
                dic2[d][0]='(Total Charges)'
            if dic2[d][0] in head_list and dic2[d].count(' ')<2:
                dic2[d][0]=dic2[d][0].lower()
            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Naruvi_N18695':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if d>1 and dic2[d][1]!=' ' and dic2[d][1] not in head_list and dic2[d].count(' ')>=3 and dic2[d][0]==' ':
                print('line spliting',dic2[d])
                dic2[d-1][1] = dic2[d-1][1]+' '+dic2[d][1]
                dic2[d][1]=' '
                dic2[d - 1][5] = dic2[d - 1][5] + dic2[d][5]
                dic2[d][5] = ' '
                dic2[d - 1][3] = dic2[d - 1][3] + dic2[d][3]
                dic2[d][3] = ' '
            if dic2[d][1] in head_list and len(re.findall('\d\.\d',dic2[d][5])) and dic2[d].count(' ')>=4:
                dic2[d][0]=dic2[d][1]
                dic2[d][1]=' '
            if dic2[d][0] != ' ' and len(
                    re.findall('\d+\s?\d+\s?\d+', dic2[d][0])) == 1 and dic2[d][1]==' ':
                print('desdate', dic2[d])
                text = dic2[d][0]
                # matchcode = re.search('\D+\s\D+\w+\D+', dic2[d][0])
                matchdate = re.search('\d+\s?\d+\s?\d+', dic2[d][0])
                print('matchdaaaa', dic2[d])
                #dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'vishwaraj_N151236':
        dic2 = dic1
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if len(re.findall('^\d{1,}\s', dic2[d][0])) == 1 and dic2[d].count(' ')<= 3:
                print('removing sno', dic2[d])
                dic2[d][0] = re.sub('^\d{1,}\s', '', dic2[d][0])

            dic1[lq] = dic2[d]
            lq += 1
        #dicA = dic1
    if hospital == 'kauvery-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('^\d{1,2}\s', dic2[d][0])):
                print('SNo Perti', dic2[d])
                a, b = re.split('^\d{1,2}\s', dic2[d][0], maxsplit=1)
                print('aa', a)
                print('bb', b)
                dic2[d][0] = dic2[d][0].replace(a, '')

                dic2[d][0] = b

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Brahma_N7077':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if d > 1 and len(re.findall('^\d{1,2}\s?\D\s?\w+', dic2[d][0])) or len(
                    re.findall('^\d{3,4}\s?\D\s?\w+', dic2[d][0])):
                print('SNoHead', dic2[d])
                if d > 1 and len(re.findall('^\d{1,2}\s?\D\s?\w+', dic2[d][0])):
                    a, b = re.split('^\d{1,2}\s?\D\s?', dic2[d][0], maxsplit=1)
                    print('mm', a)
                    print('nn', b)
                    dic2[d][0] = b
                    dic2[d][0] = b
                if d > 1 and len(re.findall('^\d{3,4}\s?\D\s?\w+', dic2[d][0])):
                    a, b = re.split('^\d{3,4}\s?\D\s?', dic2[d][0], maxsplit=1)
                    print('mm', a)
                    print('nn', b)
                    dic2[d][0] = b
                    dic2[d][0] = b

            if len(re.findall('\d{1,2}\-\d{1,2}\-\d{2,4}', dic2[d][0])) and len(dic2[d][0].split()[0]) >= 2 and dic2[d][
                1] == ' ' and dic2[d].count(' ') <= 3:
                print('if date is mergeing', dic2[d])
                # print('if code and particulars together', dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\d{1,2}\-\d{1,2}\-\d{2,4}', text)
                dic2[d][1] = matchcode.group()
                dic2[d][0] = text.replace(matchcode.group(), '')
            if len(dic2[d][4].split()) == 2:
                print('splitingg', dic2[d])
                a, b = dic2[d][4].split()
                dic2[d][4] = a
                dic2[d][5] = b
            if d > 1 and len(re.findall('^\d{1,2}', dic2[d][0])) and dic2[d].count(' ') == 5:
                dic2[d][0] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Tri_N15300':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:

            if len(re.findall('\.\d+\s\d+\.\d+', dic2[d][2])) and dic2[d][3] == ' ':
                print('RateQty', dic2[d])
                a, b = re.split('\s', dic2[d][2], maxsplit=1)
                dic2[d][2] = a
                dic2[d][3] = b
            if len(re.findall('\d+\.\d+\s\D?\d+\.\d', dic2[d][3])) and dic2[d][4] == ' ':
                print('Qtyamount', dic2[d])
                a, b = re.split('\s', dic2[d][3], maxsplit=1)
                dic2[d][3] = a
                dic2[d][4] = b

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Sita_N0449':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if d > 1 and len(re.findall('\d?\d?\s?\d+\s?\d{2}\/\d{2}\/\d{4}\s\D+', dic2[d][0])):
                a, b = re.split('\d?\d?\s?\d+\s?\d{2}\/\d{2}\/\d{4}\s', dic2[d][0], maxsplit=1)
                print('mm', a)
                print('nn', b)
                dic2[d][1] = b
            if len(re.findall('\d{2}\/\d{2}\/\d{4}', dic2[d][0])):
                # print('if code and particulars together', dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\d{2}\/\d{2}\/\d{4}', text)
                dic2[d][0] = matchcode.group()

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Kalinga_N2998':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\.\d+\s\d+\.\d+', dic2[d][3])):
                print('Ratemerge', dic2[d])
                a, b = re.split('\d+\.\d+', dic2[d][3], maxsplit=1)
                # print('aaa', a)
                # print('bbb', b)
                dic2[d][3] = dic2[d][3].replace(a, '')
                dic2[d][3] = b
            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='prk_2_N18788':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if len(re.findall('\d{1,}\-\w{3}\-\d{1,}', dic2[d][0])):
                text =dic2[d][0]
                a, b = re.split('\d{1,}\-\w{3}\-\d{1,}', dic2[d][0])
                dic2[d][0] = a
                #dic2[d][1] = b
                dic2[d][1] = text.replace(a,'')
            if len(re.findall('\d{1,}\-\w{3}\-\d{1,}', dic2[d][1])):
                text = dic2[d][1]
                matchsno = re.search(r'\d{1,}\-\w{3}\-\d{1,}', text)
                dic2[d][1] = matchsno.group()
                #dic2[d][0]=' '
                dic2[d][2] = text.replace(matchsno.group(), '')
            if len(re.findall('\w+\d+\s', dic2[d][2])) == 1 and len(dic2[d][2].split()[0])>=2  and dic2[d][0] not in head_list:
                print('if code and particulars together')
                text = dic2[d][2]
                matchcode = re.search(r'\w+\d+\s',text)
                dic2[d][2] = matchcode.group()
            #     #dic2[d][0]=' '
                dic2[d][3] = text.replace(matchcode.group(),'')
            if dic2[d][0] in src_dc['merge_set'] and dic2[d].count(' ') >= 4:
                dic2[d][7] = ' '
            if len(re.findall('\d\.\d', dic2[d][6])) == 1:
                print('if qty rate together with *')
                dic2[d][6]=dic2[d][6].replace('*','')


            dic1[lq]=dic2[d]
            lq +=1
    if hospital=='Sudha_N2451':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('ddddd',dic2[d])
            if len(re.findall('^\d{1,2}',dic2[d][0]))==1 and dic2[d].count(' ')==5:
                print('removing sno', dic2[d])
                dic2[d][0]=re.sub('^\d{1,2}\.\s','',dic2[d][0])
            if len(re.findall('\d{1,2}\-\w+\-\d{1,}', dic2[d][0])) == 1 and len(dic2[d][0].split()[0])>=2  and dic2[d][0] not in head_list:
                print('if code and particulars together')
                text = dic2[d][0]
                matchcode = re.search(r'\d{1,2}\-\w+\-\d{1,}',text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(), '')
            if dic2[d][0] not in head_list and (len(re.findall('[.]\s+[^0-9]*', dic2[d][2])) == 1 or len(
                re.findall('[-]\s+[^0-9]*', dic2[d][2])) == 1):
                print('merge', dic2[d])
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if d>1 and dic2[d][0]!=' ' and dic2[d][0] not in head_list and dic2[d].count(' ')>=5 and dic2[d-1][0] not in head_list:
                 print('shifting',dic2[d])
                 dic2[d-1][1]= dic2[d-1][1]+' '+dic2[d][0]
                 dic2[d][0]=' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Kongunad_N2388':
        dic2 = dic1
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            # if dic2[d][0].__contains__('ROOM CHARGES(ICU,MICU,CCU)'):
            #     print('roomm charge',dic2[d])
            #     dic2[d][0]='ROOM CHARGES(ICU/MICU/CCU)'
            if dic2[d][0].__contains__(','):
                dic2[d][0] = dic2[d][0].replace(',', '/')
                print('header', dic2[d])

            if len(re.findall('^\d{1,}\.?\s?', dic2[d][0])) == 1 and dic2[d].count(' ') == 5:
                print('removing sno', dic2[d])
                dic2[d][0] = re.sub('^\d{1,}\.?\s?', '', dic2[d][0])
            if len(re.findall('\d{1,2}\-\w+\-\d+', dic2[d][0])) == 1 and dic2[d][1] == ' ' and len(
                    dic2[d][0].split()[0]) >= 2 and dic2[d][0] not in head_list:
                print('if Date and particulars together', dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\d{1,2}\-\w+\-\d+', text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(), '')
            if dic2[d][0] not in head_list and (len(re.findall('[.]\s+[^0-9]*', dic2[d][3])) == 1 or len(
                    re.findall('[-]\s+[^0-9]*', dic2[d][3])) == 1):
                print('merge', dic2[d])
                dic2[d][3] = ' '
            if dic2[d][0] not in head_list and (len(re.findall('[.]\s+[^0-9]*', dic2[d][2])) == 1 or len(
                    re.findall('[-]\s+[^0-9]*', dic2[d][2])) == 1):
                print('merge', dic2[d])
                dic2[d][2] = ' '

            dic1[lq] = dic2[d]
            lq += 1
        # dicA = dic1
    if hospital == 'Navachethana_N15489':
        dic2 = dic1
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if dic2[d][1]!=' ' and dic2[d].count(' ')==5 and dic2[d-1].count(' ')==2 and dic2[d][1] not in head_list:
                print('break',dic2[d])
                dic2[d-1][1]= dic2[d-1][1]+dic2[d][1]
                dic2[d][1]=' '
            if len(re.findall('\d+\-\d+\-\d+\s?\d+\:\d+\s?\-?\s?\d+\-\d+\-\d+\s?\d+\:?\d+', dic2[d][0])) == 1 and dic2[d][1]==' ' and len(dic2[d][0].split()[0])>=2  and dic2[d][0] not in head_list:
                print('if Date and particulars together',dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\d+\-\d+\-\d+\s?\d+\:\d+\s?\-?\s?\d+\-\d+\-\d+\s?\d+\:?\d+',text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(), '')
            # if dic2[d][0] not in head_list and (len(re.findall('[.]\s+[^0-9]*',dic2[d][3]))==1 or len(re.findall('[-]\s+[^0-9]*',dic2[d][3]))==1):
            #     print('merge',dic2[d])
            #     dic2[d][3]=' '
            # if dic2[d][0] not in head_list and (len(re.findall('[.]\s+[^0-9]*',dic2[d][2]))==1 or len(re.findall('[-]\s+[^0-9]*',dic2[d][2]))==1):
            #     print('merge',dic2[d])
            #     dic2[d][2]=' '

            dic1[lq] = dic2[d]
            lq += 1
        #dicA = dic1
    if hospital == 'Ashwini1_N3171':
        dic2 = dic1
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            # if f>1 and dic2[d][0] in head_list and dic2[d-1][1] != 'Subtotal':
            #     print('add sbt',dic2[d-1],dic2[d])
            #     #dic1[lq] = dic2[d]
            #     dic1[lq] = [' ', 'Subtotal', ' ', ' ', ' ', ' ',' ']
            #     lq += 1
            # if f > 1 and d==fn  and dic2[d][1]!='Subtotal' :
            #     print('add sbt',dic2[d])
            #     dic1[lq] = dic2[d]
            #     dic1[lq+1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ',' ']
            if len(re.findall('^\d\s', dic2[d][0])) == 1 and dic2[d].count(' ') >= 1:
                print('removing sno', dic2[d])
                dic2[d][0] = re.sub('^\d\s', '', dic2[d][0])
            if dic2[d][1].__contains__('X'):
                dic2[d][1] = dic2[d][1].replace("X", "*")
            if len(re.findall('\d?\s?\d+\:\d+\s?\w+\s?\w+', dic2[d][0])) == 1 and dic2[d][1] == ' ' and len(
                    dic2[d][0].split()[0]) >= 2 and dic2[d][0] not in head_list:
                print('if code and particulars together', dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\d?\s?\d+\:\d+\s?\w+\s?\w+', text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(), '')
            if dic2[d][0].__contains__('SI No'):
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ', ' ']
            if len(re.findall('\d+\-\d+\-\d\:?', dic2[d][0])) and dic2[d].count(' ') >= 5:
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ', ' ']
            if dic2[d][5] != ' ' and dic2[d][6] != ' ' and dic2[d].count(' ') >= 5:
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ', ' ']
            if dic2[d][1] != ' ' and dic2[d][1] not in sbt and dic2[d][1] not in head_list and dic2[d].count(' ') >= 5:
                dic2[d - 1][1] = dic2[d - 1][1] + ' ' + dic2[d][1]
                dic2[d][1] = ' '
            dic1[lq] = dic2[d]
            lq += 1
        # dicA = dic1
    if hospital == 'Ashwini_N3171':
        dic2 = dic1
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if dic2[d][1].__contains__('X'):
                dic2[d][1] = dic2[d][1].replace("X", "*")
            if dic2[d][3].__contains__('Total Bed Charges :'):
                dic2[d][3] = ' '
                dic2[d][1] = 'Subtotal'
            # if dic2[d][0].__contains__('Bed Charges Details'):
            #     text=dic2[d+1][4]
            #     dic2[d+1][3]=dic2[d+1][4]
            #     dic2[d+1][4]=text
            if len(dic2[d][5].split()) == 2:
                print('removal', dic2[d])
                a, b = dic2[d][5].split()
                dic2[d][5] = b
            if len(re.findall('\d{1,}\-\d{1,}\-\d+\s?\d+\:\d+\s?\w+', dic2[d][1])) == 2 and len(
                    dic2[d][1].split()[0]) >= 2 and dic2[d][0] not in head_list:
                text = dic2[d][1]
                matchcode = re.search(r'\d{1,}\-\d{1,}\-\d+\s?\d+\:\d+\s?\w+', text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(), '')
                text = dic2[d][3]
                dic2[d][3] = dic2[d][4]
                dic2[d][4] = text
            if len(re.findall('\d{1,}\-\d{1,}\-\d+\s?\d+\:\d+\s?\w+', dic2[d][1])) == 1 and len(
                    dic2[d][1].split()[0]) >= 2 and dic2[d][0] not in head_list:
                text = dic2[d][1]
                matchcode = re.search(r'\d{1,}\-\d{1,}\-\d+\s?\d+\:\d+\s?\w+', text)
                # dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(), '').strip()
            if len(re.findall('\d{1,}\-\d{1,}\-\d+', dic2[d][0])) == 1 and dic2[d][1] == ' ' and len(
                    dic2[d][0].split()[0]) >= 2 and dic2[d][0] not in head_list:
                print('if code and particulars together', dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\d{1,}\-\d{1,}\-\d+', text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(), '')
            if dic2[d][0].__contains__('SI No'):
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ', ' ']
            # if len(re.findall('\d+\-\d+\-\d\:?',dic2[d][0])) and dic2[d].count(' ')>=5:
            #     dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ', ' ']
            # if dic2[d][5]!=' ' and dic2[d][6]!=' ' and dic2[d].count(' ')>=5:
            #     dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ', ' ']
            # if dic2[d][1]!=' ' and dic2[d][1] not in sbt and dic2[d][1] not in head_list and dic2[d].count(' ')>=5:
            #     dic2[d-1][1]=dic2[d-1][1]+' '+dic2[d][1]
            #     dic2[d][1]=' '
            dic1[lq] = dic2[d]
            lq += 1
        # dicA = dic1
    if hospital=='Ashwini_N3171-pharma':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('pbbb',dic2[d])
            if len(re.findall('\d{1,2}\:?\d{1,2}\s?\w+\s?\w+',dic2[d][0])) and dic2[d][1]==' ':
                text = dic2[d][0]
                matchdate = re.search(r'\d{1,2}\:?\d{1,2}\s?\w+\s?\w+', text)
                dic2[d][1] = text.replace(matchdate.group(), '')
                dic2[d][0] = matchdate.group()
                dic2[d][1] = dic2[d][1].replace(' ', '', -1)
            if len(re.findall('\d\.\d',dic2[d][5])) and dic2[d].count(' ')==5:
                dic2[d][5]=' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Omni_13897':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] != ' ' and dic2[d][1] == ' ' and len(re.findall('\d+\-\d+\-\d+', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()) >= 2:
                print('splitting date and parti')
                text = dic2[d][0]
                matchdate = re.search(r'\d+\-\d+\-\d+', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')
                dic2[d][1] = dic2[d][1].replace(' ', '', 1)
            if len(re.findall('\d{1,2}\-\d{2}\-\d{4}\s\d+', dic2[d][0])):
                print('date code merge')
                text = dic2[d][0]
                if len(re.findall('\d{1,2}\-\d{2}\-\d{4}', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d{1,2}\-\d{2}\-\d{4}', text)
                dic2[d][0] = matchdate.group()
            if d > 1 and d < len(dic2) and len(re.findall('\d\.\d', dic2[d][5])) and dic2[d].count(' ') <= 2 and \
                    dic2[d + 1][1] != ' ' and dic2[d + 1].count(' ') == 5:
                dic2[d][1] = dic2[d][1] + ' ' + dic2[d + 1][1]
                dic2[d + 1][1] = ' '
            if dic2[d][0] not in head_list and dic2[d][0] != ' ' and dic2[d][1] == ' ':
                dic2[d][1] = dic2[d][0]
                dic2[d][0] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'srm_N17102':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][1] in head_list and dic2[d].count(' ') >= 4:
                dic2[d][0] = dic2[d][1]
                dic2[d][1] = ' '
            if d > 1 and d < len(dic2) and dic2[d][1] not in head_list and dic2[d][1] != ' ' and dic2[d].count(
                    ' ') >= 4:
                dic2[d - 1][1] = dic2[d - 1][1] + ' ' + dic2[d][1]
                dic2[d][1] = ' '
            if len(re.findall('\d\.\d', dic2[d][5])) and dic2[d].count(' ') >= 4:
                print('add sbt', dic2[d])
                dic2[d][2] = 'Subtotal'

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'srm_N17102-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][1] in head_list and dic2[d].count(' ') >= 4:
                dic2[d][0] = dic2[d][1]
                dic2[d][1] = ' '
            if dic2[d][1] != ' ' and dic2[d].count(' ') >= 4 and dic2[d][1] not in head_list:
                dic2[d - 1][1] = dic2[d - 1][1] + ' ' + dic2[d][1]
                dic2[d][1] = ' '
            if dic2[d][5] != ' ' and dic2[d].count(" ") == 5:
                dic2[d][5] = ' '
            if len(re.findall('\w+\s\d+\-\w+\-\d+\s?\d+\:\d+', dic2[d][0])) == 1 and len(dic2[d][0].split()[0]) >= 2 and \
                    dic2[d][0] not in head_list and dic2[d][1] == ' ':
                print('if code and particulars together')
                text = dic2[d][0]
                matchcode = re.search(r'\w+\s\d+\-\w+\-\d+\s?\d+\:\d+', text)
                # dic2[d][0] = matchcode.group()
                # dic2[d][0]=' '
                dic2[d][1] = text.replace(matchcode.group(), '')
            if len(re.findall('\d+\-\w+\-\d+\s?\d+\:\d+', dic2[d][0])) == 1 and len(dic2[d][0].split()[0]) >= 2 and \
                    dic2[d][0] not in head_list:
                text1 = dic2[d][0]
                matchsno = re.search(r'\d+\-\w+\-\d+\s?\d+\:\d+', text1)
                dic2[d][0] = matchsno.group()
                # dic2[d][0]=' '
                # dic2[d][1] = text1.replace(matchsno.group(), '')
            if len(re.findall('\s\w+\-\d+', dic2[d][2])) == 1 and dic2[d][2] not in head_list:
                text1 = dic2[d][2]
                matchsno = re.search(r'\s\w+\-\d+', text1)
                # dic2[d][2] = matchsno.group()
                dic2[d][2] = text1.replace(matchsno.group(), '')
            # if len(re.findall('\d\.\d', dic2[d][5])) and dic2[d].count(' ') >= 4:
            #     print('add sbt', dic2[d])
            #     dic2[d][2] = 'Subtotal'

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Sarvodaya_N2657':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])

            if dic2[d][1] in head_list and dic2[d].count(' ') >= 4:
                dic2[d][0] = dic2[d][1]
                dic2[d][1] = ' '
            if len(re.findall('\d+\/\w+\/\d+', dic2[d][0])) == 1 and len(dic2[d][0].split()[0]) >= 2 and dic2[d][
                0] not in head_list:
                print('if code and particulars together')
                text = dic2[d][0]
                matchcode = re.search(r'\d+\/\w+\/\d+', text)
                dic2[d][0] = matchcode.group()
                # dic2[d][1] = text.replace(matchcode.group(), '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Yenepoya1_N15770':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddd==', dic2[d])
            if  dic2[d][1]!=' '  and dic2[d][1] not in head_list and dic2[d].count(' ')==5:
                print('split',dic2[d])
                dic2[d-1][1] = dic2[d-1][1]+' '+dic2[d][1]
                dic2[d][1] =' '
            #if dic2[d][0]=='CHARGE' or dic2[d][0]=='EXPENSE':
            if d>=1 and d<len(dic2) and dic2[d][0]+' '+dic2[d+1][0] in head_list:
                print('header',dic2[d])
                dic2[d][0]=dic2[d][0]+' '+dic2[d+1][0]
                dic2[d+1][0]=' '
            if len(re.findall('\d+\-\d+\-\d+', dic2[d][1])) == 1 and dic2[d][2]==' ' and len(dic2[d][1].split()[1])>=2  and dic2[d][1] not in head_list:
                print('if code and particulars together',dic2[d])
                text = dic2[d][1]
                matchcode = re.search(r'\d+\-\d+\-\d+',text)
                dic2[d][1] = matchcode.group()
                dic2[d][2] = text.replace(matchcode.group(), '')

            dic1[lq] = dic2[d]
            lq += 1
        #dicA = dic1
    if hospital=='Srcc_N15794':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            if dic2[d][0] != ' ' and (len(re.findall('\d{2}', dic2[d][0].split()[0])) == 1 or len(
                    re.findall('\d', dic2[d][0].split()[0])) == 1) :
                print('for removing snos in 0th index')
                text = dic2[d][0]
                if len(re.findall('\d{2}', dic2[d][0].split()[0])) == 1:
                    matchsno = re.search(r'\d{2}', text)
                elif len(re.findall('\d', dic2[d][0].split()[0])) == 1:
                    matchsno = re.search(r'\d', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
                #dic2[d][0] = dic2[d][0].replace(dic2[d][0][0], '', 1)
            if len(re.findall('\d{1,2}\-\d{1,2}\-\d{2,4}',dic2[d][0])) and len(dic2[d][0].split()[0])>=2 and dic2[d][1]==' ' and dic2[d].count(' ')<=3:
                print('if date is mergeing',dic2[d])
                #print('if code and particulars together', dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\d{1,2}\-\d{1,2}\-\d{2,4}', text)
                dic2[d][1] = matchcode.group()
                dic2[d][0] = text.replace(matchcode.group(), '')
            if len(re.findall('\(?\d+\)?\s\d+',dic2[d][0])) and len(dic2[d][0].split()[0])>=2  and dic2[d].count(' ')<=3:
                print('if date is mergeing',dic2[d])
                #print('if code and particulars together', dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\(?\d+\)?\s\d+', text)
                #dic2[d][1] = matchcode.group()
                dic2[d][0] = text.replace(matchcode.group(), '')
            if len(dic2[d][4].split())==2:
                print('splitingg',dic2[d])
                a,b=dic2[d][4].split()
                dic2[d][4]=a
                dic2[d][5]=b

            if dic2[d][2]!=' ' and dic2[d].count(' ')==5:
                print('lineeee breakk',dic2[d])
                dic2[d][2]=' '
            if d>1 and d<=len(dic2) and dic2[d][0]!=' ' and dic2[d].count(' ')==5 and dic2[d][0] not in head_list:
                print('break',dic2[d])
                dic2[d-1][0]= dic2[d-1][0]+' '+dic2[d][0]
                dic2[d][0]=' '
            #if d>1 and dic2[d][0] in head_list and dic2[d][1]!=' ' and dic2[d][2]!=' ' and dic2[d].count(' ')>=1:
                #print('if header with lines')
                #dic1[lq] = dic2[d]
                #dic1[lq-1] = dic2[d-1]
                #lq+=1
                #dic1[lq-1] = [dic2[d][0], ' ', ' ', ' ', ' ', ' ', ' ']
                #dic2[d][0] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Narayan_N17196':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if len(re.findall('^\d{1,}\s?',dic2[d][0]))==1 and dic2[d].count(' ')<=3:
                print('removing sno', dic2[d])
                dic2[d][0]=re.sub('^\d{1,}\s?','',dic2[d][0])
            dic1[lq] = dic2[d]
            lq +=1
    if hospital=='Srikara_N13628':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if len(dic2[d][3].split()) == 3 and dic2[d][3].split()[1] == '*' and len(re.findall('\d\.\d', dic2[d][3])) == 1 and dic2[d][4] == ' ':
                print('if qty rate together with *')
                a,b,c = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = c
            if d>1 and d<len(dic2) and len(re.findall('\d\.\d',dic2[d][4]))==1 and len(re.findall('\d\.\d',dic2[d][5]))==1 and dic2[d-1][4]==' ' and dic2[d-1][5]==' ':
                dic2[d-1][4] = dic2[d][4]
                dic2[d - 1][5] = dic2[d][5]
                dic2[d][4] = ' '
                dic2[d][5] = ' '
            dic1[lq]=dic2[d]
            lq +=1
    if hospital == 'Rajagiri_N18901':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if len(re.findall('^\d{1,}\s?',dic2[d][0]))==1 and dic2[d].count(' ')<=3:
                print('removing sno', dic2[d])
                dic2[d][0]=re.sub('^\d{1,}\s?','',dic2[d][0])
            if len(dic2[d][4].split())==2:
                print('splitingg',dic2[d])
                a,b=dic2[d][4].split()
                dic2[d][4]=b
            dic1[lq] = dic2[d]
            lq +=1
    if hospital == 'Zenith_N15241':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if len(re.findall('^\d{1,}\s',dic2[d][0]))==1 and dic2[d].count(' ')<=3:
                print('removing sno', dic2[d])
                dic2[d][0]=re.sub('^\d{1,}\s','',dic2[d][0])
            dic1[lq] = dic2[d]
            lq +=1
    if hospital == 'Choithram_N1358':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if d>1 and d<len(dic2) and dic2[d][2]!=' ' and dic2[d][3]!=' ' and dic2[d][3] not in sbt and dic2[d][5]==' ':
                dic2[d-1][2]= dic2[d-1][2]+' '+dic2[d][2]
                dic2[d][2]=' '
                dic2[d - 1][3] = dic2[d - 1][3] + ' ' + dic2[d][3]
                dic2[d][3] = ' '
            dic1[lq] = dic2[d]
            lq +=1
    if hospital == 'Choithram_N1358-pharma':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if dic2[d][0].__contains__('Return No.'):
                dic2[d][0]='Return No.'
            if dic2[d][0].__contains__('Return No.'):
                dic2[d][0]='Pharmacy Returns'
            if dic2[d][0].__contains__('Issue No.'):
                dic2[d][0]='Pharmacy'
            if dic2[d][0] in head_list and dic2[d][1]!=' ':
                dic2[d][1]=' '
            # if d>=1 and d<len(dic2) and dic2[d-2][3]=='Total Issue' and dic2[d][0]!= 'Pharmacy Returns':
            #     dic2[d][0] = 'Pharmacy Returns'
            if len(re.findall('\d{2}\/\d{2}\/\d{4}',dic2[d][1])) and dic2[d][0]!=' ':
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if dic2[d][1].__contains__('SKU Name') or dic2[d][4].__contains__('Rate'):
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if len(re.findall('\d+\/\d+\/\d+', dic2[d][2])) == 1  and dic2[d][1] not in head_list:
                print('if code and particulars together',dic2[d])
                text = dic2[d][2]
                matchcode = re.search(r'\d+\/\d+\/\d+',text)
                dic2[d][2] = matchcode.group()
                #dic2[d][2] = text.replace(matchcode.group(), '')
            if len(re.findall('\d+\s\w+\s\*?', dic2[d][1])) == 1  and dic2[d][1] not in head_list:
                print('if code and particulars together',dic2[d])
                text = dic2[d][1]
                matchcode = re.search(r'\d+\s\w+\s\*?',text)
                #dic2[d][2] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(), '')

            dic1[lq] = dic2[d]
            lq +=1
    if hospital == 'astermim_N1111':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            # if len(re.findall('^\d{1,}\s?',dic2[d][0]))==1 and dic2[d].count(' ')<=3:
            #     print('removing sno', dic2[d])
            #     dic2[d][0]=re.sub('^\d{1,}\s?','',dic2[d][0])
            if len(dic2[d][2].split())==2:
                print('splitingg',dic2[d])
                a,b=dic2[d][2].split()
                dic2[d][2]=a
                dic2[d][3]=b
            dic1[lq] = dic2[d]
            lq +=1
    if hospital == 'Narayana_N14358':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if dic2[d][5].__contains__('Tota'):
                dic2[d][5]=' '
            if dic2[d][5]!=' ' and dic2[d].count(' ')==5:
                dic2[d][5]=' '
            if len(re.findall('^\d{1,}\.?\s',dic2[d][0]))==1 and dic2[d].count(' ')<=3:
                print('removing sno', dic2[d])
                dic2[d][0]=re.sub('^\d{1,}\.?\s','',dic2[d][0])
            if len(dic2[d][4].split())>=2:
                print('splitingg',dic2[d])
                text=dic2[d][4].split()
                dic2[d][4]=text[0]
                dic2[d][5]=text[1]
            if len(dic2[d][5].split())>=2:
                print('splitingg',dic2[d])
                text=dic2[d][5].split()
                dic2[d][5]=text[0]
                #dic2[d][5]=text[1]
            if dic2[d][0].__contains__('Consultation') and dic2[d][5]!=' ' and dic2[d][4]!=' ':
                dic2[d+1][1] = dic2[d][1]
                dic2[d + 1][4] = dic2[d][4]
                dic2[d + 1][5] = dic2[d][5]
                dic2[d][1]=' '
                dic2[d][4]=' '
                dic2[d][5]=' '
            if len(dic2[d][2].split()) == 4 and dic2[d][4] == ' ' and dic2[d][5] == ' ':
                print('if qty Mrp and rate and amount together')
                # a,b,c,d = dic2[d][3].split()
                text = dic2[d][2]
                dic2[d][2] = text.split()[0]
                dic2[d][3] = text.split()[1]
                dic2[d][4] = text.split()[2]
                dic2[d][5] = text.split()[3]
            # if len(dic2[d][3].split())<=3:
            #     print('splitingg',dic2[d])
            #     a,b,c=dic2[d][3].split()
            #     dic2[d][3]=a
            #     dic2[d][4]=b
            #     dic2[d][5]=c
            # if len(dic2[d][2].split())==4:
            #     print('splitingg',dic2[d])
            #     a,b,c,d=dic2[d][2].split()
            #     dic2[d][2]=a
            #     dic2[d][3]=b
            #     dic2[d][4]=c
            #     dic2[d][5]=d
            if len(re.findall('\d{1,2}\-\d+\-\d{4}', dic2[d][0])) == 1 and dic2[d][1]==' ' and len(dic2[d][0].split()[0])>=2  and dic2[d][0] not in head_list:
                print('if Date and particulars together',dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\d{1,2}\-\d+\-\d{4}',text)
                dic2[d][1] = matchcode.group()
                dic2[d][0] = text.replace(matchcode.group(), '')
            dic1[lq] = dic2[d]
            lq +=1
    if hospital == 'baps_N12409':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('dd00==',dic2[d])
            if dic2[d][0]==' ' and dic2[d][1]!=' ' and dic2[d].count(' ')==3:
                dic2[d-1][1]= dic2[d-1][1]+' '+dic2[d][1]
                dic2[d][1]=' '
            if len(dic2[d][3].split()) == 2 and len(re.findall('\d\.\d', dic2[d][3])) == 2:
                print('if 3rd index have rate and qty merged')
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            dic1[lq] = dic2[d]
            lq +=1
    if hospital == 'Pramukh_N16147':
        dic2 = dic1
        dic1 = {}
        lq = 1
        # d= False
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] == "OT":
                dic2[d][0] = "OT CHARGES"
            if dic2[d][2].__contains__('Anestheyst'):
                dic2[d][2] = dic2[d][2].replace('Anestheyst', 'Anesthetist')
            if d > 1 and d <= len(dic2) and dic2[d][0] == ' ' and dic2[d][2].__contains__('OT Charges') == False and \
                    dic2[d][4] != ' ' and dic2[d][5] != ' ':
                dic2[d - 1][2] = dic2[d - 1][2] + " " + dic2[d][2]
                dic2[d][2] = ' '
            # if d>1 and d<len(dic2) and dic2[d][2].__contains__('Surgeon') and dic2[d-2][0]!="OT CHARGES":
            #     print('OTTT',dic2[d])
            #     dic1[lq] = dic2[d]
            #     lq += 1
            #     dic1[lq - 2] = ['OT CHARGES', ' ', ' ', ' ', ' ', ' ']
            if dic2[d][0] == ' ' and dic2[d][2] == ' ' and len(re.findall('\d\.\d', dic2[d][5])) == 1 and (
                    dic2[d][4] != ' ' or dic2[d][5] == ' ') and dic2[d].count(' ') >= 3:
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if len(re.findall("\d\s\d", dic2[d][2])) == 1:
                print('sssurgeon', dic2[d])
                dic2[d][2] = dic2[d][2].replace(' ', ".")
            if (dic2[d][2].__contains__("Surgeon") or dic2[d][2].__contains__('Anesthetist') or dic2[d][2].__contains__(
                    'OT Charges')) and len(re.findall("\d{1,}\.?\s?\d{1,}", dic2[d][2])) == 1:
                print('mergeee', dic2[d])
                text = dic2[d][2]
                matchcode = re.search(r'\d{1,}\.?\s?\d{1,}', text)
                print('matchcode', matchcode.group())
                dic2[d][4] = matchcode.group()
                dic2[d][5] = matchcode.group()
                dic2[d][2] = text.replace(matchcode.group(), '')

            if (dic2[d][4] != ' ' or dic2[d][5] != ' ') and dic2[d].count(' ') >= 4:
                dic2[d][4] = ' '
                dic2[d][5] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital =='Vasantha_N151241-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            # if dic2[d][3] == dic2[d][4]:
            #     dic2[d][4] = ' '
            # if len(dic2[d][3].split()) == 3 and dic2[d][4] == ' ':
            #     # print('if qty number and rate together')
            #     a, b, c = dic2[d][3].split()
            #     dic2[d][3] = a
            #     dic2[d][4] = c
            # if len(dic2[d][2].split()) == 3 and dic2[d][3] == ' ' and len(re.findall('\D{3}\-\d', dic2[d][2])) == 1:
            #     print('if expdate and qty number together')
            #     a, b, c = dic2[d][2].split()
            #     dic2[d][2] = a
            #     dic2[d][3] = b
            # if len(dic2[d][4].split()) == 2 and len(re.findall('\d\.\d', dic2[d][4])) == 1 and len(
            #         re.findall('\d\,', dic2[d][4].split()[0])) == 0 and dic2[d][4] != dic2[d][5]:
            #     print('if qty and rate together')
            #     a, b = dic2[d][4].split()
            #     dic2[d][3] = a
            #     dic2[d][4] = b
            if dic2[d][3].__contains__('Vial'):
                dic2[d][3] = dic2[d][3].replace('Vial', ' ')
            if dic2[d][3].__contains__('ML'):
                dic2[d][3] = dic2[d][3].replace('ML', ' ')
            if dic2[d][3].__contains__('Ampule'):
                dic2[d][3] = dic2[d][3].replace('Ampule', ' ')
            if dic2[d][3].__contains__('Tablet'):
                dic2[d][3] = dic2[d][3].replace('Tablet', ' ')
            if dic2[d][3].__contains__('Bottle'):
                dic2[d][3] = dic2[d][3].replace('Bottle', ' ')
            if dic2[d][3].__contains__('Number'):
                dic2[d][3] = dic2[d][3].replace('Number', ' ')
            if dic2[d][3].__contains__('Capsule'):
                dic2[d][3] = dic2[d][3].replace('Capsule', ' ')
            if dic2[d][3].__contains__('PFS'):
                dic2[d][3] = dic2[d][3].replace('PFS', ' ')
            if dic2[d][3].__contains__('Strip'):
                dic2[d][3] = dic2[d][3].replace('Strip', ' ')
            if dic2[d][4].__contains__('. . . . . . . . . . .'):
                dic2[d][4] = dic2[d][3].replace('. . . . . . . . . . ', ' ')
            if dic2[d][5].__contains__('. . . . . . . . . . .'):
                dic2[d][5] = dic2[d][3].replace('. . . . . . . . . . ', ' ')
            if  len(re.findall('\d{1,}\/\d{2}\/?\s?\d{4}', dic2[d][1])) == 1:
                print('desdate', dic2[d])
                text = dic2[d][1]
                # matchcode = re.search('\D+\s\D+\w+\D+', dic2[d][0])
                matchdate = re.search('\d{1,}\/\d{2}\/?\s?\d{4}', dic2[d][1])
                print('matchdaaaa',dic2[d])
                dic2[d][1] = matchdate.group()
                #dic2[d][1] = text.replace(matchdate.group(), '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Vasantha_N151241':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])

            if dic2[d][3].__contains__('No'):
                dic2[d][3] = dic2[d][3].replace('No', '')
            if dic2[d][3].__contains__('Day'):
                dic2[d][3] = dic2[d][3].replace('Day', '')
            if dic2[d][3].__contains__('Hr'):
                dic2[d][3] = dic2[d][3].replace('Hr','')
            if  dic2[d][5] != ' ':
                dic2[d][5] = dic2[d][5].replace('- - -..', '')
            if  dic2[d][5] != ' ':
                dic2[d][5] = dic2[d][5].replace('- - -', '')
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Peerless':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] != ' ' and dic2[d][1] == ' ' and len(re.findall('\d{2,4}\s?\D?\d+\s?\D?\d+\s\w+', dic2[d][0])) == 1 and len(dic2[d][0].split()) >= 2:
                print('splitting date and parti')
                text = dic2[d][0]
                matchdate = re.search(r'\d{2,4}\s?\D?\d+\s?\D?\d+', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')
                dic2[d][1] = dic2[d][1].replace(' ', '', 1)
            if dic2[d][1].__contains__('Total'):
                print('sbt',dic2[d])
                dic2[d][5]=''
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Peerless-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][3] != ' ' and dic2[d][4] == ' ' and len(re.findall('\w+\s\w{3}\-\d{2}', dic2[d][3])) == 1 and len(dic2[d][0].split()) >= 2:
                print('splitting batch and exp')
                text = dic2[d][3]
                matchdate = re.search(r'\w{3}\-\d{2}', text)
                dic2[d][4] = matchdate.group()
                dic2[d][3] = text.replace(matchdate.group(), '')
                dic2[d][3] = dic2[d][3].replace(' ', '', 1)

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Hardikar_N1872-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('yessssss', dic2[d])
            if len(re.findall('\d+\-\w+\-\d+', dic2[d][0])) >= 1 and len(dic2[d][0].split()[0]) >= 2 and dic2[d][
                0] not in head_list:
                # print('if Date and particulars together',dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\d+\-\w+\-\d+', text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(), '')
            if dic2[d][3] != ' ' and dic2[d].count(' ') <= 2:
                dic2[d][3] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Hardikar_N1872':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('yessssss', dic2[d])
            if len(re.findall('\d+\.\d{1,}', dic2[d][2])) >= 1 and len(dic2[d][2].split()[0]) >= 2:
                # print('if Date and particulars together',dic2[d])
                text = dic2[d][2]
                matchcode = re.search(r'\d+\.\d{1,}', text)
                dic2[d][3] = matchcode.group()
                dic2[d][2] = text.replace(matchcode.group(), '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Ciigma_N5041':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            if dic2[d][0].__contains__('Total Charges'):
                dic2[d][0]='Total Charges'
            if dic2[d][0] in head_list and dic2[d].count(' ')<=4:
                print('bbed',dic2[d])
                dic2[d][0]=dic2[d][0].lower()
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Inamdar_N8739':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][1] in head_list and dic2[d][0]==' ' and dic2[d].count(' ')>=4:
                dic2[d][0]=dic2[d][1]
                dic2[d][1]=' '
            if len(re.findall('\s?\d{1,}\/?\:?\s?\d{1,}\/\d+', dic2[d][0])) >= 1 and len(dic2[d][0].split()[0]) >= 2 and dic2[d][1]==' ':
                print('if Date and particulars together',dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\s?\d{1,}\/?\:?\s?\d{1,}\/\d+',text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(), '')
            if len(re.findall('\s?\d{1,}\/?\:?\s?\d{1,}\/\d+', dic2[d][0])) >= 1 and len(dic2[d][0].split()[0]) >= 2 and dic2[d][1]!=' ':
                print('if Date and particulars together',dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\s?\d{1,}\/?\:?\s?\d{1,}\/\d+',text)
                dic2[d][0] = matchcode.group()
                #dic2[d][1] = text.replace(matchcode.group(), '')
            if len(re.findall('\s?\d{1,}\/?\:?\s?\d{1,}\/\d+', dic2[d][1])) >= 1 and len(dic2[d][1].split()[0]) >= 2 and dic2[d][1]!=' ':
                print('if Date and particulars together',dic2[d])
                text = dic2[d][1]
                matchcode = re.search(r'\s?\d{1,}\/?\:?\s?\d{1,}\/\d+',text)
                #dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(), '')
            if dic2[d][2]!=' ' and dic2[d].count(' ')<=2:
                dic2[d][1]=dic2[d][1]+" "+dic2[d][2]
                dic2[d][2]=' '

                # if dic2[d+1][0]=='OPERATION THEATRE':
                #     print('aaaaaaa',dic2[d])
                #     dic1[lq] = dic2[d+1]
                #     dic1[lq - 1] = dic2[d - 1]
                #     lq += 1
                #     dic1[lq - 1] = [text, ' ', ' ', ' ', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
    #if hospital == 'Inamdar_N8739-pharma1':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0].__contains__('Sales No'):
                dic2[d]=[' ', ' ', ' ', ' ', ' ', ' ']
                dic2[d+1]=[' ', ' ', ' ', ' ', ' ', ' ']
            # if dic2[d][0].__contains__('Sales Return No'):
            #     dic2[d][0]='Pharmacy Returns'
            if d<=2 and dic2[d][0]==' ' and len(re.findall('\d\.\d',dic2[d+1][5])):
                print('empty',dic2[d])
                dic2[d][0]='Pharmacy'
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Inamdar_N8739-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] not in head_list and (len(re.findall('[.]\s+[^0-9]*',dic2[d][0]))==1 or len(re.findall('[-]\s+[^0-9]*',dic2[d][0]))==1):
                print('merge',dic2[d])
                dic2[d]=[' ',' ',' ',' ',' ',' ']
            if dic2[d][5]!=' ' and dic2[d].count(" ")>=4:
                dic2[d]=[' ',' ',' ',' ',' ',' ']
            if dic2[d][0].__contains__('Sales No'):
                dic2[d]=[' ', ' ', ' ', ' ', ' ', ' ']
                #dic2[d+1]=[' ', ' ', ' ', ' ', ' ', ' ']
            if dic2[d][0].__contains__('Sales Return No'):
                dic2[d][0]='Pharmacy Returns'
            # if d <= 2 and dic2[d][0] == ' ' and len(re.findall('\d\.\d', dic2[d + 1][5])):
            #     print('empty', dic2[d])
            #     dic2[d][0] = 'Pharmacy'

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Gokul_N1365':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][0].__contains__('SURGERY TEAM CHARGES'):
                dic2[d][0] = 'SURGERY TEAM CHARGES'
            if dic2[d][5]!=' ' and dic2[d].count(' ')==5:
                dic2[d][5] = ' '
            if len(dic2[d][5].split())==2:
                a,b = dic2[d][5].split()
                dic2[d][5] = b
            if dic2[d][0] not in head_list and len(re.findall('\d\/\d{2}\/\d',dic2[d][0])) == 0 and dic2[d][0]!=' ':
                dic2[d][0] = dic2[d][1]
                dic2[d][0] = ' '
            if dic2[d][0] == ' ' and dic2[d][1]!=sbt and dic2[d].count(' ')<5:
                dic2[d][0] = '1/1/1'
            # if len(re.findall('\d{1,4}\,\d{1,10}', dic1[d][1])) == 1:
            #     print('thiss',dic2[d])
            #     text = dic1[d][1]
            #     matchdate = re.search(r'\d{1,}\,\d{1,}', text)
            #     dic1[d][3] = matchdate.group()
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Christian_N12987-pharma':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:

            if d > 1 and d < len(dic2) and len(re.findall('\d\/\d{2}\/\d{4}', dic2[d][0])) and dic2[d + 1][2] != ' ' and \
                    dic2[d + 1].count(' ') == 5:
                print('mrrger', dic2[d], dic2[d + 1])
                dic2[d][2] = dic2[d][2] + ' ' + dic2[d + 1][2]
                dic2[d + 1][2] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Christian_N12987':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if d > 1 and dic2[d][1] != ' ' and dic2[d][2] == ' ' and len(
                    re.findall('\d+\/\d{2}\/\d{4}', dic2[d][1])) == 1 and len(dic2[d][1].split()) >= 2:
                print('splitting date and parti')
                text = dic2[d][1]
                matchdate = re.search(r'\d+\/\d{2}\/\d{4}', text)
                dic2[d][1] = matchdate.group()
                dic2[d][2] = text.replace(matchdate.group(), '')

            if d > 1 and dic2[d][2] != ' ' and dic2[d].count(' ') >= 3:
                print('mrrger', dic2[d])
                dic2[d - 1][2] = dic2[d - 1][2] + ' ' + dic2[d][2]
                dic2[d][2] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Rhythm_N13889':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])

            if len(re.findall('^\d{1,}\s',dic2[d][0]))==1 and dic2[d].count(' ')<=2:
                print('removing sno', dic2[d])
                dic2[d][0]=re.sub('^\d{1,}\s','',dic2[d][0])
            if len(re.findall('\d+\s?\.?\d+', dic2[d][2])) >= 1 and len(dic2[d][2].split()[0]) >= 2 and dic2[d][3]==' ':
                print('if Date and particulars together',dic2[d])
                text = dic2[d][2]
                matchcode = re.search(r'\d+\s?\.?\d+',text)
                dic2[d][2] = matchcode.group()
                dic2[d][3] = text.replace(matchcode.group(), '')
            if dic2[d][1]!=' ' and dic2[d].count(' ')>=3:
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if len(dic2[d][5].split())==2:
                print('splitingg',dic2[d])
                a,b=dic2[d][5].split()
                dic2[d][5]=b
                #dic2[d][4]=b
            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Sanjeevani_N1570':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('pbbb',dic2[d])
            if dic2[d][1]=="BED CHARGES" and dic2[d][2]!=' ':
                dic2[d][1]=dic2[d][1]+" "+dic2[d][2]
                dic2[d][2]=' '
            if len(re.findall('\w+\s\w+\s\d+\.\d+\.\d+',dic2[d][0])):
                dic2[d][0]=re.sub('\w+\s\w+\s\d+\.\d+\.\d+','',dic2[d][0])
                dic2[d][0]=dic2[d][0].strip()
            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Masina_N3000':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][3].__contains__('Sub Total'):
               dic2[d]= [' ', ' ', ' ', ' ', ' ', ' ']
            if len(re.findall('^\d{1,}\s?\-?\s?',dic2[d][0]))==1 and dic2[d].count(' ')>=4:
                print('removing sno', dic2[d])
                dic2[d][0]=re.sub('^\d{1,}\s?\-?\s?','',dic2[d][0])
            if len(re.findall('\d\.\d',dic2[d][5]))==1 and dic2[d].count(' ')>=4:
                dic2[d][5]=' '
            if len(re.findall('\d{1,2}\/\d+\/\d+', dic2[d][1])) == 1 and len(dic2[d][1].split()[0])>=2  and dic2[d][0] not in head_list:
                print('if Date and particulars together',dic2[d])
                text = dic2[d][1]
                matchcode = re.search(r'\d{1,2}\/\d+\/\d+',text)
                dic2[d][1] = matchcode.group()
                dic2[d][2] = text.replace(matchcode.group(), '')
            if dic2[d][1]==' ' and len(re.findall('\d{1,2}\/\d+\/\d+', dic2[d][2])) == 1 and len(dic2[d][2].split()[0])>=2  and dic2[d][0] not in head_list:
                print('if Date and particulars together in 2nd index',dic2[d])
                text = dic2[d][2]
                matchcode = re.search(r'\d{1,2}\/\d+\/\d+',text)
                dic2[d][1] = matchcode.group()
                dic2[d][2] = text.replace(matchcode.group(), '')
            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Masina_N3000-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d{1,2}\/\s?\d+\/\s?\d+', dic2[d][0])) == 1 and len(dic2[d][0].split()[0])>=2  and dic2[d][0] not in head_list:
                print('if Date and particulars together',dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\d{1,2}\/\s?\d+\/\s?\d+',text)
                dic2[d][0] = matchcode.group()
                #dic2[d][2] = text.replace(matchcode.group(), '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Sahayog_N17901':
        dic2=dic1
        print('doooothis')
        dic1={}
        lq=1
        for d in dic2:
            if d>=1 and dic2[d][0]=='ACCOMODATION CHARGES' and dic2[d][0]!=' ':
                dic2[d+1][2]=dic2[d+1][0]
                dic2[d+1][0]=' '
            if len(re.findall('\d{1,}\-\d{1,}\-\d{1,}', dic2[d][0])) and dic2[d][1] == ' ' and dic2[d][0] not in head_list:
                print('if code and particulars together')
                text = dic2[d][0]
                matchcode = re.search(r'\d{1,}\-\d{1,}\-\d{1,}', text)
                dic2[d][0] = matchcode.group()
            if len(re.findall('\d{1,}\-\d{1,}\-\d{1,}', dic2[d][2])) and dic2[d][1] == ' ' and dic2[d][0] not in head_list:
                print('if code and particulars together')
                text = dic2[d][2]
                matchcode = re.search(r'\d{1,}\-\d{1,}\-\d{1,}', text)
                dic2[d][2] = text.replace(matchcode.group(),'')
            if len(re.findall('\d{1,}\.\w\s', dic2[d][2])) and dic2[d][1] == ' ' and dic2[d][0] not in head_list:
                print('if code and particulars together')
                text = dic2[d][2]
                matchcode = re.search(r'\d{1,}\.\w\s', text)
                dic2[d][0] = matchcode.group()
                dic2[d][2] = text.replace(matchcode.group(), '')
                # dic2[d][2] = text.replace(matchdate.group(),'')
                # dic2[d][2] = dic2[d][2].replace(dic2[d][2][0],'',1)

            dic1[lq]=dic2[d]
            lq +=1
    if hospital == 'Lifeline_N5106':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][0] not in head_list and dic2[d].count(' ')==5 and dic2[d][5]!=' ':
                dic2[d][5] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'National_N0420':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('dd00==',dic2[d])
            # if d>=1 and d<len(dic2) and dic2[d][0] in head_list and dic2[d][0]  == dic2[d+1][0] and dic2[d].count(' ')==3 and dic2[d-1].count(' ')==3:
            #     # print('if header and line item are same adding s to line item')
            #     dic2[d][0] = dic2[d+1][0]+'s'

            if d > 1 and d < len(dic2) and dic2[d - 1][6] != ' ' and dic2[d + 1][0].__contains__('PHYSIOTHERAPY') and \
                    dic2[d - 1].count(' ') == 6 and dic2[d].count(' ') == 3:
                print('mmm==', dic2[d])
                listnw = ['Physiotherapy', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Pulse_N18433':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('pra', dic2[d])
            if len(re.findall('\d+\/\d+\/\d+\s\d+:\d+\:\d+\s\-\s\w+\-\d+\/\d+\s', dic2[d][0])) and len(
                    dic2[d][0].split()[0]) >= 2 and dic2[d][1] == ' ' and dic2[d].count(' ') <= 3:
                print('if date is mergeing', dic2[d])
                # print('if code and particulars together', dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\d+\/\d+\/\d+\s\d+:\d+\:\d+\s\-\s\w+\-\d+\/\d+\s', text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(), '')
            if len(re.findall('\d+\/\d+\/\d+\s\d+:\d+\:\d+\s\-\s\w+\-\d+\/\d+', dic2[d][0])) and len(
                    dic2[d][0].split()[0]) >= 2 and dic2[d][1] == ' ' and dic2[d].count(' ') <= 3:
                print('if date is mergeing', dic2[d])
                # print('if code and particulars together', dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\d+\/\d+\/\d+\s\d+:\d+\:\d+\s\-\s\w+\-\d+\/\d+', text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(), '')
            dic1[lq] = dic2[d]
            lq += 1
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:

            if dic2[d][2] == 'FREE SPECIAL/ Total for CARDIOLOGY':
                dic2[d][2] = 'Total for CARDIOLOGY'
            if dic2[d][0] == '2904/2022':
                dic2[d][0] = '29/04/2022'
            if len(dic2[d][3].split()) > 1 and len(re.findall('\d\.\d', dic2[d][3])) == 2:
                a, b = dic2[d][3].split(' ', 1)
                dic2[d][3] = a
                dic2[d][4] = b

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Babymemo_N1108':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('pbbb',dic2[d])
            if dic2[d][1].__contains__('NUTRITIONAL ASSESSMENT PROCEDURE'):
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = ['NUTRITIONAL ASSESSMENT PROCEDURE', ' ', ' ', ' ', ' ', ' ']
            #if dic2[d][1].__contains__('PACKAGE'):
            if d>1 and dic2[d][0] in head_list and dic2[d-1][3]!="Sub Total":
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq -1] = [' ', ' ', ' ', 'Sub Total', ' ', ' ']
            if dic2[d][1].__contains__('PACKAGE'):
                dic2[d][4]=dic2[d][5]
            if d>=1 and d<=len(dic2) and len(re.findall('\d{1,}\-\d{1,}\-\d{1,}',dic2[d][0]))==1 and dic2[d][1]==' ' and dic2[d].count(" ")<=3:
                text = dic2[d][0]
                matchdate = re.search(r'\d{1,}\-\d{1,}\-\d{1,}', text)
                dic2[d][1] = text.replace(matchdate.group(), '')
                dic2[d][0] = matchdate.group()
                #dic2[d][1] = dic2[d][1].replace(' ', '', -1)
            if d>1 and d<len(dic2) and len(re.findall('\d{1,}\-\d{1,}\-\d{1,}',dic2[d][2]))==1 and dic2[d].count(" ")<=3:
                text = dic2[d][2]
                matchdate = re.search(r'\d{1,}\-\d{1,}\-\d{1,}', text)
                dic2[d][2] = text.replace(matchdate.group(), '')
                #dic2[d][0] = matchdate.group()
            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Mohandai_N13476':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            if len(re.findall("\d{1,}\.\s",dic2[d][0]))==1 :
                dic2[d][0]=re.sub("\d{1,}\.\s","",dic2[d][0])
                dic2[d][0]=dic2[d][0].strip()
            if len(re.findall('\d+\-\w+\-\d+', dic2[d][0])) >= 1 and dic2[d][
                0] not in head_list:
                # print('if Date and particulars together',dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\d+\-\w+\-\d+', text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(), '')+dic2[d][1]

            if dic2[d][5]!=' ' and dic2[d].count(' ')==5:
                print('break1111',dic2[d])
                # dic2[d-1][1]= dic2[d-1][1]+dic2[d][1]
                dic2[d][5]=' '
            if len(re.findall('\d{2}\-\w{3}\-\d{2}',dic2[d][2]))==1:
                print('removing \d{2}\-\w+\-\{2}', dic2[d])
                dic2[d][2]=re.sub('\d{2}\-\w{3}\-\d{2}','',dic2[d][2])
            if len(dic2[d][3].split())==2:
                a,b=dic2[d][3].split()
                dic2[d][3]=a
                dic2[d][4]=b
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Bhagwanmahavir_N13068-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\w{3}\-\d{2}', dic2[d][2])) == 1 and dic2[d][3] == ' ':
                print('if date batch together with no space in 2nd index')
                text = dic2[d][2]
                if len(re.findall('\w{3}\-\d{2}', dic2[d][1])) == 1:
                    matchrate = re.search(r'\w{3}\-\d{2}', text)
                elif len(re.findall('\w{3}\-\d{2}', dic2[d][1])) == 1:
                    matchrate = re.search(r'\w{3}\-\d{2}', text)
            if len(re.findall('\d{2}\-\w{3}\-\d{2}\s', dic2[d][1])):
                print('date Perti', dic2[d])
                a, b = re.split('\s', dic2[d][1], maxsplit=1)
                print('aa', a)
                print('bb', b)
                dic2[d][1] = dic2[d][2].replace(b, ' ')
                dic2[d][1] = a
                dic2[d][2] = b
            dic2[d][4] = dic2[d][4].replace('Pcs','')
            dic2[d][4] = dic2[d][4].replace('Pes','')
            dic2[d][4] = dic2[d][4].replace('Number','')
            dic2[d][4] = dic2[d][4].replace('Strip','')
            dic2[d][4] = dic2[d][4].replace('Bottle','')
            dic2[d][4] = dic2[d][4].replace('Ampule','')
            dic2[d][4] = dic2[d][4].replace('Vial','')
            dic2[d][4] = dic2[d][4].replace('Tablet','')
            dic2[d][4] = dic2[d][4].replace('Via','')
            dic2[d][4] = dic2[d][4].replace('PCs','')
            dic2[d][4] = dic2[d][4].replace('Boule','')
            dic2[d][4] = dic2[d][4].replace('Ampole','')
            dic2[d][4] = dic2[d][4].replace('POST','')
            dic2[d][4] = dic2[d][4].replace('Ampale','')
            dic2[d][4] = dic2[d][4].replace('Boutk','')
            dic2[d][4] = dic2[d][4].replace('PCS','')
            dic2[d][4] = dic2[d][4].replace('es','')
            dic2[d][4] = dic2[d][4].replace('Pc','')
            dic2[d][4] = dic2[d][4].replace('Pus','')
            dic2[d][4] = dic2[d][4].replace('Container','')
            dic2[d][4] = dic2[d][4].replace('Ointment','')
            dic2[d][4] = dic2[d][4].replace('CANCHI','')
            if dic2[d][0] == 'Of Nursing Station':
                dic2[d][0] = 'OT Nursing Station'
            if len(re.findall('\w{3}\-\d{2}', dic2[d][2])) == 1 and dic2[d][3] == ' ':
                print('if rate qty together wuth no space in 2nd index')
                text = dic2[d][2]
                if len(re.findall('\w{3}\-\d{2}', dic2[d][2])) == 1:
                    matchrate = re.search(r'\w{3}\-\d{2}', text)
                elif len(re.findall('\s\w{3}\-\d{2}', dic2[d][2])) == 1:
                    matchrate = re.search(r'\s\w{3}\-\d{2}', text)
                dic2[d][3] = matchrate.group()
                dic2[d][2] = text.replace(matchrate.group(), '')
            if len(re.findall('\d+\-\w+\-\d{2}', dic2[d][1])) == 1 and dic2[d][2] == ' ':
                print('if rate qty together wuth no space in 2nd index')
                text = dic2[d][1]
                if len(re.findall('\d+\-\w+\-\d{2}', dic2[d][1])) == 1:
                    matchrate = re.search(r'\d+\-\w+\-\d{2}', text)
                elif len(re.findall('\d+\-\w+\-\d{2}', dic2[d][1])) == 1:
                    matchrate = re.search(r'\d+\-\w+\-\d{2}', text)
                dic2[d][1] = matchrate.group()
                dic2[d][2] = text.replace(matchrate.group(), '')
            if len(re.findall('\d+\-\w+\-\d+', dic2[d][0])) == 1 and dic2[d][1] != ' ':
                print('if rate qty together with no space in 2nd index')
                text = dic2[d][0]
                if len(re.findall('\d+\-\w+\-\d+', dic2[d][0])) == 1:
                    matchrate = re.search(r'\d+\-\w+\-\d+', text)
                elif len(re.findall('\d+\-\w+\-\d+', dic2[d][0])) == 1:
                    matchrate = re.search(r'\d+\-\w+\-\d+', text)
                dic2[d][1] = matchrate.group()
                dic2[d][0] = text.replace(matchrate.group(), '')
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Bhagwanmahavir_N13068':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            dic2[d][4] = dic2[d][4].replace('No', '')
            dic2[d][4] = dic2[d][4].replace('Day', '')
            dic2[d][4] = dic2[d][4].replace('Number', '')
            dic2[d][4] = dic2[d][4].replace('Hr', '')
            dic2[d][4] = dic2[d][4].replace('NO', '')
            if dic2[d][0] == "I'otal":
                dic2[d][0] = "Total"
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Sugam_N3241':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][5] != ' ' and dic2[d].count(' ') == 5:
                print('break1111', dic2[d])
                # dic2[d-1][1]= dic2[d-1][1]+dic2[d][1]
                dic2[d][5] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Sugam_N3241-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][0]=="IP DELIVERY":
                dic2[d][0]="Pharmacy"
            if dic2[d][0].__contains__("IP DELIVERY RETURN"):
                dic2[d][0]="Pharmacy Returns"
            if dic2[d][5] != ' ' and dic2[d].count(' ') == 5:
                print('break1111', dic2[d])
                dic2[d][5] = ' '
            if len(re.findall("\w+\d+\s?\w+\d+",dic2[d][0]))==1 and dic2[d].count(" ")==5:
                dic2[d]=[' ', ' ', ' ', ' ', ' ', ' ']
            if dic2[d][2].__contains__('Batch') or dic2[d][2].__contains__('Expiry') or dic2[d][0].__contains__('Product') or dic2[d][0].__contains__('Bill No'):
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Sterling_N0562':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if len(dic2[d][0].split()) == 3 and len(re.findall('\d{2}\-\d{2}\-\d{4}\D+\d+\D+', dic2[d][0])) == 1:
                print('if rate unit total together in 1st index', dic2[d])
                a, b, c = dic2[d][0].split()
                dic2[d][0] = a
                dic2[d][1] = b
                dic2[d][2] = c

            # if len(dic2[d][2].split()) == 2 and dic2[d][1] == ' ':
            #     print('if unit,total together in 2th index ')
            #     a, b = dic2[d][2].split()
            #     dic2[d][1] = a
            #     dic2[d][2] = b
            if len(dic2[d][1].split()) == 2:
                print('if unit,total together in 2th index')
                a, b = dic2[d][1].split()
                dic2[d][1] = a
                dic2[d][2] = b

            if len(re.findall('\d{2}\-\d{2}\-\d{4}\s?\.\s?\d+\s?\D+', dic2[d][0])) == 1 and (
                    dic2[d][1] == ' ' or dic2[d][1] != ' ') and len(dic2[d][0].split()) > 3:
                print('if date and particulars merge')
                text = dic2[d][0]
                matchdate = re.search(r'\d{2}\-\d{2}\-\d{4}', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')

                # if d > 1 and d != len(dic2) and dic2[d][0] == dic2[d - 1][0] and dic2[d - 1][0] in head_list:
            #     print('if sub header and header are same')
            #     dic2[d][0] = dic2[d][0] + 's'
            #     sub_head.append(dic2[d][0] + 's')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Indianhospital':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:

            if len(re.findall('^\d+\.?\s', dic2[d][0])) == 1 and dic2[d].count(' ') == 5:
                print('to remove sno')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')

            if d > 1 and len(re.findall('\d\.\d', dic2[d][5]))  and dic2[d].count(' ') >= 4:
                print('remove sbt value', dic2[d])
                dic2[d][5] = ' '
                continue

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Aarogya_N10980':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print("deee",dic2[d])
            if dic2[d][1] in head_list and dic2[d].count(' ')==6:
                dic2[d][0] = dic2[d][1]
            if dic2[d][3] != ' ' and dic2[d].count(' ') >= 3 and dic2[d][5] == ' ':
                dic2[d][5] = dic2[d][3]
                dic2[d][6] = dic2[d][3]
                dic2[d][3] = ' '
            if len(re.findall('\d+\/\w{3}\d+\w+', dic2[d][3])) == 1:
                print('if date in 3th index')
                text = dic2[d][3]
                dic2[d][4] = ' '
                dic2[d][5] = ' '
                dic2[d][6] = ' '
            if dic2[d][1] == ' ' and len(re.findall('\d{2}\-\w+\-\d{4}', dic2[d][0])) == 1 and len(dic2[d][0].split()) >= 2:
                print('if date and parti together in 1st index')
                text = dic2[d][0]
                matchdate = re.search(r'\d{2}\-\w+\-\d{4}',text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(),'')

            if dic2[d][6] != ' ' and dic2[d].count(' ') == 6:
                print('break1111', dic2[d])
                # dic2[d-1][1]= dic2[d-1][1]+dic2[d][1]
                dic2[d][6] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Cloudnine_N12573':
        dic1_a = dic1
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('dd00==',dic2[d])
            if len(re.findall('^\d+\s', dic2[d][0])) == 1:
                dic2[d][0] = re.sub('^\d+\s', '', dic2[d][0])
            if len(re.findall('\d+\-\d+\-\d+', dic2[d][3])) == 1:
                text = dic2[d][3]
                matchdate = re.search(r'\d+\-\d+\-\d+', text)
                dic2[d][2] = matchdate.group()
                dic2[d][3] = ' '
            if len(re.findall('^[0]\.[0][0]', dic2[d][5])) == 1:
                dic2[d][5] = re.sub('^[0]\.[0][0]', ' ', dic2[d][5])
                dic2[d][5] = dic2[d][5].strip()
                print('After this1', dic2[d])
            if len(re.findall('\s[0]\.[0][0]', dic2[d][5])) == 1:
                dic2[d][5] = re.sub('\s[0]\.[0][0]', ' ', dic2[d][5])
                dic2[d][5] = dic2[d][5].strip()
                print('After this1', dic2[d])
            if len(re.findall('\d\.\d', dic2[d][2])) >= 1:
                dic2[d][2] = re.sub('\d+\.\d+', '', dic2[d][2])
            if len(dic2[d][5].split()) == 2 and len(re.findall('\d\.\d', dic2[d][5])) == 2:
                # print('if qty gst and amount get mixed')
                a, b = dic2[d][5].split()
                dic2[d][5] = b
            if len(re.findall('\d{4}', dic2[d][3])) == 1 and len(dic2[d][3].split()) == 1 and dic2[d].count(' ') == 4:
                dic2[d][2] = dic2[d][3]
                dic2[d][3] = ' '
            if len(re.findall('\d+\-\d+\-\d+', dic2[d][0])) == 1 and len(re.findall('\d+\-\d+\-\d+', dic2[d][2])) == 1:
                text = dic2[d][0]
                matchdate = re.search(r'\d+\-\d+\-\d+', text)
                dic2[d][0] = text.replace(matchdate.group(), '')
            for i in head_list:
                if i in dic1_a[d][0] and dic1_a[d].count(' ') < 5 and dic1_a[d][0] != ' ':
                    print('head with line item')
                    listnw = [i, ' ', ' ', ' ', ' ', ' ']
                    dic1[lq] = dic1_a[d]
                    lq += 1
                    dic1[lq - 1] = listnw
                    dic1_a[d][0] = dic1_a[d][0].replace(i, ' ', 1)
                    dic1_a[d][0] = dic1_a[d][0].strip()
            if dic2[d][0] != ' ' and dic2[d][5] != ' ' and dic2[d].count(' ') == 4:
                dic2[d][0] = ' '
                dic2[d][5] = ' '
            if dic2[d][5] != ' ' and dic2[d].count(' ') == 5:
                dic2[d][5] = ' '
            if len(re.findall('\d+\-\d+\-\d+', dic2[d][4])) == 1:
                dic2[d][2] = dic2[d][4]
                dic2[d][4] = ' '
            if len(re.findall('\d{8}', dic2[d][3])) == 1 and len(re.findall('\d\.\d', dic2[d][3])) == 0:
                dic2[d][3] = ' '
            if len(dic2[d][3].split()) == 3 and dic2[d][3].count(' ') == 2 and len(
                    re.findall('\d\.\d', dic2[d][3])) == 3:
                a, b, c = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Velammal_N15676':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dddddd', dic2[d])
            if dic2[d][1].__contains__('DISPOSABLES'):
                print("merge",dic2[d])
                dic2[d][1]='DISPOSABLES'
            if dic2[d][1]=='IP PHARMACY':
                dic2[d][1]=' '
            for i in head_list:
                if i == dic2[d][1] and dic2[d].count(' ') >= 5:
                    dic2[d][0] = i
                    dic2[d][1] = ' '
            if len(dic2[d][2].split()) == 2 :
                print('removal', dic2[d])
                a, b = dic2[d][2].split()
                dic2[d][2]=a
                dic2[d][3]=b
                # if d > 1 and d < len(dic2) and dic2[d][1] + ' ' + dic2[d + 1][1] == i and dic2[d].count(' ') >= 5 and \
                #         dic2[d + 1].count(' ') >= 5:
                #     print("drugssss",dic2[d])
                #     dic2[d][0] = i
                #     dic2[d][1] = ' '
                #     dic2[d + 1][1] = ' '
            # if dic2[d][1] in head_list and dic2[d].count(" ")==5:
            #     dic2[d][0] = dic2[d][1]
            #     dic2[d][1]=' '
            if dic2[d][5]!=' ' and len(re.findall("\d\.\d",dic2[d][5]))==1 and dic2[d].count(" ")>=4:
                dic2[d][5]=' '
            if len(re.findall('\d+\s', dic2[d][1])) == 1 and len(dic2[d][1].split()) > 2 and len(
                    dic2[d][1].split()[0]) >= 2 :
                print('if code and parti together with 5 digits including +', dic2[d])
                text = dic2[d][1]
                if len(re.findall('\d+\s', dic2[d][1])) == 1:
                    matchcode = re.search(r'\d+\s', text)
                dic2[d][1] = text.replace(matchcode.group(), '')

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dddddd', dic2[d])
            if d >=1 and d < len(dic2) and dic2[d][1] + ' ' + dic2[d + 1][1] in head_list and dic2[d].count(' ') >= 5 and dic2[d + 1].count(' ') >= 5:
                print("drugssss", dic2[d])
                dic2[d][0] = dic2[d][1] + ' ' + dic2[d + 1][1]
                dic2[d][1] = ' '
                dic2[d + 1][1] = ' '
            if d >1 and d < len(dic2) and dic2[d][0] + ' ' + dic2[d + 1][1] in src_dc['merge_set']  and dic2[d].count(' ') >= 5 and dic2[d + 1].count(' ') >= 5:
                print("drugssss", dic2[d])
                dic2[d][0] = dic2[d][0] + ' ' + dic2[d + 1][1]
                dic2[d][1] = ' '
                dic2[d + 1][1] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Velammal_N15676-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dddddd', dic2[d])
            if len(re.findall('^\d{1,}\s?', dic2[d][0])) == 1 and dic2[d].count(' ') <= 5:
                print('removing sno', dic2[d])
                dic2[d][0] = re.sub('^\d{1,}\s?', ' ', dic2[d][0])
            if len(re.findall('\d+\s', dic2[d][1])) == 1 and len(dic2[d][1].split()) >=1:
                print('if code and parti together with 5 digits including +', dic2[d])
                text = dic2[d][1]
                matchcode = re.search(r'\d+\s', text)
                dic2[d][1]=matchcode.group()
                dic2[d][2] = text.replace(matchcode.group(), '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'yashoda_N16659':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][0].__contains__("'VISITING CHARGES")==1:
                dic2[d][0]='VISITING CHARGES'
            if dic2[d][5] != ' ' and dic2[d].count(' ') >= 4:
                print('break1111', dic2[d])
                dic2[d][5] = ' '
            if len(re.findall('^\d{1,}\.\s', dic2[d][0])) == 1 and dic2[d].count(' ') <= 5:
                print('removing sno', dic2[d])
                dic2[d][0] = re.sub('^\d{1,}\.\s', '', dic2[d][0])
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'sri_N13374':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('nddd==', dic2[d])
            if d > 1 and dic2[d][0].__contains__('IP Doctor Visit Charges') and dic2[d].count(' ') <= 2 and dic2[d + 1][
                5].__contains__('Sub Total') == True and dic2[d + 2][0].__contains__('Laboratory Charges') == True:
                dic2[d - 1] = [' ', ' ', ' ', ' ', ' ', ' ', ' ']
                listnw = [dic2[d][0], ' ', ' ', ' ', ' ', ' ', ' ']
                dic2[d][0] = ' '
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw

            if d > 1 and dic2[d][0] in head_list and dic2[d].count(' ') <= 2 and dic2[d - 1][5] == sbt:
                listnw = [dic2[d][0], ' ', ' ', ' ', ' ', ' ', ' ']
                dic2[d][0] = ' '
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw

            if d > 1 and dic2[d][0] in head_list and dic2[d].count(' ') <= 2 and dic2[d - 1][5] == sbt:
                listnw = [dic2[d][0], ' ', ' ', ' ', ' ', ' ', ' ']
                dic2[d][0] = ' '
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw

            if dic2[d][0] == '[P Doctor Visit Charges':
                dic2[d][0] = 'IP Doctor Visit Charges'

            if dic2[d][2] == 'FLATNO-207 , VERTEX PLEASANT NEAR':
                dic2[d][2] = ' '
            dic1[lq] = dic2[d]
            lq += 1
        dic2 = dic1
    if hospital == 'omnihospital':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])


            # if dic2[d][1]=="Doctor Charges":
            #     dic2[d][0] = dic2[d][1]
            #     dic2[d][1]=' '
            if dic2[d][0].__contains__('www.omnihospitals') or dic2[d][0].__contains__('WWW.omnihospitalsin'):
                dic2[d][0]=' '
            if dic2[d][3].__contains__('Sub Total:'):
                dic2[d][3]=' '
            if dic2[d][4] != ' ' and dic2[d][5] != ' ' and len(re.findall('\d+\.\d+', dic2[d][4])) == 2 and dic2[d][
                5] in dic2[d][4]:
                print('if qty, amt in 4th indx and amt in 5th indx')
                text = dic2[d][4].split()
                dic2[d][4] = text[0]
                dic2[d][5] = text[-1]
            if (dic2[d][1].__contains__('Admission Cha') or dic2[d][1].__contains__('Admission Cha')) and dic2[d][
                2] == ' ':
                dic2[d][2] = dic2[d][1]
            if dic2[d][1].__contains__('Doctor Charges'):
                dic2[d][0] = dic2[d][1]
                dic2[d][1] = ' '
            if len(dic2[d][5].split()) == 2  and len(re.findall('\d\.\d', dic2[d][5])) == 1:
                print('if qty rate together with *')
                a,b= dic2[d][5].split()
                dic2[d][4] = a
                dic2[d][5] = b
            if len(dic2[d][4].split()) == 2  and len(re.findall('\d\.\d', dic2[d][4])) == 2:
                print('if qty rate together with *')
                a,b= dic2[d][4].split()
                dic2[d][4] = a
                dic2[d][5] = b
            if len(dic2[d][5].split()) == 2  and len(re.findall('\d\.\d', dic2[d][5])) == 2:
                print('if qty rate together with *')
                a,b= dic2[d][5].split()
                dic2[d][5] = b
                #dic2[d][5] = b
            if len(re.findall('\d{1,2}\-\d{2}\-\d{4}', dic2[d][0])) == 1 and len(dic2[d][0].split()[0]) >= 2 and \
                    dic2[d][0] not in head_list and dic2[d][1] == ' ':
                print('if code and particulars together', dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\d{1,2}\-\d{2}\-\d{4}', text)
                dic2[d][0] = matchcode.group()
                # dic2[d][0]=' '
                dic2[d][1] = text.replace(matchcode.group(), '')
            if len(re.findall('\d{2}\-\d{2}\-\d{4}', dic2[d][0])) == 1 and len(dic2[d][0].split()[0]) >= 2 and \
                    dic2[d][0] not in head_list and dic2[d][1]!= ' ':
                print('if date and description', dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\d{1,2}\-\d{2}\-\d{4}', text)
                dic2[d][0] = matchcode.group()
                # dic2[d][0]=' '
                #dic2[d][1] = text.replace(matchcode.group(), '')
            # for i in head_list:
            #     if d>1 and d<len(dic2) and dic2[d][0]=="Doctor Charges":
            #         # dic1[lq][] = dic2[d]
            #         # dic1[lq + 1] = dic2[d + 1]
            #         # lq += 1
            #         # dic1[lq + 1][2] = dic1[lq+1][1]+" "+dic1[lq+1][2]
            #         text = dic2[d][0]
            #         dic2[d][0] = dic2[d][1]
            #         dic2[d][1] = text
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'convenienthospital-pharma':
        dic2=dic1
        dic1 = {}
        lq =1
        f=0
        fn=len(dic2)
        for d in dic2:
            if dic2[d][3]=='Medicine' and dic2[d][5]!=' ':
                dic2[d][3] =' '
                dic2[d][5] =' '
            if dic2[d][0].__contains__('Sales'):
                dic2[d][0] = 'MEDICINE'
            if dic2[d][0].__contains__('Return'):
                dic2[d][0] = 'MEDICINE-RETURN'
            # if dic2[d][0] in head_list and dic2[d][5]!=' ':
            #     dic2[d]=['MEDICINE', ' ', ' ', ' ', ' ', ' ', ' ']
            if len(dic2[d][3].split()) == 2  and len(re.findall('\d\.\d', dic2[d][5])) == 1:
                print('if qty rate together with *',dic2[d])
                a,b= dic2[d][3].split()
                dic2[d][3] = a
                #dic2[d][4] = c
            if len(dic2[d][2].split()) == 2  and len(re.findall('\d\.\d', dic2[d][5])) == 1:
                print('if qty rate together with *',dic2[d])
                a,b= dic2[d][2].split()
                dic2[d][2] = a
                #dic2[d][4] = c
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'convenienthospital':
        dic2 = dic1
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            if len(re.findall('\d{1,2}\-\d{2}\-\d{4}', dic2[d][0])) == 1 and len(dic2[d][0].split()[0])>=2  and dic2[d][0] not in head_list and dic2[d][2]==' ':
                print('if code and particulars together',dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\d{1,2}\-\d{2}\-\d{4}',text)
                dic2[d][0] = matchcode.group()
                #dic2[d][0]=' '
                dic2[d][2] = text.replace(matchcode.group(),'')
            if dic2[d][0].__contains__('SURGICAL MANAGEMENT'):
                dic2[d][0]='SURGICAL MANAGEMENT'
            if dic2[d][0].__contains__('HOSPITAL CHARGES'):
                dic2[d][0]='HOSPITAL CHARGES'
            if dic2[d][0].__contains__('ROOM ACCOMMODATION') and dic2[d+1][0]!=' ':
                print("priiint",dic2[d])
                dic2[d+1][2]=dic2[d+1][0]
                dic2[d+1][0]=' '
            if len(re.findall('\d{1,}\-\d{1,}\-\d{1,}', dic2[d][0])) and dic2[d][1] == ' ' and dic2[d][0] not in head_list:
                print('if code and particulars together')
                text = dic2[d][0]
                matchcode = re.search(r'\d{1,}\-\d{1,}\-\d{1,}', text)
                dic2[d][0] = matchcode.group()
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'hcg_N16943':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if len(re.findall('^\d+\s',dic2[d][0]))==1:
                dic2[d][1] = re.sub('^\d+\s','',dic2[d][0])
            if len(re.findall('^\d+\s',dic2[d][1]))==1:
                dic2[d][1] = re.sub('^\d+\s','',dic2[d][1])
            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Vinayak_N2742':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('yessssss',dic2[d])
            if dic2[d][3].__contains__('Total Amount'):
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if dic2[d][0].__contains__(','):
                dic2[d][0]=dic2[d][0].replace(',','&')
            if dic2[d][5].__contains__(' ') and dic2[d].count(" ")<=4:
                dic2[d][5]=dic2[d][5].replace(' ','')
            if len(re.findall('\d{1,}\/\w+\s?\/\s?\d+', dic2[d][0])) >= 1 and len(dic2[d][0].split()[0])>=2  and dic2[d][0] not in head_list:
                #print('if Date and particulars together',dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\d{1,}\/\w+\s?\/\s?\d+',text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(), '')
            # if len(re.findall('\d{1,2}\/\w+\s\/\d+', dic2[d][0])) == 1 and len(dic2[d][0].split()[0])>=2  and dic2[d][0] not in head_list:
            #     #print('if Date and particulars together in 2nd index',dic2[d])
            #     text = dic2[d][0]
            #     matchcode = re.search(r'\d{1,2}\/\w+\s\/\d+',text)
            #     dic2[d][0] = matchcode.group()
            #     dic2[d][1] = text.replace(matchcode.group(), '')
            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'Jehangir':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd==',dic2[d])
            if dic2[d][0] == 'Services':
                dic2[d][0] = ' '

            if dic2[d][3] != ' ' and len(re.findall('[.]\s+[^0-9]*', dic2[d][3])) == 1 and len(re.findall('\d+\.\d+', dic2[d][3])) == 0:
                dic2[d][3] = ' '
            if  dic2[d][4]!= ' ' and len(re.findall('[.]\s+[^0-9]*', dic2[d][4])) == 1 and len(re.findall('\d+\.\d+', dic2[d][4])) == 0:
                dic2[d][4] = ' '
            if  dic2[d][5]!= ' ' and len(re.findall('[.]\s+[^0-9]*', dic2[d][5])) == 1 and len(re.findall('\d+\.\d+', dic2[d][5])) == 0:
                dic2[d][5] = ' '
            if dic2[d][3]!=' ' and 'Day' in dic2[d][3]:
                dic2[d][3] = dic2[d][3].replace('Day','').strip()
            if dic2[d][3]!=' ' and 'No' in dic2[d][3]:
                dic2[d][3] = dic2[d][3].replace('No','').strip()
            if dic2[d][3]!=' ' and 'Hr' in dic2[d][3]:
                dic2[d][3] = dic2[d][3].replace('Hr','').strip()


            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Jehangir-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd==',dic2[d])
            if dic2[d][2] == 'Number':
                dic2[d][2] = ' '
            if dic2[d][3] == 'Number':
                dic2[d][3] = ' '
            if len(re.findall('\d+\/\d\s?\d\/\d+', dic2[d][0])) == 1 and len(dic2[d][0].split())>=3 and dic2[d][1] == ' ':
                print('Item, parti merged')
                text = dic2[d][0]
                matchdate = re.search(r'\d+\/\d\s?\d\/\d+',text)
                dic2[d][1] = matchdate.group()
                dic2[d][0] = dic2[d][0].replace(matchdate.group(),'')
            if dic2[d][2]!=' ' and len(dic2[d][2].split())==3 and 'Number' in dic2[d][2]:
                print('if rate, Qty with number merged')
                text = dic2[d][2].split()
                dic2[d][2] = text[0]
                dic2[d][3] = text[1]


            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Zydus_N14696':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][5]=='19.000.00':
                dic2[d][5]='19,000.00'
            if dic2[d][5]=='21,000,00':
                dic2[d][5]='21,000.00'
            if dic2[d][0].__contains__('Total'):
                dic2[d][0]="TOTAL"
            if len(re.findall('\d+\-\d+\-\d+', dic2[d][0])) and dic2[d][1]==' ' and len(dic2[d][0].split()[0])>=2  and dic2[d][0] not in head_list and dic2[d].count(" ")<=3:
                print('if Date and particulars together',dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\d+\-\d+\-\d+',text)
                dic2[d][1] = matchcode.group()
                dic2[d][0] = text.replace(matchcode.group(), '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Surana_N6086':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd===', dic2[d])
            if dic2[d][3] != ' ' and len(re.findall('\d\.\d', dic2[d][3])) == 2 and len(dic2[d][3].split()) == 2:
                print('if Rate, Qty Together in 3rd indx')
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if dic2[d][4] != ' ' and dic2[d][3] == ' ' and len(re.findall('\d\.\d', dic2[d][4])) == 2 and len(
                    dic2[d][4].split()) == 2:
                print('if Rate, Qty Together in 4th indx')
                a, b = dic2[d][4].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if dic2[d][1] != ' ' and dic2[d][3] == ' ' and dic2[d][4] == ' ' and len(
                    re.findall('\d\.\d', dic2[d][1])) == 2:
                print('if Rate, QTy with Parti')
                text = dic2[d][1].split()
                dic2[d][4] = text[-1]
                dic2[d][3] = text[-2]
                dic2[d][1] = dic2[d][1].replace(text[-1], '').replace(text[-2], '')
            if dic2[d][1] != ' ' and dic2[d][3] == ' ' and dic2[d][4] != ' ' and len(
                    re.findall('\d\.\d', dic2[d][1])) == 1:
                print('if Rate with Parti')
                text = dic2[d][1].split()
                dic2[d][3] = text[-1]
                dic2[d][1] = dic2[d][1].replace(text[-1], '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'meenakshimission':
        dic1_a = dic1
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][0] == 'INFECTION CONTROL' and dic2[d + 1][0] == 'CHARGES':
                dic2[d][0] = 'INFECTION CONTROL CHARGES'
                dic2[d + 1][0] = ' '
            for i in head_list:        
                if i in dic1_a[d][0] and dic1_a[d].count(' ') < 5 and dic1_a[d][0] != ' ' and dic1_a[d][1]==' ':
                    print('head with line item1')
                    listnw = [i, ' ', ' ', ' ', ' ', ' ']
                    dic1[lq] = dic1_a[d]
                    lq += 1
                    dic1[lq - 1] = listnw
                    dic1_a[d][1] = dic1_a[d][0].replace(i,'')
                    dic1_a[d][1] = dic1_a[d][0].strip()
                    dic1_a[d][0] = ' '
                if i in dic1_a[d][0] and dic1_a[d].count(' ') < 5 and dic1_a[d][0] != ' ':
                    print('head with line item')
                    listnw = [i, ' ', ' ', ' ', ' ', ' ']
                    dic1[lq] = dic1_a[d]
                    lq += 1
                    dic1[lq - 1] = listnw
                    dic1_a[d][0] = dic1_a[d][0].replace(i,'')
                    dic1_a[d][0] = dic1_a[d][0].strip()
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Pawan_N16260':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            # #if len(re.findall('^\d+\.?\s', dic2[d][0])) == 1 and len(dic2[d][0].split()[0])<=3:
            #     print('to remove sno')
            #     text = dic2[d][0]
            #     matchsno = re.search(r'^\d+\.?\s',text)
            #     dic2[d][0] = dic2[d][0].replace(matchsno.group(),'')

            if dic2[d][0] in head_list and dic2[d][1] != ' ' and dic2[d].count(' ') <= 4:
                dic2[d][1] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Ckbirla_N2832':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            if dic2[d][5]!=' ' and dic2[d].count(' ')==5:
                print('break1111',dic2[d])
                # dic2[d-1][1]= dic2[d-1][1]+dic2[d][1]
                dic2[d][5]=' '
            if dic2[d][0]!=' ' and dic2[d][0] not in head_list and dic2[d][5]!=' ' and dic2[d].count(' ')==4:
                dic2[d][5]=' '
            if len(re.findall('\d{2}\/\d{2}\/\d{4}', dic2[d][0])) == 1:
                print('if date in 0th index')
                text = dic2[d][0]
                matchdate = re.search(r'\d{2}\/\d{2}\/\d{4}', text)
                dic2[d][1] = matchdate.group()
                dic2[d][0] = dic2[d][0].replace(matchdate.group(), '')
            if len(dic2[d][3].split())==2:
                a,b=dic2[d][3].split()
                dic2[d][3]=a
                dic2[d][4]=b
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Healthway_N15806-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('nddd==', dic2[d])

            if dic2[d][0] == "Bill No :'":
                dic2[d][0] = 'Bill No :'
            if dic2[d][1] == 'ECOSPRIN 75 MG TAB':
                dic2[d][1] = 'ECOSPRIN75 MG TAB'
            if len(dic2[d][1].split()) >= 1 and dic2[d][2] == ' ' and len(re.findall('\d+\w{2}\d+', dic2[d][1])) == 1 and dic2[d][4] == ' ':
                print('rate  in unit')
                text = dic2[d][1]
                if len(re.findall('\d+\w{2}\d+', dic2[d][1])) == 1:
                    matchrate = re.search(r'\d+\w{2}\d+', text)
                elif len(re.findall('\d+\w{2}\d+', dic2[d][1])) == 1:
                    matchrate = re.search(r'\d+\w{2}\d+', text)
                elif len(re.findall('\d+\w{2}\d+', dic2[d][1])) == 1:
                    matchrate = re.search(r'\d+\w{2}\d+', text)
                dic2[d][1] = dic2[d][1].replace(matchrate.group(), ' ')
                dic2[d][2] = matchrate.group()
            dic1[lq] = dic2[d]
            lq += 1
        dic2 = dic1
    if hospital=='Divine_N2841':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d{1,2}\/\w+\/\d+', dic2[d][0])) == 1 and len(dic2[d][0].split()[0])>=2 and dic2[d][1]==' ' and dic2[d][0] not in head_list:
                print('if Date and particulars together',dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\d{1,2}\/\w+\/\d+',text)
                dic2[d][0] = matchcode.group()
                dic2[d][2] = text.replace(matchcode.group(), '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'shalby_N14327':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:

            if d > 1 and len(re.findall('\d{2}\-\d{2}\-\d{4}', dic2[d][0])) == 1 and dic2[d - 1][0] == ' ' and dic2[d].count(' ') <= 4:
                print('if date is mergeing', dic2[d])
                dic2[d][0] = dic2[d - 1][0]
                dic2[d - 1][0] = ' '
            if dic2[d][4] == '1 35.83 4.54 35.834.54':
                dic2[d][4] = '135834.54 35834.54'
            if dic2[d][4] == '1 12,000.0C 12,000.00':
                dic2[d][4] = '1 12000.00 12000.00'

            if dic2[d][4] == '1 35,834.54 35,834.54':
                dic2[d][4] = '1 35834.54 35834.54'
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Bengal_N2890_daycare':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if d>1 and dic2[d][5]!=' ' and dic2[d].count(' ')==5:
                dic2[d][5] = ' '
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital=='Medstar_N17161':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print("deee", dic2[d])
            if d > 1 and d < len(dic2) and len(re.findall('\d+\-\d+\-\d+', dic2[d][2])) == 1 and dic2[d-1][2]!=' '  and dic2[d-1].count(' ')>=3:
                print('add===', dic2[d], dic2[d-1])
                dic2[d][2] = dic2[d-1][2]+dic2[d][2]
            if dic2[d][1] == ' ' and len(re.findall('\d+\-\d+\-\d+', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()) >= 2:
                print('if date and code together in 0th index')
                text = dic2[d][0]
                matchdate = re.search(r'\d+\-\d+\-\d+',text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(),'')


            if len(dic2[d][3].split())==2 and dic2[d].count(' ')<=2:
                print("spliting rate and qty",dic2[d])
                a,b=dic2[d][3].split()
                dic2[d][3]=a
                dic2[d][4]=b
            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Patil_N16418':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print("deee", dic2[d])
            if d > 1 and dic2[d][0] in head_list and dic2[d].count(' ') <= 3 and dic2[d - 1][3] != sbt:
                listnw = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic2[d][0] = dic2[d][0].lower()
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'apollo_N18424':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] == 'Admission Charge':
                dic2[d + 1][1] = 'Admission Charge'
            if dic2[d][0] == 'General Registration':
                dic2[d + 1][1] = 'General Registration'
            if 'Package (From' in dic2[d][0]:
                dic2[d][0] = 'Package'
            if len(re.findall('^\d{1,2}\s', dic2[d][0])) == 1:
                print('removing sno', dic2[d])
                dic2[d][0] = re.sub('^\d{1,}\s', '', dic2[d][0])
            if dic2[d][0]!=' ' and len(re.findall('\d{2}\-\d{2}\-\d{4}', dic2[d][0])) == 1 and len(dic2[d][0].split()[0]) >= 2 and \
                    dic2[d][0] not in head_list and dic2[d][1] == ' ':
                print('if date and description in 0th indx', dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\d{1,2}\-\d{2}\-\d{4}', text)
                dic2[d][0] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(), '').strip()
            if dic2[d][0]!=' ' and len(re.findall('\d{2}\-\d{2}\-\d{4}', dic2[d][1])) == 1 and len(dic2[d][0].split()[0]) >= 2 and \
                    dic2[d][0] not in head_list and dic2[d][1] != ' ':
                print('if date and description', dic2[d])
                text = dic2[d][1]
                matchcode = re.search(r'\d{1,2}\-\d{2}\-\d{4}', text)
                dic2[d][0] = matchcode.group()
                # dic2[d][0]=' '
                dic2[d][1] = text.replace(matchcode.group(), '')
            if dic2[d][0]!=' ' and len(re.findall('\d{2}\-\d{2}\-\d{4}', dic2[d][0])) == 1 and len(dic2[d][0].split()[0]) >= 2 and \
                    dic2[d][0] not in head_list and dic2[d][1] != ' ':
                print('if date and description', dic2[d])
                text = dic2[d][0]
                matchcode = re.search(r'\d{1,2}\-\d{2}\-\d{4}', text)
                dic2[d][0] = matchcode.group()
                # dic2[d][0]=' '
                # dic2[d][1] = text.replace(matchcode.group(), '')
            if len(dic2[d][5].split()) == 2 and dic2[d].count(" ") <= 3:
                print('removal', dic2[d])
                a, b = dic2[d][5].split()
                dic2[d][5] = a
            if len(dic2[d][5].split()) == 3 and dic2[d].count(" ") <= 3:
                print('removal', dic2[d])
                a, b, c = dic2[d][5].split()
                dic2[d][5] = a
                # dic2[d][3]=b
            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd11==', dic2[d])

            
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'motherhood_N17272':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][0] == 'Administration Charges Charges':
                dic2[d][0] = 'Administration Charges'
            if dic2[d][1].__contains__('SURGEON FEE IN PACKAGE'):
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = ['SURGEON FEE', ' ', ' ', ' ', ' ', ' ']
            if dic2[d][2].__contains__('Return '):
                dic2[d][2] = dic2[d][2].replace('Return ', '')
            if (len(re.findall('\d+\/\d{2}\/\d+\D?\d?\s\d+\:\d+\:\d+\s\D\s\w+\/\d+\s\w+', dic2[d][0]))):
                print('date particular merge2', dic2[d])
                text = dic2[d][0]
                matchdate = re.search(r'\d+\/\d{2}\/\d+\D?\d?\s\d+\:\d+\:\d+', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), "")
            if (len(re.findall('\d+\/\d{2}\/\d{4}\s\d+\:\d+\:\d+\s\D\s\w+\/\d+\s\w+', dic2[d][0]))):
                print('date particular merge2', dic2[d])
                text = dic2[d][0]
                matchdate = re.search(r'\d+\/\d{2}\/\d{4}\s\d+\:\d+\:\d+', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), "")
            if (len(re.findall('\d+\/\d{2}\/\d{4}\s?\d{2}\:\d{2}\s?\-\s?\w{4}\/\d{6}', dic2[d][0])) == 1 or len(
                    re.findall('\d+\/\d{2}\/\d{4}\s?\d{2}\:\d{2}\s?\-\s?\w{8}\/\d{6}', dic2[d][0])) == 1 or len(
                re.findall('\d+\/\d{2}\/\d{4}\s?\d{2}\:\d{2}\s?\-\s?\w{8}\/\d{3}', dic2[d][0])) == 1) and dic2[
                d].count(' ') >= 1 and \
                    len(re.findall('\d\s?\.\s?\d', dic2[d][5])) == 1 and dic2[d][1] == ' ':
                print('date particular merge')
                text = dic2[d][0]
                if len(re.findall('\d+\/\d{2}\/\d{4}\s?\d{2}\:\d{2}\s?\-\s?\w{4}\/\d{6}', dic2[d][0])) == 1:
                    matchDate = re.search(r'\d+\/\d{2}\/\d{4}\s?\d{2}\:\d{2}\s?\-\s?\w{4}\/\d{6}', text)
                elif len(re.findall('\d+\/\d{2}\/\d{4}\s?\d{2}\:\d{2}\s?\-\s?\w{8}\/\d{6}', dic2[d][0])) == 1:
                    matchDate = re.search(r'\d+\/\d{2}\/\d{4}\s?\d{2}\:\d{2}\s?\-\s?\w{8}\/\d{6}', text)
                elif len(re.findall('\d+\/\d{2}\/\d{4}\s?\d{2}\:\d{2}\s?\-\s?\w{8}\/\d{3}', dic2[d][0])) == 1:
                    matchDate = re.search(r'\d+\/\d{2}\/\d{4}\s?\d{2}\:\d{2}\s?\-\s?\w{8}\/\d{3}', text)
                dic2[d][0] = matchDate.group()
                dic2[d][1] = text.replace(matchDate.group(), "")
                if dic2[d][1][0] == ' ':
                    print('remove 1st space')
                    dic2[d][1] = dic2[d][1].replace(dic2[d][1][0], '')
            if dic2[d][3] in dic2[d][2] and len(re.findall('\d\s?\.\s?\d', dic2[d][3])) == 1 and len(
                    re.findall('\d\s?\.\s?\d', dic2[d][2])) == 2:
                print('if qty is present 2 times (with rate and in qty)')
                dic2[d][3] = ' '
            if len(re.findall('\d+\/\d+\/\d+\s\d+\:\d+\D?\s?\d+\s\D\s\w+\/\w+\D?\d+\s\w+', dic2[d][0])):
                print('date particular merge3', dic2[d])
                text = dic2[d][0]
                matchdate = re.search(r'\d+\/\d{2}\/\d{4}\s\d+\:\d+\D?\s?\d+', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), "")
            if (len(re.findall('\d+\/\d{2}\/\d+\D?\d?\s\d+\:\d+\s\D\s\w+', dic2[d][0]))):
                print('date particular', dic2[d])
                text = dic2[d][0]
                matchdate = re.search(r'\d+\/\d{2}\/\d+\D?\d?\s\d+\:\d+', text)
                dic2[d][0] = matchdate.group()
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'billroth_N2259':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            # if dic2[d][0]=='RSING CARE CHARGES':
            #     dic2[d][0]='NURSING CARE CHARGES'
            if dic2[d][1] == 'ORATORY INVESTIGATIONS':
                dic2[d][1] = 'LABORATORY INVESTIGATIONS'
            # if dic2[d][1]=='IALYSIS':
            # dic2[d][1]='DIALYSIS'
            # if dic2[d][1] == 'OM RENT':
            # dic2[d][1]='ROOM RENT'
            if dic2[d][1] == 'PHYSIOTHERAPY' and dic2[d][5] != ' ':
                dic2[d][1] = 'physiotherapy'
            if len(re.findall('\w{2}\:\w{2}\:\w{2}\s?\)', dic2[d][1])) == 1 and dic2[d].count(' ') == 4:
                print('merggee', dic2[d])
                dic2[d - 1][1] = dic2[d - 1][1] + dic2[d][1]
                dic2[d][1] = ' '
            for i in head_list:
                if i == dic2[d][1]:
                    dic2[d][0] = i
                    dic2[d][1] = ' '
                    print('dd00=======', dic2[d][1])
            if dic2[d].count(' ') == 5 and len(re.findall('\d\.\d', dic2[d][5])) == 1:
                dic2[d][5] = ' '
            # if dic2[d].count(' ') == 5 and dic2[d][1] not in head_list:
            #     dic2[d][1] = ' '
            #     print('rooom rent', dic2[d])
            if dic2[d][1]!=' ' and dic2[d][0]==' ' and dic2[d].count(' ')==5:
                dic2[d][0]=dic2[d][1]
                dic2[d][1]=' '
            if len(re.findall('\d{2}\s\w{3}\s\d{4}', dic2[d][0])) == 1 and dic2[d][1]== ' ' and len(dic2[d][0].split())>3:
                print('if date and particulars merge')
                text = dic2[d][0]
                matchdate = re.search(r'\d{2}\s\w{3}\s\d{4}',text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(),'')
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'gurushree_N3308':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if d > 1 and d < len(dic2) and dic2[d][0] in head_list and dic2[d][0] == dic2[d + 1][0] and dic2[d].count(
                    ' ') == 5 and dic2[d + 1].count(' ') == 3:
                print('if header and line item are same adding s to line item')
                dic2[d + 1][0] = dic2[d][0] + 's'

            if dic2[d][0].__contains__("Private NonAC") and dic2[d][4] == ' ' and dic2[d][5] == ' ':
                dic2[d][4] = dic2[d + 1][4]
                dic2[d + 1][4] = ' '

                dic2[d][5] = dic2[d + 1][5]
                dic2[d + 1][5] = ' '

                dic2[d + 1][0] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Relife_N7895':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:

            if len(re.findall('\d+\s\D+', dic2[d][4])) and dic2[d].count(' ') >= 2:
                print('to remove extra value', dic2[d])
                text = dic2[d][4]
                matchsno = re.search(r'\D+', text)
                dic2[d][4] = text.replace(matchsno.group(), '')

            dic1[lq] = dic2[d]
            lq += 1
    return dic1
def peronailse_at_merge(dic1,src_dc,head_list,sbt,noc,hospital):
    sub_head=src_dc['merge_set']
    if hospital=='aig':
        dic1_a=dic1
        la=1
        dic1={}
        f =0
        try:
            for d in dic1_a:  
                f +=1
                sl=''
                sl1=''
                if  dic1_a[d].count(' ') ==6 and  len(re.findall('PACKAGE FROM \d{2}\-\d{2}\-\d{4}',dic1_a[d][0]))==1:
                    dic1_a[d].pop(0)
                    dic1_a[d].insert(0,'PACKAGE Details')   
                
                if f>3 and len(re.findall('\d{2}\-\d{2}\-\d{4}',dic1_a[d][1]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][5]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][6]))==1 and len(dic1_a[d-1][5].strip())==0 and len(dic1_a[d-1][6].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-2][5]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-2][6]))==1:
                    print('ghjghj',dic1_a[d-1],dic1_a[d])
                    new_l=copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))   
                    dic1[la-1]=new_l
                    # la +=1
                    continue
                if f>3 and dic1_a[d][0] in head_list and dic1_a[d].count(' ')==6 and sl.join(dic1_a[d-1]).__contains__(sbt)==False and sl1.join(dic1_a[d-2]).__contains__(sbt)==False:
                    print('aig_sbt_issue_put679g') 
                    nevv = copy.deepcopy(dic1_a[d-1])
                    nevv.pop(5)
                    nevv.insert(5,sbt)
                    dic1[la-1]=nevv
                dic1[la]=dic1_a[d]
                dic1[la]=dic1_a[d]
                la +=1
        except:
            print('Aig_issue_at_per+merge_gy764edt')
    if hospital == 'amri':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d\/\d{2}\/\d', dic2[d][0])):
                print('extra', dic2[d])
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if len(dic2[d][1].split())==2:
                a,b=dic2[d][1].split()
                dic2[d][1]=b


            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='fortis'  or hospital == 'fortis1':
        dic1_a=dic1
        
        la=1
        dic1={}
        f =0
        fn=len(dic1_a)
        for d in dic1_a:  
            f +=1
            ss=''
            if f>2 and f<fn and dic1_a[d][0] in head_list and ss.join(dic1_a[d-1]).__contains__(sbt) and dic1_a[d][1].count(' ')<8 and dic1_a[d+1][1].count(' ')==8:

                print('ghjghj',dic1_a[d-1],dic1_a[d])
                # new_l=copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))   
                # dic1[la-1]=new_l
                # # la +=1
                # continue
            dic1[la]=dic1_a[d]
            la +=1
    
    if hospital=='manipal':
        dic1_a=dic1
        la=1
        dic1={}
        lasta=[]
        f=1
        for d in dic1_a:
            sw=''
            f +=1
            if f>4 and ((len(re.findall('\d\.\d',dic1_a[d][5]))>=1 or len(re.findall('\d\.\d',dic1_a[d][3]))>=1) and len(dic1_a[d][0])==1 and len(dic1_a[d][1])>2) and (dic1_a[d-1].count(' ')>=3 and len(re.findall('\d\.\d',dic1_a[d-1][5]))==0  and dic1_a[d-2].count(' ')>=3 and len(re.findall('\d\.\d',dic1_a[d-2][5]))==0):
                print('aaaaa',dic1_a[d])
                lh1=dic1_a[d][:2]
                lh2=dic1_a[d][2:]
                lh1.insert(2,' ')
                lh1.insert(2,' ')
                lh1.insert(2,' ')
                lh1.insert(2,' ')
                lh1=copy.deepcopy(lh1)
                dic1[la]=lh1
                la +=1
                lh2.insert(0,' ')
                lh2.insert(0,' ')
                lh2=copy.deepcopy(lh2)
                dic1[la]=lh2
                la +=1
                print('bbbbbb',lh1,lh2)
                continue
            elif f>4 and ((len(re.findall('\d\.\d',dic1_a[d][5]))>=1 or len(re.findall('\d\.\d',dic1_a[d][3]))>=1) and len(dic1_a[d][0])==1 and len(dic1_a[d][1])>2) and (dic1_a[d-1].count(' ')>=3 and len(re.findall('\d\.\d',dic1_a[d-1][5]))==0 and sw.join(dic1_a[d-1]).__contains__('SAC')==False):
                print('cccccc',dic1_a[d])
                lh1=dic1_a[d][:2]
                lh2=dic1_a[d][2:]
                lh1.insert(2,' ')
                lh1.insert(2,' ')
                lh1.insert(2,' ')
                lh1.insert(2,' ')
                lh1=copy.deepcopy(lh1)
                dic1[la]=lh1
                la +=1
                lh2.insert(0,' ')
                lh2.insert(0,' ')
                lh2=copy.deepcopy(lh2)
                dic1[la]=lh2
                la +=1
                print('dddddd',lh1,lh2)
                continue
            dic1[la]=dic1_a[d]
            lasta=dic1_a[d]
            la +=1
        dic1_a=dic1
        la=1
        dic1={}
        f=1
        proper_box = 2
        print('now_at_manipal_merge_222',head_list)
        for d in dic1_a:
            f +=1
            if 'SAC' in str(dic1_a[d][0]+' '+dic1_a[d][1]) and dic1_a[d][2:].count(' ')==4:
                print('this_i_found_spl222_headddd22',dic1_a[d])
                proper_box = 0
            if sbt in dic1_a[d][4]:
                print('this_i_found_spl222_sbttt22',dic1_a[d])
                proper_box = 1    
            dic1[la]=dic1_a[d]
            la +=1
        print(proper_box,'opopopopopopopop',head_list)
        try:
            if proper_box==0:
                fn= len(dic1)
                print('kkkkkkllll',fn,dic1[fn])
                ndvv = copy.deepcopy(dic1[fn])
                if sbt not in ndvv[4]:
                    dic1[fn+1] = [' ', ' ', ' ', ' ', 'Sub Total:', ' ']
        except:
            print('last_section_sbt_missing_manipal_097uygty') 
        
        dic1_a=dic1
        la=1
        dic1={}
        f=1
        for d in dic1_a:
            f +=1
            if f>2 and 'SAC' in dic1_a[d][1] and dic1_a[d][2:].count(' ')==4 and len(dic1_a[d][0].strip())==0 and len(re.findall('\d{1,2}',dic1_a[d-1][0]))==1 and dic1_a[d-1][1:].count(' ')==5:
                print('nnnnnnnnoooooooouuuuuu',dic1_a[d-1],dic1_a[d])
                dic1[la-1]=opr1(dic1_a[d-1],dic1_a[d],src_dc)
                continue
            dic1[la]=dic1_a[d]
            la +=1
        for d in dic1:
            print('ee9_okokokok',dic1[d])

    if hospital=='fortisjindal':
        dic1_a=dic1
        la=1
        dic1={}
        f=1
        for d in dic1_a:
            sw=''
            f +=1
            if f>3 and len(dic1_a[d][0])>5 and len(dic1_a[d][2])>5 and len(re.findall('\d{0,2}\/\d{2}\/\d{4}',dic1_a[d][0]))==1 and len(dic1_a[d][3].strip())==0 and len(dic1_a[d][5].strip())==0  and len(dic1_a[d-1][3].strip())>2 and len(dic1_a[d-1][5].strip())>2 and len(dic1_a[d-1][0].strip())==0 and len(dic1_a[d-1][2].strip())==0 and sw.join(dic1_a[d]).__contains__(sbt)==False and sw.join(dic1_a[d-1]).__contains__(sbt)==False:
                print('jjjjjj',dic1_a[d])
                dic1[la-1]=opr1(dic1_a[d-1],dic1_a[d],src_dc)
                continue
            dic1[la]=dic1_a[d]
            lasta=dic1_a[d]
            la +=1
    if hospital=='artemis':
        # for d in dic1:
        #     print('gggg',dic1[d])
        print('ffffoooo')
        dic1_a=dic1
        la=1
        dic1={}
        f=1
        for d in dic1_a:
            sw=''
            f +=1
            if f>2 and dic1_a[d-1][0].__contains__('Subtotal') and dic1_a[d-1][1:].count(' ')==5 and len(dic1_a[d][0].strip())==0 and len(re.findall('^Subtotal',dic1_a[d][1]))==1 and dic1_a[d][2:5].count(' ')==3 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][5]))==1:
                print('jjjjjj_ttt',dic1_a[d-1])                 
                dic1[la-1]=opr1(dic1_a[d-1],dic1_a[d],src_dc)
                continue
            dic1[la]=dic1_a[d]
            lasta=dic1_a[d]
            la +=1    
    if hospital=='max' or hospital == 'nanavati':
        
        dic1_a=dic1
        la=1
        dic1={}
        f=1
        fn=len(dic1_a)
        for d in dic1_a:
            # print('mlineee',dic1_a[d])
            f +=1
            sw='' 
            if f>3 and f<fn and dic1_a[d][0].strip().title() in ['Consultation'] and  dic1_a[d].count(' ')==noc-1 and sw.join(dic1_a[d+1]).__contains__(sbt)==True and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][3]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][5]))==1 and len(dic1_a[d-1][0])>10:
                tnbs1=copy.deepcopy(dic1_a[d][0])
                tnbs=tnbs1+')'
                dic1_a[d].pop(0)
                dic1_a[d].insert(0,tnbs)

            if f>3 and dic1_a[d][1].__contains__('Sub Total') and len(dic1_a[d][0].strip())>1:
                print('ywywywy',dic1_a[d])
                tpr0=dic1_a[d][0]
                tpr1=dic1_a[d-1][0]+' '+dic1_a[d][0]
                dic1_a[d-1].pop(0)
                dic1_a[d-1].insert(0,tpr1)
                dic1[la-1]=dic1_a[d-1]
                dic1_a[d].pop(0)
                dic1_a[d].insert(0,' ')
            if f>2 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][3]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][5]))==1 and len(dic1_a[d-1][3])==1 and len(dic1_a[d-1][5])==1 and dic1_a[d][1].__contains__('Sub Total')==False and len(dic1_a[d][0].strip())==0 and len(re.findall('\d{3}\s?\d{3}',dic1_a[d-1][0]))==1:
                print('ywywywy11',dic1_a[d-1],dic1_a[d])
                dic1[la-1]=opr1(dic1_a[d-1],dic1_a[d],src_dc)
                continue    
            dic1[la]=dic1_a[d]
            la +=1
        dic1_a=dic1
        la=1
        dic1={}
        fn=len(dic1_a)
        f=1
        for d in dic1_a:
            # print('dddd',dic1_a[d])
            ss=''
            f +=1
            
            if f>2 and f+1<fn and (len(re.findall('\d\/\d?\d\/\d{4}|\d\/\d?\d\/\d{2}\s\d{2}',dic1_a[d][1]))==1 or len(re.findall('\d\s?\.\s?\d',dic1_a[d][3]))==1) and len(re.findall('\d\s?\.\s?\d',dic1_a[d][5]))==1 and len(dic1_a[d][0])>1:
                if ss.join(dic1_a[d-1]).__contains__('Sub Total') and (ss.join(dic1_a[d+1]).__contains__('Sub Total') or ss.join(dic1_a[d+2]).__contains__('Sub Total')):
                    print('ououou1',dic1_a[d])
                    dic1[la]=['HEAD_PKG',' ',' ',' ',' ',' ']
                    la +=1

            if f>2 and f<fn and len(re.findall('Medical Consumables|/J Stent Removal',dic1_a[d][0]))==1 and len(re.findall('\(?100%\)?',dic1_a[d+1][0]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][5]))==1:
                print('ououou_bbbb',dic1_a[d])
                if ss.join(dic1_a[d-1]).__contains__('Sub Total') and (ss.join(dic1_a[d+1]).__contains__('Sub Total') or ss.join(dic1_a[d+2]).__contains__('Sub Total')):
                    print('ououou',dic1_a[d])
                    dic1[la]=['HEAD_PKG',' ',' ',' ',' ',' ']
                    la +=1

            if f>2 and f<fn and len(re.findall('ADHESIONYSIS \(?Lap\)?',dic1_a[d-1][0]))==1 and len(re.findall('\(?100%\)?',dic1_a[d][0]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][5]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][3]))==1 and dic1_a[d].count(' ')>=3 and dic1_a[d-1].count(' ')==5:
                print('ououou_dddd',dic1_a[d])
                last_l=copy.deepcopy(dic1_a[d-1])
                one_l=dic1_a[d-1][0]+' '+dic1_a[d][0]
                last_l.pop(0)
                last_l.insert(0,one_l)
                dic1[la-1]=last_l
                dic1_a[d].pop(0)
                dic1_a[d].insert(0,' ')
                dic1_a[d].pop(1)
                dic1_a[d].insert(0,'Sub Total')
            if f>3 and f<fn and len(re.findall('\d\s?\.\s?\d',dic1_a[d][3]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][5]))==1 and dic1_a[d].count(' ')==4 and dic1_a[d+1][0] in head_list and  len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][3]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][5]))==1 and dic1_a[d-1].count(' ')<3:
                print('ououou_cccc',dic1_a[d])
                dic1_a[d].pop(1)
                dic1_a[d].insert(1,'Sub Total')
            dic1[la]=dic1_a[d]
            la +=1
        sk_l=0
        dic1_a=dic1
        la=1
        dic1={}
        f=1
        fn=len(dic1_a)
        for d in dic1_a:
            if sk_l==1:
                sk_l=0
                continue
            sw=''
            f +=1
            if f>3 and dic1_a[d-1][0] in head_list and dic1_a[d-1].count(' ')==5 and len(re.findall('\d\d?\s\d{4}',dic1_a[d][0]))==1 and len(dic1_a[d][5].strip())==0 and len(dic1_a[d+1][0].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic1_a[d+1][5]))==1:
                print('jjjjjj',dic1_a[d],dic1_a[d+1])
                dic1[la]=opr1(dic1_a[d],dic1_a[d+1],src_dc)
                la +=1
                sk_l=1
                continue
            if f>3 and len(re.findall('\d{3,6}',dic1_a[d-1][0]))==1 and len(dic1_a[d][0].strip())==0 and dic1_a[d-1].count(' ')<=4 and len(dic1_a[d-1][3])==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][3]))==1 and len(dic1_a[d-1][5].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][5]))==1: 
                print('yyyyuuuuww',dic1_a[d-1],dic1_a[d])
                dic1_a[d-1].pop(3)
                dic1_a[d-1].insert(3,' ')
                dic1[la-1]=opr1(dic1_a[d-1],dic1_a[d],src_dc)
                continue
            if f>3 and len(re.findall('\d\d?\/\d\d?\/\d{4}',dic1_a[d-1][1]))==1 and len(dic1_a[d][1].strip())==0 and dic1_a[d-1].count(' ')<=4 and len(dic1_a[d-1][3])==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][3]))==1 and len(dic1_a[d-1][5].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][5]))==1: 
                print('yyyyuuuuww11',dic1_a[d-1],dic1_a[d])
                dic1_a[d-1].pop(3)
                dic1_a[d-1].insert(3,' ')
                dic1[la-1]=opr1(dic1_a[d-1],dic1_a[d],src_dc)
                continue
            dic1[la]=dic1_a[d]
            lasta=dic1_a[d]
            la +=1

        dic1_a=dic1
        la=1
        dic1={}
        f=1
        fn=len(dic1_a)
        for d in dic1_a:
            # print('mlineee',dic1_a[d])
            f +=1
            sw='' 
            if f>2 and f<fn and dic1_a[d+1][0] in head_list and dic1_a[d+1].count(' ')==5 and dic1_a[d][1]=='Total' and len(re.findall('\d\s?\.\s?\d',dic1_a[d][3]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][5]))==1:
                print('uuuuuu',dic1_a[d])
                dic1_a[d].pop(1)
                dic1_a[d].insert(1,'Sub Total')
            dic1[la]=dic1_a[d]
            la +=1
    if hospital=='yashoda-pharma' or hospital == 'yashodamalakpet_N3060-pharma':
        dic1_a=dic1
        la=1
        dic1={}
        for d in dic1_a:
            if dic1_a[d][0].__contains__('Item Returns'): 
                dic1[la]=[' ','Sub Total',' ',' ',' ',' ']
                la +=1
            dic1[la]=dic1_a[d]
            la +=1
        dic1[la]=[' ','Sub Total',' ',' ',' ',' ']
        
    if hospital=='ruby':
        dic1_a=dic1
        la=1
        dic1={}
        temp_head=''
        for d in dic1_a:
            if dic1_a[d][0] in head_list:    
                if temp_head==dic1_a[d][0]:
                    print('jjjj',temp_head)
                    continue
                else:
                    temp_head=dic1_a[d][0]
                print('kkkk',temp_head,'---',dic1_a[d][0],'---',temp_head==dic1_a[d][0])
            dic1[la]=dic1_a[d]
            la +=1

        dic1_a=dic1
        la=1
        dic1={}
        f=1
        for d in dic1_a:
            f +=1
            if f>2 and dic1_a[d][0] in head_list:
                dic1[la]=[' ',' ','Subtotal',' ',' ',' ']
                la +=1
            dic1[la]=dic1_a[d]
            la +=1
        dic1[la]=[' ',' ','Subtotal',' ',' ',' ']


    if hospital=='srch-pharma':
        dic1_a=dic1
        la=1
        dic1={}
        f=1
        last_it=[]
        for d in dic1_a:
            f +=1
            ss =''
            if f>3 and dic1_a[d][0] in head_list and ss.join(dic1_a[d-1]).__contains__('Subtotal')==False:
                dic1_a[d-1].pop(1)
                dic1_a[d-1].insert(1,'Subtotal')
                dic1[la-1]=copy.deepcopy(dic1_a[d-1])
            dic1[la]=dic1_a[d]
            last_it=dic1_a[d]
            la +=1
        last_it.pop(1)
        last_it.insert(1,'Subtotal')
        dic1[la-1]=last_it

        dic1_a=dic1
        la=1
        dic1={}
        f=1
        for d in dic1_a:
            f +=1
            ss =''
            try:
                if len(dic1_a[d][5].strip())==0 and len(dic1_a[d][4].strip())>10 and len(dic1_a[d][4].split())>=2:
                    if re.sub('[,.]','',dic1_a[d][4].split()[0]).isdigit()==True and re.sub('[,.]','',dic1_a[d][4].split()[1]).isdigit()==True:
                        print('do_correction_srch_pharma_at_mergeddddd11111',dic1_a[d])
                        nevv = copy.deepcopy(dic1_a[d])
                        nvv_fr = dic1_a[d][4].split()[0]
                        nvv_fv = dic1_a[d][4].split()[1]
                        nevv.pop(4)
                        nevv.insert(4,nvv_fr)
                        nevv.pop(5)
                        nevv.insert(5,nvv_fv)
                        dic1[la]=nevv
                        la +=1
                        continue
                if len(dic1_a[d][5].strip())>2 and len(dic1_a[d][4].strip())>2 and len(dic1_a[d][3].strip())==0 and len(dic1_a[d][2].strip())>7 and len(dic1_a[d][2].split())>=2:
                    print('do_correction_srch_pharma_at_mergeddddd22222',dic1_a[d])
                    nevv = copy.deepcopy(dic1_a[d])
                    nvv_fr = dic1_a[d][2].split()[0]
                    nvv_fv = dic1_a[d][2].split()[1]
                    nevv.pop(2)
                    nevv.insert(2,nvv_fr)
                    nevv.pop(3)
                    nevv.insert(3,nvv_fv)
                    print('do_correction_srch_pharma_at_mergeddddd22222_nowww',nevv)
                    dic1[la]=nevv
                    la +=1
                    continue
                if len(dic1_a[d][5].strip())>2 and len(dic1_a[d][4].strip())>2 and len(dic1_a[d][3].strip())==0 and len(dic1_a[d][2].strip())>7 and len(dic1_a[d][2].split('('))>=2:
                    print('do_correction_srch_pharma_at_mergeddddd22222_3333',dic1_a[d])
                    nevv = copy.deepcopy(dic1_a[d])
                    nvv_fr = dic1_a[d][2].split('(')[0]
                    nvv_fv = dic1_a[d][2].split('(')[1]
                    nevv.pop(2)
                    nevv.insert(2,nvv_fr)
                    nevv.pop(3)
                    nevv.insert(3,nvv_fv)
                    print('do_correction_srch_pharma_at_mergeddddd22222_3333_nowww',nevv)
                    dic1[la]=nevv
                    la +=1
                    continue
                if len(dic1_a[d][5].strip())>2 and len(dic1_a[d][4].strip())>2 and len(dic1_a[d][3].strip())==0 and len(dic1_a[d][2].strip())>7 and (len(dic1_a[d][2].split('('))==1 or len(dic1_a[d][2].split())==1):
                    if len(re.findall('\d?\d?\d?\d?\.\d\d',dic1_a[d][2]))==2:
                        
                        print('do_correction_srch_pharma_at_mergeddddd22222_3333_4444',dic1_a[d])
                        nevv = copy.deepcopy(dic1_a[d])
                        nvv_fr = re.findall('\d?\d?\d?\d?\.\d\d',dic1_a[d][2])[0]
                        nvv_fv = re.findall('\d?\d?\d?\d?\.\d\d',dic1_a[d][2])[1]
                        nevv.pop(2)
                        nevv.insert(2,nvv_fr)
                        nevv.pop(3)
                        nevv.insert(3,nvv_fv)
                        print('do_correction_srch_pharma_at_mergeddddd22222_3333_4444_nowww',nevv)
                        dic1[la]=nevv
                        la +=1
                        continue   
            except:
                print('error_at_srch_pharma_merged_ert6789')
            dic1[la]=dic1_a[d]
            la +=1


    if hospital=='sarvodaya-pharma' or hospital == 'Felix_N15239-pharma':
        dic1_a=dic1
        la=1
        dic1={}
        print('fffffggggghhhh')
        current_head=''
        for d in dic1_a:
            print('jjjjjeeeeee',dic1_a[d])
            if dic1_a[d][:3].count(' ')==3:
                # print('jjjjjeeeeee',dic1_a[d])
                continue
            if dic1_a[d][3]=='Medicine' and len(dic1_a[d][0])>1:
                dic1[la]=[dic1_a[d][0], ' ', ' ', ' ', ' ', ' ', ' ']
                la +=1
                continue
            if dic1_a[d][0].__contains__('Sales') and current_head=='':
                current_head='Sales'
                dic1[la]=['Sales', ' ', ' ', ' ', ' ', ' ', ' ']
                la +=1
                continue
            if dic1_a[d][0].__contains__('Sales') and current_head=='Sales':
                # dic1[la]=['Sales', ' ', ' ', ' ', ' ', ' ', ' ']
                # la +=1
                continue
            if dic1_a[d][0].__contains__('Return') and current_head=='Sales':
                current_head='Return'
                dic1[la]=[' ', ' ', ' ', 'Sub Total', ' ', ' ', ' ']
                la +=1
                dic1[la]=['Return', ' ', ' ', ' ', ' ', ' ', ' ']
                la +=1
                
                continue
            if dic1_a[d][0].__contains__('Return') and current_head=='Return':
                # dic1[la]=['Return', ' ', ' ', ' ', ' ', ' ', ' ']
                # la +=1
                continue
            dic1[la]=dic1_a[d]
            la +=1
        
        ld=len(dic1)
        dic1[ld+1]=[' ',' ',' ','Sub Total',' ',' ',' ']
    if hospital== 'sarvodaya3-pharma':
        dic1_a = dic1
        la = 1
        dic1 = {}
        f = 1
        fn = len(dic1_a)
        for d in dic1_a:
            #if len(re.findall('\d\s?\.\s?\d',dic1_a[d][3])) and len(re.findall('\d\s?\.\s?\d',dic1_a[d][5])) and len(re.findall('\d\s?\.\s?\d',dic1_a[d+1][5])) and len(re.findall('\w+',dic1_a[d+1][3])) and dic1_a[d+1].count(' ') == 4:
             if dic1_a[d][3] in sbt:
                 print('FGGG',dic1_a[d])
                 continue


             dic1[la] = dic1_a[d]
             la += 1
    # //////////////////////////
    if hospital=='yashoda' or hospital == 'yashodamalakpet_N3060':
        
        dic1_a=dic1
        la=1
        dic1={}
        for d in dic1_a:
            if dic1_a[d].count(' ')==6:
                continue
            if len(re.findall('^b Total',dic1_a[d][1]))==1 and dic1_a[d].count(' ')>3:
                print('this_i_found_spl222wwww',dic1_a[d])
                nfn = copy.deepcopy(dic1_a[d])
                nfn.pop(1)
                nfn.insert(1,'Sub Total')
                dic1[la]=nfn
                la +=1
                continue
            dic1[la]=dic1_a[d]
            la +=1

        dic1_a=dic1
        la=1
        dic1={}
        f=1
        print('now_at_yashoda_merge')
        for d in dic1_a:
            f +=1
            ss =''
            # print('this_i_found',dic1_a[d])
            if f>2 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][5]))==1 and (dic1_a[d].count(' ')==5 or len(ss.join(dic1_a[d][:5]).replace(',','').replace('.','').replace(' ',''))<2) and dic1_a[d-1].count(' ')==5 and dic1_a[d-1][1].__contains__('Sub Total'):
                # print('this_i_found_spl',dic1_a[d])
                new_l=copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))   
                dic1[la-1]=new_l
                continue
            try:
                if len(dic1_a[d][5])>3 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][5]))==2 and len(re.findall('\d\s?\.\d\d$',dic1_a[d][5]))==1:
                    lfv = copy.deepcopy(dic1_a[d][5])
                    lfv_lst =  re.findall('\d\s?\.\d\d$',lfv)[0]
                    print('double_dot_yashoda',dic1_a[d])
                    if len(re.split('.\d\d$',lfv))==2:
                        lfv_now = re.split('.\d\d$',lfv)[0].replace('.','')+ lfv_lst
                        dic1_a[d].pop(5)
                        dic1_a[d].insert(5,lfv_now)
                        print('double_dot_yashoda_noww',dic1_a[d])
                        dic1[la]=dic1_a[d]
                        la +=1
                        continue
            except:
                print('now_at_yashoda_merge_error11')
            dic1[la]=dic1_a[d]
            la +=1
        
        dic1_a=dic1
        la=1
        dic1={}
        f=1
        print('now_at_yashoda_merge_222_basic')
        for d in dic1_a:
            
            f +=1
            ss =''
            if f==2 and len(re.findall('[A-Z]+\s?[A-Z]+',dic1_a[d][0]))>=1 and len(dic1_a[d][0])>5 and dic1_a[d].count(' ')==5 and dic1_a[d][0] not in head_list:
                print('this_i_found_spl222_basic_first',dic1_a[d])
                head_list.append(dic1_a[d][0])
            
            dic1[la]=dic1_a[d]
            la +=1
        # print('opopopopopopopop11111',head_list)

        dic1_a=dic1
        la=1
        dic1={}
        f=1
        proper_box = 2
        print('now_at_yashoda_merge_222',head_list)
        for d in dic1_a:
            f +=1
            ss =''
            # print('this_i_found',dic1_a[d])
            if f>3 and dic1_a[d-1][1].__contains__(sbt) and dic1_a[d][0] not in head_list and len(dic1_a[d][0])>5 and dic1_a[d].count(' ')==5:
                print('this_i_found_spl222',dic1_a[d])
                head_list.append(dic1_a[d][0])
            if dic1_a[d][0] in head_list:
                print('this_i_found_spl222_headddd',dic1_a[d])
                proper_box = 0
            if sbt in dic1_a[d][1]:
                print('this_i_found_spl222_sbttt',dic1_a[d])
                proper_box = 1    
            dic1[la]=dic1_a[d]
            la +=1
        print(proper_box,'opopopopopopopop',head_list)
        try:
            if proper_box==0:
                fn= len(dic1)
                print('kkkkkkllll',fn,dic1[fn])
                ndvv = copy.deepcopy(dic1[fn])
                if sbt not in ndvv[1]:
                    dic1[fn+1] = [' ', 'Sub Total', ' ', ' ', ' ', ' ']
        except:
            print('last_section_sbt_missing_yashoda_097uygty') 
        for d in dic1:
            print('okokokok',dic1[d])       
           
    if hospital=='Sunshine':
        dic1_a=dic1
        dic1={}
        la=1
        f =0
        for d in dic1_a:
            f +=1
            if f>2 and len(dic1_a[d][0].strip())==0 and len(dic1_a[d-1][0].strip())>3 and len(dic1_a[d][1].strip())==0 and len(dic1_a[d-1][1].strip())>3 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][5]))==1 and len(dic1_a[d-1][5].strip())==0:
                if len(dic1_a[d][4].strip())==0 and len(re.findall('^\*\s\d{2}',dic1_a[d][3]))==1 and len(re.findall('\d',dic1_a[d-1][3]))>=1:
                    print('sunshinnnnnn',dic1_a[d-1],dic1_a[d],len(dic1_a[d][4].strip())==0,len(re.findall('^\*\s\d{2}',dic1_a[d][3]))==1,len(re.findall('\d',dic1_a[d-1][3]))>=1)
                    nevv = copy.deepcopy(dic1_a[d])
                    nv_th = nevv[3].strip(' *')
                    nevv.pop(3)
                    nevv.insert(3,' ')
                    nevv.pop(4)
                    nevv.insert(4,nv_th)
                    print(nevv,'nevvvvvv')
                    newn = opr1(dic1_a[d-1],nevv,src_dc)
                    dic1[la-1]=newn
                    continue
            
            dic1[la]=dic1_a[d]
            la +=1 

    if hospital=='holy':

        dic1_a=dic1
        la=1
        dic1={}
        f=1
        fn=len(dic1_a)

        hdl_now = ['ANAESTHESIA CHARGES']
        hdl_now_one = ['SUPPLIES (WARD DISPOSABLES)','OXYGEN','OT SUPPLIES(DISPOSABLES)','INVESTIGATIONS BEDSIDE','INSTRUMENTS & SPECIAL EQUIPMENTS','ECHOCARDIOGRAPHY','ECG','VENTILATOR','TREATMENT','PHYSICAL THERAPY','DIET FOR ATTENDANTS']
        for d in dic1_a:
            print('jjjllll',dic1_a[d])
            f +=1
            ss =''
            if f>2 and dic1_a[d][0] in hdl_now and len(re.findall('\d\d?\/\d{2}\/\d{4}',dic1_a[d-1][0]))==1 and dic1_a[d][1:].count(' ')==5:
                print('ffffkkkkooo',dic1_a[d-1],dic1_a[d])
                dic1[la] = [' ', ' ', ' ', 'TOTAL', ' ', ' ']
                la +=1
            if f>2 and dic1_a[d][0] in hdl_now_one and (len(re.findall('\d\d?\/\d{2}\/\d{4}',dic1_a[d-1][0]))==1 or dic1_a[d-1][0]=='SERVICES') and dic1_a[d][1:].count(' ')==5:
                print('ffffkkkkooo_pppp',dic1_a[d-1],dic1_a[d])
                nevv = copy.deepcopy(dic1_a[d])
                nvv_z = nevv[0].title()
                nevv.pop(0)
                nevv.insert(0,nvv_z)
                dic1[la] = nevv
                la +=1
                continue

            dic1[la]=dic1_a[d]
            la +=1

        dic1_a=dic1
        la=1
        dic1={}
        f=1
        fn=len(dic1_a)
        for d in dic1_a:
            f +=1
            ss =''
            if f>3 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-2][5]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][5]))==1 and dic1_a[d-1][:-1].count(' ')==5 and (dic1_a[d][1:].count(' ')==5 or sbt in ss.join(dic1_a[d])):
                print('hhjjjkkggwwww11',dic1_a[d-2],dic1_a[d-1],dic1_a[d])
                nevv = copy.deepcopy(dic1_a[d])
                dic1[la-1]=nevv
                
                continue
            dic1[la]=dic1_a[d]
            la +=1

        dic1_a=dic1
        la=1
        dic1={}
        f=1
        fn=len(dic1_a)
        for d in dic1_a:
            f +=1
            ss =''
            if f>3 and f<fn and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d-1][0]))==1 and len(dic1_a[d-2][0].strip())==0 and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d][0]))==1 and dic1_a[d-2][:2].count(' ')>1 and dic1_a[d-2][3:].count(' ')<1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][5]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-2][5]))==1 and len(dic1_a[d][5].strip())==0:
                print('hhjjjkkgg',dic1_a[d-2],dic1_a[d-1],dic1_a[d])
                nevv = copy.deepcopy(dic1_a[d-1])
                linn1 = nevv[:3]+[' ', ' ', ' ']
                linn2 = [' ', ' ', ' '] + nevv[3:]
                print(linn1,linn2,'linnnnnnn')
                new_l1 = copy.deepcopy(opr1(dic1_a[d-2],linn1,src_dc)) 
                new_l2 = copy.deepcopy(opr1(linn2,dic1_a[d],src_dc)) 
                dic1[la-2]=new_l1
                dic1[la-1]=new_l2
                print(new_l1,new_l2,'linnnnnnn')
                # la +=1
                continue
            dic1[la]=dic1_a[d]
            la +=1
        
        dic1_a=dic1
        la=1
        dic1={}
        f=1
        fn=len(dic1_a)
        for d in dic1_a:
            f +=1
            ss =''
            # if f>2 and f<fn and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d-1][0]))==1 and len(dic1_a[d-2][0].strip())==0 and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d][0]))==1 and dic1_a[d-2][:2].count(' ')>1 and dic1_a[d-2][3:].count(' ')<1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][5]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-2][5]))==1 and len(dic1_a[d][5].strip())==0:
            if f>2 and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d][0]))==1 and len(dic1_a[d][1].strip())>=3 and  dic1_a[d][3:].count(' ')==3 and dic1_a[d-1][:2].count(' ')==2 and dic1_a[d-1][3:].count(' ')==0 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][5]))==1:

                print('hhjjjkkgg1111',dic1_a[d-1],dic1_a[d])
                new_l1 = copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))
                dic1[la-1]=new_l1
                continue
            
            if f>2 and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d][0]))==1 and dic1_a[d].count(' ')<=3 and dic1_a[d-1].count(' ')==5 and len(dic1_a[d][5].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][5]))==1:

                print('hhjjjkkgg1111444444',dic1_a[d-1],dic1_a[d])
                new_l1 = copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))
                dic1[la-1]=new_l1
                continue

            if f>2 and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d-1][0]))==1 and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d][0]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][5]))==2 and len(dic1_a[d][5].strip())==0:
                
                print('hhjjjkkgg11112222',dic1_a[d-1],dic1_a[d])
                
                nevv = copy.deepcopy(dic1_a[d-1])
                nevv1 = copy.deepcopy(dic1_a[d])
                if len(nevv[5].split())==2:
                    fv1,fv2=nevv[5].split()
                    nevv.pop(5)
                    nevv.insert(5,fv1)
                    nevv1.pop(5)
                    nevv1.insert(5,fv2)
                    
                    dic1[la-1]=nevv
                    dic1[la]=nevv1
                    la +=1
                    print(nevv,nevv1,'linnnnnnn33333')
                    continue
            dic1[la]=dic1_a[d]
            la +=1

        dic1_a=dic1
        la=1
        dic1={}
        f=1
        for d in dic1_a:
            f +=1
            if len(dic1_a[d][0])>15 and len(re.findall('\w\w?\/\d{2}\/\d{4}',dic1_a[d][0]))==1:
                nevv = copy.deepcopy(dic1_a[d])
                print(nevv,'linnnnnnn33333_ppppp')
                nvv_z = nevv[0]
                nvv_o = nevv[1]
                cgh_1 = re.findall('\w\w?\/\d{2}\/\d{4}',dic1_a[d][0])[0]
                cgh_2 = (nvv_z.replace(cgh_1,'').strip()+' '+nvv_o).strip()
                nevv.pop(0)
                nevv.insert(0,cgh_1)
                nevv.pop(1)
                nevv.insert(1,cgh_2)
                dic1[la] = nevv
                la +=1
                continue
            if len(re.findall('\d\s?\.\s?\d',dic1_a[d][3]))==2 and len(dic1_a[d][3].split())==2 and len(dic1_a[d][4].strip())==0 and len(dic1_a[d][2].strip())==0:
                # nevv = copy.deepcopy(dic1_a[d])
                if len(dic1_a[d][3].split())==2 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][3].split()[0]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][3].split()[1]))==1:
                    nevv = copy.deepcopy(dic1_a[d])
                    # print(nevv,'linnnnnnn33333_qqqqqqq')
                    cgh_1,cgh_2 = dic1_a[d][3].split()
                    print(nevv,'linnnnnnn33333_qqqqqqq',cgh_1,cgh_2)
                    nevv.pop(3)
                    nevv.insert(3,cgh_1)
                    nevv.pop(4)
                    nevv.insert(4,cgh_2) 
                    print(nevv,'linnuuuuuuu33_qqqqqqq',cgh_1,cgh_2)
                    dic1[la] = nevv
                    la +=1
                    continue
            # print(dic1_a[d],'linnnnnnn33333_qqqqqqq_RRRRRRRRRRR')
            if len(re.findall('\d\s?\.\s?\d',dic1_a[d][3]))==2 and len(dic1_a[d][3].split())==2 and len(dic1_a[d][5].strip())==0 and len(dic1_a[d][2].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][4]))==1:
                # nevv = copy.deepcopy(dic1_a[d])
                if len(dic1_a[d][3].split())==2 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][3].split()[0]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][3].split()[1]))==1:
                    nevv = copy.deepcopy(dic1_a[d])
                    # print(nevv,'linnnnnnn33333_qqqqqqq')
                    cgh_1,cgh_2 = dic1_a[d][3].split()
                    cgh_3 = nevv[4]
                    print(nevv,'linnnnnnn33333_qqqqqqq',cgh_1,cgh_2,cgh_3)
                    nevv.pop(3)
                    nevv.insert(3,cgh_1)
                    nevv.pop(4)
                    nevv.insert(4,cgh_2) 
                    nevv.pop(5)
                    nevv.insert(5,cgh_3) 
                    print(nevv,'linnuuuuuuu33_qqqqqqq',cgh_1,cgh_2,cgh_3)
                    dic1[la] = nevv
                    la +=1
                    continue
            dic1[la]=dic1_a[d]
            la +=1

    if hospital=='Bethany':
        dic1_a=dic1
        dic1={}
        la=1
        f =0
        print(sub_head,'ooopppppjjjjj',type(sub_head))
        for d in dic1_a:
            f +=1
            try:
                if f>2 and len(dic1_a[d][2].strip())>3 and dic1_a[d].count(' ')==5:
                    print('bethnyyyy111',dic1_a[d-1],dic1_a[d])
                    new_l=copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))  
                    dic1[la-1] = new_l
                    continue
                if len(re.findall('\d\s?\.\s?\d',dic1_a[d][3]))>=2 and len(re.findall('\d\d?\-\d{2}\-\d{4}',dic1_a[d][0]))==1 and len(dic1_a[d][3].split())>2:
                    nevv = copy.deepcopy(dic1_a[d])
                    # print('hiottt',re.split('\d\s?\.\s?\d',dic1_a[d][3]),dic1_a[d][3])
                    nvv_z = dic1_a[d][3].split()[0]
                    nevv.pop(3)
                    nevv.insert(3,nvv_z) 
                    dic1[la] = nevv
                    la +=1
                    continue
                if len(dic1_a[d][0].strip())>12 and len(re.findall('\d\d?\-\d{2}\-\d{4}',dic1_a[d][0]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][5]))==1:
                    print('hhhio9987',re.sub('\d\d?\-\d{2}\-\d{4}','',dic1_a[d][0]).strip(),re.split('\d\d?\-\d{2}\-\d{4}',dic1_a[d][0])[0].strip())
                    nw_sbh = re.split('\d\d?\-\d{2}\-\d{4}',dic1_a[d][0])[0].strip()
                    if nw_sbh in sub_head:
                        dic1[la] = [nw_sbh, ' ', ' ', ' ', ' ', ' ']
                        la +=1
                        nvv_z = copy.deepcopy(dic1_a[d][0]).replace(nw_sbh,'').strip()
                        
                        dic1_a[d].pop(0)
                        dic1_a[d].insert(0,nvv_z)
                        
                        # print(nevv,'jjo087',la)
                        # dic1[la] = nevv
                        # la +=1
                        # continue
                #     # brk_the_loop = 0
                #     # for sbh in sub_head:
                #     #     if dic1_a[d][0].startswith(sbh):
                #     #         print('yehyyyi haiiii',la)
                #     #         dic1[la] = [sbh, ' ', ' ', ' ', ' ', ' ']
                #     #         la +=1
                #     #         print('yehyyyi haiiii_n',la)
                #     #         nevv = copy.deepcopy(dic1_a[d])
                #     #         nvv_z = nevv[0].replace(sbh,'').strip()
                #     #         nevv.pop(0)
                #     #         nevv.insert(0,nvv_z)
                #     #         print(nevv,'jjo087',la)
                #     #         dic1[la] = nevv
                #     #         la +=1
                #     #         brk_the_loop = 1
                #     #         print(nevv,'jjo087',la)
                #     #         break
                #     # if brk_the_loop == 1:
                #     #     print('i954eee',nevv)
                #     #     continue
            except:
                print('bethnyyyy111_hospital_merged_zeroandfirst_cell_error_tyu8943d58',dic1_a[d])
            # print(la,'i954ee33333e',dic1_a[d])
            dic1[la]=dic1_a[d]
            la +=1 
        # for d in dic1:
        #     print('hddddddiii',dic1[d])
    
    if hospital=='Batra':
        dic1_a=dic1
        dic1={}
        la=1
        f =0
        for d in dic1_a:
            f +=1
            try:
                if len(dic1_a[d][1].strip())<6 and len(dic1_a[d][0].strip())>20 and len(re.findall('\d\d?\/\d{2}\/\d{4}\s\-\s\d{2}\-\d{2}[A-Z]{2}\d{6,7}|\d\d?\/\d{2}\/\d{4}\s\-\s\d{2}\-\d{3}[A-Z]\d{6,7}',dic1_a[d][0]))==1:
                    print('batraaaaaaaa',re.findall('\d\d?\/\d{2}\/\d{4}\s\-\s\d{2}\-\d{2}[A-Z]{2}\d{6,7}|\d\d?\/\d{2}\/\d{4}\s\-\s\d{2}\-\d{3}[A-Z]\d{6,7}',dic1_a[d][0])[0],'-----',dic1_a[d])
                    nevv = copy.deepcopy(dic1_a[d])
                    nvv_z = copy.deepcopy(re.findall('\d\d?\/\d{2}\/\d{4}\s\-\s\d{2}\-\d{2}[A-Z]{2}\d{6,7}|\d\d?\/\d{2}\/\d{4}\s\-\s\d{2}\-\d{3}[A-Z]\d{6,7}',dic1_a[d][0])[0])
                    nvv_o = re.sub(re.findall('\d\d?\/\d{2}\/\d{4}\s\-\s\d{2}\-\d{2}[A-Z]{2}\d{6,7}|\d\d?\/\d{2}\/\d{4}\s\-\s\d{2}\-\d{3}[A-Z]\d{6,7}',dic1_a[d][0])[0],'',dic1_a[d][0])
                    nevv.pop(0)
                    nevv.insert(0,nvv_z.strip(' - '))
                    nevv.pop(1)
                    nevv.insert(1,nvv_o.strip(' - '))
                    dic1[la] = nevv
                    la +=1
                    continue
                # print('head-subhead-sameeee',dic1_a[d-1],dic1_a[d],dic1_a[d][0]==dic1_a[d-1][0],dic1_a[d][1:].count(' ')==5,dic1_a[d-1][1:].count(' ')==5,dic1_a[d-1][0] in head_list)
                if f>=2 and dic1_a[d][0]==dic1_a[d-1][0] and dic1_a[d][1:].count(' ')==5 and dic1_a[d-1][1:].count(' ')==5 and dic1_a[d-1][0] in head_list:
                    print('head-subhead-sameeee',dic1_a[d-1],dic1_a[d])
                    nevv = copy.deepcopy(dic1_a[d])
                    nev_z = nevv[0].title()
                    nevv.pop(0)
                    nevv.insert(0,nev_z)
                    dic1[la] = nevv
                    la +=1
                    continue
                if dic1_a[d][0]=='OT' and dic1_a[d][1:].count(' ')==5:
                    print('head-OTOTOT-sameeee',dic1_a[d])
                    nevv = copy.deepcopy(dic1_a[d])
                    nev_z = 'OT.'
                    nevv.pop(0)
                    nevv.insert(0,nev_z)
                    dic1[la] = nevv
                    la +=1
                    continue
            except:
                print('batara_hospital_merged_zeroandfirst_cell_error_ytyi87658')
            dic1[la]=dic1_a[d]
            la +=1 
  
    if hospital=='yashoda-2':
        dic1_a=dic1
        dic1={}
        la=1
        f =0
        for d in dic1_a:
            f +=1
            try: 
                if f>2 and len(dic1_a[d][0].strip())==0 and len(re.findall('\d\/\d{2}\/\d{4}',dic1_a[d-1][0]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][2]))==1 and dic1_a[d-1][3:].count(' ')==5 and len(dic1_a[d][2].strip())==0 and dic1_a[d][3:].count(' ')==0:
                    print('mmmmmmmmjjjjjjjj',dic1_a[d-1],dic1_a[d])
                    new_l = copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))   
                    dic1[la-1] = new_l
                    continue
            except:
                print('yashoda-222222_hospital_merged_zeroandfirst_cell_error_yt98uytt58')
            dic1[la]=dic1_a[d]
            la +=1

    if hospital=='yashoda-3':
        dic1_a = dic1
        la = 1
        dic1 = {}
        f = 1
        for d in dic1_a:
            f +=1
            try: 
                nevv = copy.deepcopy(dic1_a[d])
                if nevv[4].__contains__('/') or nevv[4].__contains__('"') or nevv[5].__contains__('/') or nevv[5].__contains__('"'):
                    nvv_t = nevv[4].replace('/','').replace('"','')
                    nvv_f = nevv[5].replace('/','').replace('"','')
                    print('yashodddgu84',nevv)
                    nevv.pop(4)
                    nevv.insert(0,nvv_t)
                    nevv.pop(5)
                    nevv.insert(5,nvv_f)
                    dic1[la] = nevv
                    la += 1
                    continue
            except:
                print('yashodddda-3333_error_wrtyyiree11_56gu842222')
            dic1[la] = dic1_a[d]
            la += 1

        dic1_a = dic1
        la = 1
        dic1 = {}
        f = 1
        fn=len(dic1_a)
        for d in dic1_a:

            f +=1
            
            try: 
                if f>2 and f<fn and dic1_a[d][0] not in head_list and dic1_a[d-1][2]=='Subtotal':
                    print('tgiihhhhhh1111',dic1_a[d])
                    nevv = copy.deepcopy(dic1_a[d-1])
                    nevv.pop(2)
                    nevv.insert(2,' ')
                    dic1[la-1] = nevv
            except:
                print('yashodddda-3333_error_wrtyyiree11_56gu842222')
            dic1[la] = dic1_a[d]
            la += 1

        dic1_a = dic1
        la = 1
        dic1 = {}
        f = 1
        for d in dic1_a:
            f +=1
            try:
                nevv = copy.deepcopy(dic1_a[d])
                nvv_z = nevv[0]
                nvv_o = nevv[1]
                if len(re.findall('^\(?\|?\d\d?\d?\-\w{3}\-\d{3}\d?',nvv_z))==1:
                    print('iiii_9999',re.findall('^\(?\|?\d\d?\d?\-\w{3}\-\d{3}\d?',nvv_z),nevv)
                    nvv_z = re.findall('^\(?\|?\d\d?\d?\-\w{3}\-\d{3}\d?',nvv_z)[0].strip('|').strip('(')
                    nvv_var = nevv[0].replace(nvv_z,'').strip(' ').strip('|').strip('-')
                    nvv_o  = (nvv_var + nvv_o).strip()
                    nevv.pop(0)
                    nevv.insert(0,nvv_z)
                    nevv.pop(1)
                    nevv.insert(1,nvv_o)
                    dic1[la] = nevv
                    la += 1
                    continue
            except:
                print('yashodddda-3333_error_while_cleaning_box11_56gu84')
            dic1[la] = dic1_a[d]
            la += 1

        dic1_a = dic1
        la = 1
        dic1 = {}
        f = 1
        fn = len(dic1_a)
        for d in dic1_a:
            print('pmdd33=', dic1_a[d])
            f += 1
            ss = ''
            if f > 3 and f < fn and len(re.findall('\w+', dic1_a[d][1])) and len(
                    re.findall('\d\s?\.\s?\d', dic1_a[d][5])) == 1 and dic1_a[d].count(' ') == 4 and dic1_a[d + 1][
                0] in head_list and dic1_a[d][1] != 'Subtotal':
                print('LLL', dic1_a[d])
                nevv = copy.deepcopy(dic1_a[d])
                linn = [' ', 'Subtotal', ' '] + nevv[3:]
                nevv.pop(5)
                nevv.insert(5, ' ')
                dic1[la] = nevv
                la += 1
                dic1[la] = linn
                la += 1
                continue
            if f > 3 and len(re.findall('\w+', dic1_a[d][1])) and len(re.findall('\d\s?\.\s?\d', dic1_a[d][5])) == 1 and \
                    dic1_a[d].count(' ') == 4 and len(re.findall('\d\s?\.\s?\d', dic1_a[d - 1][5])) and dic1_a[d][
                1] != 'Subtotal':
                print('PPP', dic1_a[d])
                nevv = copy.deepcopy(dic1_a[d])
                linn = [' ', 'Subtotal', ' '] + nevv[3:]
                nevv.pop(5)
                nevv.insert(5, ' ')
                dic1[la] = nevv
                la += 1
                dic1[la] = linn
                la += 1
                continue
            if d == len(dic1_a) and dic1_a[d][1] != 'Subtotal' and dic1_a[d][5] != ' ':
                print('for last line sbt')
                dic1_a[d - 1][1] = dic1_a[d - 1][1] + ' ' + dic1_a[d][1]
                dic1_a[d][1] = 'Subtotal'

            dic1[la] = dic1_a[d]
            la += 1

    
    # if hospital=='Batra':
    #     dic1_a=dic1
    #     dic1={}
    #     la=1
    #     f =0
    #     for d in dic1_a:
    #         f +=1
    #         try:
    #             if len(dic1_a[d][1].strip())<6 and len(dic1_a[d][0].strip())>20 and len(re.findall('\d\d?\/\d{2}\/\d{4}\s\-\s\d{2}\-\d{2}[A-Z]{2}\d{6,7}|\d\d?\/\d{2}\/\d{4}\s\-\s\d{2}\-\d{3}[A-Z]\d{6,7}',dic1_a[d][0]))==1:
    #                 print('batraaaaaaaa',re.findall('\d\d?\/\d{2}\/\d{4}\s\-\s\d{2}\-\d{2}[A-Z]{2}\d{6,7}|\d\d?\/\d{2}\/\d{4}\s\-\s\d{2}\-\d{3}[A-Z]\d{6,7}',dic1_a[d][0])[0],'-----',dic1_a[d])
    #                 nevv = copy.deepcopy(dic1_a[d])
    #                 nvv_z = copy.deepcopy(re.findall('\d\d?\/\d{2}\/\d{4}\s\-\s\d{2}\-\d{2}[A-Z]{2}\d{6,7}|\d\d?\/\d{2}\/\d{4}\s\-\s\d{2}\-\d{3}[A-Z]\d{6,7}',dic1_a[d][0])[0])
    #                 nvv_o = re.sub(re.findall('\d\d?\/\d{2}\/\d{4}\s\-\s\d{2}\-\d{2}[A-Z]{2}\d{6,7}|\d\d?\/\d{2}\/\d{4}\s\-\s\d{2}\-\d{3}[A-Z]\d{6,7}',dic1_a[d][0])[0],'',dic1_a[d][0])
    #                 nevv.pop(0)
    #                 nevv.insert(0,nvv_z.strip(' - '))
    #                 nevv.pop(1)
    #                 nevv.insert(1,nvv_o.strip(' - '))
    #                 dic1[la] = nevv
    #                 la +=1
    #                 continue
    #         except:
    #             print('batara_hospital_merged_zeroandfirst_cell_error_ytyi87658')
    #         dic1[la]=dic1_a[d]
    #         la +=1 
  
          
    if hospital=='ruby-pharma':
        
        dic2=dic1
        dic1={}
        lq=1
        f=0
        for d in dic2:
            print('kkkllll',dic2[d])
            f +=1
            if f>3 and dic2[d][0] in ['RETURNS', 'ISSUES','Issues','Returns']:
                dic1[lq]=[' ',' ','Subtotal',' ',' ',' ',' ']
                lq +=1
            dic1[lq]=dic2[d]
            lq +=1

        ld=len(dic1)
        dic1[ld+1]=[' ',' ','Subtotal',' ',' ',' ',' ']
    
    if hospital=='lilavati-pharma':
        dic2=dic1
        dic1={}
        lq=1
        f=1
        for d in dic2:
            f +=1
            sl=''
            if dic2[d].count(' ')==noc-1 and len(dic2[d][0])>1:
                # head_list.append(dic2[d][0])
                if f>3 and sl.join(dic2[d-1]).__contains__('Subtotal')==False:
                    dic1[lq]=[' ','Subtotal',' ',' ',' ',' ']
                    lq +=1
            dic1[lq]=dic2[d]
            lq +=1
        print(head_list)
    
    if hospital=='srch':
        dic1_a=dic1
        la=1
        dic1={}
        f=1
        for d in dic1_a:
            f +=1 
            
            if f>1 and dic1_a[d][1]=='Subtotal' and dic1_a[d-1][1]=='Subtotal':
                print('srchhhyyyy_SSSSS',dic1_a[d],dic1_a[d])
                continue
            dic1[la]=dic1_a[d]
            la +=1

        dic1_a=dic1
        la=1
        dic1={}
        f=1
        for d in dic1_a:
            f +=1 
            ss=''
            if dic1_a[d].count(' ')==6:
                continue
            if f>2 and dic1_a[d][1]=='Subtotal' and dic1_a[d-1][1]=='Subtotal':
                print('srchhhyyyy',dic1_a[d])
                continue
            if f==2 and dic1_a[d].count(' ')==5 and dic1_a[d][1]=='Subtotal':
                print('srchhhyyyy_www',dic1_a[d])
                continue
            if f>2 and dic1_a[d][0] in head_list and ss.join(dic1_a[d-1]).__contains__('Subtotal')==False:                
                print('gggggggg',dic1_a[d-1])
                g1=copy.deepcopy(dic1_a[d-1][3])
                g2=copy.deepcopy(dic1_a[d-1][4])
                g3=copy.deepcopy(dic1_a[d-1][5])
                dic1_a[d-1].pop(-1)
                dic1_a[d-1].pop(-1)
                dic1_a[d-1].pop(-1)
                dic1_a[d-1].append(' ')
                dic1_a[d-1].append(' ')
                dic1_a[d-1].append(' ')
                dic1[la-1]=dic1_a[d-1]
                lg=copy.deepcopy([' ','Subtotal',' ',g1,g2,g3])
                dic1[la]=lg
                la +=1
            dic1[la]=dic1_a[d]
            lasta=dic1_a[d]
            la +=1
    

    if hospital=='apolo': 
        dic1_a=dic1
        la=1
        dic1={}
        f=1
        fn=len(dic1_a)
        for d in dic1_a:
            f +=1
            ss=''
            if f>3 and f<fn and 3<len(dic1_a[d][3])<6 and len(re.findall('\d\d?\:\d\d?',dic1_a[d][3]))==1 and 8<len(dic1_a[d-1][3])<12 and len(re.findall('\d\d?\/\d{2}\/\d{4}',dic1_a[d-1][3]))==1 and dic1_a[d-1][1] in sub_head and len(re.findall('\d\d?\-[A-Z][a-z]{2}\-\d{4}',dic1_a[d-2][0]))==1 and dic1_a[d-2].count(' ')==8: 
                print('post-uu-post11',dic1_a[d-1],'---',dic1_a[d])
                nlh1_one=copy.deepcopy(dic1_a[d-1][1])
                nlh1=[' ',nlh1_one,' ',' ',' ',' ',' ',' ',' ']
                dic1[la-1] = nlh1
                dic1_a[d-1].pop(1)
                dic1_a[d-1].insert(1,' ')
                new_l=copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))   
                dic1[la]=new_l
                la +=1
                continue
            if f>4 and f<fn and 3<len(dic1_a[d-1][3])<6 and len(re.findall('\d\d?\:\d\d?',dic1_a[d-1][3]))==1 and 8<len(dic1_a[d-2][3])<12 and len(re.findall('\d\d?\/\d{2}\/\d{4}',dic1_a[d-2][3]))==1 and 8<len(dic1_a[d][3])<12 and len(re.findall('\d\d?\/\d{2}\/\d{4}',dic1_a[d][3]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-2][6]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-2][8]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][6]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][8]))==1 and len(dic1_a[d][6].strip())==0 and len(dic1_a[d][8].strip())==0:
                print('post-uu-post11_one',dic1_a[d-1],'---',dic1_a[d])
                nlh1_one=copy.deepcopy(dic1_a[d-1])
                nlh1_one1=nlh1_one[:6]+[' ',' ',' ']
                nlh1_one2=[' ',' ',' ',' ',' ',' ']+nlh1_one[6:]
                dic1[la-1]=nlh1_one1
                new_l=copy.deepcopy(opr1(nlh1_one2,dic1_a[d],src_dc))   
                dic1[la]=new_l
                la +=1
                continue
            dic1[la]=dic1_a[d]
            la +=1

        dic1_a=dic1
        la=1
        dic1={}
        f=1
        fn=len(dic1_a)
        for d in dic1_a:
            f +=1
            ss=''
            if f>2 and dic1_a[d-1][0] not in head_list and len(re.findall('\d{4}',dic1_a[d][0]))==0 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][8]))==1 and len(re.findall('\d{4}',dic1_a[d-1][0]))==1 and len(re.findall('\d\-\w{3}\-\d{4}',dic1_a[d-1][0]))==0 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][8]))==0 and ss.join(dic1_a[d]).__contains__('Dept ')==False and ((len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d-1][3]))==0 and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d][3]))==1) or (len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d-1][3]))==1 and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d][3]))==0)):                
                print('post-post11_1',dic1_a[d-1],'---',dic1_a[d])
                
                new_l=copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))   
                dic1[la-1]=new_l
                continue
            
            if f>2 and f<fn and len(dic1_a[d][0])>=8 and len(re.findall('\d{2}\-[A-Z][a-z]{2}\-\d{4}',dic1_a[d][0]))==0 and len(dic1_a[d][8].strip())==0 and dic1_a[d][4:].count(' ')==5 and len(re.findall('\d{7}',dic1_a[d-1][0]))==1 and (len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][8]))==1 or len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][6]))==1 or len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d-1][3]))==1) and len(dic1_a[d+1][0].strip())==0 and len(dic1_a[d+1][8].strip())==0 and dic1_a[d+1].count(' ')>=7:
                print('post-post_one',dic1_a[d-1],'---',dic1_a[d],'---',dic1_a[d+1])
                if dic1_a[d][0].__contains__(' ')==True and len(dic1_a[d][0].split())>=2:
                    md_zero=dic1_a[d][0]
                    md0=dic1_a[d][0].split()[0]
                    md1=md_zero.replace(md0,'').strip()
                    md_one=md1+' '+dic1_a[d][0]
                    dic1_a[d].pop(0)
                    dic1_a[d].pop(0)
                    dic1_a[d].insert(0,md1)
                    dic1_a[d].insert(0,md0)
                new_l=copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))   
                dic1[la-1]=new_l
                continue
            elif f>2 and f<fn and len(dic1_a[d][0])>=8 and len(dic1_a[d][8].strip())==0 and dic1_a[d][4:].count(' ')==5 and len(re.findall('\d{7}',dic1_a[d-1][0]))==1 and (len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][8]))==1 or len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][6]))==1 or len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d-1][3]))==1) and (ss.join(dic1_a[d]).__contains__('PMIS')):
                print('post-post_two',dic1_a[d-1],'---',dic1_a[d],'---',dic1_a[d+1])
                if dic1_a[d][0].__contains__(' ')==True and len(dic1_a[d][0].split())>=2:
                    md_zero=dic1_a[d][0]
                    md0=dic1_a[d][0].split()[0]
                    md1=md_zero.replace(md0,'').strip()
                    md_one=md1+' '+dic1_a[d][0]
                    dic1_a[d].pop(0)
                    dic1_a[d].pop(0)
                    dic1_a[d].insert(0,md1)
                    dic1_a[d].insert(0,md0)
                new_l=copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))
                dic1[la-1]=new_l
                continue
            if len(dic1_a[d][0])<=3 and dic1_a[d][1].__contains__(' ')==True and len(dic1_a[d][1].split())>=2 and dic1_a[d][1].split()[0].isdigit()==True and dic1_a[d].count(' ')<=6:
                mrd_one=dic1_a[d][1]
                mrd0=dic1_a[d][1].split()[0]
                mrd1=mrd_one.replace(mrd0,'').strip()
                dic1_a[d].pop(0)
                dic1_a[d].pop(0)
                dic1_a[d].insert(0,mrd1)
                dic1_a[d].insert(0,mrd0)
            if len(re.findall('^\d\s\d',dic1_a[d][5]))==1 and len(re.findall('\.\d\d$',dic1_a[d][5]))==1 and len(dic1_a[d][4].strip())==0:
                mkd4=dic1_a[d][5][0]
                mkd5=dic1_a[d][5].replace(mkd4+' ','').strip()
                dic1_a[d].pop(4)
                dic1_a[d].pop(4)
                dic1_a[d].insert(4,mkd5)
                dic1_a[d].insert(4,mkd4)
            
            if f>2 and f<fn and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d][3]))==0 and dic1_a[d-1].count(' ')==8 and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d-1][3]))==1 and ss.join(dic1_a[d]).__contains__('Final'):                
                print('post-post_two',dic1_a[d-1],'---',dic1_a[d])
                new_l=copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))   
                dic1[la-1]=new_l
                continue
            if f>2 and f<fn and len(re.findall('\d\:\d{2}',dic1_a[d][3]))==1 and dic1_a[d].count(' ')==8 and len(re.findall('\d\:\d{2}',dic1_a[d-1][3]))==0:                
                print('post-post_two_1',dic1_a[d-1],'---',dic1_a[d])
                new_l=copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))   
                dic1[la-1]=new_l
                continue
            
            dic1[la]=dic1_a[d]
            la +=1
        dic1_a=dic1
        la=1
        dic1={}
        f=1
        fn=len(dic1_a)
        for d in dic1_a:
            f +=1
            ss=''
            if f>2 and len(re.findall('\d{2}\:\d{2}',dic1_a[d][3]))==1 and ss.join(dic1_a[d]).__contains__('Dept Sub Total')==False and len(dic1_a[d][3])==5 and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d-1][3]))==1 and len(dic1_a[d-1][3])==10:
                temp_line1=opr1(dic1_a[d-1],dic1_a[d],src_dc)
                # print('hhhhhuuu11',dic1_a[d-1],'---',dic1_a[d])
                dic1[la-1]=copy.deepcopy(temp_line1)
                continue
            elif f>2 and len(re.findall('\d\:\d{2}',dic1_a[d][3]))==1 and len(dic1_a[d][3])==4 and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d-1][3]))==1 and len(dic1_a[d-1][3])==10:
                temp_line1=opr1(dic1_a[d-1],dic1_a[d],src_dc)
                # print('hhhhhuuu22',dic1_a[d-1],'---',dic1_a[d])
                dic1[la-1]=copy.deepcopy(temp_line1)
                continue
            dic1[la]=dic1_a[d]
            la +=1
        
        dic1_a=dic1
        la=1
        dic1={}
        f=1
        fn=len(dic1_a)
        for d in dic1_a:
            # print('yyyyy',dic1_a[d])
            f +=1
            ss=''  
            if f>3 and f<fn and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d][3]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][8]))==1 and len(re.findall('\d{2}\:\d{2}',dic1_a[d+1][3]))==1 and len(dic1_a[d][6].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-2][6]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][6]))==1:
                print('post-22post_two',dic1_a[d-1],'---',dic1_a[d])
                new_l=copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))   
                dic1[la-1]=new_l
                continue
            if f>2 and len(dic1_a[d][0].strip())==0 and len(re.findall('\d{3}',dic1_a[d-1][0]))>=1 and len(dic1_a[d-1][3].strip())==0 and len(re.findall('\d{2}\/\d{2}\/\d{4}\s\d\d?\:\d\d?',dic1_a[d][3]))==1 and len(dic1_a[d][6].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][6]))==1 and len(dic1_a[d-1][8].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][8]))==1:
                print('post-22post22_two',dic1_a[d-1],'---',dic1_a[d])
                new_l=copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))   
                dic1[la-1]=new_l
                continue
            if f>2 and f<fn and dic1_a[d][1] in ['Nursing'] and dic1_a[d].count(' ')==8 and len(re.findall('\d{3}',dic1_a[d-1][0]))>=1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][6]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][8]))==1 and dic1_a[d-2]==dic1_a[d]:
                print('post-22post33_three',dic1_a[d-1],'---',dic1_a[d])
                new_l=copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))   
                dic1[la-1]=new_l
                continue 
            if f>2 and f<fn and len(dic1_a[d][0].strip())==0 and len(re.findall('\d{3}',dic1_a[d-1][0]))>=1 and 3<len(dic1_a[d][3])<6 and len(re.findall('\d\d?\:\d\d?',dic1_a[d][3]))==1 and 8<len(dic1_a[d-1][3])<12 and len(re.findall('\d\d?\/\d{2}\/\d{4}',dic1_a[d-1][3]))==1 and len(dic1_a[d][6].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][6]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][8]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][8]))==1 and ss.join(dic1_a[d-1]).__contains__('RANDOM BLOOD'):
                print('post-22post33_frrr',dic1_a[d-1],'---',dic1_a[d])
                nex_et=copy.deepcopy(dic1_a[d][8])
                dic1_a[d].pop(8)
                dic1_a[d].insert(8,' ')
                new_l=copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))   
                dic1[la-1]=new_l
                newl=[' ',' ',' ',' ',' ',' ',' ',' ',nex_et]
                dic1[la]=newl
                print('hhhhh',dic1[la])
                la +=1
                
                continue
            dic1[la]=dic1_a[d]
            la +=1 
        # for d in dic1:
        #     print('gggggg',dic1[d])

        dic1_a=dic1
        la=1
        dic1={}
        f=1
        fn=len(dic1_a)
        for d in dic1_a:
            f +=1
            ss=''
            if f>3 and f<fn and 3<len(dic1_a[d][3])<6 and len(re.findall('\d\d?\:\d\d?',dic1_a[d][3]))==1 and 8<len(dic1_a[d-1][3])<12 and len(re.findall('\d\d?\/\d{2}\/\d{4}',dic1_a[d-1][3]))==1 and dic1_a[d-1][1] in sub_head and len(re.findall('\d\d?\-[A-Z][a-z]{2}\-\d{4}',dic1_a[d-2][0]))==1 and dic1_a[d-2].count(' ')==8: 
                print('post-uu-post11',dic1_a[d-1],'---',dic1_a[d])
                nlh1_one=copy.deepcopy(dic1_a[d-1][1])
                nlh1=[' ',nlh1_one,' ',' ',' ',' ',' ',' ',' ']
                dic1[la-1] = nlh1
                dic1_a[d-1].pop(1)
                dic1_a[d-1].insert(1,' ')
                new_l=copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))   
                dic1[la]=new_l
                la +=1
                continue
            if f>4 and f<fn and 3<len(dic1_a[d-1][3])<6 and len(re.findall('\d\d?\:\d\d?',dic1_a[d-1][3]))==1 and 8<len(dic1_a[d-2][3])<12 and len(re.findall('\d\d?\/\d{2}\/\d{4}',dic1_a[d-2][3]))==1 and 8<len(dic1_a[d][3])<12 and len(re.findall('\d\d?\/\d{2}\/\d{4}',dic1_a[d][3]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-2][6]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-2][8]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][6]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][8]))==1 and len(dic1_a[d][6].strip())==0 and len(dic1_a[d][8].strip())==0:
                print('post-uu-post11_one',dic1_a[d-1],'---',dic1_a[d])
                nlh1_one=copy.deepcopy(dic1_a[d-1])
                nlh1_one1=nlh1_one[:6]+[' ',' ',' ']
                nlh1_one2=[' ',' ',' ',' ',' ',' ']+nlh1_one[6:]
                dic1[la-1]=nlh1_one1
                new_l=copy.deepcopy(opr1(nlh1_one2,dic1_a[d],src_dc))   
                dic1[la]=new_l
                la +=1
                continue
            dic1[la]=dic1_a[d]
            la +=1

        dic1_a=dic1
        la=1
        dic1={}
        f=1
        fn=len(dic1_a)
        for d in dic1_a:
            f +=1
            ss=''
            if f>2 and dic1_a[d-1][0] not in head_list and len(re.findall('\d{4}',dic1_a[d][0]))==0 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][8]))==1 and len(re.findall('\d{4}',dic1_a[d-1][0]))==1 and len(re.findall('\d\-\w{3}\-\d{4}',dic1_a[d-1][0]))==0 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][8]))==0 and ss.join(dic1_a[d]).__contains__('Dept ')==False and ((len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d-1][3]))==0 and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d][3]))==1) or (len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d-1][3]))==1 and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d][3]))==0)):                
                print('post-post11_2',dic1_a[d-1],'---',dic1_a[d])
                new_l=copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))   
                dic1[la-1]=new_l
                continue
            
            if f>2 and f<fn and len(dic1_a[d][0])>=8 and len(re.findall('\d{2}\-[A-Z][a-z]{2}\-\d{4}',dic1_a[d][0]))==0 and len(dic1_a[d][8].strip())==0 and dic1_a[d][4:].count(' ')==5 and len(re.findall('\d{7}',dic1_a[d-1][0]))==1 and (len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][8]))==1 or len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][6]))==1 or len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d-1][3]))==1) and len(dic1_a[d+1][0].strip())==0 and len(dic1_a[d+1][8].strip())==0 and dic1_a[d+1].count(' ')>=7:
                print('post-post_one',dic1_a[d-1],'---',dic1_a[d],'---',dic1_a[d+1])
                if dic1_a[d][0].__contains__(' ')==True and len(dic1_a[d][0].split())>=2:
                    md_zero=dic1_a[d][0]
                    md0=dic1_a[d][0].split()[0]
                    md1=md_zero.replace(md0,'').strip()
                    md_one=md1+' '+dic1_a[d][0]
                    dic1_a[d].pop(0)
                    dic1_a[d].pop(0)
                    dic1_a[d].insert(0,md1)
                    dic1_a[d].insert(0,md0)
                new_l=copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))   
                dic1[la-1]=new_l
                continue
            elif f>2 and f<fn and len(dic1_a[d][0])>=8 and len(dic1_a[d][8].strip())==0 and dic1_a[d][4:].count(' ')==5 and len(re.findall('\d{7}',dic1_a[d-1][0]))==1 and (len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][8]))==1 or len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][6]))==1 or len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d-1][3]))==1) and (ss.join(dic1_a[d]).__contains__('PMIS')):
                print('post-post_two',dic1_a[d-1],'---',dic1_a[d],'---',dic1_a[d+1])
                if dic1_a[d][0].__contains__(' ')==True and len(dic1_a[d][0].split())>=2:
                    md_zero=dic1_a[d][0]
                    md0=dic1_a[d][0].split()[0]
                    md1=md_zero.replace(md0,'').strip()
                    md_one=md1+' '+dic1_a[d][0]
                    dic1_a[d].pop(0)
                    dic1_a[d].pop(0)
                    dic1_a[d].insert(0,md1)
                    dic1_a[d].insert(0,md0)
                new_l=copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))
                dic1[la-1]=new_l
                continue
            if len(dic1_a[d][0])<=3 and dic1_a[d][1].__contains__(' ')==True and len(dic1_a[d][1].split())>=2 and dic1_a[d][1].split()[0].isdigit()==True and dic1_a[d].count(' ')<=6:
                mrd_one=dic1_a[d][1]
                mrd0=dic1_a[d][1].split()[0]
                mrd1=mrd_one.replace(mrd0,'').strip()
                dic1_a[d].pop(0)
                dic1_a[d].pop(0)
                dic1_a[d].insert(0,mrd1)
                dic1_a[d].insert(0,mrd0)
            if len(re.findall('^\d\s\d',dic1_a[d][5]))==1 and len(re.findall('\.\d\d$',dic1_a[d][5]))==1 and len(dic1_a[d][4].strip())==0:
                mkd4=dic1_a[d][5][0]
                mkd5=dic1_a[d][5].replace(mkd4+' ','').strip()
                dic1_a[d].pop(4)
                dic1_a[d].pop(4)
                dic1_a[d].insert(4,mkd5)
                dic1_a[d].insert(4,mkd4)
            
            if f>2 and f<fn and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d][3]))==0 and dic1_a[d-1].count(' ')==8 and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d-1][3]))==1 and ss.join(dic1_a[d]).__contains__('Final'):                
                print('post-post_two',dic1_a[d-1],'---',dic1_a[d])
                new_l=copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))   
                dic1[la-1]=new_l
                continue
            if f>2 and f<fn and len(re.findall('\d\:\d{2}',dic1_a[d][3]))==1 and dic1_a[d].count(' ')==8 and len(re.findall('\d\:\d{2}',dic1_a[d-1][3]))==0:                
                print('post-post_two_1',dic1_a[d-1],'---',dic1_a[d])
                new_l=copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))   
                dic1[la-1]=new_l
                continue
            
            dic1[la]=dic1_a[d]
            la +=1
        dic1_a=dic1
        la=1
        dic1={}
        f=1
        fn=len(dic1_a)
        for d in dic1_a:
            f +=1
            ss=''
            if f>2 and len(re.findall('\d{2}\:\d{2}',dic1_a[d][3]))==1 and ss.join(dic1_a[d]).__contains__('Dept Sub Total')==False and len(dic1_a[d][3])==5 and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d-1][3]))==1 and len(dic1_a[d-1][3])==10:
                temp_line1=opr1(dic1_a[d-1],dic1_a[d],src_dc)
                # print('hhhhhuuu11',dic1_a[d-1],'---',dic1_a[d])
                dic1[la-1]=copy.deepcopy(temp_line1)
                continue
            elif f>2 and len(re.findall('\d\:\d{2}',dic1_a[d][3]))==1 and len(dic1_a[d][3])==4 and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d-1][3]))==1 and len(dic1_a[d-1][3])==10:
                temp_line1=opr1(dic1_a[d-1],dic1_a[d],src_dc)
                # print('hhhhhuuu22',dic1_a[d-1],'---',dic1_a[d])
                dic1[la-1]=copy.deepcopy(temp_line1)
                continue
            dic1[la]=dic1_a[d]
            la +=1
        
        dic1_a=dic1
        la=1
        dic1={}
        f=1
        fn=len(dic1_a)
        for d in dic1_a:
            # print('yyyyy',dic1_a[d])
            f +=1
            ss=''  
            if f>3 and f<fn and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic1_a[d][3]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][8]))==1 and len(re.findall('\d{2}\:\d{2}',dic1_a[d+1][3]))==1 and len(dic1_a[d][6].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-2][6]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][6]))==1:
                print('post-22post_two',dic1_a[d-1],'---',dic1_a[d])
                new_l=copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))   
                dic1[la-1]=new_l
                continue
            if f>2 and len(dic1_a[d][0].strip())==0 and len(re.findall('\d{3}',dic1_a[d-1][0]))>=1 and len(dic1_a[d-1][3].strip())==0 and len(re.findall('\d{2}\/\d{2}\/\d{4}\s\d\d?\:\d\d?',dic1_a[d][3]))==1 and len(dic1_a[d][6].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][6]))==1 and len(dic1_a[d-1][8].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][8]))==1:
                print('post-22post22_two',dic1_a[d-1],'---',dic1_a[d])
                new_l=copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))   
                dic1[la-1]=new_l
                continue
            if f>2 and f<fn and dic1_a[d][1] in ['Nursing'] and dic1_a[d].count(' ')==8 and len(re.findall('\d{3}',dic1_a[d-1][0]))>=1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][6]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][8]))==1 and dic1_a[d-2]==dic1_a[d]:
                print('post-22post33_three',dic1_a[d-1],'---',dic1_a[d])
                new_l=copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))   
                dic1[la-1]=new_l
                continue 
            if f>2 and f<fn and len(dic1_a[d][0].strip())==0 and len(re.findall('\d{3}',dic1_a[d-1][0]))>=1 and 3<len(dic1_a[d][3])<6 and len(re.findall('\d\d?\:\d\d?',dic1_a[d][3]))==1 and 8<len(dic1_a[d-1][3])<12 and len(re.findall('\d\d?\/\d{2}\/\d{4}',dic1_a[d-1][3]))==1 and len(dic1_a[d][6].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][6]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d][8]))==1 and len(re.findall('\d\s?\.\s?\d',dic1_a[d-1][8]))==1 and ss.join(dic1_a[d-1]).__contains__('RANDOM BLOOD'):
                print('post-22post33_frrr',dic1_a[d-1],'---',dic1_a[d])
                nex_et=copy.deepcopy(dic1_a[d][8])
                dic1_a[d].pop(8)
                dic1_a[d].insert(8,' ')
                new_l=copy.deepcopy(opr1(dic1_a[d-1],dic1_a[d],src_dc))   
                dic1[la-1]=new_l
                newl=[' ',' ',' ',' ',' ',' ',' ',' ',nex_et]
                dic1[la]=newl
                print('hhhhh',dic1[la])
                la +=1
                
                continue
            dic1[la]=dic1_a[d]
            la +=1 
        # for d in dic1:
        #     print('gggggg',dic1[d])
    if hospital == 'CHRISTIAN':
        dic1_a = dic1
        la = 1
        dic1 = {}
        f = 1
        for d in dic1_a:
            print('pmdd=', dic1_a[d])
            if dic1_a[d][2] == 'Surgery name & Type':
                dic1_a[d][0] = dic1_a[d][2]
                dic1_a[d][2] = ' '
                dic1_a[d][3] = ' '
                dic1_a[d][5] = ' '
            if len(re.findall('\d{2}\/\d{2}\/\d{2}', dic1_a[d][0])) == 1 and (
                    len(re.findall('\D{7}\d\s\D{3}\s\D{4}\s\D{8}\s\D{4}', dic1_a[d - 1][0])) == 1 or dic1_a[d - 1][
                0] == 'BedTypeGENERAL' or 'Bed TypeGENERAL' in dic1_a[d - 1][0]) and dic1_a[d - 1].count(' ') == 5:
                print('for surgery nformation adding Total with its above value')
                if len(re.findall('\d\.\d', dic1_a[d - 2][5])) == 1:
                    listnw = [' ', ' ', 'Total', ' ', ' ', dic1_a[d - 2][5]]
                elif len(re.findall('\d\.\d', dic1_a[d - 3][5])) == 1:
                    listnw = [' ', ' ', 'Total', ' ', ' ', dic1_a[d - 3][5]]
                dic1[la] = dic1_a[d]
                dic1[la - 1] = dic1_a[d - 1]
                la += 1
                dic1[la - 1] = listnw
            if d > 1 and (dic1_a[d][3] == 'Total for Dispensary:' or dic1_a[d][3] == 'Total for Returns:' or dic1_a[d][
                3] == 'Total for Dispensary' or dic1_a[d][3] == 'Total for Returns') and dic1_a[d - 1][5] != ' ':
                print('for removing extra total values')
                dic1_a[d - 1][5] = ' '
            if dic1_a[d][0] == dic1_a[d][1]:
                print('if 0th and 1st index are same')
                dic1_a[d][1] = ' '
            dic1[la] = dic1_a[d]
            lasta = dic1_a[d]
            la += 1
    # ///////////////////////////
    if hospital=='jupiter':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ppmmmdd===', dic2[d])
            if dic2[d][0] == dic2[d][1]:
                dic2[d][0] = ' '
            if d > 1 and dic2[d][5] != ' ' and dic2[d][6] != ' ' and dic2[d][3] != ' ' and dic2[d - 1][0] != ' ' and \
                    dic2[d - 1][2] != ' ' and (dic2[d - 1][6] == ' ' or dic2[d][6] != ' ') and \
                    (dic2[d].count(' ') == 4 or dic2[d].count(' ') == 3) and (
                    dic2[d - 1].count(' ') == 4 or dic2[d - 1].count(' ') == 3):
                print('if lines divided 4,3 and 4,3')
                dic2[d - 1][3:] = dic2[d][3:]
                dic2[d][3:] = [' ', ' ', ' ', ' ']
            if d > 1 and dic2[d][5] != ' ' and dic2[d][6] != ' ' and dic2[d][3] != ' ' and dic2[d - 1][0] != ' ' and \
                    dic2[d - 1][2] != ' ' and (dic2[d - 1][6] == ' ' or dic2[d][6] != ' ') and \
                    (dic2[d].count(' ') == 4 or dic2[d].count(' ') == 3) and (
                    dic2[d - 1].count(' ') == 4 or dic2[d - 1].count(' ') == 5):
                print('if lines divided with 4,3 and 4,5')
                dic2[d - 1][3:] = dic2[d][3:]
                dic2[d][3:] = [' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # ///////////////////////////
    if hospital=='hiranandani':
        dic1_a=dic1
        la=1
        dic1={}
        f=1
        for d in dic1_a:
            # print('pmdd=',dic1_a[d])
            if d>2 and d<len(dic1_a) and len(re.findall('\D{14}\s\D{7}\s\d{5}', dic1_a[d][0])) == 1 and dic1_a[d].count(' ')==6 and len(re.findall('\D{7}', dic1_a[d-1][1])) == 1 and len(re.findall('\d{2}\:\d{2}\:\d{2}', dic1_a[d-1][0])) == 1 and dic1_a[d-1].count(' ')==5:
                print('for 220100597040 adding package details total')
                listnw = ['Total',' ',' ',' ',' ',' ',' ']
                dic1[la] = dic1_a[d]
                dic1[la - 1] = dic1_a[d - 1]
                la += 1
                dic1[la - 1] = listnw
            dic1[la] = dic1_a[d]
            lasta = dic1_a[d]
            la += 1
    # //////////////////////////
    if hospital=='jaypee':
        dic1_a=dic1
        print("type: ",type(dic1_a))
        la=1
        dic1={}
        f=1
        for d in dic1_a:
            print("p d:",dic1_a[d])
            if d>2 and d<len(dic1_a)+1 and len(re.findall('\d\-\d{2}\-\d{3}', dic1_a[d][1])) == 1 and len(re.findall('\D{3}\s\D{4}\s\D{5}\s\d{3}\D\d{3}\D{2}\s\{\s\D{6}\)\s\.\.', dic1_a[d-1][0])) == 1 and dic1_a[d-1].count(' ')==4 and \
                    dic1_a[d].count(' ') == 3 and dic1_a[d-2].count(' ')==4:
                print('for Bed Bath Wipes 320X240mm { Baroda) ..')
                dic1_a[d-2][1] = ' '
                dic1_a[d-2][2] = ' '
                dic1_a[d][4] = ' '
                new_l = copy.deepcopy(opr1(dic1_a[d - 1], dic1_a[d], src_dc))
                dic1[la - 1] = new_l
                dic1_a[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if d>1 and d<len(dic1_a) and (len(re.findall('\d\.\d{3}\.\d', dic1_a[d][4])) == 1 or len(re.findall('\d\.\d', dic1_a[d][4])) == 1 or len(re.findall('\d\,\d', dic1_a[d][4])) == 1) and (len(re.findall('\d\.\d{3}\.\d', dic1_a[d][2])) == 1 or len(re.findall('\d\.\d', dic1_a[d][2])) == 1) and \
                    (len(re.findall('\d\-\d{2}\-\d{4}', dic1_a[d][1])) == 1 or len(re.findall('\d\-\d{2}\-\d{3}', dic1_a[d][1])) == 1) and (dic1_a[d].count(' ')==3) and dic1_a[d-1].count(' ')==5:
                print('if two lines not merg')
                dic1_a[d][5] = dic1_a[d][4]
                dic1_a[d][4] = ' '
                new_l = copy.deepcopy(opr1(dic1_a[d - 1], dic1_a[d], src_dc))
                dic1[la-1] = new_l
                dic1[la-1] = new_l
                dic1[la-1] = new_l
                dic1[la-1] = new_l
                dic1_a[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if d>1 and d<len(dic1_a) and dic1_a[d][0] == 'Drugs and Consumables' and dic1_a[d].count(' ')==5 and dic1_a[d-1].count(' ')==5 and \
                    len(re.findall('\d{2}\,\d{3}\.\d{2}', dic1_a[d - 1][5])) == 1:
                dic1_a[d-1][2] = 'Consultation Total'
            if dic1_a[d][2] == 'Package Totall':
                dic1_a[d][2] = 'Package Total'
            if dic1_a[d][2] == 'Registration Totall':
                dic1_a[d][2] = 'Registration Total'
            if dic1_a[d][4]!=' ' and dic1_a[d][5] == ' ':
                dic1_a[d][5] = dic1_a[d][4]
                dic1_a[d][4] = ' '
            dic1[la] = dic1_a[d]
            la += 1
    # //////////////////////////

    if hospital == 'aig1':
        print("#aig_format1")
        dic1_a = dic1
        la = 1
        dic1 = {}
        f = 1
        temp_subt = 0
        for d in dic1_a.keys():
            print("#peronailse_at_merge :", dic1_a[d])
            if ('TOTAL' in dic1_a[d][1] and dic1_a[d][-1] != " ") or (not 'TOTAL' in dic1_a[d][1] and d == len(dic1_a)):
                subtrow = [' ', ' ', ' ', ' ', 'Subtotal',str(temp_subt)]
                temp_subt = 0
                dic1[la] = subtrow
                la+=1

            elif dic1_a[d][1] in head_list and dic1_a[d][-1] == " ":
                subtrow = [' ', ' ', ' ', ' ', 'Subtotal',str(temp_subt)]
                temp_subt = 0
                dic1[la] = subtrow
                la+=1
                found_subh = dic1_a[d][1]
                dic1_a[d][0] = dic1_a[d][1]
                dic1_a[d][1] = " "

            elif dic1_a[d][-1] != " " and not dic1_a[d][1] in head_list:
                temp_subt = temp_subt+float(dic1_a[d][-1].replace(",","").strip())
                print(temp_subt)

            if len(re.findall("\d{2}\-\d{2}\-\d{3,4}",dic1_a[d][0]))==1 and dic1_a[d][1] == " ":
                origtxt = dic1_a[d][0]
                dic1_a[d][0] = re.findall("\d{2}\-\d{2}\-\d{3,4}", dic1_a[d][0])[0]
                dic1_a[d][1] = origtxt.split(dic1_a[d][0])[1]



            dic1[la] = dic1_a[d]
            la += 1

    if hospital == 'reliance':
        print('personaliseattmmmmmmmmmmmmmergedlineddicc')
        dic1_a = dic1
        la = 1
        dic1 = {}
        for d in dic1_a:
            print('ppmd111==', dic1_a[d])
            if d <= 5 and dic1_a[d][0] == 'Package Exclusions' and (
                    len(re.findall('\d\s?\.\s?\d', dic1_a[d - 1][5])) == 1 or len(
                re.findall('\d\s?\.\s?\d', dic1_a[d - 2][5])) == 1) and \
                    (len(re.findall('\d\.\s?\d{2}\s?\.\d{4}', dic1_a[d - 1][0])) == 1 or len(
                        re.findall('\d\.\s?\d{2}\s?\.\d{4}', dic1_a[d - 2][0])) == 1):
                print('for adding subtotal to package exclusions subtotal')
                head_name = dic1_a[d][0]
                dic1_a[d][0] = ' '
                dic1_a[d][2] = head_name + ' ' + 'Subtotal'
            for i in head_list:
                if i in dic1_a[d][0] and dic1_a[d].count(' ') != 5 and dic1_a[d][1] != ' ':
                    print('if header with line item')
                    listnw = [i, ' ', ' ', ' ', ' ', ' ']
                    dic1[la] = dic1_a[d]
                    la += 1
                    dic1[la - 1] = listnw
                    dic1_a[d][0] = dic1_a[d][0].replace(i, '')

            dic1[la] = dic1_a[d]
            lasta = dic1_a[d]
            la += 1
    # //////////////////////////
    if hospital == 'pushpawati':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('data',dic2[d])
            if len(dic2[d][2].split()) == 2:
                a, b = dic2[d][2].split()
                dic2[d][2] = a
            if len(re.findall('\w{2}\/\d{2}\-\d{2}\/\d{1,4}', dic2[d][0])) == 1 and dic2[d][1] == ' ':
                print('data', dic2[d])
                a, b = re.split('\w{2}\/\d{2}\-\d{2}\/\d{1,4}', dic2[d][0], 1)
                dic2[d][1] = b.strip()
                dic2[d][0] = a.strip()
            if len(re.findall('\w\d?\w?\/\s?\w{2}\s?\d{2}\/\s?\d{1,4}', dic2[d][0])) == 1 and dic2[d][1] == ' ':
                print('data', dic2[d])
                a, b = re.split('\w\d?\w?\/\s?\w{2}\s?\d{2}\/\s?\d{1,4}', dic2[d][0], 1)
                dic2[d][1] = b.strip()
                dic2[d][0] = a.strip()
            dic1[lq] = dic2[d]
            lq += 1
    # //////////////////////////
    if hospital =='bhailal-2':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('pmdddd',dic2[d])
            if dic2[d][0] == 'CENTRAL DRUG STORE':
                dic2[d][0] = 'PHARMACY RETURNS'
            if dic2[d][0] == 'MEDICAL':
                dic2[d][0] = 'PHARMACY'
            if len(re.findall('\d{14}\s\D+', dic2[d][1])) or len(re.findall('\d{14}\D+', dic2[d][1])) or len(re.findall('\d{14}\s\d', dic2[d][1])):
                a, b = re.split('\d{14}', dic2[d][1])
                print('aa', a)
                print('bb', b)
                dic2[d][1] = dic2[d][1].replace(b, '')
                dic2[d][2] = b
                # dic1[lq] = dic2[d]
                # lq += 1
                # continue
            if len(re.findall('\d{1,2}\/\d\s?\d\/\d{3,4}\s', dic2[d][3]))==1 and len(dic2[d][3].split())<=3:
                print('DateRate',dic2[d])
                a, b = re.split('\d{1,2}\/\d\s?\d\/\d{3,4}', dic2[d][3],maxsplit=1)
                print('HHH',b)
                # dic2[d][3] = dic2[d][3].replace(a, '')
                # a, b= dic2[d][3].split()
                dic2[d][3] = b
                # dic1[lq] = dic2[d]
                # lq += 1
                # continue
            if  len(re.findall('\d+\s\d+', dic2[d][6]))==1:
                print('DiscAmount', dic2[d])
                a, b = dic2[d][6].split()
                dic2[d][6] = b




            dic1[lq] = dic2[d]
            lq += 1
    # //////////////////////////
    if hospital == 'medica':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:


            if dic2[d][1].__contains__(sbt) and dic2[d][2].__contains__(sbt) and dic2[d].count(' ')>=2:
                print('KOKO',dic2[d])
                dic2[d].pop(2)
                dic2[d].insert(2,' ')

            if len(dic2[d][0]) > 5 and len(re.findall('^\d+\s[A-Za-z]+|^\d+\s\d\D+\d+\D+', dic2[d][0])) == 1:
                cln = copy.deepcopy(dic2[d])
                cln_zero = re.sub('^\d+\s+', '', cln[0])
                cln.pop(0)
                cln.insert(0, cln_zero)
                dic2[d] = cln


            if  d>1 and d<len(dic2) and dic2[d-1][2].__contains__(sbt) and dic2[d-1].count(' ')==6  :
                print('sbt line break',dic2[d-1],dic2[d])
                tty1 = opr1(dic2[d], dic2[d - 1], src_dc)
                dic1[lq - 1] = tty1
                continue

            if d>1 and d<len(dic2)  and len(re.findall('\d{2}\/\d{1,2}\/\d{4}', dic2[d-1][2])) == 1 and dic2[d-1].count(' ')==3 and dic2[d].count(' ')==4:
                print('3023',dic2[d-1])
                tty1 = opr1(dic2[d], dic2[d - 1], src_dc)
                dic1[lq - 1] = tty1
                continue

            if len(re.findall('\d\s?\.\s?\d{2}\s\d\s?\.\s?\d{2}',dic2[d][5])) :
                print('QtUnitPrice', dic2[d])
                a,c = dic2[d][5].split()
                dic2[d][5] = a

            if len(re.findall('\d\s?\.\s?\d',dic2[d][6])) and dic2[d].count(' ')==5 and dic2[d-1][6].count(' ')==1:
                print('220202540817',dic2[d],dic2[d-1])
                tty2 = opr1(dic2[d], dic2[d - 1], src_dc)
                dic1[lq - 1] = tty2
                continue

            if len(re.findall('\d\s?\.\s?\d',dic2[d][5])) and len(re.findall('\d\s?\.\s?\d',dic2[d][4]))  and dic2[d].count(' ')==4 and dic2[d-1][4].count(' ')==1 and dic2[d-1].count(' ')==4:
                print('220202541784',dic2[d],dic2[d-1])
                tty2 = opr1(dic2[d], dic2[d - 1], src_dc)
                dic1[lq - 1] = tty2
                continue


            dic1[lq] = dic2[d]
            lq += 1
    # //////////////////////////
    if hospital == 'yatharth':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('data', dic2[d])
            if len(re.findall('\d\.\d', dic2[d][3])) == 1 and dic2[d][0].__contains__('@'):
                # print('data1', dic2[d])
                a, b = dic2[d][0].split('@')
                # print('for1', a)
                # print('for2', b)
                dic2[d][0] = dic2[d][0].replace(b, '')
                dic2[d][0] = dic2[d][0].rstrip('@')
                dic2[d][2] = b.rstrip('For')
                dic1[lq] = dic2[d]
                lq += 1
                continue
            dic1[lq] = dic2[d]
            lq += 1

        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('data', dic2[d])
            if len(re.findall('\d\.\d', dic2[d][3])) == 1 and dic2[d][3].__contains__('Visit(s)'):
                # print('data1', dic2[d])
                dic2[d][2] = dic2[d][2].replace('Rs.', '')
                a, b = dic2[d][3].split('Visit(s)')
                # print('for1', a)
                # print('for2', b)
                dic2[d][2] = dic2[d][2].rstrip('*')
                dic2[d][3] = a
                dic2[d][0] = dic2[d][0] + ' ' + b
                # print('data2', dic2[d])
                dic1[lq] = dic2[d]
                lq += 1
                continue
            if len(re.findall('\d\.\d', dic2[d][3])) == 1 and len(dic2[d][3].split()) == 2:
                # print('data1', dic2[d])
                dic2[d][3] = dic2[d][3].strip()
                dic2[d][2] = dic2[d][2].replace('Rs.', '')
                dic2[d][2] = dic2[d][2].replace('Per Day', '')
                dic2[d][2] = dic2[d][2].strip()
                a, b = dic2[d][3].split()
                dic2[d][3] = a.strip()
                dic1[lq] = dic2[d]
                lq += 1
                continue

            if len(re.findall('\d\.\d', dic2[d][5])) == 1 and dic2[d].count(' ') == 4 and dic2[d][0].__contains__(
                    'Total') == 0:
                # print('data1', dic2[d])
                if dic2[d][0].__contains__('a Rs.') or dic2[d][0].__contains__("'a Rs"):
                    # print('data1', dic2[d])
                    dic2[d][0] = dic2[d][0].replace('a Rs.', '@ Rs.')
                    dic2[d][0] = dic2[d][0].replace("'a Rs.", '@ Rs.')

                if len(re.findall('\d{11}', dic2[d][0])) == 1 and dic2[d].count(' ') == 4:
                    # print('data1', dic2[d])
                    dic2[d][0] = ' '
                    dic2[d - 1][5] = dic2[d][5]
                    dic2[d][5] = ' '
                    # print('data1', dic2[d-1])
                    dic1[lq] = dic2[d]
                    lq += 1
                    continue

                if dic2[d][0].count('@') > 1:
                    # print('@#@', dic2[d])
                    dic2[d][0] = dic2[d][0].replace('UnitHospital &', '')
                    dic2[d][0] = dic2[d][0].strip()
                    a, b = dic2[d][0].split('Unit')
                    # print('data2',b)
                    # print('data3',a)
                    dic2[d][0] = a.strip()
                    dic2[d + 1][0] = b.strip()
                    # print('@#@', dic2[d],dic2[d+1])
                    dic1[lq] = dic2[d]
                    lq += 1
                    continue

                if dic2[d][0].count('@') == 1:
                    # print('data1', dic2[d])
                    a, b = dic2[d][0].split('@')
                    # print('data1', dic2[d])
                    # print('data2',b)
                    # print('data3',a)
                    dic2[d][0] = a
                    dic2[d][2] = b
                    # print('data4', dic2[d])
                    dic2[d][2] = dic2[d][2].strip()
                    dic2[d][2] = dic2[d][2].replace('Rs.', '')
                    dic2[d][2] = dic2[d][2].replace('Unit', '')
                    # dic2[d][2] = dic2[d][2].replace('For', '')
                    dic2[d][2] = dic2[d][2].strip()
                    # print('data1', dic2[d])
                    dic1[lq] = dic2[d]
                    lq += 1
                    continue

            dic1[lq] = dic2[d]
            lq += 1

        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('data', dic2[d])
            if len(re.findall('\d\.\d', dic2[d][2])) == 2 and dic2[d].count(' ') < 4 and len(dic2[d][2].split()) == 3:
                print('data1', dic2[d])
                a, b, c = dic2[d][2].split()
                # print('data1', dic2[d])
                # print('aaas', a)
                # print('baas', c)
                dic2[d][2] = a
                dic2[d][3] = c
            if dic2[d][2].__contains__('Rs.') or dic2[d][3].__contains__('Unit'):
                # print('data1', dic2[d])
                dic2[d][2] = dic2[d][2].replace('Rs.', '')
                dic2[d][2] = dic2[d][2].rstrip()
                dic2[d][3] = dic2[d][3].replace('Unit', '')
                dic2[d][3] = dic2[d][3].rstrip()
            dic1[lq] = dic2[d]
            lq += 1

        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:  # for 6274 pdf
            # print('data', dic2[d])
            if dic2[d][0].__contains__('*') or dic2[d][0].__contains__('For'):
                # print('data', dic2[d])
                if dic2[d][0].__contains__('*') and dic2[d][3] != ' ' and dic2[d].__contains__('@') == 1:
                    print('data', dic2[d])
                    a, b = dic2[d][3].split('@ Rs.')
                    dic2[d][0] = dic2[d][0] + a
                    dic2[d][2] = b.replace('For', '')
                    dic2[d][3] = dic2[d][3].replace(dic2[d][3], '')

                if dic2[d][0].__contains__('*') and dic2[d][3] == ' ':
                    # print('data', dic2[d])
                    dic2[d][0] = dic2[d][0].replace('( Rs.', '@ Rs.')
                    dic2[d][0] = dic2[d][0].replace('a Rs.', '@ Rs.')
                    a, b = dic2[d][0].split('@')
                    dic2[d][0] = a
                    dic2[d][2] = b
                    # dic1[lq] = dic2[d]
                    # lq += 1
                    if dic2[d][2].__contains__('Dr.'):
                        a, b = dic2[d][2].split('*')
                        dic2[d][2] = a.lstrip('Rs.')
                        dic2[d][0] = dic2[d][0] + b
                        # dic1[lq] = dic2[d]
                        # lq += 1
                if dic2[d][0].__contains__('For'):
                    dic2[d][0] = dic2[d][0].strip('For')
                    # print('data', dic2[d])
                    dic2[d][0] = dic2[d][0].replace('a Rs.', '@ Rs.')
                    # print('data', dic2[d])
                    if len(re.findall(
                            '\w{2}\-\w{3}\-\d{2}|\w{2}\-\w{3}\-\w{3}|\w{2}\-\w{4}\-\w{1}|\w{2}\-\w{5}\-\w{1}|\w{3}\-\d{3}|\w{2}\-\w{3}\-\d',
                            dic2[d][3])) == 1:
                        dic2[d][3] = re.sub(
                            '\w{2}\-\w{3}\-\d{2}|\w{2}\-\w{3}\-\w{3}|\w{2}\-\w{4}\-\w{1}|\w{2}\-\w{5}\-\w{1}|\w{3}\-\d{3}|\w{2}\-\w{3}\-\d',
                            '', dic2[d][3])
                        # print('data', dic2[d])
                        # dic1[lq] = dic2[d]
                        # lq += 1
                    dic2[d][2] = dic2[d][2].strip()
                    dic2[d][3] = dic2[d][3].strip()
                    # dic1[lq] = dic2[d]
                    # lq += 1
                    # print('data', dic2[d])
                    if len(dic2[d][3].split()) == 2:
                        # print('data', dic2[d])
                        a, b = dic2[d][3].split()
                        dic2[d][3] = a.strip()
                        # dic1[lq] = dic2[d]
                        # lq += 1
                    if dic2[d][0].__contains__('Rs.'):
                        # print('data', dic2[d])
                        a, b = dic2[d][0].split('Rs.', 1)
                        dic2[d][0] = a.replace('@', '')
                        dic2[d][0] = dic2[d][0].strip()
                        dic2[d][2] = b
                        # print('data', dic2[d])
                        # dic1[lq] = dic2[d]
                        # lq += 1
            if dic2[d][2].__contains__('*') == 1:
                print('data', dic2[d])
                dic2[d][2] = dic2[d][2].replace('*', ' ')
                dic2[d][2] = dic2[d][2].strip()
            if dic2[d][2].__contains__('Investigation') == 1 or dic2[d][0].__contains__('Investigation') == 1 or \
                    dic2[d][3].__contains__('Investigation') == 1:
                # print('data', dic2[d])
                dic2[d][0] = dic2[d][0].replace('Investigation', ' ')
                dic2[d][0] = dic2[d][0].strip()
                dic2[d][2] = dic2[d][2].replace('Investigation', ' ')
                dic2[d][2] = dic2[d][2].strip()
                dic2[d][3] = dic2[d][3].replace('Investigation', ' ')
                dic2[d][3] = dic2[d][3].strip()
                if dic2[d][2].__contains__('For') == 1:
                    print('data', dic2[d])
                    a, b = dic2[d][2].split('For', 1)
                    dic2[d][2] = a
                    dic2[d][2] = dic2[d][2].strip()
                    dic2[d][3] = b
                    dic2[d][3] = dic2[d][3].strip()
            if dic2[d][2].__contains__('For') == 1:
                # print('data', dic2[d])
                a, b = dic2[d][2].split('For',1)
                dic2[d][2] = a
                dic2[d][2] = dic2[d][2].strip()
                dic2[d][3] = b
                dic2[d][3] = dic2[d][3].strip('Unit')
                dic2[d][3] = dic2[d][3].strip()

                # print('kkbl',dic2[d])
            if dic2[d][3].__contains__('Day(s)') == 1:
                dic2[d][3] = dic2[d][3].replace('Day(s)', '')
            if dic2[d][2].__contains__('Per Day') == 1:
                dic2[d][2] = dic2[d][2].replace('Per Day', '')
            #     dic2[d][2] = dic2[d][2].strip('Per Day')
            if dic2[d][0].__contains__('Rs.') == 1:
                a, b = dic2[d][0].split('Rs.')
                dic2[d][0] = a
                dic2[d][2] = b
                dic2[d][3] = '1'
            if len(re.findall('\d\.\d', dic2[d][3])) == 1 and len(dic2[d][3].split()) >= 2:
                print('finallu', dic2[d])
                a, b = dic2[d][3].split(' ', 1)
                dic2[d][3] = a
            if len(re.findall('\*\s\s?\w{2}\.', dic2[d][2])) == 1:
                print('Hellollllll', dic2[d])
                a, b = re.split('\*\s\s?', dic2[d][2])
                dic2[d][2] = a
                dic2[d][0] = dic2[d][0] + b
            dic1[lq] = dic2[d]
            lq += 1
    # //////////////////////////
    if hospital=='vijaya_chennai-pharma':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('data', dic2[d])
            if len(re.findall('^\d{1,3}\s\w',dic2[d][0]))==1:
                dic2[d][0]= re.sub('^\d{1,2}\s','',dic2[d][0])
                dic2[d][0].strip()
                # print('data', dic2[d])
            if len(re.findall('\d\.\d',dic2[d][4]))==5 or len(re.findall('\d\.\d',dic2[d][4]))==4 or len(re.findall('\d\.\d',dic2[d][4]))==3:
                # print('data', dic2[d])
                a,b = dic2[d][4].split(' ',1)
                # print('data1',a)
                # print('data2',b)
                dic2[d][4] = a
                dic2[d][4].strip()
            if len(re.findall('\d\.\d',dic2[d][3]))==2 and len(dic2[d][3].split())==3:
                # print('data', dic2[d])
                a,b,c = dic2[d][3].split()
                dic2[d][2] = a
                dic2[d][3] = b
                dic2[d][4] = c
            if len(re.findall('\d\.\d', dic2[d][3])) > 3:
                # print('data', dic2[d])
                a,b,c = dic2[d][3].split(' ',2)
                # print('data1',a)
                # print('data2',b)
                dic2[d][3] = a
                dic2[d][4] = b
            if len(re.findall('\d\.\d', dic2[d][2])) > 3:
                # print('data', dic2[d])
                a,b,c= dic2[d][2].split(' ',2)
                # print('data1',a)
                # print('data2',b)
                dic2[d][2] = a
                dic2[d][3] = b
                dic2[d][4] = c
                if len(re.findall('\d\.\d', dic2[d][4])) > 3:
                    a, b = dic2[d][4].split(' ', 1)
                    dic2[d][4] = a
            if len(re.findall('\d\.\d', dic2[d][5])) >= 1:
                # print('data', dic2[d])
                if len(re.findall('\d\.\d', dic2[d][5]))==2:
                    a,b= dic2[d][5].split(' ',1)
                    # print('data1',a)
                    # print('data2',b)
                    dic2[d][5] = b
                if len(re.findall('\d\.\d', dic2[d][5]))>=3:
                    # print('data', dic2[d])
                    a, b = dic2[d][5].rsplit(' ', 1)
                    # print('data1', a)
                    # print('data2',b)
                    dic2[d][5] = b
                if dic2[d][5].count(' ')>2:
                    # print('data', dic2[d])
                    a, b = dic2[d][5].rsplit(' ', 1)
                    # print('data1', a)
                    # print('data2',b)
                    dic2[d][5] = b
            if len(re.findall('\d\.\d', dic2[d][4]))>=1 and dic2[d].count(' ')==4:
                # print('data', dic2[d],dic2[d-1])
                dic2[d-1][5] = dic2[d][5]
                dic2[d][4] = ' '
                dic2[d][5] = ' '
            dic1[lq] = dic2[d]
            lq += 1

        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('data', dic2[d])
            if len(re.findall('\d\.\d',dic2[d][5]))==1 and dic2[d].count(' ')==5 and len(re.findall('\d\.\d',dic2[d+1][5]))==1 and len(re.findall('\d\.\d',dic2[d-1][5]))==1:
                print('data', dic2[d])
                dic2[d].pop(5)
                dic2[d].insert(5, ' ')
            if dic2[d][3].__contains__('Total Amount :'):
                dic2[d][3] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    # //////////////////////////
    if hospital == 'jaslok' or hospital == 'jaslok1':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][2].__contains__('CSSD CHARGES') or dic2[d][2].__contains__('MAIN STORE ITEM MANUAL') or dic2[d][
                2].__contains__('MEDICINE FROM DRUGS STORE') or dic2[d][2].__contains__('STORES CHARGES FROM FLOOR'):
                dic2[d][2] = ' '
            if len(dic2[d][0]) > 5 and len(re.findall('^\d+\s?\D\s?\w+', dic2[d][0])) == 1:
                cln = copy.deepcopy(dic2[d])
                cln_zero = re.sub('^\d+\s?\D\s?', '', cln[0])
                cln.pop(0)
                cln.insert(0, cln_zero)
                dic2[d] = cln
            if dic2[d][0] in head_list and dic2[d].count(' ') <= 3:
                print('220100795985', dic2[d])
                nevv = copy.deepcopy(dic2[d])
                linn1 = [nevv[0], ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = linn1
                lq += 1
                linn2 = [' '] + nevv[1:]
                dic1[lq] = linn2
                lq += 1

            if len(re.findall('\d?\/\d{1,2}\/\d{4}\d|\d?\/\d{1,2}\/\d{4}\D|\d?\/\d{1,2}\/\d{4}\s?\d', dic2[d][2])) == 1:
                print('DateDescription', dic2[d])
                cln2 = copy.deepcopy(dic2[d])
                cln2_zero = re.sub('\d?\/\d{1,2}\/\d{4}', '', cln2[2])
                cln2.pop(2)
                cln2.insert(2, cln2_zero)
                dic2[d] = cln2

            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'jaslok2':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][2].__contains__('CSSD CHARGES') or dic2[d][2].__contains__('MAIN STORE ITEM MANUAL') or dic2[d][
                2].__contains__('MEDICINE FROM DRUGS STORE') or dic2[d][2].__contains__('STORES CHARGES FROM FLOOR'):
                dic2[d][2] = ' '
            if len(re.findall('^\d+\s?\D\s?\w+|\D+\d\s?\D\s?\w+', dic2[d][0])) and dic2[d].count(' ') == 5:
                print('HOOOO', dic2[d])
                cln = copy.deepcopy(dic2[d])
                cln_zero = re.sub('^\d+\s?\D\s?', '', cln[0])
                cln.pop(0)
                cln.insert(0, cln_zero)
                dic2[d] = cln
                print('NOOO', dic2[d])

            if dic2[d][1].__contains__(sbt) and dic2[d][2].__contains__(sbt) and dic2[d].count(' ') >= 2:
                print('KOKO', dic2[d])
                dic2[d].pop(2)
                dic2[d].insert(2, ' ')
            # if dic2[d][1]

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'jaslok-pharma':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('data', dic2[d])
            if len(re.findall('\d+\.\d\s?\d+', dic2[d][5])) == 1 and len(dic2[d][5].split()) == 2 and dic2[d][
                4] == ' ' and dic2[d].count(' ') < 3:
                # print('5th', dic2[d])
                a, b = dic2[d][5].split()
                # print('aaa', a)
                # print('bbb', b)
                dic2[d][5] = dic2[d][5].replace(b, '')
                dic1[lq] = dic2[d]
                lq += 1
                continue

            if len(re.findall('\d\.\d{2}\s?\d+\.\d{1,2}', dic2[d][5])) == 1 and len(dic2[d][5].split()) == 2 and \
                    dic2[d][4] == ' ' and dic2[d].count(' ') < 3:
                # print('5th', dic2[d])
                a, b = dic2[d][5].split()
                # print('abb', a)
                # print('bbb', b)
                dic2[d][5] = b
                # print('a11',dic2[d])
                dic1[lq] = dic2[d]
                lq += 1
                continue
            if dic2[d][0].count(' ') > 1 and dic2[d][0] not in head_list:
                print('5th', dic2[d])
                a, b = dic2[d][0].split(' ', 1)
                dic2[d][0] = a
            dic1[lq] = dic2[d]
            lq += 1

        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('noneeee',dic2[d])
            if dic2[d][0].__contains__(dic2[d][1]) and dic2[d].count(' ') > 2 and dic2[d][0] not in head_list:
                # print('noneeee', dic2[d])
                dic2[d][0] = ' '

            if len(re.findall('\d{1,2}\w{1,2}\d{1,7}\w?\d{1,2}', dic2[d][1])):
                # print('noneeee', dic2[d])
                dic2[d][1] = re.sub('\d{1,2}\w{1,2}\d{1,7}\w?\d{1,2}', '', dic2[d][1])
                # print('noneeee', dic2[d])
                dic2[d][1] = dic2[d][1].strip()
            dic1[lq] = dic2[d]
            lq += 1
    # //////////////////////////
    if hospital == 'nanavati':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('hellp',dic2[d])
            if len(re.findall('^\d{1,4}\s',dic2[d][0]))==1 and dic2[d].count(' ')>=1:
                # print('hellp', dic2[d])
                dic2[d][0] = re.sub('^\d{1,4}\s', '', dic2[d][0])
            if dic2[d][5].__contains__(sbt) and dic2[d].count(' ')==5:
                dic2[d][5]=' '
            if dic2[d][2].__contains__('Packet') or dic2[d][2].__contains__('Nos') or dic2[d][2].__contains__('No') or dic2[d][2].__contains__('Inch')\
                    or dic2[d][2].__contains__('Ampoul') or dic2[d][2].__contains__('es') or dic2[d][2].__contains__('Tablets') or dic2[d][2].__contains__('Vial')\
                    or dic2[d][2].__contains__('Patches') or dic2[d][2].__contains__('Bottle') or dic2[d][2].__contains__('as')\
                    or dic2[d][2].__contains__('Patch') or dic2[d][2].__contains__('Sachets'):
                dic2[d][2] = dic2[d][2].replace('Packet','')
                dic2[d][2] = dic2[d][2].replace('Nos', '')
                dic2[d][2] = dic2[d][2].replace('No', '')
                dic2[d][2] = dic2[d][2].replace('Inch', '')
                dic2[d][2] = dic2[d][2].replace('Ampoul', '')
                dic2[d][2] = dic2[d][2].replace('es', '')
                dic2[d][2] = dic2[d][2].replace('Tablets', '')
                dic2[d][2] = dic2[d][2].replace('Vial', '')
                dic2[d][2] = dic2[d][2].replace('Patches', '')
                dic2[d][2] = dic2[d][2].replace('Bottle', '')
                dic2[d][2] = dic2[d][2].replace('as', '')
                dic2[d][2] = dic2[d][2].replace('Patch', '')
                dic2[d][2] = dic2[d][2].replace('Sachets', '')
                dic2[d][2] = dic2[d][2].strip()
            if dic2[d][2] != ' ' and len(dic2[d][2].split('  ')) == 2 and dic2[d][3] == ' ' and dic2[d].count(' ') < 3:
                print('hellp11', dic2[d])
                a, b = dic2[d][2].split(' ', 1)
                dic2[d][2] = a.strip()
                dic2[d][3] = b.strip()
            dic1[lq] = dic2[d]
            lq += 1
    #//////////////////////////
    if hospital == 'thunga' or hospital=='Thunga_N1700':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('hellp',dic2[d])
            if dic2[d][0] not in head_list and len(re.findall('^\d+\s?', dic2[d][0])) == 1 and dic2[d].count(' ') == 3:
                dic2[d][0] = re.sub('^\d+\s?', '', dic2[d][0])
            if dic2[d][0] in head_list and dic2[d][5].count(' ') < 3 and len(re.findall('\d\.\d', dic2[d][5])) == 1:
                print('hensnsn', dic2[d])
                dic2[d][0] = dic2[d][0].lower()
            if dic2[d][1] == 'Subtotal':
                dic2[d][1] = 'Sub Total'
            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'thunga-pharma' or hospital=='Thunga_N1700-pharma':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('hellp',dic2[d])
            if len(re.findall('\d{1,}\/\d{1,}\/\w{1,}\/\d{1,}\s?', dic2[d][0])) == 1 and dic2[d].count(' ') < 6:
                # print('hellp',dic2[d])
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if len(re.findall('^\d{1,}\s?', dic2[d][0])) == 1 and dic2[d].count(' ') < 4:
                dic2[d][0] = re.sub('^\d{1,}\s?', '', dic2[d][0]).strip()
            if dic2[d].count(' ') == 5 or dic2[d].count(' ') == 4:
                # print('error',dic2[d])
                if dic2[d][1].__contains__(sbt) == False:
                    print('error', dic2[d])
                    dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
    #//////////////////////////
    if hospital == 'bhatia':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('hellp',dic2[d])
            if dic2[d][0]=='2D ECHO Tota':
                dic2[d][0]='2D ECHO Total'
            if dic2[d][0]=='C. T. SCAN Tot':
                dic2[d][0]='C. T. SCAN Total'
            if dic2[d][0]=='PATH - CLINICAL Tot':
                dic2[d][0]='PATH - CLINICAL Total'
            if dic2[d][0]=='ICU CHARGES Tota':
                dic2[d][0]='ICU CHARGES Total'
            if dic2[d][0]=='EDURE HARGES':
                dic2[d][0]='PROCEDURE CHARGES'
            if dic2[d][0]=='- HAEMATOL' or dic2[d][0]== 'PATH - HAEMATOLOGY Tota':
                dic2[d][0]='PATH - HAEMATOLOGY Total'
            if dic2[d][0]=='X-RAY Tota':
                dic2[d][0]='X-RAY Total'
            if dic2[d][0]=='PATH - IMMUNOLOGY Tota':
                dic2[d][0]='PATH - IMMUNOLOGY Total'
            if dic2[d][0]=='PATH - HISTOPATHOLOG Tota':
                dic2[d][0]='PATH - HISTOPATHOLOG Total'
            if dic2[d][0].__contains__('COVID CHARGES') and dic2[d+1][0] in head_list and dic2[d].count(' ')==4:
                print('hellp', dic2[d])
                dic2[d][0] = 'COVID CHARGES Total'

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'sundaram':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d+', dic2[d][0])) and dic2[d].count(' ') >= 0 and dic2[d][6] != ' ':
                print('sno', dic2[d])

                dic2[d][0] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'sagar':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('hellp',dic2[d])
            if len(re.findall('\d\/\d', dic2[d][0])) > 0 and dic2[d][0].count(' ') > 1 and dic2[d].count(' ') < 3 and \
                    dic2[d][1] != ' ':
                # print('hellp',dic2[d])
                a, b = dic2[d][0].split(' ', 1)
                dic2[d][0] = a.strip()
            if len(re.findall('\d{1,}\/\d{1,}\-\d{1,}\d{1,}\s?', dic2[d][0])) == 1 and dic2[d].count(' ') < 4 and \
                    dic2[d][1] == ' ':
                # print('hellp',dic2[d])
                a, b = re.split('\s?\d{1,}\/\d{1,}\-\d{1,}\d{1,}\s?', dic2[d][0], maxsplit=2)
                dic2[d][1] = b.strip()
                dic2[d][1] = re.sub('^\/\s?\d{2,}', '', dic2[d][1]).strip()
                a, b = dic2[d][0].split(' ', 1)
                dic2[d][0] = a.strip()
            if len(re.findall('\d\.\d', dic2[d][2])) > 1 and len(dic2[d][2].split()) == 2 and dic2[d][3] == ' ':
                print('hellp', dic2[d])
                a, b = dic2[d][2].split(' ', 1)
                dic2[d][2] = a.strip()
                dic2[d][3] = b.strip()
            if len(dic2[d][3].split()) == 2 and dic2[d][2] != ' ' or dic2[d][2] == ' ':
                print('hellp', dic2[d])
                if dic2[d][2] != ' ':
                    a, b = dic2[d][3].split(' ', 1)
                    dic2[d][3] = b.strip()
                    dic2[d][2] = dic2[d][2].replace(b, '')
                if dic2[d][2] == ' ':
                    a, b = dic2[d][2].split(' ', 1)
                    dic2[d][2] = a.strip()
                    dic2[d][3] = b.strip()
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'moolchand':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('hellp',dic2[d])
            if len(re.findall('\-\s?\w{5}\d{2}\/\d', dic2[d][0])) == 1 or len(
                    re.findall('\-\s?\w{2}\d{1,}\/\?', dic2[d][0])) == 1 \
                    or len(re.findall('\-\s?\w{2}\d{2}\/\d', dic2[d][0])) == 1 or len(
                re.findall('\-\s?\w{1,5}\d', dic2[d][0])) == 1 and dic2[d].count(' ') < 2:
                # print('hellp', dic2[d])
                a, b = dic2[d][0].split(' ', 1)
                dic2[d][0] = a.strip()
            if len(re.findall('\d\.\d', dic2[d][2])) == 1 and dic2[d][3] == ' ':
                # print('hellp', dic2[d])
                dic2[d][2] = re.sub('\d{1,}\.\d{2}', '', dic2[d][2]).strip()
            if dic2[d].count(' ') == 4 and len(re.findall('\d\.\d', dic2[d][5])) == 1 and len(
                    re.findall('\d\.\d', dic2[d - 1][5])) == 1 and dic2[d][2].__contains__('(10800238) (10800238)'):
                print('hellp', dic2[d])
                dic2[d][2] = 'Total for Store: Pharmacy (MOT)'
            if dic2[d].count(' ') == 4 and len(re.findall('\d\.\d', dic2[d][5])) == 1 and len(
                    re.findall('\d\.\d', dic2[d - 1][5])) == 1 and dic2[d][2].__contains__(
                    'l for Store: Pharmacy (IP)'):
                # print('hellp', dic2[d])
                dic2[d][2] = 'Total for Store: Pharmacy (MOT)'
            if len(re.findall('\d\/\d{2}\/\d{4}', dic2[d][0])) == 1 and dic2[d].count(' ') == 5 and dic2[d + 1][
                0] == ' ' and len(re.findall('\d\.\d', dic2[d + 1][3])) == 1 and \
                    len(re.findall('\d\/\d{2}\/\d{4}', dic2[d - 1][0])) == 1:
                dic2[d + 1][0] = dic2[d][0]
                dic2[d][0] = ' '

                print('hellp', dic2[d])
            if dic2[d][2].__contains__('Total'):
                dic2[d][1] = dic2[d][2]
                dic2[d][2] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'baptist-bangalore':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('hellp',dic2[d])
            if len(dic2[d][0].split())>1 and dic2[d][1] == ' ' and dic2[d][0] not in head_list and len(re.findall('\d\-\d{1,2}\-\d',dic2[d][0])) ==1\
                    or len(re.findall('\d\/\d{1,2}\/\d',dic2[d][0])) == 1 and dic2[d][1] == ' ':
                # print('hellp', dic2[d])
                if len(dic2[d][0].split())>1:
                    a,b = dic2[d][0].split(' ',1)
                    dic2[d][0] = a
                    dic2[d][1] = b
            if len(re.findall('\d\/\d{1,2}\/\d',dic2[d][0])) == 1 and len(re.findall('\d\/\d{1,2}\/\d',dic2[d][1])) == 1 and len(dic2[d][0].split())>1\
                and len(dic2[d][1].split())>1 :
                # print('hellp', dic2[d])
                a,b = dic2[d][0].split(' ',1)
                dic2[d][0] = a
                dic2[d][1] = b
                # print('hellp', dic2[d])
            if dic2[d].count(' ')==4 and dic2[d][1].__contains__(sbt) == False and dic2[d][0] not in head_list:
                # print('hellp', dic2[d])
                dic2[d-1][1] = dic2[d-1][1]+''+dic2[d][1]
                dic2[d][1]='Subtotal'
            if len(re.findall('\d\-\d{1,2}\-\d',dic2[d][1])) == 1:
                # print('hellp',dic2[d])
                a, b = dic2[d][1].split(' ', 1)
                dic2[d][0] = dic2[d][0] + a
                dic2[d][1] = b
                # print('hellp', dic2[d])

            if len(re.findall('\d{1,}\.\d{1,2}',dic2[d][1])) ==1 and dic2[d][3] == ' ':
                # print('hellp', dic2[d])
                dic2[d][3] = dic2[d][5]
                dic2[d][1] = re.sub('\d{1,}\.\d{1,2}','',dic2[d][1])
            if dic2[d][1].__contains__(sbt) and dic2[d][0]!=' ':
                print('hellp', dic2[d])
                dic2[d][1] = ' '


            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Neotia':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('hellp',dic2[d])
            if len(re.findall('\d\-\d{2}\-\d',dic2[d][0]))==1 and dic2[d].count(' ') == 5 :
                # print('hellp', dic2[d])
                dic2[d][0]=' '
            if len(re.findall('\d\.\d',dic2[d][4])):
                print('hellp', dic2[d])
                dic2[d][5] = dic2[d][4]
                dic2[d][4] = ' '
            if dic2[d][2]=='Investigation Tota':
                dic2[d][2]='Investigation Total'
            if dic2[d][2]=='DRUGGROUP T':
                dic2[d][2] = 'DRUGGROUP Total'
            if dic2[d][3]=='Total' or dic2[d][3]=='Day Total':
                dic2[d]=[' ', ' ', ' ', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'asian_N1653':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('hellp',dic2[d])
            if dic2[d][0] == dic2[d][1]:
                dic2[d][1] = ' '
            if len(re.findall('\d\/\d{2}\/\d', dic2[d][1])) == 1:
                text = dic2[d][1]
                matchdate = re.search(r'\d+\/\d{2}\/\d+', text)
                dic2[d][1] = dic2[d][1].replace(matchdate.group(), '')
            if len(re.findall('\d\.\d', dic2[d][3])) == 2 and len(dic2[d][3].split())==2:
                a,b = dic2[d][3].split()
                if dic2[d][4]!=' ':
                    dic2[d][3] = a
                if dic2[d][4]==' ':
                    dic2[d][3] = a
                    dic2[d][3] = b
            if len(re.findall('\d\/\d{2}\/\d', dic2[d][0])) == 1 and dic2[d][1]==' ' and dic2[d+1]!=' ' and dic2[d].count(' ')==4 and \
                dic2[d+1].count(' ')==3:
                print('hellp', dic2[d],dic2[d+1])
                dic2[d][1]=dic2[d+1][1]
                dic2[d][5] = dic2[d + 1][5]
                dic2[d][4] = dic2[d + 1][4]
                dic2[d+1][1] = dic2[d+1][4] = dic2[d+1][5] = ' '
            if len(re.findall('\d\/\d{2}\/\d', dic2[d][0])) == 0 and dic2[d].count(' ')==5 and dic2[d][0] in src_dc['merge_set']:
                dic2[d][1] = dic2[d][0]
                dic2[d][0] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'asian_N1653-pharma' or hospital == 'AIMS1-pharma':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('hellp',dic2[d])
            if  len(dic2[d][2].split())>0 and len(re.findall('\d{1,}\s?\.\s?\d{1,}\s', dic2[d][2])) == 1:
                print('hellp', dic2[d])
                a,b = dic2[d][2].split(' ',1)
                dic2[d][2] = a
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Eternal':
        dic2 = dic1
        dicA = {}
        lq = 1
        for d in dic2:
            if dic2[d][1]=='RGES':
                dic2[d][1]==''
                dic2[d][0]='BED CHARGES'
            if len(re.findall('\d\/\d{2}\/\d',dic2[d][0]))==1 and dic2[d][1]==' ':
                a, b = re.split('\-\s',dic2[d][0], maxsplit=2)
                dic2[d][1] = b
                dic2[d][1] = re.sub('\w{2}\d{1,}\-\d{1,}\/\d{1,}\s', '', dic2[d][1])
                if len(dic2[d][0].split())>1:
                    a,b = dic2[d][0].split(' ', 1)
                    dic2[d][0] = a
            if len(dic2[d][0].split()) > 1 and dic2[d][1]!=' ' and len(re.findall('\d\/\d{2}\/\d',dic2[d][0]))==1 :
                a, b = dic2[d][0].split(' ', 1)
                dic2[d][0] = a

            dic1[lq] = dic2[d]
            lq+=1
    if hospital == 'shalby' or hospital == 'shalby-pharma' or hospital == 'Shalby_N15517' or hospital == 'Sha_N18716'or hospital == 'shalby_N14327':
        dic2 = dic1
        dicA = {}
        lq = 1
        for d in dic2:
            if len(dic2[d][3].split()) == 2 and len(re.findall('^\d\s\d', dic2[d][3])) == 1 and dic2[d][4] == ' ':
                # print('dmmmsms',dic2[d])
                a, b = dic2[d][3].split(' ', 1)
                dic2[d][3] = a
                dic2[d][4] = b
            if len(dic2[d][3].split()) == 3 and dic2[d][4] == ' ' and dic2[d][5] == ' ':
                print('dmmmsms', dic2[d])
                a, b, c = dic2[d][3].split(' ', 2)
                dic2[d][3] = a
                dic2[d][4] = b
                dic2[d][5] = c
            if dic2[d][0].__contains__('CONSUMA') and len(re.findall('\d\.\d', dic2[d][5])) == 1 and dic2[d].count(' ') == 4:
                dic2[d][0] = 'CONSUMABLE Total Rs.'
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'SPH':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][2].__contains__(sbt) and dic2[d + 1][2].__contains__(sbt):
                dic2[d + 1][2] = ' '
                dic2[d + 1][5] = ' '
            if len(dic2[d][5].split()) == 2:
                a, b = dic2[d][5].split()
                dic2[d][5] = a
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
            if dic2[d][5].count(' ') > 1:
                a, b = dic2[d][5].split(' ', 1)
                dic2[d][5] = a
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Dharamshila':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:

            if d > 1 and len(re.findall('\d+\s\d+\D?\d+\s?\d+\D?\d+\s?\d+\D?\d+\.\d+', dic2[d][2])) == 1:
                print('for Qty & MRP')
                a, b = re.split('\s', dic2[d][2], maxsplit=1)
                dic2[d][2] = a
                dic2[d][3] = b

            if d > 1 and len(re.findall('\d+\D?\d+\s\d+\D?\d+\D?\d+\s?\d\D?\d+\D?\d+', dic2[d][3])) == 1:
                print('for MRP & Unit')
                a, b = re.split('\s', dic2[d][3], maxsplit=1)
                dic2[d][3] = a
                dic2[d][4] = b
            if d > 1 and len(re.findall('\d\D?\d+\s\d+\D?\d+\D?\d+', dic2[d][4])) == 1:
                print('for Unit & Gross')
                a, b = re.split('\s', dic2[d][4], maxsplit=1)
                dic2[d][4] = a
                dic2[d][5] = b
            if d > 1 and len(re.findall('\d\D?\d+\s\d+\D?\d+\D?\d+', dic2[d][6])) == 1:
                print('for discount & amount')
                a, b = re.split('\s', dic2[d][6], maxsplit=1)
                dic2[d][6] = a

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='MGM':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('ROMSONS', dic2[d][1])) and dic2[d].count(' ')==4:
                print('hey',dic2[d])
                myl = opr1(dic2[d - 1], dic2[d], src_dc)
                dic1[lq - 1] = copy.deepcopy(myl)
                dic2[d].pop(1)
                dic2[d].insert(1, 'Subtotal')
            if len(re.findall('\d\/\d{2}\/\d{4}\s\d', dic2[d][2])):
                print('daterate', dic2[d])
                a, b = re.split('\d\/\d{2}\/\d{4}\s', dic2[d][2], maxsplit=1)
                print('aaa', a)
                print('bbb', b)
                dic2[d][2] = dic2[d][2].replace(b, '')
                dic2[d][2] = a
                dic2[d][3] = b


            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'ramaiahmemorial':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            print('pmddd',dic2[d])
            if dic2[d][0]==' +Consultation Charges':
                dic2[d][0]='Consultation Charges'
            if dic2[d][0]=='Cystoscopy urs with DJ stenting unilateral':
                dic2[d+1][2]='Sub Total'
            if len(re.findall('^\d{1,}',dic2[d][0]))==1 and dic2[d].count(' ')==5 or dic2[d].count(' ')==2:
                #print('hellp', dic2[d])
                dic2[d][0]=re.sub('^\d{1,}','',dic2[d][0])

            if d>1 and dic2[d][0] in head_list and dic2[d-1][2]!='Sub Total':
                print('yes',dic2[d])
                dic2[d][0]=dic2[d][0].lower()
            if d>1 and dic2[d][0]not in head_list  and dic2[d][0] not in sub_head and dic2[d].count(' ')==5:
                print('mergeing',dic2[d])
                dic2[d-1][0]=dic2[d-1][0]+dic2[d][0]
                dic2[d][0]=' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'sparshhospital_N14752':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:


            # print('hellp',dic2[d])
            if len(re.findall('\d+\.?\s\w+', dic2[d][0])):
                print('date', dic2[d])
                a, b = re.split('\d+\.?\s', dic2[d][0], maxsplit=1)
                print('aa', a)
                print('bb', b)
                dic2[d][0] = dic2[d][1].replace(a, '')
                dic2[d][0] = b

            if d>2 and len(re.findall('\d\.\d', dic2[d][7])) == 1 and dic2[d].count(' ')==6 and dic2[d+1][7]==' ':
                print('mergeing',dic2[d-1],dic2[d],dic2[d+1])
                dic2[d+1][7]=dic2[d][7]
                dic2[d][7]=' '
            if d>2 and len(re.findall('\d\.\d', dic2[d][6])) == 1 and dic2[d].count(' ')==6 and dic2[d+1][6]==' ':
                print('mergeing',dic2[d-1],dic2[d],dic2[d+1])
                dic2[d+1][6]=dic2[d][6]
                dic2[d][6]=' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'RGStone_N0433':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][4] == '0.00' and len(dic2[d][3].split(' ')) == 2:
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'motherhood_N17143':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:

            if d > 1 and len(re.findall('\d\-\d{2}\-\d{4}', dic2[d - 1][0])) and dic2[d - 1].count(' ') >= 3 and dic2[
                d] != ' ' and dic2[d].count(' ') >= 1:
                print('linebreak', dic2[d])
                tty1 = opr1(dic2[d - 1], dic2[d], src_dc)
                dic1[lq - 1] = tty1
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            for i in head_list:
                if i in dic2[d][0] and dic2[d].count(' ') <= 3:
                    print('PROFILEEE')
                    lineee = [i, ' ', ' ', ' ', ' ', ' ']
                    dic1[lq] = dic2[d]
                    lq += 1
                    dic1[lq - 1] = lineee
                    dic2[d][0] = dic2[d][0].replace(i, '')

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'kims_N1251':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('merge', dic2[d])
            if d >= 1 and d < len(dic2) and dic2[d][0].__contains__('Room Rent#'):
                a, b = dic2[d][0].split('#', 1)
                dic2[d][0] = a
                dic2[d + 1][0] = b
            if len(re.findall(
                    '\(?\d+\-\w+\-\d+\s?\d{1,}\:\d+\:\d+\s?\w+\s?\w+\s?\d+\-\w+\-\d+\s?\d{1,}\:\d+\:\d+\s?\w+\)',
                    dic2[d][0])) == 1:
                print('rooooom rennnt', dic2[d])
                text = dic2[d][0]
                matchdate = re.search(
                    r'\(?\d+\-\w+\-\d+\s?\d{1,}\:\d+\:\d+\s?\w+\s?\w+\s?\d+\-\w+\-\d+\s?\d{1,}\:\d+\:\d+\s?\w+\)', text)
                dic2[d][0] = text.replace(matchdate.group(), '')
                dic2[d][0] = dic2[d][0].strip()
                # dic2[d][0] = dic2[d][0].replace(' ', '', -1)
                # dic2[d][0] = dic2[d][0].replace('*', '', -1)
            if dic2[d][0] != ' ' and dic2[d].count(' ') == 5 and dic2[d][0] not in head_list and dic2[d - 1][
                0] in head_list:
                dic2[d + 1][0] = dic2[d][0] + " " + dic2[d + 1][0]
                dic2[d][0] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Neo_N15412':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('^\d{1,}\.\s',dic2[d][0]))==1 or len(re.findall('^\w\d{1,}\.\s',dic2[d][0]))==1  and len(re.findall('\d\.\d',dic2[d][5]))==1:
                print('hellp',dic2[d])
                dic2[d][0] = re.sub('^\d{1,}\.\s|^\w\d{1,}\.\s','',dic2[d][0])
            if len(re.findall('\d{1,}\-\w{3}\-\d{1,}', dic2[d][0])) == 1 and dic2[d][1] ==' ':
                # print('hellp', dic2[d])
                text = dic2[d][0]
                matchrate = re.search(r'\d{1,}\-\w{3}\-\d{1,}', text)
                dic2[d][1] = dic2[d][0].replace(matchrate.group(), '')
                dic2[d][0] = matchrate.group()
                dic2[d][1] = dic2[d][1].strip()
                # print('hellp', dic2[d])
            if len(re.findall('\d{1,}\-\w{3}\-\d{1,}', dic2[d][0])) == 2 and dic2[d][1] ==' ':
                text = dic2[d][0]
                matchrate = re.search(r'\d{1,}\-\w{3}\-\d{1,}', text)
                dic2[d][1] = dic2[d][0].replace(matchrate.group(), '')
                dic2[d][0] = matchrate.group()
                dic2[d][1] = dic2[d][1].strip()
            if dic2[d][0].__contains__(dic2[d][1]) and dic2[d].count(' ')<3:
                print('hellp11',dic2[d])
                if dic2[d][0] == dic2[d][1]:
                    dic2[d][0] = ' '
                else:
                    text = dic2[d][0]
                    matchrate = re.search(r'\d{1,}\-\w{3}\-\d{1,}|\w{1,}\-\w{3}\-\d{1,}|\d{1,}\s\w{3}\s\d{1,}|\d{1,}\s\w{3}\-\d{1,}', text)
                    dic2[d][0] = matchrate.group()
            if len(re.findall('\d\.\d', dic2[d][3])) == 2:
                a,b = dic2[d][3].split(' ',1)
                dic2[d][3] = a


            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Saraswati_N17332':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('hellp',dic2[d])
            if len(re.findall('\d{1,}\/\d{2}\/\d{1,}',dic2[d][0]))==1 and dic2[d].count(' ')==5:
                # print('hellp', dic2[d])
                dic2[d-1][0] = dic2[d-1][0] +' '+dic2[d][0]
                dic2[d][0] = ' '
            if len(re.findall('^\d{1,}\/\d{2}\/\d{1,}',dic2[d][0]))==1 and dic2[d].count(' ')==3:
                # print('hellp', dic2[d])
                dic2[d - 1][0] = dic2[d - 1][0] + ' ' + dic2[d][0]
                dic2[d][0] = ' '
                dic2[d][1] = 'Subtotal'
            if len(re.findall('^\d{1,}\/\d{2}\/\d{1,}',dic2[d][0]))==1 and dic2[d].count(' ')==2:
                # print('hellp', dic2[d])
                dic2[d - 1][0] = dic2[d - 1][0] + ' ' + dic2[d][0]
                dic2[d][0] = ' '
                dic2[d][1] = 'Subtotal'
                # print('hellp', dic2[d])
            dic1[lq] = dic2[d]
            lq += 1

        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d{1,}\/\d{2}\/\d{1,}', dic2[d][0])) == 1 and dic2[d][2] != ' ':
                # print('hellp', dic2[d])
                if len(re.findall('\d{1,}\/\d{2}\/\d{1,}', dic2[d][2])) == 1:
                    print('hellp', dic2[d])
                    text = dic2[d][0]
                    matchrate = re.search(r'\d{1,}\/\d{2}\/\d{1,}', text)
                    dic2[d][0] = dic2[d][0].replace(matchrate.group(), '')
                else:
                    dic2[d][2] = ' '
            if len(re.findall('\d{1,}\/\d{2}\/\d{1,}', dic2[d][0])) == 1 and dic2[d][2] ==' ':
                # print('hellp', dic2[d])
                text = dic2[d][0]
                matchrate = re.search(r'\d{1,}\/\d{2}\/\d{1,}', text)
                dic2[d][2] = matchrate.group()
                dic2[d][0] = dic2[d][0].replace(matchrate.group(), '')
                # print('hellp', dic2[d])
            if dic2[d][0] ==' ' and dic2[d][1] ==' ' and dic2[d][2] ==' ' and dic2[d].count(' ')==3:
                dic2[d][1] = 'Subtotal'
            if len(re.findall('\d\.\d', dic2[d][5])) == 2 and len(dic2[d][5].split())==2:
                print('twodi',dic2[d])
                a,b = dic2[d][5].split()
                dic2[d][5] = a
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Kamineni_N0066':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][0] in head_list and dic2[d+1][0] in head_list and dic2[d].count(' ')==4 and dic2[d+1].count(' ')==4:
                # print('hellp',dic2[d],dic2[d+1])
                dic2[d+1][0] = dic2[d+1][0].upper()
            if len(re.findall('\d\/\d{2}\/\d',dic2[d][0]))==1 and dic2[d].count(' ') == 4:
                # print('hellp',dic2[d])
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if  len(re.findall('\w{3}\-\d{1,}\s?',dic2[d][2]))==1:
                # print('hellp', dic2[d])
                text = dic2[d][2]
                matchrate = re.search(r'\w{3}\-\d{1,}', text)
                dic2[d][2] = matchrate.group()
            if  len(re.findall('\d\/\d{2}\/\d',dic2[d][2]))==1:
                # print('hellp', dic2[d])
                text = dic2[d][2]
                matchrate = re.search(r'\d{1,}\/\d{1,}\/\d{1,}', text)
                dic2[d][2] = matchrate.group()

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'pushpawati_daycare':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(dic2[d][3].split())>1 and len(re.findall('\d\.\d',dic2[d][3]))==2:
                a,b = dic2[d][3].split(' ',1)
                dic2[d][3] = a
                dic2[d][5] = b
            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'Vedant_N14369-pharma':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][1].__contains__('Total For Voucher No'):
                dic2[d] = [' ',' ',' ',' ',' ',' ']

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Horizon_N18007-pharma':
        dic2=dic1
        dic1={}
        lq=1
        for d in dic2:
            if len(re.findall('\d{8}',dic2[d][0]))==1 and dic2[d][1]!=' ':
                print('pharmacyyy',dic2[d])
                dic2[d]=['Pharmacy', ' ', ' ', ' ', ' ', ' ']


            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Santom_N4135':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('^\d{1,}\.',dic2[d][0]))==1 and dic2[d].count(' ')>3:
                print('hellp',dic2[d])
                dic2[d][0] = re.sub('^\d{1,}\.','',dic2[d][0])
            if dic2[d][2].__contains__('Total') and dic2[d][3].__contains__('Total') and dic2[d][2]!=' ' :
                dic2[d][2] = ' '
            if dic2[d][5].__contains__('Total'):
                dic2[d][5]=' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Santom_N4135-pharma':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # if dic2[d].count(' ')>2 and len(re.findall('^\d{1,}\-\w{1,}\-\d{1,}',dic2[d][0]))==1:
            #     dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            # if len(re.findall('\d\.\d',dic2[d][5]))==1 and dic2[d].count(' ')>3 and dic2[d][3].__contains__('Total')==False:
            #     print('hellp',dic2[d])
            #     dic2[d][5] = ' '
            if len(re.findall('^\d{1,}\-\w{1,}\-\d{1,}', dic2[d][0])) == 1 and dic2[d][1] == ' ' and dic2[d].count(
                    ' ') < 5 and len(dic2[d][0].split()) > 1:
                print('hellppp', dic2[d])
                text = dic2[d][0]
                matchrate = re.search(r'^\d{1,}\-\w{1,}\-\d{1,}\s', text)
                dic2[d][0] = matchrate.group()
                dic2[d][1] = text.replace(matchrate.group(), '')
            if len(re.findall('^\d{1,}\-\w{1,}\-\d{1,}', dic2[d][0])) == 1 and dic2[d].count(' ') == 5:
                dic2[d][0] = ' '
            if len(re.findall('\d\.\d', dic2[d][4])) == 1 and dic2[d].count(' ') == 5:
                dic2[d][4] = ' '
            if dic2[d][3].__contains__('Amount'):
                dic2[d][3] = 'Total Amount :'
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Sainath_N13533':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][3].__contains__('Days') or dic2[d][3].__contains__('NORMAL'):
                dic2[d][3] = dic2[d][3].strip('Days')
                dic2[d][3] = dic2[d][3].strip('NORMAL')
                dic2[d][3] = dic2[d][3].strip('-')
            if dic2[d][0] == 'SERVICE DETAILS' and (
                    dic2[d + 1][0].__contains__('IPD RELATED') or dic2[d + 1][0].__contains__('PD RELATED')):
                print('hello', dic2[d])
                dic2[d][0] = 'SERVICE DETAILS IPD RELATED'
                dic2[d + 1][0] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    
    if hospital == 'Bansal':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('hellp',dic2[d])
            if dic2[d][0] in head_list and dic2[d][2]!=' ':
                dic2[d+1][2] = dic2[d][2] + dic2[d+1][2]
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Bansal-pharma1':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('hellp',dic2[d])
            if len(re.findall('\d\.\d',dic2[d][4]))==2 and len(dic2[d][4].split())==2:
                print('hellp', dic2[d])
                a,b = dic2[d][4].split()
                dic2[d][4] = a
                dic2[d][5] = b
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Savla_N15124':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][0] in head_list and len(re.findall('\d\.\d', dic2[d][5])) == 1 and dic2[d].count(' ') < 4:
                dic2[d][0] = dic2[d][0].lower()

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'psghospital':
        dic2 = dic1
        dicA = {}
        lq = 1
        for d in dic2:
            if dic2[d][0] in head_list and len(re.findall('\d', dic2[d][5])) > 0 and len(
                    re.findall('\d\-\w{3}\-\d', dic2[d][1])) == 1:
                # print('dic2[ddd', dic2[d])
                dic2[d][0] = dic2[d][0].lower()
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'psghospital-pharma':
        dic2 = dic1
        dicA = {}
        lq = 1
        for d in dic2:
            # print('dic2[ddd', dic2[d])
            if len(re.findall('^\d{1,}\s', dic2[d][0])) == 1 and dic2[d].count(' ') == 2:
                dic2[d][0] = re.sub('^\d{1,}\s', '', dic2[d][0])

            if len(dic2[d][2].split()) > 1:
                a, b = dic2[d][2].split(' ', 1)
                dic2[d][2] = a
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'apolo_1':
        dic2 = dic1
        dicA = {}
        lq = 1
        for d in dic2:
            # print('dic2[ddd', dic2[d])
            if len(re.findall('^\d{1,}\s', dic2[d][0])) == 1 and dic2[d].count(' ') > 2:
                dic2[d][0] = re.sub('^\d{1,}\s', '', dic2[d][0])
            if len(re.findall('^\d{1,}\|\s?', dic2[d][0])) == 1 and dic2[d].count(' ') > 2:
                dic2[d][0] = re.sub('^\d{1,}\|\s?', '', dic2[d][0])
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Savla_N15124' or hospital == 'iasis_N16931':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][0] in head_list and len(re.findall('\d\.\d', dic2[d][5])) == 1 and dic2[d].count(' ') < 4:
                dic2[d][0] = dic2[d][0].lower()

            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='criticare_N5848' or hospital=='iasis_N16931':
        dic2 = dic1
        dicA = {}
        lq = 1
        for d in dic2:
            if len(re.findall('^\d{1,}\s',dic2[d][0]))==1 and dic2[d].count(' ')<4:
                dic2[d][0] = re.sub('^\d{1,}\s','',dic2[d][0])
            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Shalby_N15517-pharma' or hospital == 'Sha_N18716'or hospital == 'shalby_N14327':
        dic2 = dic1
        dicA = {}
        lq = 1
        for d in dic2:
            if dic2[d][5] == ' ' and len(re.findall('\d\.\d',dic2[d][4]))>1 and dic2[d].count(' ')<4 and len(dic2[d][4].split())==2:
                print('hellp',dic2[d])
                a,b = dic2[d][4].split(' ',1)
                dic2[d][4] = a
                dic2[d][5] = b
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Vision_N16937':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][5].__contains__('RS.') or dic2[d][5].__contains__('Rs.') and len(re.findall('\d\.\d',dic2[d][5]))==1:
                dic2[d][5] = dic2[d][5].replace('RS. ','')
                dic2[d][5] = dic2[d][5].replace('Rs. ', '')
            if dic2[d][0].__contains__('@'):
                print('@@@@',dic2[d])
                a,b = dic2[d][0].split('@',1)
                dic2[d][0] = a
                dic2[d][1] = b
                if dic2[d][1].__contains__('*'):
                    a,b = dic2[d][1].split('*')
                    dic2[d][1] = a
                    dic2[d][2] = b
                elif dic2[d][1].__contains__('@'):
                    a,b = dic2[d][1].split('@')
                    dic2[d][1] = a
                    dic2[d][2] = b
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Victor_N0472':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('hemmms',dic2[d])
            if dic2[d][1]!= ' '  and dic2[d].count(' ')==5 and dic2[d-1][3] == sbt:
                dic2[d+1][1]= dic2[d][1]
                dic2[d][1] = ' '
            if dic2[d][0] == dic2[d][1] or dic2[d][0] not in head_list:
                dic2[d][0] = ' '
            dic1[lq] = dic2[d]
            lq += 1
   
    if hospital == 'Welcare_N0681-pharma':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('^\d{1,}\s',dic2[d][0]))==1:
                dic2[d][0] = re.sub('^\d{1,}\s','',dic2[d][0])
            if dic2[d][0].__contains__('Rs'):
                a,b = dic2[d][0].split('Rs.')
                dic2[d][0] = a
                dic2[d][1] = b
            if len(re.findall('\d{1,}\s\w\s\d{1,}\s',dic2[d][0]))==1:
                text = dic2[d][0]
                matchrate = re.search(r'\d{1,}\s\w\s\d{1,}\s', text)
                dic2[d][1] = matchrate.group()
                dic2[d][0] = text.replace(matchrate.group(), '')
                dic2[d][1] = dic2[d][1].strip()
            if len(re.findall('\d{1,}\s\w\s\d{1,}', dic2[d][1])) == 1:
                print('hellp',dic2[d])
                a,b = re.split('\s\w{1}\s',dic2[d][1])
                dic2[d][1] = a.strip()
                dic2[d][2] = b.strip()
            if dic2[d][2]== ' ':
                dic2[d][2] = '1'
            if dic2[d][1] == ' ' and dic2[d][5]!=' ' and dic2[d][5].__contains__('Total') == False:
                dic2[d][1] = dic2[d][5]
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Welcare_N0681':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('^\d{1,}\s',dic2[d][0]))==1:
                dic2[d][0] = re.sub('^\d{1,}\s','',dic2[d][0])
            if dic2[d][0].__contains__('Rs'):
                a,b = dic2[d][0].split('Rs.')
                dic2[d][0] = a
                dic2[d][1] = b
            if len(re.findall('\d{1,}\s\w\s\d{1,}\s',dic2[d][0]))==1:
                text = dic2[d][0]
                matchrate = re.search(r'\d{1,}\s\w\s\d{1,}\s', text)
                dic2[d][1] = matchrate.group()
                dic2[d][0] = text.replace(matchrate.group(), '')
                dic2[d][1] = dic2[d][1].strip()
            if len(re.findall('\d{1,}\s\w\s\d{1,}', dic2[d][1])) == 1:
                print('hellp',dic2[d])
                a,b = re.split('\s\w{1}\s',dic2[d][1])
                dic2[d][1] = a.strip()
                dic2[d][2] = b.strip()
            if dic2[d][2]== ' ':
                dic2[d][2] = '1'
            if dic2[d][1] == ' ' and dic2[d][5]!=' ' and dic2[d][5].__contains__('Total') == False:
                dic2[d][1] = dic2[d][5]
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Ruk_N15156':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # if dic2[d][5]!=' ' and dic2[d][4]!=' ' and dic2[d].count(' ')==4:
            #     dic2[d][0]='Total'
            if dic2[d][1]==' ' and len(re.findall('\d\/\d{1,}\/\d',dic2[d][0]))==1 and dic2[d].count(' ')>=1:
                print('dksss',dic2[d])
                text = dic2[d][0]
                matchrate = re.search(r'\d{1,}\/\d{2}\/\d{1,}', text)
                dic2[d][1] = matchrate.group()
                dic2[d][0] = text.replace(matchrate.group(), '')
            if dic2[d][0] not in head_list and dic2[d].count(' ')==3 and dic2[d][0].__contains__(sbt)== False:
                dic2[d-1][0] = dic2[d-1][0]+dic2[d][0]
                dic2[d][0] = ' ' 
            if dic2[d][5]!=' ' and dic2[d][4]!=' ' and dic2[d].count(' ')==4:
                dic2[d][0]='Total'
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'st_john-pharma':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if (len(re.findall('\d\/\d{2}\/\d', dic2[d][2])) == 1 or len(re.findall('\d\/\d\s\d\/\d', dic2[d][2])) == 1)and len(dic2[d][2].split()) > 1:
                text = dic2[d][2]
                matchrate = re.search(r'\d{1,}\/\d{2}\/\d{1,}|\d{1,}\/\d\s\d\/\d{1,}', text)
                dic2[d][2] = matchrate.group()
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Poona-2-pharma':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][5]!=' ' and dic2[d].count(' ')==5:
                dic2[d][4] = 'Total'
            if len(re.findall('\d\/\d{2}\/\d',dic2[d][0]))==1 and dic2[d][1]==' ' and len(dic2[d][0].split())>1:
                text = dic2[d][0]
                matchrate = re.search(r'^\d{1,}\/\d{2}\/\d{1,}\s', text)
                dic2[d][0] = matchrate.group()
                dic2[d][1] = text.replace(matchrate.group(), '')
            if len(re.findall('\d\/\d{2}\/\d',dic2[d][0]))==1 and dic2[d][1]!=' ' and len(dic2[d][0].split())>1:
                a,b = dic2[d][0].split(' ',1)
                dic2[d][0] = a.strip()
                dic2[d][1] = b.strip()
            if dic2[d][1] !=' ' and dic2[d].count(' ')==5:
                dic1[lq - 1] = opr1(dic2[d - 1], dic2[d], src_dc)
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'bombay-pharma':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d\/\d{2}\/\d',dic2[d][1]))==1 and dic2[d][2].__contains__('Total'):
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if len(re.findall('\s\d{1,}',dic2[d][2]))==0 and dic2[d][2]!= sbt:
                dic2[d][2] = ' '
            if len(re.findall('\s\d{1,}', dic2[d][2])) == 1 and len(dic2[d][2].split())==2:
                a,b = dic2[d][2].split()
                dic2[d][2] = b
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'bombay':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][5]!= ' ' and len(dic2[d][5].split())>1:
                a,b = dic2[d][5].split(' ',1)
                dic2[d][5] = a
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'jss_N1060':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if d > 1 and len(re.findall('\d\/\d{2}\/\d{4}', dic2[d - 1][0])) and dic2[d][1] != ' ' and dic2[d - 1][
                5] == ' ' and dic2[d].count(' ') >= 3:
                print('merge', dic2[d])
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Tri_N15300':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:

            if d > 1 and len(re.findall('\d\/\d{2}\/\d+', dic2[d - 1][0])) and dic2[d][0] == ' ' and dic2[d][
                1] == ' ' and dic2[d].count(' ') == 3:
                print('line break', dic2[d])
                tty1 = opr1(dic2[d - 1], dic2[d], src_dc)
                dic1[lq - 1] = tty1
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Life_N6303-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][0].__contains__('- - - -') or dic2[d][5].__contains__(' . . .') or dic2[d][0].__contains__(
                    '. . '):
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Vyhospital_N14429':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d\-\d{2}\-\d', dic2[d][0])) == 2 and dic2[d].count(' ') == 5:
                print('hellp6', dic2[d], dic2[d + 1])
                dic2[d + 1][0] = dic2[d][0]
                dic2[d][0] = ' '
            if dic2[d][1] in head_list:
                dic2[d][0] = dic2[d][1]
                dic2[d][1] = ' '
            if dic2[d][4] == 'Subtotal':
                dic2[d][3] = ' '
            if len(re.findall('\d\.\d', dic2[d][3])) == 3:
                a, b, c = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if d > 1 and dic2[d][0] in head_list and len(re.findall('\d\.\d', dic2[d - 1][5])) == 1 and dic2[
                d - 1].count(' ') == 5:
                print('dic2ooso', dic2[d])
                dic2[d - 1][4] = 'Subtotal'
            if len(re.findall('\d\.\d', dic2[d][5])) == 1 and (dic2[d].count(' ') == 5 or dic2[d].count(' ') == 4) and \
                    dic2[d - 1][5] == ' ' and dic2[d - 1][0] != ' ':
                dic2[d - 1][5] = dic2[d][5]
                dic2[d - 1][4] = dic2[d][4]
                dic2[d][5] = ' '
                dic2[d][4] = ' '
            if dic2[d][0] not in head_list and dic2[d][0] != ' ' and dic2[d].count(' ') == 5:
                dic2[d + 1][0] = dic2[d][0]
                dic2[d][0] = ' '
            if len(re.findall('^\d{1,}\.', dic2[d][0])) == 1:
                dic2[d][0] = re.sub('^\d{1,}\.\s', '', dic2[d][0])
            if dic2[d][5] != ' ' and dic2[d].count(' ') > 4:
                dic2[d][4] = 'Subtotal'
            if dic2[d][0] != ' ' and dic2[d][1] != ' ' and dic2[d].count(' ') == 4:
                print('bedffo', dic2[d])
                dic2[d + 1][0] = dic2[d][0]
                dic2[d][0] = ' '
                dic2[d + 1][1] = dic2[d][1]
                dic2[d][1] = ' '
                dic2[d + 1][1] = dic2[d + 1][1] + dic2[d + 1][3]
                dic2[d + 1][3] = ' '
                print('bedffo', dic2[d], dic2[d + 1])
            if len(re.findall('\d{1,}\-\d{1,}\-\d', dic2[d][0])) == 1 and dic2[d][3] != ' ':
                dic2[d][1] = dic2[d][3]
                dic2[d][3] = ' '
            if dic2[d][0] == 'ADMISSION CHARGE' and dic2[d].count(' ') == 3:
                dic2[d][0] = dic2[d][0].lower()
            if dic2[d][5] != ' ' and dic2[d][3] != ' ' and dic2[d].count(' ') == 4:
                dic2[d - 1][1] = dic2[d - 1][1] + ' ' + dic2[d][3]
                dic2[d][3] = ' '
            if len(re.findall('\d\.\d', dic2[d][3])) == 0 and dic2[d][3] != ' ':
                dic2[d - 1][1] = dic2[d - 1][1] + ' ' + dic2[d][3]
                dic2[d][3] = ' '
            if dic2[d][1] in src_dc['merge_set']:
                dic2[d][1] = ' '
            if dic2[d][0] in head_list and dic2[d].count(' ') < 5:
                dic2[d][0] = dic2[d][0].lower()
            if len(re.findall('\w{1}\/\s?\w{2}\/\s?\d{2}\-\s?\d{2}\/\d{1,}\s', dic2[d][1])) == 1:
                dic2[d][1] = re.sub('\w{1}\/\s?\w{2}\/\s?\d{2}\-\s?\d{2}\/\d{1,}\s', '', dic2[d][1])
            if len(re.findall('\w{1,}\/\s?\w{1,}\s?\/\s?\w{1,}\/\s?\d{1,}\s?\-\s?\d{1,}\s?\/\s?\d{1,}\s?',
                              dic2[d][1])) == 1:
                dic2[d][1] = re.sub('\w{1,}\/\s?\w{1,}\s?\/\s?\w{1,}\/\s?\d{1,}\s?\-\s?\d{1,}\s?\/\s?\d{1,}\s', '',
                                    dic2[d][1])
            if len(re.findall('\w{1,}\/\s?\w{1,}\s\w{1,}\s?\/\s?\d{1,}\s?\-\s?\d{1,}\s?\/\s?\d{1,}\s?',
                              dic2[d][1])) == 1:
                dic2[d][1] = re.sub('\w{1,}\/\s?\w{1,}\s\w{1,}\s?\/\s?\d{1,}\s?\-\s?\d{1,}\s?\/\s?\d{1,}\s?', '',
                                    dic2[d][1])
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Rajagiri_N18901':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d\s?\.\s?\d', dic2[d][6])) and dic2[d].count(' ') == 5 and dic2[d - 1].count(' ') >= 2:
                print('hellppp', dic2[d], dic2[d - 1])
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if d > 3 and dic2[d][1].__contains__('CARI HEALTHCAR'):
                dic2[d][1] = ' '
                continue

            if len(re.findall('\d\s?\.\s?\d', dic2[d][6])) and len(re.findall('\d\s?\.\s?\d', dic2[d][5])) and dic2[
                d].count(' ') == 4 and dic2[d - 1].count(' ') >= 3:
                print('hellp', dic2[d], dic2[d - 1])
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Lisie_N15171':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][0] == 'CG':
                dic2[d][0] = 'ECG'
            if len(re.findall('\d\/\d{2}\/\d',dic2[d][3])) == 1 and len(re.findall('\d\.\d',dic2[d][4])) == 1:
               dic2[d][3] = dic2[d][4]
               dic2[d][4] = ' '
            if dic2[d][0] in head_list and dic2[d].count(' ')<5:
                dic2[d][0] = dic2[d][0].lower()
            if len(dic2[d][0].split())==2 and (len(re.findall('\w{2,}\-\d{1,}\s',dic2[d][0]))==1 or len(re.findall('\d{1,}',dic2[d][0]))==1):
                a,b = dic2[d][0].split()
                dic2[d][0]= b
            dic1[lq] = dic2[d]
            lq += 1
    if hospital=='Hindu_N2283':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if d==1  and dic2[d][0].__contains__('BED CHARGES'):
                print('remove subhead',dic2[d])
                dic2[d][0] = 'Bed Charges'

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Gokul_N1365':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d\/\d{2}\/\d',dic2[d][0])) == 1  and len(dic2[d][0].split())>=2:
                print('lsllls',dic2[d])
                a,b = dic2[d][0].split(' ',1)
                dic2[d][0] = a
                dic2[d][1] = b

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Mallige_N0897':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:

            if d > 1 and d<len(dic2) and len(re.findall('\d{2}\-\w{3}\-\d{4}', dic2[d][0])) and dic2[d + 1][0] != ' ' and dic2[
                d + 1].count(' ') == 5:
                print('shift', dic2[d])
                dic2[d + 1][0] = dic2[d + 1][1]
            if dic2[d][2].__contains__("'Professional Fees' Tot ]"):
                dic2[d][2] = "Professional Fees Total"

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Lifeline_N5106':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\(\d{1,}\.\d{1,}\)',dic2[d][1]))==1:
                print('lslsl',dic2[d][1])
                text = dic2[d][1]
                matchrate = re.search(r'\(\d{1,}\.\d{1,}\)', text)
                dic2[d][3] = matchrate.group()
                dic2[d][1] = dic2[d][1].replace(matchrate.group(), '')
                dic2[d][3] = dic2[d][3].strip(')')
                dic2[d][3] = dic2[d][3].strip('(')
                a,b = dic2[d][3].split('.')
                dic2[d][3] = a
                dic2[d][4] = b
            if len(re.findall('\(\d{1,}\*\d{1,}\.?\d\)',dic2[d][0]))>=1:
                text = dic2[d][0]
                matchrate = re.search(r'\(\d{1,}\*\d{1,}\.?\d\)', text)
                dic2[d][3] = matchrate.group()
                dic2[d][0] = dic2[d][0].replace(matchrate.group(), '')
                dic2[d][3] = dic2[d][3].strip(')')
                dic2[d][3] = dic2[d][3].strip('(')
                a, b = dic2[d][3].split('*')
                dic2[d][3] = a
                dic2[d][4] = b
            if len(re.findall('\(\d{1,}\+\d{1,}\.?\d\)',dic2[d][0]))>=1:
                text = dic2[d][0]
                matchrate = re.search(r'\(\d{1,}\+\d{1,}\.?\d\)', text)
                dic2[d][3] = matchrate.group()
                dic2[d][0] = dic2[d][0].replace(matchrate.group(), '')
                dic2[d][3] = dic2[d][3].strip(')')
                dic2[d][3] = dic2[d][3].strip('(')
                a, b = dic2[d][3].split('+')
                dic2[d][3] = a
                dic2[d][4] = b
            if len(re.findall('\(\d{1,}\*\d{1,}\.?\d?\)',dic2[d][1]))==1:
                text = dic2[d][1]
                matchrate = re.search(r'\(\d{1,}\*\d{1,}\.?\d?\)', text)
                dic2[d][3] = matchrate.group()
                dic2[d][1] = dic2[d][1].replace(matchrate.group(), '')
                dic2[d][3] = dic2[d][3].strip(')')
                dic2[d][3] = dic2[d][3].strip('(')
                a, b = dic2[d][3].split('*')
                dic2[d][3] = a
                dic2[d][4] = b
            if len(re.findall('\(\d{1,}\+\d{1,}\.?\d?\)',dic2[d][1]))==1:
                text = dic2[d][1]
                matchrate = re.search(r'\(\d{1,}\+\d{1,}\.?\d\)', text)
                dic2[d][3] = matchrate.group()
                dic2[d][1] = dic2[d][1].replace(matchrate.group(), '')
                dic2[d][3] = dic2[d][3].strip(')')
                dic2[d][3] = dic2[d][3].strip('(')
                a, b = dic2[d][3].split('+')
                dic2[d][3] = a
                dic2[d][4] = b
            if len(re.findall('\(\d{1,}\-\d{1,}\.?\d?\)',dic2[d][1]))==1:
                text = dic2[d][1]
                matchrate = re.search(r'\(\d{1,}\-\d{1,}\.?\d?\)', text)
                dic2[d][3] = matchrate.group()
                dic2[d][1] = dic2[d][1].replace(matchrate.group(), '')
                dic2[d][3] = dic2[d][3].strip(')')
                dic2[d][3] = dic2[d][3].strip('(')
                a, b = dic2[d][3].split('-')
                dic2[d][3] = a
                dic2[d][4] = b
            if d>1 and dic2[d][0] == 'Sub Total' or dic2[d][0]=='Total' and dic2[d-1] not in head_list:
               dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Ils_N2847':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(re.findall('\d\/\d{2}\/\d',dic2[d][0]))==1:
                print('kskks',dic2[d])
                text = dic2[d][0]
                matchrate = re.search(r'\d{1,2}\/\d{2}\/\d{1,4}', text)
                dic2[d][1] = matchrate.group()
                dic2[d][0] = text.replace(matchrate.group(), '')
            if len(dic2[d][2].split())>2:
                a,b = dic2[d][2].split(' ',1)
                dic2[d][2] = a
                dic2[d][3] = b
            if dic2[d].count(' ')==5 and dic2[d][5]!=' ':
                dic2[d][5]=' '
            if len(re.findall('^\d{1,3}\s', dic2[d][0])) == 1:
                dic2[d][0] = re.sub('^\d{1,3}\s','',dic2[d][0])
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Bhagwanmahavir_N13068-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddpp==', dic2[d])
            if len(re.findall('\w{3}\-\d{2}', dic2[d][2])) == 1 and dic2[d][3] == ' ':
                print('if date batch together with no space in 2nd index')
                text = dic2[d][2]
                if len(re.findall('\w{3}\-\d{2}', dic2[d][1])) == 1:
                    matchrate = re.search(r'\w{3}\-\d{2}', text)
                elif len(re.findall('\w{3}\-\d{2}', dic2[d][1])) == 1:
                    matchrate = re.search(r'\w{3}\-\d{2}', text)
                dic2[d][3] = matchrate.group()
                dic2[d][2] = text.replace(matchrate.group(), '')
            if len(re.findall('\d+\,\d+\.\d+', dic2[d][4])) == 1 and  len(dic2[d][4].split()) == 1  and  dic2[d][5] == '':
                print('if rate qty together wuth no space in 2nd index')
                dic2[d][5] = dic2[d][4]
                dic2[d][4] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Ashwini1_N3171':
        dic2 = dic1
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if len(re.findall("\(?\d{1,}\s?\*\s?\d{1,}\(?",dic2[d][1]))==1:
                print('if code and particulars together', dic2[d])
                text = dic2[d][1]
                matchcode = re.search(r'\d{1,}\s?\*\s?\d{1,}', text)
                dic2[d][2] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(), '')
            if len(dic2[d][2].split()) == 3 and dic2[d][2].split()[1] == '*':
                print('if qty rate together with *')
                a,b,c = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = c
            if dic2[d][1].__contains__("()")==1:
                dic2[d][1]=dic2[d][1].replace("()","")
            dic1[lq] = dic2[d]
            lq += 1
        #dicA = dic1
    if hospital == 'Ashwini_N3171':
        dic2 = dic1
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            if len(re.findall("\d{1,}\s?\*\s?\d{1,}",dic2[d][1]))==1:
                print('if code and particulars together', dic2[d])
                text = dic2[d][1]
                matchcode = re.search(r'\d{1,}\s?\*\s?\d{1,}', text)
                dic2[d][4] = matchcode.group()
                dic2[d][1] = text.replace(matchcode.group(), '')
            if len(dic2[d][4].split()) == 3 and dic2[d][4].split()[1] == '*':
                print('if qty rate together with *')
                a,b,c = dic2[d][4].split()
                dic2[d][4] = a
                dic2[d][3] = c
            if dic2[d][1].__contains__("()")==1:
                dic2[d][1]=dic2[d][1].replace("()","")
            dic1[lq] = dic2[d]
            lq += 1
        #dicA = dic1
    if hospital == 'Indianhospital':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:

            if len(re.findall('^\d+\.?\s', dic2[d][0])) == 1 and dic2[d].count(' ') == 5:
                print('to remove sno')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')

            if d > 1 and d < len(dic2) and len(re.findall('\d{2}\/\d{2}\/\d{4}', dic2[d][0])) and dic2[d + 1][
                1] != ' ' and dic2[d + 1].count(' ') == 5 and dic2[d + 2][1] != ' ' and dic2[d + 2].count(' ') == 4:
                print('shift', dic2[d + 1])
                dic2[d + 1][1] = dic2[d + 1][1] + '\s' + dic2[d + 2][1]
                dic2[d + 2][1] = ' '

            if d > 1 and d < len(dic2) and len(re.findall('\d{2}\/\d{2}\/\d{4}', dic2[d][0])) and dic2[d + 1][
                1] != ' ' and dic2[d + 1].count(' ') == 4:
                print('shift2', dic2[d + 1])
                dic2[d][1] = dic2[d][1] + '\s' + dic2[d + 1][1]
                dic2[d + 1][1] = ' '

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Cloudnine_N12573':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(dic2[d][3].split()) == 2 and len(re.findall('\d\.\d', dic2[d][3])) == 2:
                print('if rate and qty together')
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if len(re.findall('\d\.\d', dic2[d][3])) == 1 and len(dic2[d][3].split()) > 1:
                print('if date and rate merge')
                text = dic2[d][3]
                matchdate = re.search(r'\s?\d+\.\d+', text)
                dic2[d][3] = matchdate.group()
                dic2[d][2] = text.replace(matchdate.group(), '')
            if len(re.findall('\d\-\d{2}', dic2[d][3])) == 1 and len(dic2[d][3].split()) == 1:
                dic2[d][2] = dic2[d][3]
                dic2[d][3] = ' '
            if dic2[d][3] == dic2[d][2]:
                dic2[d][3] = dic2[d][2] = ' '
            if len(re.findall('\d\-\d{2}', dic2[d][3])) == 1 and len(re.findall('\d\.\d', dic2[d][3])) == 2:
                dic2[d][3] = re.sub('\d{2}\-\d{2}\-?', '', dic2[d][3])
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if len(dic2[d][5].split()) == 3 and len(re.findall('\d\.\d', dic2[d][5])) >= 2:
                print('3need', dic2[d])
                a, b, c = dic2[d][5].split()
                dic2[d][5] = c
            if len(dic2[d][5].split()) >= 3 and len(re.findall('\d\.\d', dic2[d][5])) >= 2:
                print('3need', dic2[d])
                a, b, c = dic2[d][5].split(' ', 2)
                dic2[d][5] = c
            if len(re.findall('\d+\-\d+\-\d+', dic2[d][0])) == 1:
                text = dic2[d][0]
                matchdate = re.search(r'\d+\-\d+\-\d+', text)
                dic2[d][2] = matchdate.group()
                dic2[d][0] = text.replace(matchdate.group(), '')
                dic2[d][0] = dic2[d][0].strip()
            if dic2[d][0] == 'Room' or dic2[d][0] == 'Room ':
                dic2[d][0] = 'Room Rent'
            if dic2[d][0] == 'Nursing ':
                dic2[d][0] = 'Nursing Charges'
            if dic2[d][0] == 'Total':
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            if dic2[d][3] == dic2[d][4]:
                dic2[d][3] = ' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Velammal_N15676-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dddddd', dic2[d])
            if d==1 and dic2[d][0]!="Pharmacy":
                print('empty', dic2[d])
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = ['Pharmacy', ' ', ' ', ' ', ' ',' ']
            if d>1 and d<len(dic2) and len(re.findall("\d\.\d",dic2[d][5]))==1 and dic2[d-1][3].__contains__("Issued Amount"):
                print("returns",dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq-1]=dic2[d-1]
                lq+=1
                dic1[lq-1]=['Pharmacy Returns', ' ', ' ', ' ', ' ',' ']
            dic1[lq] = dic2[d]
            lq += 1
        # dicA = dic1
    if hospital == 'sri_N13374':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('nddd==', dic2[d])
            for i in head_list:
                if i in dic2[d][0] and dic2[d].count(' ') <= 5:
                    print('PROFILEEE')
                    lineee = [i, ' ', ' ', ' ', ' ', ' ', ' ']
                    dic1[lq] = dic2[d]
                    lq += 1
                    dic1[lq - 1] = lineee
                    dic2[d][0] = dic2[d][0].replace(i, '')
            dic1[lq] = dic2[d]
            lq += 1
        dic2 = dic1
    if hospital == 'asian_N0043':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:

            if d > 1 and len(re.findall('\d\-\d{2}\-\d{4}', dic2[d - 1][0])) and dic2[d - 1].count(' ') == 5 and dic2[
                d] != ' ' and dic2[d].count(' ') == 1:
                print('linebreak', dic2[d])
                tty1 = opr1(dic2[d - 1], dic2[d], src_dc)
                dic1[lq - 1] = tty1
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Ayurved_N16913':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if d > 1 and d < len(dic2) and dic2[d][0] in head_list and dic2[d].count(' ') == 5 and dic2[d + 1][0] == \
                    dic2[d][0]:
                print('make lower', dic2[d])
                dic2[d + 1][0] = dic2[d + 1][0].lower()
            if d > 1 and dic2[d][2] != ' ':
                print('gfd', dic2[d])
                dic2[d][0] = dic2[d][0] + ' ' + dic2[d][2]
                dic2[d][2]=' '
            if d > 1 and dic2[d][0].__contains__('CONSULTATION CHARGES') and dic2[d].count(' ') == 1:
                dic2[d][0] = dic2[d][0].lower()
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Shankara_N16938':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(dic2[d][3].split()) >= 2:
                a, b = dic2[d][3].split(' ', 1)
                dic2[d][3] = a
            dic1[lq] = dic2[d]
            lq += 1
    return dic1,head_list
def basic_extracted_dic(json_data,src_dc,clm_rng):
    noc=int(src_dc['#colm'])
    end1_t=int(src_dc['end1_t'])
    start1_t=int(src_dc['start1_t'])
    
    list1=table_size(noc)
    list1_dt=table_size_dt(noc)

    hospital=src_dc['Hospital']
    swb=src_dc['space_within_box']
    if swb=='yes':
        swb=' '
    else:
        swb=''
    
    chk,bnd,ky,tm2,an0,an2=0,0,0,0,0,0
    
    dic1={}    
    l=1
    dic1_dt={}    
    l_dt=1

    start1=start_one(json_data,src_dc)
    end1=end_one(json_data,src_dc)
    end_no='abcdzyxw'
    if len(src_dc['end_no'])>1:
        end_no=src_dc['end_no']
    
    start_no='abcdzyxw'
    if len(src_dc['start_no'])>1:
        start_no=src_dc['start_no']

    sbt=src_dc['sbt']
    sbt_no=src_dc['sbt_no']
    sbt_not_cnsd=src_dc['sbt_not_cnsd']
    sbt_cnsd=src_dc['sbt_cnsd'] 
    
    for i in range(len(json_data)):
        if len(re.findall(end1,json_data[i].get('text')))==1 and len(re.findall(end_no,json_data[i].get('text')))==0:
            if hospital=='artemis' or hospital=='aig'or hospital=='asian_N0043':
                print('dooooooo')
                tm2=json_data[i].get('boundingBox')[3]-end1_t
            elif hospital=='yashoda-2' and i<8 and len(re.findall(end1,json_data[i].get('text')))==1 and len(re.findall(end_no,json_data[i].get('text')))==0:
                print('9AAAAAA',json_data[i].get('text'))
                continue
            else:
                tm2=json_data[i].get('boundingBox')[1]-end1_t
            break
    
    if hospital=='apolo' and end1=='Bed Detail':
        # print('yessssss')
        tm2 += 3
    hold=0
    hold_s,hold_e='',''
    hold_continue,hold_stop=0,0
    if hospital=='apolo':
        ew,sw=0,0
        hold=0
        print(end1,'fghfgh')
        for i in range(len(json_data)):
            if len(re.findall('ndicates bed|Bed Detail|Grand Total',json_data[i].get('text')))==1:
                ew=1
                print('nmnmnmnm_000',json_data[i].get('text'))
            if len(re.findall('Order',json_data[i].get('text')))==1 and ew==1:
                print('nmnmnmnm_111',json_data[i].get('text'))
                sw=1
            if sw==1:
                hold=1
                tm2=4000
                hold_s=start1
                hold_e=copy.deepcopy(end1)
                start1='Name'
                end1=''

    if hospital=='action':
        start1_t = start1_t-15
        print('startttt',start1_t)
    # ///////////
    print(start1,'--',end1,'--',sbt,'--',tm2,'ssssssss')    
    for i in range(len(json_data)):
        # print('***',json_data[i].get('text'))
        if hospital=='yashoda-2' and i<8 and len(re.findall(end1,json_data[i].get('text')))==1 and len(re.findall(end_no,json_data[i].get('text')))==0:
            print('9AAAAAA',json_data[i].get('text'))
            continue

        if len(src_dc['w_mark_txt'])>1 and (json_data[i].get('boundingBox')[2]-json_data[i].get('boundingBox')[0]) in range(-28,22):
            print('1AA')
            continue
        if len(src_dc['cnt_cond'])>1:
            if json_data[i].get('text').__contains__(src_dc['cnt_cond']):
                print('2AA')
                continue
        if len(re.findall(end1,json_data[i].get('text')))==1 and len(re.findall(end_no,json_data[i].get('text')))==0 and json_data[i].get('boundingBox')[1]>200:
            print('3AA',json_data[i].get('text'))
            if hold==1:
                continue
            break

        if len(start1)>1 and len(re.findall(start1,json_data[i].get('text')))==1 and len(re.findall(start_no,json_data[i].get('text')))==0: 
            print('4AA',json_data[i].get('text'))           
            bnd=json_data[i].get('boundingBox')[7]+start1_t
            print('$AAAa',json_data[i].get('text'),'---',bnd)
            ky=1 
        if len(start1)==0:
            print('5AA')
            bnd=5 
            ky=1      
        if ky==1:
            # print(json_data[i].get('text'),'-**-',json_data[i].get('boundingBox'))
            if json_data[i].get('boundingBox')[1]<bnd:
                # print('666666',bnd,'--',start1,json_data[i].get('boundingBox'),json_data[i].get('text'))
                continue
            if tm2!=0 and json_data[i].get('boundingBox')[7]>tm2:
                print('777777',json_data[i].get('boundingBox'),json_data[i].get('text'),'--',tm2,'--',json_data[i].get('boundingBox')[7])
                continue               
            chk=an2
            an0=json_data[i].get('boundingBox')[0]
            an2=json_data[i].get('boundingBox')[2] 
            
            # print(json_data[i].get('text'),'---',an0,'--',an2)  
            
            if len(sbt_not_cnsd)>1 and (an0<chk or (len(re.findall(sbt,json_data[i].get('text')))==1 and len(re.findall(sbt_not_cnsd,json_data[i].get('text')))==0)):                           
                # print('AAAAAAAAAAAAa',list1)                
                dic1[l]=list1
                list1=table_size(noc)
                l+=1 
                dic1_dt[l_dt]=list1_dt
                list1_dt=table_size_dt(noc)
                l_dt+=1

            elif len(sbt_cnsd)>1 and (an0<chk or (len(re.findall(sbt,json_data[i].get('text')))==1 or len(re.findall(sbt_cnsd,json_data[i].get('text')))==1)): 
                # print('BBBBBBBBBBBBb',list1)                           
                
                dic1[l]=list1
                list1=table_size(noc)                
                l+=1 
                dic1_dt[l_dt]=list1_dt
                list1_dt=table_size_dt(noc)
                l_dt+=1

            elif len(sbt_not_cnsd)==0 and len(sbt_cnsd)==0 and (an0<chk or len(re.findall(sbt,json_data[i].get('text')))==1):
                # print('CCCCCCCCCcCCC',list1)
                
                dic1[l]=list1   
                list1=table_size(noc)             
                l+=1 
                dic1_dt[l_dt]=list1_dt
                list1_dt=table_size_dt(noc)
                l_dt+=1

            # print(json_data[i].get('text'),'--',json_data[i].get('boundingBox'))
            for k in range(0,(2*(int(noc))-1),2):
                hh=k//2
                if clm_rng[k]<an0<clm_rng[k+1]:
                    tmp=list1[hh]
                    list1.pop(hh)
                    tmp+=swb+json_data[i].get('text')
                    list1.insert(hh,tmp.strip())  

                    tmp_one=[' ',' ',' ']
                    tmp_dt=list1_dt[hh][0]
                    list1_dt.pop(hh)
                    tmp_dt1 = json_data[i].get('boundingBox')[1]
                    tmp_dt2 = json_data[i].get('boundingBox')[7]-json_data[i].get('boundingBox')[1]
                    tmp_one.pop(0)
                    tmp_one.insert(0,tmp.strip())
                    tmp_one.pop(1)
                    tmp_one.insert(1,tmp_dt1)
                    tmp_one.pop(2)
                    tmp_one.insert(2,tmp_dt2)
                    list1_dt.insert(hh,tmp_one)
    dic1[l]=list1
    dic1_dt[l_dt]=list1_dt

    if hold==1:
        print('holllld',hold_e)
        continue_line=[]
        dic_two=dic1
        dic1={}
        lq=1
        for d in dic_two:
            ss=''
            print('uuuuu',dic_two[d], ss.join(dic_two[d]))
            if ss.join(dic_two[d]).__contains__('Order'):
                print('nnnnuu',dic_two[d])
                hold_continue=0
                continue_line.append(d)
                continue
            if hold_continue==1:
                print('nnnnuu11',dic_two[d])
                continue_line.append(d)
                continue
            # if ss.join(dic_two[d]).__contains__(hold_e):
            if len(re.findall('ndicates bed|Bed Detail|Grand Total',ss.join(dic_two[d])))==1:
                print('nnnnuu22',dic_two[d])
                hold_continue=1
                continue_line.append(d)
                continue
            
            dic1[lq]=dic_two[d]
            lq +=1
        print(continue_line,'cnnnnnn')
        dic_two_dt=dic1_dt
        dic1_dt={}
        lq_dt=1
        for d in dic_two_dt:
            if d in continue_line:
                continue
            dic1_dt[lq_dt]=dic_two_dt[d]
            lq_dt +=1
    # for d in dic1:
    #     print('11111',dic1[d])
    # for d in dic1_dt:
    #     print('11111',dic1_dt[d])    
    # line_separation_index=['close','very_close']
    # line_separation='close'
    # if hospital in ['aig']:
    #     line_separation='very_close'
    z1,z2=1,1
    # if line_separation=='close':
    #     z1,z2=4,5
    # elif line_separation=='very_close':
    #     z1,z2=3,5
    head_list=src_dc['head_list'].split(',')
    sub_head=src_dc['merge_set'].split(',')
    # print('head_in',head_list)
    head_list_one=head_list
    if len(sub_head)>2:
        head_list_one = head_list + sub_head
    # print('subbbbb',sub_head,len(sub_head))
    # print('head_one',head_list_one)

    #################
    if hospital  in ['max','apolo','asian','aig','miot']:
        print('yes_noooo')
        dic22=dic1
        dic1={}
        lq=1
        dic1_dt_temp=dic1_dt
        dic1_dt={}    
        l_dt=1
        fn=len(dic22)
        f=0
        move_continue=0
        for d in dic22: 
            ss=''
            f +=1
            this_h,this_w=0,0
            break_index=10
            if f<fn:
                # first_c=0
                # for i in range(noc):
                #     if dic1_dt_temp[d][i][1]!=' ' and  dic1_dt_temp[d][i][2]!=' ':
                #         if this_h!=0 and this_w!=0:
                #             if dic1_dt_temp[d][i][1]-this_h>((3*this_w)//2):
                #                 break_index=i
                #                 print('split_ittttt',dic22[d],break_index)
                #                 break
                #         this_h = dic1_dt_temp[d][i][1]
                #         this_w = dic1_dt_temp[d][i][2]
                first_c=0
                for i in range(noc):
                    if dic1_dt_temp[d][i][1]!=' ' and  dic1_dt_temp[d][i][2]!=' ':
                        if this_h!=0 and this_w!=0:
                            if dic1_dt_temp[d][i][1]-this_h>((3*this_w)//2):
                                
                                near_h,near_w=[],[]
                                new_h,new_w=0,0
                                new1_h,new1_w=0,0
                                for j in range(noc):
                                    if dic1_dt_temp[d+1][j][1]!=' ' and  dic1_dt_temp[d+1][j][2]!=' ':
                                        near_h.append(dic1_dt_temp[d+1][j][1])
                                        near_w.append(dic1_dt_temp[d+1][j][2])
                                if len(near_h)>=1:
                                    new_h=avg(near_h)
                                    new_w=avg(near_w)
                                    near_h.append(dic1_dt_temp[d][i][1])
                                    near_w.append(dic1_dt_temp[d][i][2])
                                    new1_h=avg(near_h)
                                    new1_w=avg(near_w)
                                if -new_w//5<=new_h-new1_h<=new_w//5 and ss.join(dic22[d+1]).strip() not in head_list_one and ss.join(dic22[d+1]).__contains__(sbt)==False:

                                    break_index=i
                                    print('split_ittttt',dic22[d],break_index,new_h,new1_h,new_w//5)
                                    break
                        this_h = dic1_dt_temp[d][i][1]
                        this_w = dic1_dt_temp[d][i][2]
                if break_index<10:
                    this_line = copy.deepcopy(dic22[d])
                    split_line1 = this_line[:break_index]
                    split_line2 = this_line[break_index:]
                    line_size1=table_size(noc)[break_index:]
                    line_size2=table_size(noc)[:break_index]
                    this_line_1 = split_line1 + line_size1
                    this_line_2 = line_size2 + split_line2
                    dic1[lq]=this_line_1
                    lq +=1
                    dic1[lq]=this_line_2
                    lq +=1

                    this_line = copy.deepcopy(dic1_dt_temp[d])
                    split_line1 = this_line[:break_index]
                    split_line2 = this_line[break_index:]
                    line_size1=table_size_dt(noc)[break_index:]
                    line_size2=table_size_dt(noc)[:break_index]
                    this_line_1 = split_line1 + line_size1
                    this_line_2 = line_size2 + split_line2
                    dic1_dt[l_dt]=this_line_1
                    l_dt +=1
                    dic1_dt[l_dt]=this_line_2
                    l_dt +=1

                    move_continue=1
            if move_continue ==1:
                move_continue=0
                continue
            dic1[lq]=dic22[d]
            lq +=1

            dic1_dt[l_dt]=dic1_dt_temp[d]
            l_dt +=1
    #######################

    last_avg_hl,last_avg_wl=0,0
    dic22=dic1
    dic1={}
    lq=1
    for d in dic22:
        ss=''
        avg_hl,avg_wl=0,0
        hight_line,width_line=[],[]
        for i in range(noc):           
            if len(dic1_dt[d][i]) > 1 and dic1_dt[d][i][1]!=' ' and last_avg_wl!=0 and dic1_dt[d][i][2]>=(2*(last_avg_wl)):
                print('msssss',dic1_dt[d])
                continue

            if len(dic1_dt[d][i]) > 2 and dic1_dt[d][i][2]!=' ':
                width_line.append(dic1_dt[d][i][2])
            if len(dic1_dt[d][i]) > 1 and dic1_dt[d][i][1]!=' ':
                hight_line.append(dic1_dt[d][i][1])
        if hight_line!=[] and width_line!=[]:
            avg_hl = avg(hight_line)
            avg_wl = avg(width_line)
        # print('gtpl',avg_hl,avg_wl,hight_line,width_line,'--**',dic1_dt[d]) 
        # print('gtpl',last_avg_hl,last_avg_wl,(avg_hl-last_avg_hl),'--**',dic1_dt[d])        
        if last_avg_hl!=0 and last_avg_wl!=0 and (avg_hl - last_avg_hl) in range((z1*(-last_avg_wl//5))//z2,(z1*(last_avg_wl//2))//z2) and ss.join(dic22[d-1]).strip() not in head_list_one and ss.join(dic22[d]).strip() not in head_list_one and ss.join(dic22[d-1]).__contains__(sbt)==False and ss.join(dic22[d]).__contains__(sbt)==False:
            # print('deee',(z1*(-last_avg_wl//4))//z2,(z1*(last_avg_wl))//z2,(-last_avg_wl//4,last_avg_wl))
            print('deee',dic1_dt[d-1],dic1_dt[d])
            new_l=copy.deepcopy(opr1(dic22[d-1],dic22[d],src_dc))
            dic1[lq-1]=new_l
            continue 
        last_avg_hl = avg_hl
        last_avg_wl = avg_wl
        dic1[lq]=dic22[d]
        lq +=1

    head_list=src_dc['head_list'].split(',')

    if len(src_dc['head_to_home'])>1:
        idh=int(src_dc['head_to_home'].split(',')[1])
        dic1=head_to_home(dic1,src_dc,idh,head_list,noc)
    if len(src_dc['vacant_box'])>1:
        idh1,idh2,idh3,idh4=src_dc['vacant_box'].split(',')
        idh1,idh2,idh3,idh4=int(idh1),int(idh2),int(idh3),int(idh4)
        dic1=vacant_box(dic1,src_dc,idh1,idh2,idh3,idh4)

    if len(src_dc['correct_box'])>1:
       dic1=correct_box(dic1,src_dc)
    if len(src_dc['correct_spl_box'])>1:
       dic1=correct_spl_box(dic1,src_dc)      
    if len(src_dc['boxwise_corr'])>1:
       dic1=boxwise_corr(dic1,src_dc)

    if len(src_dc['correct_head'])>1:
        dic1=correct_head(dic1,src_dc)

    if src_dc['pre_peronailse_at_basic_ext']=='yes':
        hospital=src_dc['Hospital']
        dic1=pre_peronailse_at_basic_ext(dic1,src_dc,head_list,sbt,noc,hospital)

    if len(src_dc['add_subtotal'])>1:
        if src_dc['add_subtotal'].split(',')[0]=='basic' or src_dc['add_subtotal'].split(',')[0]=='stg_one':
            dic1=add_subtotal_one(dic1,src_dc,head_list)
        if src_dc['add_subtotal'].split(',')[0]=='lvl_two':
            dic1=add_subtotal_two(dic1,src_dc,head_list)
    
    if len(src_dc['one_to_many'])>1:
        if src_dc['one_to_many'].split(',')[0]=='3':
            dic1=one_to_many_3(dic1,src_dc)
    
    if len(src_dc['specific_head_corr'])>1:
       dic1=specific_head_corr(dic1,src_dc,noc) 
    if src_dc['peronailse_at_basic_ext']=='yes':
        hospital=src_dc['Hospital']
        dic1=peronailse_at_basic_ext(dic1,src_dc,head_list,sbt,noc,hospital)
    if hospital=='apolo':
        j_count=0
        for i in range(len(json_data)):
            j_count +=1
            if len(re.findall('Department\s?Name',json_data[i].get('text')))==1 and j_count<15:
                print('clasification issue')
                dic1={}
                dic1[1]=table_size(noc)
                break
    if hospital == 'hinduja':
        for i in range(len(json_data)):
            # print('***',json_data[i].get('text'))
            if i < 30 and (len(re.findall('MEDIAN A', json_data[i].get('text'))) == 1 or len(
                    re.findall('MEDIAN B', json_data[i].get('text'))) == 1 or
                           len(re.findall('MEDIAN C', json_data[i].get('text'))) == 1 or len(
                        re.findall('DELUX', json_data[i].get('text'))) == 1 or len(
                        re.findall('SPECIAL', json_data[i].get('text'))) == 1 or
                           len(re.findall('SUITE', json_data[i].get('text'))) == 1 or len(
                        re.findall('MEDIAN', json_data[i].get('text'))) == 1 or len(
                        re.findall('SSS Premium', json_data[i].get('text'))) == 1):
                print('9AAAAAA', json_data[i].get('text'), i)
                roomfind = json_data[i].get('text')
                print('roomfind = ', roomfind)
            else:
                roomfind = ''

        bed_charges_found = False
        for d in dic1:
            print('hhhhhh', dic1[d])
            if dic1[d][0] == 'BED CHARGES' and dic1[d].count(' ') == 4:
                print('yes press')
                bed_charges_found = True
            elif bed_charges_found and dic1[d][0] != ' ' and dic1[d].count(' ') <= 3:
                dic1[d][0] = dic1[d][0] + roomfind
            elif dic1[d][0] in head_list and dic1[d].count(' ') == 4 and bed_charges_found == True:
                print('found next header after bed charges')
                break
    if hospital == 'hinduja_N10188':
        for i in range(len(json_data)):
            # print('***',json_data[i].get('text'))
            # PREMIUM DELUX, PREMIUM TWIN
            if i<30 and len(re.findall('Billing Class', json_data[i].get('text'))) == 1:
                print('9AAAAAA bbiiling class', json_data[i].get('text'),i)
                print('9AAAAAA11 rrooom typeee', json_data[i+1].get('text'), i)
                roomfind = json_data[i+1].get('text')
                print('roomfind = ',roomfind)

        bed_charges_found = False
        for d in dic1:
            print('hhhhhh',dic1[d])
            if dic1[d][0] == 'BED CHARGES' and dic1[d].count(' ')>=4:
                print('yes press')
                bed_charges_found = True
            elif bed_charges_found and dic1[d][0] != ' ' and dic1[d].count(' ')<=3:
                dic1[d][0] = dic1[d][0] + roomfind
            elif dic1[d][0] in head_list and dic1[d].count(' ')==4 and bed_charges_found == True:
                print('found next header after bed charges')
                break
    if hospital == 'Sainath_N13533':
        bed_charges_found = False
        for d in dic1:
            print('hhhhhh', dic1[d])
            if dic1[d][0] == 'VISIT DETAILS' or dic1[d][0] == 'BED CHARGES':
                print('yes press')
                bed_charges_found = True
                dic1[d][1] = dic1[d][1] + ' ' + dic1[d][2]
                dic1[d][2] = ' '
            elif bed_charges_found and dic1[d][1] != ' ' and dic1[d][1]!=sbt:
                dic1[d][1] = dic1[d][1] +' '+ dic1[d][2]
                dic1[d][2] = ' '
            elif dic1[d][0] in head_list and dic1[d].count(' ') == 5 and bed_charges_found == True:
                print('found next header after bed charges')
                bed_charges_found = False
                break
    if hospital == 'omnihospital_N12946':
        for i in range(len(json_data)):
            if i < 30 and len(re.findall('Ward/Bed', json_data[i].get('text'))) == 1:
                print('room type', json_data[i])
                if len(json_data[i + 2].get('text')) < 10:
                    bed_type = json_data[i + 1].get('text') + json_data[i + 2].get('text')
                else:
                    bed_type = json_data[i + 1].get('text')
                print('bed_type', bed_type)
        bed_charges_found = False
        for d in dic1:
            print('hhhhhh', dic1[d])
            if dic1[d][0].__contains__('Ward Charges') == True:
                print('yes room rent presemt')
                bed_charges_found = True
            elif bed_charges_found and dic1[d].count(' ') <= 4:
                print('attaching bed type')
                dic1[d][2] = dic1[d][2] + ' ' + bed_type
            elif dic1[d][0] in head_list and dic1[d].count(' ') == 5 and bed_charges_found:
                print('found next header after bed charges')
                break
        Doctor_charges_found = False
        for d in dic1:
            print('hhhhh111', dic1[d])
            if dic1[d][0].__contains__('Doctor Charges') == True:
                print('trueeeeeeeeeeee doctor')
                Doctor_charges_found = True
            elif Doctor_charges_found and dic1[d].count(' ') <= 4:
                print('changeeeeeee doctor')
                dic1[d][2] = dic1[d][1] + ' ' + dic1[d][2]
            elif dic1[d][0] in head_list and dic1[d].count(' ') == 5 and Doctor_charges_found:
                print('found next header after Doctor charges')
                break
    if hospital == 'Ciigma_N5041':
        for i in range(len(json_data)):
            if i < 60 and (len(re.findall('Billing Glass', json_data[i].get('text'))) == 1 or len(
                    re.findall('Billing Class', json_data[i].get('text'))) == 1):
                print('room type', json_data[i])
                if len(json_data[i + 2].get('text')) < 10:
                    bed_type = json_data[i + 1].get('text') + json_data[i + 2].get('text')
                else:
                    bed_type = json_data[i + 1].get('text')
                print('bed_type', bed_type)
        # bed_charges_found = False
        for d in dic1:
            print('hhhhhh', dic1[d])
            if dic1[d][0].__contains__('bed charges') == True:
                print('yes room rent presemt')
                dic1[d][0] = dic1[d][0] + ' ' + bed_type
    if hospital == 'Gokul_N1365':
        bed_charges_found = False
        for d in dic1:
            print('hhhhhh', dic1[d])
            if dic1[d][0] == 'SURGERY TEAM CHARGES':
                print('yes press')
                bed_charges_found = True
            elif bed_charges_found == True and dic1[d][1] != ' ' and dic1[d][1]!=sbt:
                dic1[d][4] = dic1[d][3]
                dic1[d][5] = dic1[d][3]
                dic1[d][3] = ' '
            elif dic1[d][0] in head_list and (dic1[d].count(' ') == 5 or dic1[d].count(' ') == 4) and bed_charges_found == True:
                print('found next header after bed charges')
                bed_charges_found = False
                break

        bed_charges_found = False
        for d in dic1:
            if dic1[d][0] == 'COST OF IMPLANT':
                # print('yes press')
                bed_charges_found = True
            elif bed_charges_found == True and dic1[d][1] != ' ' and dic1[d][1] != sbt:
                dic1[d][5] = dic1[d][1]
                dic1[d][4] = dic1[d][1]
                dic1[d][1] = ' '
            elif dic1[d][0] in head_list and (dic1[d].count(' ') == 5 or dic1[d].count(' ') == 4) and bed_charges_found == True:
                print('found next header after bed charges')
                bed_charges_found = False
                break
    if hospital == 'mpct_N15237':
        bed_type_found = False
        for d in dic1:
            print('hhhhhh', dic1[d])
            if dic1[d][0].__contains__('Nursing Charges') == True:
                bed_type_found = True
            elif bed_type_found and dic1[d][0] not in head_list:
                print('attaching bed type')
                dic1[d][2] = dic1[d][3]
                dic1[d][3] = ' '
            elif dic1[d][0] in head_list and dic1[d].count(' ') == 5 and bed_type_found:
                print('found next header after bed charges')
                bed_type_found = False
                break
            if dic1[d][2].__contains__('Sub Total') == True:
                dic1[d][2] = ' '
    if hospital == 'Kalinga_N18633':
        bed_charges_found = False
        for d in dic1:
            print('hhhhhh', dic1[d])
            if dic1[d][0] == 'Consultation':
                print('yes press')
                bed_charges_found = True
            elif bed_charges_found == True and dic1[d][1] != ' ' and dic1[d][3]!=sbt:
                dic1[d][0] = dic1[d][0]+' '+dic1[d][2]
                dic1[d][2] = ' '
            elif dic1[d][0] in head_list and (dic1[d].count(' ') == 5 or dic1[d].count(' ') == 4) and bed_charges_found == True:
                print('found next header after bed charges')
                bed_charges_found = False
                break
    if hospital == 'Sushrut_N1598':
        for i in range(len(json_data)):
            # print('***',json_data[i].get('text'))
            if (len(re.findall('Bed / Ward :', json_data[i].get('text'))) == 1 or len(re.findall('Bed/ Ward :', json_data[i].get('text'))) == 1 or
                    len(re.findall('Bed /Ward :', json_data[i].get('text'))) == 1 or len(re.findall('Bed/Ward :', json_data[i].get('text'))) == 1) and i<30 and 'Bed Charge Details' in str(json_data):
                print('ii',i)
                if len(json_data[i+1].get('text')) < 10:
                    roomfind = json_data[i].get('text')+' '+json_data[i+1].get('text')
                roomfind = json_data[i].get('text')
                if len(re.findall('Bed / Ward :', json_data[i].get('text'))) == 1:
                    roomfind = roomfind.replace('Bed / Ward :','').strip()
                elif len(re.findall('Bed/ Ward :', json_data[i].get('text'))) == 1:
                    roomfind = roomfind.replace('Bed/ Ward :','').strip()
                elif len(re.findall('Bed /Ward :', json_data[i].get('text'))) == 1:
                    roomfind = roomfind.replace('Bed /Ward :','').strip()
                elif len(re.findall('Bed/Ward :', json_data[i].get('text'))) == 1:
                    roomfind = roomfind.replace('Bed/Ward :','').strip()
                print('ii', roomfind)


        bed_charges_found = False
        for d in dic1:
            print('hhhhhh',dic1[d])
            if dic1[d][0] == 'Bed Charge Details' and dic1[d].count(' ')==5:
                print('yes press')
                bed_charges_found = True
            elif bed_charges_found and dic1[d][0] != ' ' and dic1[d].count(' ')<=4:
                dic1[d][0] = roomfind
            elif 'Total' in dic1[d][2] and bed_charges_found == True:
                print('found next header after bed charges')
                break
    if hospital == 'Srcc_N15794':
        for i in range(len(json_data)):
            if i < 60 and (len(re.findall('Ward/Bed', json_data[i].get('text'))) == 1 or len(re.findall('Ward/Be', json_data[i].get('text'))) == 1):
                print('room type', json_data[i])
                if len(json_data[i + 2].get('text')) < 10:
                    bed_type = json_data[i + 1].get('text') + json_data[i + 2].get('text')
                else:
                    bed_type = json_data[i + 1].get('text')
                print('bed_type', bed_type)
        #bed_charges_found = False
        for d in dic1:
            print('hhhhhh', dic1[d])
            if dic1[d][0].__contains__('BED CHARGES') == True:
                print('yes room rent presemt')
                dic1[d][0] = dic1[d][0]+" "+bed_type
    if hospital == 'Cloudnine_N12573':
        dic3 = {}
        start_key = None
        lq = 1
        for key in dic1:
            print('firstt=', dic1[key])
            if (dic1[key][0] == 'Total' or dic1[key][0] == 'Adv adj to Bill' or dic1[key][0]=='Adv ad; to Bill') and dic1[key+1][0] in head_list:
                print('found start point parti')
                start_key = dic1[key][0]
                if start_key is not None:
                    new_dict = {key: dic1[key] for key in range(key, max(dic1.keys()) + 1)}
                    # print('new_dictt',new_dict)                            
                    dic1 = new_dict
                else:
                    print("Particulars not found")
            if dic1[key][0]=='Payable' and dic1[key+1][0] == ' ' and dic1[key+2][0] in head_list:
                print('found start point parti')
                start_key = dic1[key+1][0]
                if start_key is not None:
                    new_dict = {key: dic1[key] for key in range(key, max(dic1.keys()) + 1)}
                    # print('new_dictt',new_dict)
                    dic1 = new_dict
                else:
                    print("Particulars not found")
    for d in dic1:
        print('ggggg',dic1[d])
    print('***********####################****************')
    return dic1

def basic_extracted_dic_one(json_data, src_dc, clm_rng, esk):
    hospital = src_dc['Hospital']
    noc = int(src_dc['#colm'])
    list1 = table_size(noc)

    dic1 = {}
    chk, an0, an2 = 0, 0, 0
    l = 1
    sbt = src_dc['sbt']
    swb = src_dc['space_within_box']
    head_data = src_dc['head_list']
    if swb == 'yes':
        swb = ' '
    else:
        swb = ''
    for i in range(len(json_data)):
        chk = an2
        an0 = json_data[i].get('boundingBox')[0]
        an2 = json_data[i].get('boundingBox')[2]
        # print(json_data[i].get('text'),an0)
        if an0 < chk or json_data[i].get('text').__contains__(sbt):
            dic1[l] = list1
            if noc == 6:
                list1 = [' ', ' ', ' ', ' ', ' ', ' ']
            elif noc == 7:
                list1 = [' ', ' ', ' ', ' ', ' ', ' ', ' ']
            elif noc == 8:
                list1 = [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ']
            elif noc == 9:
                list1 = [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ']
            l += 1
        for k in range(0, (2 * (int(noc)) - 1), 2):
            hh = k // 2
            if clm_rng[k] < an0 < clm_rng[k + 1]:
                tmp = list1[hh]
                list1.pop(hh)
                tmp += swb + json_data[i].get('text')
                list1.insert(hh, tmp.strip())
    dic1[l] = list1

    if hospital == 'manipaldelhi':
        dic3 = {}
        start_key = None
        lq = 1
        for key in dic1:
            print('firstt=', dic1[key])
            if dic1[key][0] != ' ' and len(re.findall('[.]\s+[^0-9]*', dic1[key][0])) == 1 and len(
                    re.findall('\w+', dic1[key][0])) == 0:
                print('dotss in 0th indx')
                dic1[key][0] = ' '
            if dic1[key][3] != ' ' and len(re.findall('[.]\s+[^0-9]*', dic1[key][3])) == 1 and len(
                    re.findall('\w+', dic1[key][3])) == 0:
                print('dotss in 3rd indx')
                dic1[key][3] = ' '
            if dic1[key][3] != ' ' and len(re.findall('[-]\s+[^0-9]*', dic1[key][3])) == 1 and len(
                    re.findall('\w+', dic1[key][3])) == 0:
                print('--- in 3rd indx')
                dic1[key][3] = ' '
            if dic1[key][5] != ' ' and len(re.findall('[.]\s+[^0-9]*', dic1[key][5])) == 1 and len(
                    re.findall('\w+', dic1[key][5])) == 0:
                print('dotss in 5th indx')
                dic1[key][5] = ' '
            if dic1[key][5] != ' ' and len(re.findall('[-]\s+[^0-9]*', dic1[key][5])) == 1 and len(
                    re.findall('\w+', dic1[key][5])) == 0:
                print('--- in 5th indx')
                dic1[key][5] = ' '
            if dic1[key][0] == '3 Service Nursing Charges':
                dic1[key][0] = '3 Service Nursing Charges SAC: 999311'
            if dic1[key][0] == '4 Clinical Management Fee':
                dic1[key][0] = '4 Clinical Management Fee SAC: 999311'
            if dic1[key][0] == 'Procedures BAC: 999311':
                dic1[key][0] = 'Procedures SAC: 999311'
            if dic1[key][0] == 'Resident Medical Doctor Fea SAC: 999311':
                dic1[key][0] = 'Resident Medical Doctor Fee SAC: 999311'
            if dic1[key][0] == '20 Registration. Charges':
                dic1[key][0] = '20 Registration Charges'
            if dic1[key][0] == 'in:cal Management Fee SAC : 9993 1 1':
                dic1[key][0] = 'Clinical Management Fee SAC : 999311'
            if dic1[key][0] == 'Medical Equ : pmen: SAC : 99931 1':
                dic1[key][0] = 'Medical Equipment SAC : 999311'
            if dic1[key][0] == 'Consultation OF SAC : 999311':
                dic1[key][0] = 'Consultation OP SAC : 999311'
            if dic1[key][0] == '12 Surgical Support Fees S':
                dic1[key][0] = '12 Surgical Support Fees SAC: 999311'
                dic1[key + 1][0] = ' '
            if dic1[key][0] == '8 Procedures':
                dic1[key][0] = '8 Procedures SAC: 999311'
                dic1[key + 1][0] = ' '
            if key > 1 and dic1[key][0] == 'Resident Medical Doctor Fee' and 'SAC' not in dic1[key][0]:
                dic1[key][0] = dic1[key][0].lower()
            if key > 1 and key < len(dic1) and dic1[key][0] in head_data and dic1[key + 1][0] == 'SAC: 999311':
                print('if header and SAC in diff lines')
                dic1[key][0] = dic1[key][0] + ' ' + dic1[key + 1][0]
                dic1[key + 1][0] = ' '
            if key > 1 and dic1[key][0] != ' ' and len(dic1[key][0].split()) >= 2 and dic1[key][0].replace(
                    dic1[key][0].split()[0], '').strip() in head_data and 'SAC' in dic1[key + 1][0] and 'SAC' not in \
                    dic1[key][0] and dic1[key].count(' ') == 5:
                print('if header with sno and SAC in diff lines')
                dic1[key][0] = dic1[key][0] + ' ' + dic1[key + 1][0]
                dic1[key + 1][0] = ' '
            if dic1[key][0] != ' ' and dic1[key][0] in head_data and 'SAC' not in dic1[key][0] and dic1[key].count(
                    ' ') >= 3:
                print('if SAC is missing in header')
                dic1[key][0] = dic1[key][0] + ' ' + 'SAC : 999311'
            if dic1[key][0] == 'Particulare':
                dic1[key][0] = 'Particulars'
            for i in range(len(json_data)):
                if len(re.findall('Admission Charges', json_data[i].get('text'))) >= 1:
                    # print('found hospital name place')
                    if 'Particula' in dic1[key][0]:
                        print('found start point parti')
                        start_key = dic1[key][0]
                        if start_key is not None:
                            new_dict = {key: dic1[key] for key in range(key, max(dic1.keys()) + 1)}
                            # print('new_dictt',new_dict)
                            dic1 = new_dict
                        else:
                            print("Particulars not found")
                if (len(re.findall('Vijayawada', json_data[i].get('text'))) == 1 or len(
                        re.findall('GHAZIABAD', json_data[i].get('text'))) == 1 or len(
                        re.findall('Mangaluru', json_data[i].get('text'))) == 1) and i < 30:
                    # print('found hospital name place')
                    if 'Particula' in dic1[key][0]:
                        print('found start point parti')
                        start_key = dic1[key][0]
                        if start_key is not None:
                            new_dict = {key: dic1[key] for key in range(key, max(dic1.keys()) + 1)}
                            # print('new_dictt',new_dict)
                            dic1 = new_dict
                        else:
                            print("Particulars not found")
            # for i in range(len(json_data)):
            #     if(len(re.findall('Vijayawada', json_data[i].get('text'))) == 1 or len(re.findall('GHAZIABAD', json_data[i].get('text'))) == 1 or len(re.findall('Mangaluru', json_data[i].get('text'))) == 1) and i < 5:
            #         print('found startt')
            #         if 'Particula' in str(json_data):
            #             print('founr partii')
            #             start_key = 'Particula'
            #             break

    dic2 = dic1
    dic1 = {}
    l1 = 1
    esk = esk
    for d in dic2:
        # print('dd==000',dic2[d])
        st1 = ''
        if dic2[d].count(' ') == noc or st1.join(dic2[d]).__contains__('Page') or st1.join(dic2[d]).__contains__(
                'http'):
            continue
        if len(re.findall('\d{2}\/\d{2}\/\d{4}', dic2[d][5])) == 1:
            continue
        if st1.join(dic2[d]).__contains__('PATIENT Share') or st1.join(dic2[d]).__contains__('Prepared by') or st1.join(
                dic2[d]).__contains__('Generated by') or st1.join(dic2[d]).__contains__('Policy Disc') or st1.join(
                dic2[d]).__contains__('Patient Share') or st1.join(dic2[d]).__contains__('Share'):
            break
        # seeeeeeeeee
        # if st1.join(dic2[d]).__contains__('SIR GANGA RAM') and st1.join(dic2[d+1]).__contains__('INTERIM RUNNING')==False and len(re.findall('\d\.\d',dic2[d+2][-1].replace(' ',''))):
        #     esk=0
        #     continue
        # seeeeeeeeee
        if st1.join(dic2[d]).__contains__('SIR GANGA RAM') or st1.join(dic2[d]).__contains__('Name') or st1.join(
                dic2[d]).__contains__('Printed Date') or st1.join(dic2[d]).__contains__('INTERIM RUNNING') or st1.join(
                dic2[d]).__contains__('Admission Date') or st1.join(dic2[d]).__contains__(
                'Provisional GSTIN :') or st1.join(dic2[d]).__contains__('GANGA RAM HOSPITAL') or st1.join(
                dic2[d]).__contains__('Sl. Particulars') or st1.join(dic2[d]).__contains__(
                '002 Insurance Comp: NONE') or st1.join(dic2[d]).__contains__('Payor : ICICI') or \
                st1.join(dic2[d]).__contains__('Address : HIG 191') or st1.join(dic2[d]).__contains__(
            'Ina . Comp .') or st1.join(dic2[d]).__contains__('$1. Particular'):
            esk = 1
        if st1.join(dic2[d]).__contains__('Order Item') or st1.join(dic2[d]).__contains__('Order Iten') or st1.join(
                dic2[d]).__contains__('SIR GANGA RAM HOSPITAL, Rajinder Nagar, New Delhi 110060') or st1.join(
                dic2[d]).__contains__('Fellows in PHO') or st1.join(dic2[d]).__contains__(
                'Dr. Manas Kalra') or st1.join(dic2[d]).__contains__('Dr.Anupam Sachdeva') or st1.join(
                dic2[d]).__contains__('CASE SUMMARY') or st1.join(dic2[d]).__contains__('conscious.') or st1.join(
                dic2[d]).__contains__('INFO-LIVE-NEW') or \
                st1.join(dic2[d]).__contains__('Payor Exemptions under Package') or st1.join(dic2[d]).__contains__(
            'Sl . Particulars') or st1.join(dic2[d]).__contains__('Order Team') or st1.join(dic2[d]).__contains__(
            'Insurance Comp: NA') or st1.join(dic2[d]).__contains__('ADHOC DETAILED BILL DATE WISE') or st1.join(
            dic2[d]).__contains__('MR MMAN RANT') or st1.join(dic2[d]).__contains__('UID 002130697') or st1.join(
            dic2[d]).__contains__('Ward/Bed FHM-WAR1-A108B') or \
                st1.join(dic2[d]).__contains__('DEHDALA 4CHAND BEST-UNA') or st1.join(dic2[d]).__contains__(
            '"Payor" ICICI LOMBARD" GENERAL') or st1.join(dic2[d]).__contains__('SI. Particulars') or st1.join(
            dic2[d]).__contains__('VatAmt JetAmt') or st1.join(dic2[d]).__contains__('Payor') or st1.join(
            dic2[d]).__contains__('Address') or st1.join(dic2[d]).__contains__('Particulars') or st1.join(
            dic2[d]).__contains__('1..5 30 | Go') or \
                st1.join(dic2[d]).__contains__('MHE T2018') or st1.join(dic2[d]).__contains__('Date') or st1.join(
            dic2[d]).__contains__('INPATIENT') or st1.join(dic2[d]).__contains__('Reg No') or st1.join(
            dic2[d]).__contains__('Age/ Sex') or st1.join(dic2[d]).__contains__('Admission Time') or st1.join(
            dic2[d]).__contains__('Age/Sex') or \
                st1.join(dic2[d]).__contains__('Total 60524. 00') or st1.join(dic2[d]).__contains__(
            'No. of Days') or st1.join(dic2[d]).__contains__(': 11:10AM') or st1.join(dic2[d]).__contains__(
            'Female') or st1.join(dic2[d]).__contains__('Age / Sex ') or st1.join(dic2[d]).__contains__(
            'years/Male') or st1.join(dic2[d]).__contains__('GSTIN') or st1.join(dic2[d]).__contains__('MHE 12018') or \
                st1.join(dic2[d]).__contains__('Dept OBG MHD') or st1.join(dic2[d]).__contains__(
            'Dept MINIMAL') or st1.join(dic2[d]).__contains__('ICICI LOMBARD GENERAL') or st1.join(
            dic2[d]).__contains__('INSURANCE COMPANY Net PayableLIMITED | HYDERABAD | 1002 Share') or st1.join(
            dic2[d]).__contains__('rder Item') or st1.join(dic2[d]).__contains__('MANIPAL HOSPITAL') or st1.join(
            dic2[d]).__contains__('SARJAPURA ROAD') or \
                st1.join(dic2[d]).__contains__('U85110KA2003PTC033055') or st1.join(dic2[d]).__contains__(
            'PURAM BANGALORE') or st1.join(dic2[d]).__contains__('PURAM BANGALORE') or st1.join(dic2[d]).__contains__(
            'Bed 304-2/DOUBLE MSB') or st1.join(dic2[d]).__contains__('Dept GENERAL SURGERY MSB') or st1.join(
            dic2[d]).__contains__('Registered Office') or st1.join(dic2[d]).__contains__('Airport Road') or st1.join(
            dic2[d]).__contains__('DOUBLE MSB') or \
                st1.join(dic2[d]).__contains__('602-1/DOUBLE MSB') or st1.join(dic2[d]).__contains__(
            'Hospital Information System') or st1.join(dic2[d]).__contains__('ASMOLI DIST') or st1.join(
            dic2[d]).__contains__('web/csp/uescadhocdetailbilldate') or st1.join(dic2[d]).__contains__(
            'ROAD BHOGAL') or st1.join(dic2[d]).__contains__('s1. Particular') or st1.join(dic2[d]).__contains__(
            'Amt (') or st1.join(dic2[d]).__contains__('Episode Number') or \
                st1.join(dic2[d]).__contains__('EXTENSION, PATPER GANJ'):
            # print(' to remove unnecesary data')
            esk = 0
            continue
        if esk == 0:
            dic1[l1] = dic2[d]
            l1 += 1
    dic2 = dic1
    l2 = 1
    print('headdata==', head_data)
    for d in dic2:
        if len((dic2[d][0])) > 1 and (dic2[d][0]).strip() in head_data and dic2[d].count(' ') == noc - 1:
            # print('aaaaaaaa',dic2[d])
            tem1 = dic2[d][0]
            dic2[d].pop(0)
            dic1[d].insert(0, ' ')
            dic2[d].pop(1)
            dic1[d].insert(1, tem1)
        if len((dic2[d][0])) > 1 and re.sub('[0-9]', '', dic2[d][0]).strip() in head_data and dic2[d].count(
                ' ') == noc - 1:
            # print('bbbbbbbb',dic2[d])
            tem1 = dic2[d][0]
            tem0 = ' '
            if len(dic2[d][0].split(' ', 1)) == 2:
                tem0 = dic2[d][0].split(' ', 1)[0]
                tem1 = dic2[d][0].split(' ', 1)[1]
            dic2[d].pop(0)
            dic1[d].insert(0, tem0)
            dic2[d].pop(1)
            dic1[d].insert(1, tem1)
        if (len(dic2[d][0].strip()) == 0 or dic2[d][0].isdigit() == True) and len(dic2[d][1]) > 1 and dic2[d][
            1] in head_data and dic2[d][1:].count(' ') == noc - 3:
            # print('ccccccccc',dic2[d])
            tem2 = dic2[d][1]
            hhl = dic2[d][1:]
            stl = ''
            tem2 = stl.join(hhl).strip()
            dd_temp = dic2[d]
            for x in range(len(dd_temp)):
                dd_temp.pop(x)
                dd_temp.insert(x, ' ')
            dd_temp.pop(1)
            dd_temp.insert(1, tem2)
            dic2[d] = dd_temp
        if dic2[d][0] == dic2[d][1] and dic2[d][1] in head_data and dic2[d][2:].count(' ') == noc - 2:
            dic2[d].pop(0)
            dic1[d].insert(0, ' ')
        dic1[l2] = dic2[d]
        l2 += 1

    # 22nd march gangaram
    if hospital == 'gangaram':
        print('nooooo')
        dic2 = dic1
        l2 = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if dic2[d][2] == dic2[d][3]:
                dic2[d][3] = ' '
            if dic2[d][1] in head_data and dic2[d][1] in dic2[d][0]:
                print('if header is in both 0th and 1st index')
                dic2[d][0] = ' '
            if dic2[d][1] == "OR'S OPERATION CHARGES":
                dic2[d][1] = "DOCTOR'S OPERATION CHARGES"
            if dic2[d][1] == "listopathology Laboratory Charges":
                dic2[d][1] = "Histopathology Laboratory Charges"
            if dic2[d][1] == "DOCTOR'S PROCEDURE CHARGES (WP)":
                dic2[d][1] = "DOCTOR'S PROCEDURE CHARGES"
            if dic2[d][1] == 'iochemist':
                dic2[d][1] = 'Biochemistry Laboratory Charges'
            if len(dic2[d][2].split()) == 2 and len(re.findall('\d+\.\d+', dic2[d][2])) >= 1 and dic2[d][3] == ' ':
                print('if qty and rate in 2nd index and 3rd inx empty')
                a, b = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = b
            if len(dic2[d][4].split()) == 3 and dic2[d][5] == ' ':
                print('if cgst and sgst present in 4thind and 5thindx is empty')
                dic2[d][5] = dic2[d][4].split()[-1]
            if (dic2[d][2].__contains__('(') or dic2[d][2].__contains__(')')) and (
                    len(re.findall('\d', dic2[d][2])) == 1 or len(re.findall('\d{3}\s\(', dic2[d][2])) == 1 or len(
                re.findall('\d{2}\s\(', dic2[d][2])) == 1) and len(
                re.findall('\d{2}\/\d{2}\/\d{4}', dic2[d][1])) == 1:
                print('to remove bracktes from qty')
                dic2[d][2] = dic2[d][2].replace('(', '')
                dic2[d][2] = dic2[d][2].replace(')', '')
            if (len(re.findall('\D{8}\s\D{6}\s\(\s\D{2}\d{4}\s\)\s\d{2}', dic2[d][1])) == 1 or len(
                    re.findall('\D{8}\s\D{5}\s\D{7}\s\(\s\D\d{4}\s\)\s\d{2}', dic2[d][1])) == 1 or len(
                re.findall('\D{3}\s\D{2}\,\s\D{6}\s\D{12}\s\d{2}\s\D{2}\s\(\s\d\-\d\s\)', dic2[d][1])) == 1) and (
                    len(re.findall('\D{9}\s\d\/\d\s\D{6}\s\D{7}', dic2[d][4])) == 1 or len(
                re.findall('\D{8}\s\d\/\d\s\D{6}\s\D{5}', dic2[d][4])) == 1 or len(
                re.findall('\(\s\D\d{4}\D\s\)\s\d\/\d\s\D{6}\s\D{5}', dic2[d][4])) == 1) and dic2[d].count(
                ' ') == 4:
                print('for parti in 1st and 4th indx')
                dic2[d][1] = dic2[d][1] + dic2[d][4]
                dic2[d][4] = ' '
            if dic2[d][1].__contains__('Total Qty Charged') and dic2[d][2] == ' ' and len(
                    re.findall('\d', dic2[d][1])) == 1:
                print('if total qty charge is present')
                text = dic2[d][1]
                if len(re.findall('\d', text.split()[-1])) == 1:
                    matchqty = re.search(r'\d', text.split()[-1])
                dic2[d][2] = matchqty.group()
            if dic2[d][1] != ' ' and len(re.findall('\d\s?\.\s?\d', dic2[d][3])) == 1 and len(
                    re.findall('\d\s?\.\s?\d', dic2[d][5])) == 1 and (
                    len(re.findall('\d\s\(\d', dic2[d][1])) == 1 or len(
                re.findall('\d{2}', dic2[d][1].split()[0])) == 1 or len(
                re.findall('\.\s\d{2}\s\(\s', dic2[d][1])) == 1 or len(
                re.findall('\d\s\(\s\.', dic2[d][1])) == 1 or len(re.findall('\d\s\(\D', dic2[d][1])) == 1) and \
                    dic2[d][2] == ' ':
                print('for qty in index 1 with bracket')
                text = dic2[d][1]
                if len(re.findall('\d{3}', text.split()[0])) == 1:
                    print('enttttttttttttt11')
                    matchqty = re.search(r'\d{3}', text.split()[0])
                elif len(re.findall('\.\s\d{2}\s\(\s', text)) >= 1 or len(re.findall('\.\s\d{2}\s\(\s', text)) == 1:
                    print('enttttttttttttt22')
                    matchqty = re.search(r'\.\s\d{2}', text)
                elif len(re.findall('\.\s\d{2}\(\s', text)) >= 1 or len(re.findall('\.\s\d{2}\s\(', text)) == 1:
                    print('enttttttttttttt33')
                    matchqty = re.search(r'\.\s\d{2}', text)
                elif len(re.findall('\.\s\d\s\(\s?\.', text)) >= 1 or len(re.findall('\.\s\d\s\(\.', text)) >= 1:
                    print('entttttttttttttttttttttttttt44')
                    matchqty = re.search(r'\.\s\d', text)
                elif len(re.findall('\d{1}\(', text.split()[0])) == 1:
                    print('entttttttttttttttttttttttttt55')
                    matchqty = re.search(r'\d{1}', text.split()[0])
                elif len(re.findall('\d{2}', text.split()[0])) == 1:
                    print('entttttttttttttttttttttttttt66')
                    matchqty = re.search(r'\d{2}', text.split()[0])
                elif len(re.findall('\d{1}', text.split()[0])) == 1:
                    print('entttttttttttttttttttttttttt77')
                    matchqty = re.search(r'\d{1}', text.split()[0])
                elif len(re.findall('^\D{1}', text.split()[0])) == 1:
                    print('entttttttttttttttttttttttttt77')
                    matchqty = re.search(r'^\D{1}', text.split()[0])
                dic2[d][2] = matchqty.group()
                dic2[d][1] = text.replace(matchqty.group(), '')
            if dic2[d][5] == 'Amt (Rs . )' or dic2[d][5] == 'GENERAL &' or dic2[d][0] == 's1. Particulars' or dic2[d][
                0] == 's1 .':
                dic2[d][5] = ' '
                dic2[d][0] = ' '
                dic2[d][1] = ' '
            if dic2[d][1] == 'FARIDABAD SEC-23 HARYANA':
                dic2[d][1] = ' '
            if dic2[d][4] != ' ' and dic2[d][3] == ' ' and (
                    len(re.findall('\d\s\.\s\d', dic2[d][4])) == 1 or len(re.findall('\d\.\d', dic2[d][4])) == 1 or len(
                re.findall('\d\s\.\d', dic2[d][4])) == 1 or len(re.findall('\d\.\s\d', dic2[d][4])) == 1):
                print('if 4th index not empty and 3rd index empty')
                dic2[d][3] = dic2[d][4]
                dic2[d][4] = ' '
            if (len(re.findall('\-\s\D\d{2}', dic2[d][3])) == 1 or len(
                    re.findall('\D{6}\s\D{9}\s\D{7}', dic2[d][1])) == 1 or len(
                re.findall('\D{2}\s\D{6}\s\d{2}\s\(\s\D{3}\s\d\s\D{2}\s', dic2[d][1])) == 1 or len(
                re.findall('\D{10}\s\D{6}\s\D{8}', dic2[d][1])) == 1 or len(
                re.findall('\D{11}\s\D{7}\s\D{8}', dic2[d][1])) == 1 or len(
                re.findall('\D{3}\s\D{10}\s\(\s\D{5}\s\d{4}\s\)', dic2[d][1])) == 1 or len(
                re.findall('\D{9}\s\D{4}\s\D{5}\s\D{6}\s\D{3}', dic2[d][1])) == 1) and (
                    len(re.findall('\D{4}\.\s\D{8}\s\D{11}', dic2[d][1])) == 1 or len(
                re.findall('\D{8}\s\(\D{5}\s\D{2}\s\D{2}\s\D{2}\s\D{2}\s\D{8}\s\D{5}', dic2[d][3])) == 1 or len(
                re.findall('\D{10}\s\D{10}\s\-\s\D{16}', dic2[d][3])) == 1 or len(
                re.findall('\D{10}\s\D{7}\s\D{8}\s\-\s\D{16}', dic2[d][3])) == 1 or len(
                re.findall('\D{8}\s\D{7}\s\D{6}', dic2[d][3])) == 1 or len(
                re.findall('\D{7}\s\D\s\D{12}\s\D{7}\s\(\D{4}\s\d\)\s\-\D{2}\.', dic2[d][3])) == 1 or len(
                re.findall('\D{7}', dic2[d][3])) == 1 or len(re.findall('\D\s\-\s\D{6}\s', dic2[d][3])) == 1) and \
                    dic2[d].count(' ') == 4:
                print(
                    'for 220202010287,220202025538,220202029593,220202061817,ABHISHEK DC 2.pdf,H_23031_5909438213_54_27_kabir chauhan breakup  parti in 3rd index used')
                dic2[d][1] = dic2[d][1] + dic2[d][3]
                dic2[d][3] = ' '
            if len(re.findall('\d\s?\.\s?\d', dic2[d][2])) == 1 and len(re.findall('\d\s?\.\s?\d', dic2[d][3])) == 0 and \
                    dic2[d][2] != ' ' and dic2[d][3] == ' ':
                print('if val present in 2nd index and not 3rd index')
                dic2[d][3] = dic2[d][2]
                dic2[d][2] = ' '

            if dic2[d][2].isdigit() == False and dic2[d][1].isdigit() == False and dic2[d][1] != ' ' and dic2[d][
                2] != ' ' and len(re.findall('\d\s?\.\s?\d', dic2[d][5])) == 0 and len(
                re.findall('\d\s?\.\s?\d', dic2[d][3])) == 0:
                print('if parti is divided in 1st and 2nd index')
                dic2[d][1] = dic2[d][1] + dic2[d][2]
                dic2[d][2] = ' '

            # if dic2[d][2].__contains__('Total'):
            #     print('if Total is present in 5th index then it is come under Top')
            #     dic2[d][2] = ' '
            # if dic2[d][3].__contains__('Total'):
            #     print('if Total is present in 5th index then it is come under Top')
            #     dic2[d][3] = ' '
            # if dic2[d][4].__contains__('Total'):
            #     print('if Total is present in 5th index then it is come under Top')
            #     dic2[d][4] = ' '

    # for fortis2109/
    if hospital == 'fortismohali':
        print('yesss')
        dic2 = dic1
        l2 = 1
        for d in dic2:
            print('dd11==', dic2[d])
            if dic2[d][0] == 'ADMISSION-CHARGES' or dic2[d][0] == '8. ADMISSION CHARGES.':
                dic2[d][0] = 'ADMISSION CHARGES'
            if dic2[d][0] == '6 BLOOD BANK.':
                dic2[d][0] = 'BLOOD BANK'
            if dic2[d][0] == '3.DRUGS..':
                dic2[d][0] = 'DRUGS'
            if dic2[d][0] == 'His mom s es ( MEDICAL" CONSUMABLE':
                dic2[d][0] = 'MEDICAL CONSUMABLE'
            if len(re.findall('\d\.\d\s\d{4}\s\.\s\d{2}', dic2[d][2])) == 1 and len(
                    re.findall('\d{2}\/\d{2}\/\d{4}', dic2[d][0])) == 1:
                print('for 220201945544 0.5 3000 . 00', dic2[d][2].split()[0])
                dic2[d][2] = dic2[d][2].split()[0]
            if len(re.findall('\d\s\.\s\d', dic2[d][2])) == 1 or len(re.findall('\d\s\.\d', dic2[d][2])) == 1:
                dic2[d][2] = dic2[d][2].replace(' ', '')
            if len(re.findall('\d\s\.\s\d', dic2[d][3])) == 1:
                dic2[d][3] = dic2[d][3].replace(' ', '')
            if len(re.findall('\d\s\.\s\d', dic2[d][4])) == 1:
                dic2[d][4] = dic2[d][4].replace(' ', '')
            if len(re.findall('\d\s\.\s\d', dic2[d][5])) == 1:
                dic2[d][5] = dic2[d][5].replace(' ', '')
            if len(dic2[d][2].split()) == 3 and (dic2[d][3] == ' ' or dic2[d][3] in dic2[d][2]) and len(
                    re.findall('\d\.\d', dic2[d][2])) >= 1:
                print('if qty,rate and discount in 2nd index')
                a, b, c = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = b
                dic2[d][4] = c
            if len(dic2[d][2].split()) == 2 and len(re.findall('\d\.\d', dic2[d][2])) == 1:
                print('if qty and rate in 2nd index')
                a, b = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = b
            if len(dic2[d][2].split()) == 2 and len(re.findall('\d\.\d', dic2[d][2])) == 2:
                print('if rate and discount in 2nd index')
                a, b = dic2[d][2].split()
                dic2[d][2] = ' '
                dic2[d][3] = a
                dic2[d][4] = b
            if len(dic2[d][3].split()) == 2 and len(re.findall('\d\.\d', dic2[d][3])) >= 1:
                print('for rate and discount split')
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if len(re.findall('\d\s?\.\s?\d', dic2[d][2])) == 1 and dic2[d][3] == ' ':
                print('if qty is absent and rate is in 2nd index changing to 3rd index')
                dic2[d][3] = dic2[d][2]
                dic2[d][2] = ' '
            if dic2[d][2] == dic2[d][3] and (
                    len(re.findall('\d\s?\.\s?\d', dic2[d][2])) == 1 or len(re.findall('\d\s\d', dic2[d][2])) == 1):
                print('if rate is in both 2nd and 3rd index with same value')
                dic2[d][2] = ' '
            if dic2[d][2] == '12 Lead' and dic2[d][3] == '12 Lead':
                dic2[d][2] = ' '
                dic2[d][3] = ' '

    if hospital == 'manipaldelhi' or hospital == 'manipal_N0900' or hospital == 'Columbia_N16420' or hospital == 'Vikram':
        print('yesss')
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if len(re.findall('\s\.\s', dic2[d][3])) == 1:
                text = dic2[d][3]
                matchspaceright = re.search(r'\s\.\s', text)
                print('matchh s.s in 3rd index', matchspaceright.group())
                dic2[d][3] = text.replace(matchspaceright.group(), '.')
            if len(re.findall('\s\.\s', dic2[d][2])) == 1:
                text = dic2[d][2]
                matchspaceright = re.search(r'\s\.\s', text)
                print('matchh s.s in 2nd index', matchspaceright.group())
                dic2[d][2] = text.replace(matchspaceright.group(), '.')
            if len(re.findall('\s\.\s', dic2[d][5])) == 1:
                text = dic2[d][5]
                matchspaceright = re.search(r'\s\.\s', text)
                print('matchh s.s in 5th index', matchspaceright.group())
                dic2[d][5] = text.replace(matchspaceright.group(), '.')
            if dic2[d][0].__contains__('Sub Total') or dic2[d][0] == 'Total':
                dic2[d][0] = ' '
                dic2[d][5] = ' '
            if dic2[d][1] in head_data and 'SAC' not in dic2[d][1]:
                dic2[d][1] = dic2[d][1].lower()

            dic1[lq] = dic2[d]
            lq += 1

        dic2 = dic1
        l2 = 1
        for d in dic2:
            print('dd11==', dic2[d])
            if dic2[d][0] == 'Clinical Manage ment Fee':
                dic2[d][0] = 'Clinical Management Fee'
            if dic2[d][0] == '13 tists Fees SAC : 999311':
                dic2[d][0] = 'Anasthetists Fees'
            if dic2[d][0] == '16 I Support Fees SAC : 999311':
                dic2[d][0] = 'Surgical Support Fees'
            if dic2[d][0] == 'Drugs SAC : 999311':
                dic2[d][0] = 'Pharmacy Drugs'
            if dic2[d][0] == '7 Surgeon Foe SAC : 999311':
                dic2[d][0] = 'Surgeon Fee'
            if dic2[d][0] == '6 Theatre Chargoa SAC : 999311':
                dic2[d][0] = 'Theatre Charges'
            if dic2[d][0] == '8 laneous SAC : 999311' or dic2[d][0] == '15 Laneous SAC : 999311':
                dic2[d][0] = 'Miscellaneous'
            if dic2[d][0] == '5 Modical Equipment SAC : 999311':
                dic2[d][0] = 'Medical Equipment'
            if dic2[d][0] == '6 Haomatology SAC: 999316':
                dic2[d][0] = 'Haematology'
            if dic2[d][0] == 'Admission Cha SAC : 999311':
                dic2[d][0] = 'Admission Charges'
            if dic2[d][0] == '16 Diet ITE666 :DYS':
                dic2[d][0] = 'Diet'
            if dic2[d][0] == 'Bad Charges SAC: 999311':
                dic2[d][0] = 'Bed Charges SAC: 999311'
            for i in src_dc['head_list'].split(','):
                if i in dic2[d][0] and dic2[d][0].__contains__(i + ' ' + 'SAC'):
                    print('yeess for head')
                    dic2[d][1] = i
                    dic2[d][0] = ' '
            if dic2[d][5].__contains__('Total'):
                print('if Total is present in 5th index then it is come under Top')
                dic2[d][5] = dic2[d][5].replace('Total', 'total')
            if dic2[d][3].__contains__('Total'):
                print('if Total is present in 5th index then it is come under Top')
                dic2[d][3] = dic2[d][3].replace('Total', 'total')
            if dic2[d][0] == dic2[d][2]:
                dic2[d][0] = ' '
            if dic2[d][2] == dic2[d][3]:
                dic2[d][2] = ' '
            if dic2[d][2].__contains__('*'):
                dic2[d][2] = dic2[d][2].replace('*', '')
            if dic2[d][3].__contains__('*'):
                dic2[d][3] = dic2[d][3].replace('*', '')
            if d > 1 and d < len(dic2) and len(re.findall('\d{3}\.\s\d{2}', dic2[d][3])) == 1 and len(
                    re.findall('\d{3}\.\s\d{2}', dic2[d][5])) == 1 and len(
                    re.findall('\[\s\w{5}\d{2}\]\s\w{13}\s\w{1}', dic2[d - 1][0])) == 1 and dic2[d].count(' ') == 4 and \
                    dic2[d - 1].count(' ') == 5:
                dic2[d - 1][3] = dic2[d][3]
                dic2[d - 1][5] = dic2[d][5]
                dic2[d][3] = ' '
                dic2[d][5] = ' '
            if d >= 4 and d < len(dic2) + 4 and len(re.findall('\d{3}\s\.\s\d{2}', dic2[d][3])) == 1 and len(
                    re.findall('\d{4}\s\.\s\d{2}', dic2[d][5])) == 1 and len(
                    re.findall('\w{6}\:\s\d{2}\,\s\w{8}\s\:\d', dic2[d - 1][0])) == 1 and dic2[d].count(' ') == 4 and \
                    dic2[d - 1].count(' ') == 5 and dic2[d - 2].count(' ') == 5 and dic2[d - 3].count(' ') == 5 and len(
                re.findall('\w{6}\s\w\s\d\.\s\d\w{2}\s\w{9}\s\w{4}', dic2[d - 3][0])) == 1:
                print('for 220202148974 AXIFUR H 1. 5GM INJECTION VIAL ( CEFUROXIME)')
                dic2[d - 3][3] = dic2[d][3]
                dic2[d - 3][5] = dic2[d][5]
                dic2[d][3] = ' '
                dic2[d][5] = ' '
            if len(re.findall('\d\s\.\s\d', dic2[d][3])) == 1 or len(re.findall('\d\s\.\d', dic2[d][3])) == 1 or len(
                    re.findall('\d\.\s\d', dic2[d][3])) == 1:
                dic2[d][3] = dic2[d][3].replace(' ', '')
            if len(re.findall('\d\s\.\s\d', dic2[d][5])) == 1 or len(re.findall('\d\s\.\d', dic2[d][5])) == 1 or len(
                    re.findall('\d\.\s\d', dic2[d][5])) == 1:
                dic2[d][5] = dic2[d][5].replace(' ', '')
            if d > 1 and (len(re.findall('\d\s\.\s\d', dic2[d][3])) == 1 or len(
                    re.findall('\d\.\d', dic2[d][3])) == 1 or len(re.findall('\d\s\.\d', dic2[d][3])) == 1 or len(
                re.findall('\d\.\s\d', dic2[d][3])) == 1) and (
                    len(re.findall('\d\s\.\s\d', dic2[d][5])) == 1 or len(
                re.findall('\d\.\d', dic2[d][5])) == 1 or len(re.findall('\d\s\.\d', dic2[d][5])) == 1 or len(
                re.findall('\d\.\s\d', dic2[d][5])) == 1) and dic2[d].count(' ') >= 4 and dic2[d - 1].count(
                ' ') >= 4 and len(re.findall('\d\s\.\s\d', dic2[d - 1][3])) == 0 and len(
                re.findall('\d\s\.\s\d', dic2[d - 1][5])) == 0:
                print('for parti and num separet lines')
                dic2[d - 1][3] = dic2[d][3]
                dic2[d - 1][5] = dic2[d][5]
                dic2[d][3] = ' '
                dic2[d][5] = ' '

    for d in dic1:
        print(dic1[d])
    print('***********####################****************')
    return dic1
def spf_spl_corr(dic_1,head_list,noc,p1,p2):
    dic2=dic_1
    dic1={}
    l2=1
    lst=[]
    f=1
    for d in dic2:
        f +=1
        if f>2 and dic2[d][0]==p1 and lst[0].__contains__(p2) and dic2[d].count(' ')==noc-1:
            # print(dic2[d],'---',lst)
            dic2[d].pop(0)
            dic2[d].insert(0,p1+'#')
        dic1[l2]=dic2[d]
        lst=dic2[d]
        l2 +=1
    dic_1=dic1
    return dic_1
def merged_lines_dic(dic1:dict,src_dc,head_list,summary_headers):  
    sbt=src_dc['sbt']
    hospital=src_dc['Hospital']
    sub_head=src_dc['merge_set'].split(',')
    # print(sub_head)
    noc=int(src_dc['#colm'])

    if src_dc['Hospital']=='akash':
        dicone=dic1
        dic1={}
        cl=1
        for d in dicone:
            if dicone[d][0]=='General Misc,' and dicone[d].count(' ')==7:
               dd1='General Misc.'
               dicone[d].pop(0)
               dicone[d].insert(0,dd1)
            dic1[cl] = dicone[d]
            cl +=1
    if src_dc['Hospital'] == 'srch':
        h = len(dic1)
        if 'Subtotal' not in dic1[h][1]:
            dic1[h + 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']

    list1=table_size(noc)

    if len(src_dc['correct_cld_1'])>1:
        dic_1=dic1
        dic1=correct_conclude(dic_1,src_dc,head_list)

    if len(src_dc['head_to_head_sbt'])>1:
        dic_1=dic1
        dic1=head_to_head_sbt(dic_1,src_dc,head_list)

    if len(src_dc['sift_sbt'])>1:
        dic_1=dic1
        dic1=sift_sbt(dic_1,src_dc,head_list)
    if src_dc['peronailse_at_merge']=='yes':
        hospital=src_dc['Hospital']
        dic1,head_list=peronailse_at_merge(dic1,src_dc,head_list,sbt,noc,hospital)

    if src_dc['head_identify_1']=='yes':
        dic1,head_list = head_identify(dic1,src_dc,sbt,noc,head_list,hospital,summary_headers)
    dic_c=dic1
    dic1={}
    cl=1
    for d in dic_c:
        if dic_c[d].count(' ')==noc:
            continue
        dic1[cl]=dic_c[d]
        cl +=1

    last=[]
    dicA={}
    ll=1
    flg=0
    if len(src_dc['merge_set'])>1:
        # print('AAAAAAAAAAAA')
        p1=src_dc['merge_param'].split(',')[0]
        p2=src_dc['merge_param'].split(',')[1]
        p3=src_dc['merge_param'].split(',')[2]
        p4=src_dc['merge_param'].split(',')[3]
        p5=src_dc['merge_param'].split(',')[4]
        p6=src_dc['merge_param'].split(',')[5]
        i1=int(src_dc['merge_param'].split(',')[6])
        i2=int(src_dc['merge_param'].split(',')[7])
        i3=int(src_dc['merge_param'].split(',')[8])
        i4=int(src_dc['merge_param'].split(',')[9])
        i5=int(src_dc['merge_param'].split(',')[10])
        i6=int(src_dc['merge_param'].split(',')[11])
        cn=int(src_dc['merge_param'].split(',')[12])
        p1c='.'
        if p1.__contains__('.'):
            p1c=''
        p2c='.'
        if p2.__contains__('.'):
            p2c=''
        p3c='.'
        if p3.__contains__('.'):
            p3c=''
        p4c='.'
        if p4.__contains__('.'):
            p4c=''
        p5c='.'
        if p5.__contains__('.'):
            p5c=''
        p6c='.'
        if p6.__contains__('.'):
            p6c=''
        # print(p1,'-',p2,'-',p3,'-',p4,'--',i1,'-',i2,'-',i3,'-',i4,'--',cn,'----')
        cvt=0
        for dd in dic1:
            cvt +=1
            # for first item in dic1
            if len(last)==0:
                last=dic1[dd]
                flg=1
                continue

            if flg==1:
                str13=''
                if (dic1[dd][0].strip() in head_list) or (dic1[dd][0].strip() in sub_head or dic1[dd][1].strip() in sub_head) or (len(re.findall(p1,dic1[dd][i1].replace(p1c,'')))>=1 or len(re.findall(p2,dic1[dd][i2].replace(p2c,'')))>=1 or len(re.findall(p3,dic1[dd][i3].replace(p3c,'')))>=1 or len(re.findall(p4,dic1[dd][i4].replace(p4c,'')))>=1 or len(re.findall(p5,dic1[dd][i5].replace(p5c,'')))>=1 or (len(re.findall(p6,dic1[dd][i6].replace(p6c,'')))>=1) and dic1[dd].count(' ')<=cn) or (str13.join(dic1[dd]).__contains__(sbt)==True):
                    # print(dic1[dd],'33333333333333333333333')
                    dicA[ll]=last
                    ll +=1
                    last=dic1[dd]
                else:
                    if (last[0].strip() in sub_head or last[1].strip() in sub_head) and cvt>3 and dic1[dd-1][1]!=dic1[dd-2][1]:
                        # print(dic1[dd],'4444444444444444444444444_111111')
                        dicA[ll]=last
                        ll +=1
                        last=list1
                    last=opr1(last,dic1[dd],src_dc)
        dicA[ll]=last
        if hospital=='apolo':
            dic22=dicA
            dicA={}
            lq=1
            for d in dic22:
                if dic22[d][1:].count(' ')==8 and dic22[d][0].__contains__('HSN') or dic22[d][0].__contains__('PMIS'):
                    myl= opr1(dic22[d-1],dic22[d],src_dc)
                    dicA[lq-1]=copy.deepcopy(myl)
                    continue
                dicA[lq-1]= dic22[d]
                lq +=1

    else:

        if src_dc['mp_else']=='yes':
            # print('BBBBBBBBBBBBBBBBBBBb')
            i1,v1,i2,v2,i3,v3,v4=src_dc['merge_param'].split(',')
            i1,v1,i2,v2,i3,v3,v4=int(i1),int(v1),int(i2),int(v2),int(i3),int(v3),int(v4)
            for dd in dic1:
                # print('9999999',dic1[dd])
                if len(last)==0:
                    last=dic1[dd]
                    flg=1
                    continue
                if flg==1:
                    str13=''
                    if ((len(dic1[dd][i1])==v1 and len(dic1[dd][i2])>=v2) and str13.join(dic1[dd]).__contains__(sbt)==False) or ((len(dic1[dd][i3])>=v3 and dic1[dd].count(' ')>=v4) and (len(last[i3])>=v3 and last.count(' ')>=v4) and str13.join(last).__contains__('SAC')==False):
                    # if len(dic1[dd][1])>=1 and dic1[dd].count(' ')>=noc-2 and len(last[1])>1:
                        # print('1111111',dic1[dd])
                        last=opr1(last,dic1[dd],src_dc)
                    else:
                        # print('22222222',dic1[dd])
                        dicA[ll]=last
                        ll +=1
                        last=dic1[dd]
            dicA[ll]=last
        else:
            # print('CCCCCCCCCCCCCCCCCCCCCCCCCCC')
            # head_list=src_dc['head_list'].split(',')
            p1=src_dc['merge_param'].split(',')[0]
            p2=src_dc['merge_param'].split(',')[1]
            p3=src_dc['merge_param'].split(',')[2]
            p4=src_dc['merge_param'].split(',')[3]
            i1=int(src_dc['merge_param'].split(',')[4])
            i2=int(src_dc['merge_param'].split(',')[5])
            i3=int(src_dc['merge_param'].split(',')[6])
            i4=int(src_dc['merge_param'].split(',')[7])
            cn=int(src_dc['merge_param'].split(',')[8])
            p1c='.'
            if p1.__contains__('.'):
                p1c=''
            p2c='.'
            if p2.__contains__('.'):
                p2c=''
            p3c='.'
            if p3.__contains__('.'):
                p3c=''
            p4c='.'
            if p4.__contains__('.'):
                p4c=''
            rep1=''
            rep2=''
            if src_dc['merge_space']=='yes':
                rep1=' '
            print(head_list)
            for dd in dic1:
                # print('00000000',dic1[dd])
                # for first item in dic1
                if len(last)==0:
                    last=dic1[dd]
                    flg=1
                    continue
                if flg==1:
                    str13=''
                    if (dic1[dd][0].strip() in head_list) or (len(re.findall(p1,dic1[dd][i1].replace(rep1,rep2).replace(p1c,'')))==1 or len(re.findall(p2,dic1[dd][i2].replace(rep1,rep2).replace(p2c,'')))==1 or len(re.findall(p3,dic1[dd][i3].replace(rep1,rep2).replace(p3c,'')))==1 or (len(re.findall(p4,dic1[dd][i4].replace(rep1,rep2).replace(p4c,'')))==1) and dic1[dd].count(' ')<=cn) or (str13.join(dic1[dd]).__contains__(sbt)==True):
                        # print('11111111',dic1[dd])
                        dicA[ll]=last
                        ll +=1
                        last=dic1[dd]
                    else:
                        # print('2222222',dic1[dd],dic1[dd].count(' '),last)
                        last=opr1(last,dic1[dd],src_dc)
            dicA[ll]=last

    if len(dicA)==1:
        return dicA
    if hospital=='max' or hospital == 'nanavati':
        dic2=dicA
        dic1={}
        lq=1
        spl_head1=['Procedures']
        f=0
        fn=len(dic2)
        for d in dic2:
            print('tttt==',dic2[d])
            f +=1
            ss=''
            if len(re.findall('^1\s0.\d{2}',dic2[d][3]))==1 and len(dic2[d][3].split())==2 and len(dic2[d][2].strip())==0 and len(re.findall('^0.\d{2}',dic2[d][5]))==1:
                print('oppppp',dic2[d])
                md2=dic2[d][3].split()[0]
                md3=dic2[d][3].split()[1]
                dic2[d].pop(2)
                dic2[d].pop(2)
                dic2[d].insert(2,md3)
                dic2[d].insert(2,md2)
            if f>3 and f<fn and len(dic2[d][0].strip())==0 and len(dic2[d][1].strip())==0 and ss.join(dic2[d]).__contains__('Sub Total')==False and len(re.findall('\d\s?\.\s?\d',dic2[d][5]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d][3]))==1 and dic2[d-1].count(' ')==1 and dic2[d+1].count(' ')==5 and dic2[d+1][0] in spl_head1:
                dic2[d].pop(2)
                dic2[d].insert(2,'Sub Total')
            if f>3 and (len(re.findall('\d\s?\.\s?\d',dic2[d][3]))==1 or len(re.findall('\d\s?\.\s?\d',dic2[d][5]))==1) and ss.join(dic2[d]).__contains__(sbt)==False and ss.join(dic2[d-1]).__contains__(sbt)==True:
                rooom=['Single','Economy','Double','Twin','Deluxe','General','Isolation','Room']

                # rmt=['GW','G.W','G/W','G.W.','Day', 'PLATINUM','Care', 'Deluxe', 'Covid', 'Special', 'A/C', 'Non', 'General', 'Ward', 'Economy', 'HDU', 'Isolation', 'ICU', 'NICU', 'ICCU','MICU','CLASS', 'CCU', 'PICU', 'Mentioned', 'Sharing', 'Semi', 'Private', 'Room', 'Single', 'Suite', 'Excecutive', 'Luxury', 'Super', 'Triple', 'Twin', 'isolation', 'ward', 'icu', 'single', 'twin', 'room', 'sharing', 'shared', 'intensive', 'double', 'deluxe', 'premium', 'critical', 'care', 'unit']
                room_yes=0
                # print('bubububu',dic2[d-1],'---',dic2[d])
                for i in rooom:
                    if dic2[d][0].lower().__contains__(i.lower()):
                        print('addd_room_type')
                        dic1[lq]=['Room Rent',' ',' ',' ',' ',' ']
                        lq +=1
                        room_yes=1
                        break
                if room_yes==0:
                    print('oyoyoyoy',dic2[d-1],'---',dic2[d])
                    dic1[lq]=['Head',' ',' ',' ',' ',' ']
                    lq +=1
            dic1[lq]=dic2[d]
            lq +=1
        dicA=dic1

        dic2=dicA
        dic1={}
        lq=1
        fn=len(dic2)
        f=1
        for d in dic2:
            ss=''
            f +=1
            if f>2 and f<fn and (len(re.findall('\d\/\d?\d\/\d{4}|\d\/\d?\d\/\d{2}\s\d{2}',dic2[d][1]))==1 or len(re.findall('\d\s?\.\s?\d',dic2[d][3]))==1) and len(re.findall('\d\s?\.\s?\d',dic2[d][5]))==1 and len(dic2[d][0])>1:
                if ss.join(dic2[d-1]).__contains__('Sub Total') and (ss.join(dic2[d+1]).__contains__('Sub Total') or ss.join(dic2[d+2]).__contains__('Sub Total')):
                    print('ououou1',dic2[d])
                    dic1[lq]=['HEAD_PKG',' ',' ',' ',' ',' ']
                    lq +=1
            dic1[lq]=dic2[d]
            lq +=1
        dicA=dic1

        dic2=dicA
        dic1={}
        lq=1
        fn=len(dic2)
        f=1
        for d in dic2:
            try:
                ss=''
                f +=1
                if f>=2 and len(dic2[d][3])>=3 and len(dic2[d][3].split('.'))==3:
                    dic2[d].pop(3)
                    dic2[d].insert(3,ss.strip('., '))
                if f>=2 and len(dic2[d][2])>3 and len(dic2[d][2].split())==2 and len(dic2[d][3])>3 and len(dic2[d][3].split())==2:
                    # print('clclclcl',dic2[d],dic2[d][2].split()[0].isdigit(),dic2[d][2].split()[1].replace('.','',1).isdigit())
                    if dic2[d][2]==dic2[d][3] and len(dic2[d][5].strip())==0 and dic2[d][2].split()[0].isdigit()==True and dic2[d][2].split()[1].replace('.','',1).isdigit()==True:
                        # print('clclclcl_000',dic2[d],'--',dic2[d][2].split()[0],'--',dic2[d][2].split()[1].replace('.','',1))
                        ud1,ud2=dic2[d][2].split()
                        vd1,vd2=int(ud1),int(ud2.replace('.','',1))
                        vd3=int(vd1)*vd2
                        ud3=str(vd3)
                        ud3=ud3[:-2]+'.'+ud3[-2:]
                        dic2[d].pop(2)
                        dic2[d].insert(2,str(ud1))
                        dic2[d].pop(3)
                        dic2[d].insert(3,str(ud2))
                        dic2[d].pop(5)
                        dic2[d].insert(5,ud3)
                        # print('clclclcl_000_111',dic2[d])
                    if dic2[d][2]==dic2[d][3] and len(re.findall('\d\s?\.\s?\d',dic2[d][5]))==1 and dic2[d][5].replace('.','',1).isdigit()==True and dic2[d][2].split()[0].isdigit()==True and dic2[d][2].split()[1].replace('.','',1).isdigit()==True:
                        # print('blblblbl_111',dic2[d])
                        ud1,ud2=dic2[d][2].split()
                        vd1,vd2=int(ud1),int(ud2.replace('.','',1))
                        vd3=vd1*vd2
                        vd3=int(vd3)
                        vd4=int(dic2[d][5].strip().replace('.','',1))
                        ud3=str(vd3)
                        if vd3==vd4:
                            dic2[d].pop(2)
                            dic2[d].insert(2,ud1)
                            dic2[d].pop(3)
                            dic2[d].insert(3,ud2)
                            # dic2[d].pop(5)
                            # dic2[d].insert(5,dic2[d][5])
                            # print('blblblbl_111_111',dic2[d])
            except:
                print('cleaning issue',dic2[d])
            dic1[lq]=dic2[d]
            lq +=1

        dic2=dicA
        dic1={}
        lq=1
        fn=len(dic2)
        f=1
        for d in dic2:
            try:
                f +=1
                if f>=2 and len(dic2[d][3])>=3 and len(dic2[d][3].split('.'))==3:
                    ssn = copy.deepcopy(dic2[d][3])
                    dic2[d].pop(3)
                    dic2[d].insert(3,ssn.strip('., '))
                if  dic2[d][4]==' ' and len(dic2[d][3].replace('.','').replace(',',''))>2 and dic2[d][3].replace('.','',1).isdigit()==True and len(dic2[d][5].replace('.','').replace(',',''))>3 and dic2[d][3].replace(',','',1).replace('.','',1).isdigit()==True:
                    two_n=copy.deepcopy(dic2[d][2])
                    three_n=copy.deepcopy(dic2[d][3])
                    five_n=copy.deepcopy(dic2[d][5])
                    five_n=five_n.replace(',','',1)
                    three=float(three_n)
                    five=float(five_n)
                    if two_n!=' ':
                        two=1
                        for i in range(1,25):
                            two=i
                            if five==(two*three):
                                break
                            print('__gggg',two,three,five,five-(two*three))
                            for x in [0.01,0.02,0.03,0.04,0.05]:
                                if five==(two*three)+float(x) and str(two)==str(two_n):
                                    print(dic2[d],'uuuuu1__',(two*three)+float(x),five)
                                    dic2[d].pop(2)
                                    dic2[d].insert(2,str(two))
                                    dic2[d].pop(5)
                                    dic2[d].insert(5,str(round((two*three)+x,2)))
                                elif five+float(x)==(two*three) and str(two)==str(two_n):
                                    print(dic2[d],'__1uuuuu',five+x,(two*three))
                                    dic2[d].pop(2)
                                    dic2[d].insert(2,str(two))
                                    dic2[d].pop(5)
                                    dic2[d].insert(5,str(round(five+x,2)))

            except:
                print('cleaning issue11',dic2[d])
            dic1[lq]=dic2[d]
            lq +=1

        dicA=dic1
        print('kkkkkmmmmmmmm')
        dic2=dicA
        dic1={}
        lq=1
        for d in dic2:
            try:
                if len(dic2[d][0])>5 and  len(re.findall('^\d\d\s[A-Za-z]+',dic2[d][0]))==1:
                    # print('cleaning the indexes',dic2[d])
                    obb = copy.deepcopy(dic2[d])
                    obb_zero = re.sub('^\d\d\s+','',obb[0])
                    obb.pop(0)
                    obb.insert(0,obb_zero)
                    dic2[d]=obb
                    # print('cleaning the indexes_look',dic2[d])
            except:
                print('error cleaning indexes',dic2[d])
            dic1[lq]=dic2[d]
            lq +=1
        dicA=dic1

        dic2 = dicA
        dic1 = {}
        for d in dic2:
            print('mddd', dic2[d])
            if d > 1 and len(re.findall('\d{2}\/\d{2}\/\d{2}', dic2[d][0])) == 1 and dic2[d][1] == ' ':
                print('if date merged with 0th indx in surgery lines')
                text = dic2[d][0]
                matchdate = re.search(r'\d{2}\/\d{2}\/\d{2}', text)
                dic2[d][1] = matchdate.group()
                dic2[d][0] = dic2[d][0].replace(matchdate.group(), '')
            if d > 1 and (dic2[d][1].__contains__('Surgeon Fee') or dic2[d][1].__contains__('Anesthestist Fee') or
                          dic2[d][1].__contains__('T Charges') or dic2[d][1].__contains__('Equipment Fee')) and dic2[d][
                5] != ' ' and dic2[d].count(' ') >= 2 and dic2[d][2] == ' ':
                print('for surgery line items')
                if dic2[d][0] != ' ':
                    dic2[d - 1][0] = dic2[d - 1][0] + ' ' + dic2[d][0]
                    dic2[d][0] = dic2[d][1]
                    dic2[d][1] = ' '
                else:
                    dic2[d][0] = dic2[d][1]
                    dic2[d][1] = ' '
            if d > 1 and (
                    dic2[d][0].__contains__('(') or dic2[d][0].__contains__(')') or dic2[d][0].__contains__('-') or
                    dic2[d][0].__contains__('*')) and dic2[d][5] == ' ' and dic2[d][1] != ' ' and \
                    dic2[d].count(' ') >= 3 and (
                    dic2[d - 1][3].__contains__('Sub To') or dic2[d - 1][2].__contains__('Sub To')):
                print('for surgery sbtss with date in 1st indx')
                dic2[d - 1][2] = ' '
                dic2[d - 1][3] = ' '
                dic2[d - 1][5] = ' '
            if d > 1 and (dic2[d][0].__contains__('Second Assistant Surgeon') or dic2[d][0].__contains__(')')) and \
                    dic2[d][5] == ' ' and dic2[d][1] == ' ' and \
                    dic2[d].count(' ') >= 3 and (
                    dic2[d - 1][3].__contains__('Sub To') or dic2[d - 1][2].__contains__('Sub To')):
                print('for surgery sbtss with no date in 1st indx')
                dic2[d - 1][2] = ' '
                dic2[d - 1][3] = ' '
                dic2[d - 1][5] = ' '
            if (dic2[d][0] != ' ' and dic2[d][0] != '') and (
                    len(re.findall('\d{2}', dic2[d][0].split()[0])) == 1 or len(
                    re.findall('\d', dic2[d][0].split()[0])) == 1 or len(
                re.findall('\d{3}', dic2[d][0].split()[0])) == 1) and dic2[d].count(' ') <= 3 and (
                    len(dic2[d][0].split()[0]) <= 3) and '-' not in dic2[d][0].split()[0] and len(
                dic2[d][0].split()) >= 2:
                # print('for removing snos in 0th index', dic2[d])
                text = dic2[d][0]
                if len(re.findall('\d{3}', dic2[d][0].split()[0])) == 1 and len(dic2[d][0].split()[0]) == 3:
                    matchsno = re.search(r'\d{3}', text)
                elif len(re.findall('\d{2}', dic2[d][0].split()[0])) == 1 and len(dic2[d][0].split()[0]) == 2:
                    matchsno = re.search(r'\d{2}', text)
                elif len(re.findall('\d', dic2[d][0].split()[0])) == 1 and len(dic2[d][0].split()[0]) == 1:
                    matchsno = re.search(r'\d', text)
                elif len(re.findall('\D?\d', dic2[d][0].split()[0])) == 1:
                    matchsno = re.search(r'\D?\d', text)
                elif len(re.findall('\D?\d{2}', dic2[d][0].split()[0])) == 1:
                    matchsno = re.search(r'\D?\d{2}', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
                dic2[d][0] = dic2[d][0].replace(dic2[d][0][0], '', 1)
            if dic2[d][1] in dic2[d][0] and dic2[d][1] != ' ' and dic2[d][0] != ' ' and len(
                    re.findall('\d\/\d\s?\d\/\d', dic2[d][1])) >= 1:
                print('for room rent dates')
                dic2[d][0] = dic2[d][0].replace(dic2[d][1], '')
            if dic2[d][0] != ' ' and dic2[d][1] == ' ' and len(
                    re.findall('\d+\/\d+\/\d+\s\d+\:\d+\s\d+\/\d+\/\d+\s\d+\:\s?\d+', dic2[d][0])) == 1:
                print('for room rent date in 0th indx and 1st indx empty')
                text = dic2[d][0]
                matchdate = re.search(r'\d+\/\d+\/\d+\s\d+\:\d+\s\d+\/\d+\/\d+\s\d+\:\s?\d+', text)
                dic2[d][1] = matchdate.group()
                dic2[d][0] = dic2[d][0].replace(matchdate.group(), '')
                dic2[d][0] = dic2[d][0].strip()
            if dic2[d][0] != ' ' and len(
                    re.findall('\d+\/\d+\/\d+\s\d+\:\d+\s\d+\/\d+\/\d+\s\d+\:\s?\d+', dic2[d][0])) == 1 and \
                    len(re.findall('\d+\/\d+\/\d+\s\d+\:\d+\s\d+\/\d+\/\d+\s\d+\:\s?\d+', dic2[d][1])) == 1:
                print('for room rent date in 0th indx and 1st indx')
                text = dic2[d][0]
                matchdate = re.search(r'\d+\/\d+\/\d+\s\d+\:\d+\s\d+\/\d+\/\d+\s\d+\:\s?\d+', text)
                dic2[d][1] = matchdate.group()
                dic2[d][0] = dic2[d][0].replace(matchdate.group(), '')
                dic2[d][0] = dic2[d][0].strip()
            if dic2[d][5] != ' ' and len(dic2[d][5].split()) >= 2:
                text = dic2[d][5].split()
                dic2[d][5] = text[-1]

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'max_daycare':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'max_daycare1':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if d==1 and dic2[d][0] != 'Head':
                listnw = ['Head', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq-1] = listnw
            if d==len(dic2) and dic2[d][1]!='Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq+1] = listnw


            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////

    if hospital=='apolo':
        # print('subbbbb',sub_head)
        dic2=dicA
        dic1={}
        lq=1
        f=1
        my_lines=['Charges(SPECIAL STANDARD BED)']
        for d in dic2:
            print('md====',dic2[d])
            f += 1
            ss=''
            if f>2 and dic2[d][1] in my_lines and dic2[d].count(' ')==8 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==1 and len(re.findall('\d{4}',dic2[d-1][0]))==1:
                print('opppppw',dic2[d])
                myl= opr1(dic2[d-1],dic2[d],src_dc)
                dic1[lq-1]=copy.deepcopy(myl)
                continue

            if f>2 and (len(re.findall('\d{5}',dic2[d-1][0]))==1 and len(dic2[d][0].strip())==0) and ((len(re.findall('\d\s?\.\s?\d|\d{2}\s\d{2}',dic2[d-1][8]))==1 or len(re.findall('\d\s?\.\s?\d|\d{2}\s\d{2}',dic2[d-1][6]))==1) and (len(re.findall('\d\s?\.\s?\d|\d{2}\s\d{2}',dic2[d][8]))==0 or len(re.findall('\d\s?\.\s?\d|\d{2}\s\d{2}',dic2[d][6]))==0) and (len(re.findall('\d\s?\.\s?\d|\d{2}\s\d{2}',dic2[d][8]))==1 or len(re.findall('\d\s?\.\s?\d|\d{2}\s\d{2}',dic2[d][6]))==1) and (len(re.findall('\d\s?\.\s?\d|\d{2}\s\d{2}',dic2[d][8]))==0 or len(re.findall('\d\s?\.\s?\d|\d{2}\s\d{2}',dic2[d][6]))==0)) and (ss.join(dic2[d]).__contains__('PMIS') or ss.join(dic2[d]).__contains__('PMIN')) and len(dic2[d-1][1])>5 and dic2[d].count(' ')>=5:
                if len(re.findall('\d\d?\/\d{2}\/\d{4}\s\d\d?\:\d\d',dic2[d-1][3]))==1 and len(re.findall('\d\d?\:\d\d',dic2[d][3]))==1:
                    pass
                else:
                    print('post-post_three33',dic2[d-1],'---',dic2[d])
                    new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                    dic1[lq-1]=new_l
                    continue

            if f>2 and (len(re.findall('\d{5}',dic2[d-1][0]))==1 and len(dic2[d][0].strip())==0) and ((len(re.findall('\d\s?\.\s?\d',dic2[d][8]))>=1 and len(re.findall('\d\s?\.\s?\d',dic2[d][6]))==0) and (len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][6]))>=1) or (len(re.findall('\d\s?\.\s?\d',dic2[d][8]))==0 and len(re.findall('\d\s?\.\s?\d',dic2[d][6]))>=1) and (len(re.findall('\d\s?\.\s?\d|\d\s?\.\s?D',dic2[d-1][8]))>=1 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][6]))==0)) and ((len(dic2[d][1].strip())==0 or len(dic2[d-1][1].strip())==0) or (len(re.findall('\d{2}\/\d{2}\/\d{4}',dic2[d-1][3]))==1 or len(re.findall('\d{2}\/\d{2}\/\d{4}',dic2[d][3]))==1)) and dic2[d].count(' ')>=5 and ss.join(dic2[d]).__contains__('Dept ')==False:
                print('post-post_three_dot',dic2[d-1],'---',dic2[d])
                # (len(re.findall('\d{2}\/\d{2}\/\d{4}',dic2[d-1][3]))==1 and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic2[d][3]))==1))
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue

            if f>2 and (len(re.findall('\d{5}',dic2[d-1][0]))==1 and len(dic2[d][0].strip())==0) and ((len(re.findall('\d\s?\.\s?\d',dic2[d][8]))>=1 and len(re.findall('\d\s?\.\s?\d',dic2[d][6]))==0) and (len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][6]))>=1) or (len(re.findall('\d\s?\.\s?\d',dic2[d][8]))==0 and len(re.findall('\d\s?\.\s?\d',dic2[d][6]))>=1) and (len(re.findall('\d\s?\.\s?\d|\d\s?\.\s?D',dic2[d-1][8]))>=1 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][6]))==0)) and ((len(dic2[d][1].strip())==0 or len(dic2[d-1][1].strip())==0) or (len(re.findall('\d{2}\/\d{2}\/\d{4}',dic2[d-1][3]))==1 or len(re.findall('\d{2}\/\d{2}\/\d{4}',dic2[d][3]))==1)) and dic2[d].count(' ')>=5 and ss.join(dic2[d]).__contains__('Dept ')==False:
                print('post-post_three_dot',dic2[d-1],'---',dic2[d])
                # (len(re.findall('\d{2}\/\d{2}\/\d{4}',dic2[d-1][3]))==1 and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic2[d][3]))==1))
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue
            if f>2 and dic2[d][2:].count(' ')==7 and len(re.findall('\d{5}',dic2[d][0]))>=1 and len(dic2[d][1])>10 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][6]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==1:
                print('post-post_fouur_dot',dic2[d-1],'---',dic2[d])
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue
            if f>2 and len(dic2[d][8].strip())==0 and len(dic2[d][0].strip())>1 and len(dic2[d][3].strip())>1 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==1 and (dic2[d-1][1] in sub_head) and dic2[d-1].count(' ')==7 and dic2[d].count(' ')<7:
                print('post-post_three11',dic2[d-1],'---',dic2[d])
                line_last=copy.deepcopy(dic2[d-1])
                lnl_e=line_last[-1]
                line_last.pop(-1)
                line_last.append(' ')
                dic1[lq-1]=line_last
                dic2[d].pop(-1)
                dic2[d].append(lnl_e)
                print('post-post_three_linelast',line_last,'---',dic2[d])
            dic1[lq]=dic2[d]
            lq +=1
        dicA=dic1

        dic2=dicA
        dic1={}
        lq=1
        f=1
        my_lines=['Medical Records','CONSULTATION']
        for d in dic2:
            f += 1
            ss=''
            if f>2 and dic2[d][1] in my_lines and (len(re.findall('\d{4}',dic2[d-1][0]))==1 and len(dic2[d][0].strip())==0) and (len(re.findall('\d{2}\/\d{2}\/\d{4}',dic2[d-1][3]))==1 or len(re.findall('\d{2}\/\d{2}\/\d{4}',dic2[d][3]))==1) and ((len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==1 or len(re.findall('\d\s?\.\s?\d',dic2[d-1][6]))==1) and (len(re.findall('\d\s?\.\s?\d',dic2[d][8]))==1 or len(re.findall('\d\s?\.\s?\d',dic2[d][6]))==1)):
                print('post-post_four',dic2[d-1],'---',dic2[d])
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue

            if f>2 and dic2[d][1] in my_lines and (len(re.findall('\d{4}',dic2[d-1][0]))==1 and len(dic2[d][0].strip())==0) and (len(re.findall('\d{2}\/\d{2}\/\d{4}',dic2[d-1][3]))==1 and len(re.findall('\d{2}\:\d{2}',dic2[d][3]))==1) and (len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][6]))==1) and (len(dic2[d][6].strip())==0 and len(dic2[d][8].strip())==0):
                print('post-post_five',dic2[d-1],'---',dic2[d])
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue

            if f>2 and (len(re.findall('PMIS',dic2[d][1]))==1 and len(dic2[d][1].strip())>=5) and (len(re.findall('\d{4}',dic2[d-1][0]))==1 and len(dic2[d][0].strip())==0) and (len(re.findall('\d{2}\s?\/\s?\d{2}\s?\/\s?\d{4}',dic2[d-1][3]))==1 or len(re.findall('\d{2}\s?\/\s?\d{2}\s?\/\s?\d{4}',dic2[d][3]))==1) and ((len(re.findall('\d\s?\.\s?\d|\d{2}\s\d{2}',dic2[d-1][8]))==1 and len(re.findall('\d\s?\.\s?\d|\d{2}\s\d{2}',dic2[d-1][6]))==1 and len(re.findall('\d\s?\.\s?\d|\d{2}\s\d{2}',dic2[d][8]))==0 and len(re.findall('\d\s?\.\s?\d|\d{2}\s\d{2}',dic2[d][6]))==0) or (len(re.findall('\d\s?\.\s?\d|\d{2}\s\d{2}',dic2[d][8]))==1 and len(re.findall('\d\s?\.\s?\d|\d{2}\s\d{2}',dic2[d][6]))==1) and len(re.findall('\d\s?\.\s?\d|\d{2}\s\d{2}',dic2[d-1][6]))==0 and len(re.findall('\d\s?\.\s?\d|\d{2}\s\d{2}',dic2[d-1][8]))==0):
                print('post-post_five55',dic2[d-1],'---',dic2[d])
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue
            dic1[lq]=dic2[d]
            lq +=1
        dicA=dic1

        dic2=dicA
        dic1={}
        lq=1
        f=0
        fn=len(dic2)
        for d in dic2:
            f += 1
            ss=''

            if f>3 and f<fn and len(re.findall('\d{2}\/\d{2}\/\d{4}\s\d{2}',dic2[d][3]))==1 and len(re.findall('\d{2}\/\d{2}\/\d{4}\s\d{2}',dic2[d-1][3]))==1 and len(re.findall('\d{2}\/\d{2}\/\d{4}\s\d{2}',dic2[d-2][3]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d][8]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d-2][8]))==1 and len(re.findall('\d\s?\.\s?\d\d',dic2[d-1][6]))==2 and len(re.findall('\d\s?\.\s?\d',dic2[d-2][6]))==1 and len(dic2[d][6].strip())==0:
                print('yyyyyyyyyy',dic2[d],dic2[d-1],dic2[d-2])
                if len(dic2[d-1][6].split())==2:
                    el6_a,el6_b=dic2[d-1][6].split()
                    dic2[d-1].pop(6)
                    dic2[d-1].insert(6,el6_a)
                    dic1[lq-1] = dic2[d-1]
                    dic2[d].pop(6)
                    dic2[d].insert(6,el6_b)
            # if f>2 and len(dic2[d][3].strip())==0 and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic2[d-1][3]))==1 and len(dic2[d][6].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][6]))==1 and len(dic2[d-1][8].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d][8]))==1 and ss.join(dic2[d]).__contains__('Total')==False and len(dic2[d-1][0].strip())==0 and len(re.findall('\d{3}',dic2[d][0]))==1:
            #     print('pst-pst_5five',dic2[d-1],'---',dic2[d])
            #     new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
            #     dic1[lq-1]=new_l
            #     continue
            if f>2 and len(dic2[d-1][3].strip())==0 and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic2[d][3]))==1 and len(dic2[d-1][6].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d][6]))==1 and len(dic2[d][8].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==1 and ss.join(dic2[d-1]).__contains__('Total')==False and len(dic2[d][0].strip())==0 and len(re.findall('\d{3}',dic2[d-1][0]))==1:
                print('pst-pst_4four',dic2[d-1],'---',dic2[d])
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue
            if f>4 and f+1<fn and (dic2[d][:2].count(' ')==2 and dic2[d][-2:].count(' ')==0) and (dic2[d-1][:2].count(' ')==0 and dic2[d-1][-2:].count(' ')==0) and (dic2[d-2][:2].count(' ')==0 and dic2[d-2][-2:].count(' ')==2) and (dic2[d+1][:2].count(' ')==0 and dic2[d+1][-2:].count(' ')==0) and ss.join(dic2[d-1]).__contains__('ROOM RENT') and ss.join(dic2[d-2]).__contains__('ROOM RENT') and ss.join(dic2[d+1]).__contains__('ROOM RENT'):
                print('ttt00tt**010101tt',dic2[d],dic2[d-1],dic2[d-2],dic2[d+1])
                lt1,lt2=dic2[d-2][:5],dic2[d-2][-4:]
                lo1,lo2=dic2[d-1][:5],dic2[d-1][-4:]
                nw1,nw2=dic2[d][:5],dic2[d][-4:]
                dic1[lq-2]=lt1+lo2
                dic1[lq-1]=lo1+nw2
                continue
            if f>2 and f<fn and len(re.findall('\d\d?\/\d{2}\/\d{4}',dic2[d-1][3]))==1 and 8<len(dic2[d-1][3])<12 and len(re.findall('\d\d?\:\d{2}',dic2[d][3]))==1 and 3<len(dic2[d][3])<6 and len(dic2[d][6].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][6]))==1 and len(dic2[d-1][8].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d][8]))==1:
                print('pst-pst_4four44',dic2[d-1],'---',dic2[d])
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue

            if f>3 and f<fn and len(re.findall('\d{2}\/\d{2}\/\d{4}\s\d{2}',dic2[d][3]))==1 and len(re.findall('\d{2}\/\d{2}\/\d{4}\s\d{2}',dic2[d-2][3]))==1 and len(dic2[d-1][3].strip())==0 and len(dic2[d][8].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==1 and len(dic2[d][6].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][6]))==1 and len(dic2[d-1][0].strip())==0 and len(re.findall('\d{3,5}',dic2[d][0]))==1:
                print('yuyuyuyiiii',dic2[d],dic2[d-1],len(dic2[d-1][8].strip()),len(re.findall('\d\s?\.\s?\d',dic2[d][8])),len(dic2[d-1][6].strip()),len(re.findall('\d\s?\.\s?\d',dic2[d][6])))
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue
            dic1[lq]=dic2[d]
            lq +=1
        dicA=dic1

        dic2=dicA
        dic1={}
        lq=1
        f=0
        fn=len(dic2)
        for d in dic2:
            f += 1
            ss=''

            if f>2 and len(dic2[d][3].strip())==0 and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic2[d-1][3]))==1 and len(dic2[d][6].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][6]))==1 and len(dic2[d-1][8].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d][8]))==1 and ss.join(dic2[d]).__contains__('Total')==False and len(dic2[d-1][0].strip())==0 and len(re.findall('\d{3}',dic2[d][0]))==1:
                print('pst-pst_5five',dic2[d-1],'---',dic2[d])
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue

            dic1[lq]=dic2[d]
            lq +=1
        dicA=dic1


        dic2=dicA
        dic1={}
        lq=1
        f=0
        fn=len(dic2)
        for d in dic2:
            f += 1
            ss=''
            if f>3 and ss.join(dic2[d-1]).__contains__('Dept Total') and len(re.findall('\d{2}\-[A-Z][a-z]{2}\-\d{4}',dic2[d][0]))==1 and dic2[d].count(' ')==8:
               dic1[lq]=['HEADING',' ',' ',' ',' ',' ',' ',' ',' ']
               lq +=1
               print('lqqqqqqq',dic2[d-1],dic2[d])

            if f>3 and f<fn and len(re.findall('\d{2}\/\d{2}\/\d{4}\s\d{2}\:\d{2}',dic2[d][3]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d][8]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d][6]))==1 and len(dic2[d][0].strip())==0 and len(re.findall('\d{4}',dic2[d-1][0]))==1 and dic2[d-1][2:].count(' ')==7:
                print('ioooooo',dic2[d-1],dic2[d])
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue
            if f>3 and f<fn and len(re.findall('\d{2}\/\d{2}\/\d{4}\s\d\d?\:\d\d?',dic2[d][3]))==1 and len(re.findall('\d{2}\/\d{2}\/\d{4}\s\d\d?\:\d\d?',dic2[d-1][3]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][6]))==2 and len(dic2[d][6].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-2][6]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d+1][6]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d][8]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==1 and len(dic2[d][0])>=3 and len(dic2[d-1][0])>=3:
                print('tyyyyyy',dic2[d-1],dic2[d])
                if len(dic2[d-1][6].split())==2:
                    lsix,nsix=dic2[d-1][6].split()
                    lstsix=copy.deepcopy(dic2[d-1])
                    lstsix.pop(6)
                    lstsix.insert(6,lsix)
                    dic1[lq-1]=lstsix
                    dic2[d].pop(6)
                    dic2[d].insert(6,nsix)
            if f>2 and f<fn and len(re.findall('\d{2}\/\d{2}\/\d{4}\s\d\d?\:\d\d?',dic2[d][3]))==1 and len(dic2[d-1][3].strip())==0 and len(re.findall('\d{2}\/\d{2}\/\d{4}\s\d\d?\:\d\d?',dic2[d+1][3]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][6]))==1 and len(dic2[d][6].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==1 and len(dic2[d][8].strip())==0 and len(re.findall('\d{3}',dic2[d-1][0]))>=1 and len(re.findall('\d\s?\.\s?\d',dic2[d+1][8]))==1 and len(dic2[d][0].strip())==0:
                print('tyyyyyyqqq',dic2[d-1],dic2[d])
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue
            if f>2 and f<fn and len(re.findall('\d{2}\/\d{2}\/\d{4}\s\d\d?\:\d\d?',dic2[d][3]))==1 and len(dic2[d-1][3].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][6]))==1 and len(dic2[d][6].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==1 and len(dic2[d][8].strip())==0 and len(re.findall('\d{3}',dic2[d-1][0]))>=1 and len(dic2[d][0].strip())==0 and ss.join(dic2[d+1]).__contains__('Dept Sub Total')==True:
                print('tyyyyyyqqq11',dic2[d-1],dic2[d])
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue
            if f>3 and f<fn and len(re.findall('\d\s?\.\s?\d',dic2[d][6]))==1 and len(dic2[d-1][6].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==1 and len(dic2[d][8].strip())==0 and len(re.findall('\d{3}',dic2[d][0]))>=1 and len(dic2[d-1][0].strip())==0 and dic2[d-2][1] in ['Nursing'] and dic2[d-2].count(' ')==8:
                print('tyyyyyyqqq22',dic2[d-1],dic2[d])
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue
            if f>3 and f<fn and ss.join(dic2[d]).__contains__('Dept Sub Total')==True and dic2[d].count(' ')==8 and len(re.findall('\d{4}',dic2[d-2][0]))>=1 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d-2][8]))==1 and len(re.findall('\d\d?\/\d{2}\/\d{4}\s\d\d?\:\d\d?',dic2[d-2][3]))==1 and len(dic2[d-1][0].strip())==0 and len(dic2[d-1][3].strip())==0:
                print('tyyyyyyqqq33',dic2[d-1],dic2[d])
                ltt1=copy.deepcopy(dic2[d-1])
                ltt1_item=ltt1[8]
                ltt1.pop(8)
                ltt1.insert(8,' ')
                new_l=copy.deepcopy(opr1(dic2[d-2],ltt1,src_dc))
                dic1[lq-2]=new_l
                ltt2=copy.deepcopy(dic2[d])
                ltt2.pop(8)
                ltt2.insert(8,ltt1_item)
                dic1[lq-1]=ltt2
                continue

            if f>3 and f<fn and len(re.findall('\d\s?\.\s?\d',dic2[d-1][6]))==1 and len(dic2[d][6].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==1 and len(dic2[d][8].strip())==0 and len(re.findall('\d\d?\/\d{2}\/\d{4}\s\d\d?\:\d\d?',dic2[d-2][3]))==1 and len(re.findall('\d\d?\/\d{2}\/\d{4}',dic2[d-1][3]))==1 and 8<len(dic2[d-1][3])<12 and len(re.findall('\d\d?\:\d\d?',dic2[d][3]))==1 and 3<len(dic2[d][3])<6:
                print('tyyyyyyqqq2233',dic2[d-1],dic2[d])
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue
            if f>3 and f<fn and len(re.findall('\d\s?\.\s?\d',dic2[d-1][6]))==1 and len(dic2[d][6].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d][8]))==1 and len(dic2[d-1][8].strip())==0 and len(re.findall('\d\d?\/\d{2}\/\d{4}',dic2[d-1][3]))==1 and 8<len(dic2[d-1][3])<12 and len(re.findall('\d\d?\:\d\d?',dic2[d][3]))==1 and 3<len(dic2[d][3])<6 and len(re.findall('\d\d?\/\d{2}\/\d{4}\s\d\d?\:\d\d?',dic2[d+1][3]))==1 and len(re.findall('\d\d?\/\d{2}\/\d{4}\s\d\d?\:\d\d?',dic2[d-2][3]))==1:
                print('tyyyyyyqqq223344',dic2[d-1],dic2[d])
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue
            if f>2 and f<fn and len(re.findall('\d\d?\/\d{2}\/\d{4}\s\d\d?\:\d\d?',dic2[d][3]))==1 and len(dic2[d][8].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==1 and dic2[d-1].count(' ')==8:
                print('tyyyyyyqqq22334455',dic2[d-1],dic2[d])
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue
            if f>3 and f<fn and ss.join(dic2[d]).__contains__('RANDOM BLOOD') and len(re.findall('\d\d?\/\d{2}\/\d{4}\s\d\d?\:\d\d?',dic2[d][3]))==1 and len(dic2[d][8].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d-2][8]))==1 and 3<len(dic2[d-1][3])<6 and len(re.findall('\d\d?\:\d?\d',dic2[d-1][3]))==1 and 8<len(dic2[d-2][3])<12 and len(re.findall('\d\d?\/\d{2}\/\d{4}',dic2[d-2][3]))==1:
                print('gtttttt',dic2[d])
                fwl=copy.deepcopy(dic2[d-1][8])
                flp2=copy.deepcopy(dic2[d-2])
                flp1=copy.deepcopy(dic2[d-1])
                flp0=copy.deepcopy(dic2[d])
                flp0.pop(8)
                flp0.insert(8,fwl)
                flp1.pop(8)
                flp1.insert(8,' ')
                new_l=copy.deepcopy(opr1(flp2,flp1,src_dc))
                dic1[lq-2]=new_l
                dic1[lq-1]=flp0
                continue
            if f>2 and f<fn and len(re.findall('\d{4}',dic2[d][0]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d][6]))==1 and dic2[d][7:].count(' ')==2 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==1 and len(dic2[d-1][6].strip())==0 and dic2[d-1][1] in sub_head and dic2[d-1].count(' ')>=6:
                print('gtttttthh',dic2[d])
                flp1=copy.deepcopy(dic2[d-1])
                flsv=flp1[7]
                flet=flp1[8]
                flp0=copy.deepcopy(dic2[d])
                flp1=flp1[:7]+[' ',' ']
                flp0=flp0[:7]+[flsv,flet]
                dic1[lq-1]=flp1
                dic1[lq]=flp0
                lq +=1
                continue
            if f>2 and f<fn and 3<len(dic2[d][3])<6 and len(re.findall('\d\d?\:\d\d?',dic2[d][3]))==1 and 8<len(dic2[d-1][3])<12 and len(re.findall('\d\d?\/\d{2}\/\d{4}',dic2[d-1][3]))==1 and len(dic2[d][6].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][6]))==1 and len(dic2[d][8].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==1:
                print('tyyyyyyqqq33333',dic2[d-1],dic2[d])
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue
            if f>3 and f<fn and len(re.findall('\d\/\d{2}\/\d{3}\d?\s\d\d?\:\d\d?',dic2[d][3]))==1 and len(dic2[d-1][0].strip())==0 and len(re.findall('\d{3}',dic2[d][0]))>=1 and len(re.findall('\d\/\d{2}\/\d{3}\d?\s\d\d?\:\d\d?',dic2[d-2][3]))==1 and len(re.findall('\d\/\d{2}\/\d{3}\d?\s\d\d?\:\d\d?',dic2[d+1][3]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][6]))==1 and len(dic2[d][6].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==1 and len(dic2[d][8].strip())==0:
                print('tyyyyyyqqq333334444',dic2[d-1],dic2[d])
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue

            if f>2 and f<fn and len(re.findall('\d\/\d{2}\/\d{3}\d?\s\d\d?\:\d\d?',dic2[d][3]))==1 and len(dic2[d-1][8].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d][8]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][6]))==1 and len(dic2[d][6].strip())==0 and dic2[d-1][1] in sub_head:
                print('gtttttthheee',dic2[d-1],dic2[d])
                flp11=copy.deepcopy(dic2[d-1])
                flp01=copy.deepcopy(dic2[d])
                flsx=flp11[6]
                flsv=flp11[7]
                flet=flp01[8]

                flp11=flp11[:6]+[' ',' ',' ']
                flp01=flp01[:6]+[flsx,flsv,flet]
                dic1[lq-1]=flp11
                dic1[lq]=flp01
                lq +=1
                print(flp11,flp01,'uuuuuuu')
                continue

            if f>2 and f<fn and len(re.findall('\d\/\d{2}\/\d{3}\d?\s\d\d?\:\d\d?',dic2[d][3]))==1 and len(dic2[d][8].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d][6]))==1 and len(dic2[d-1][6].strip())==0 and dic2[d-1][1] in sub_head:
                print('gtttttthheee',dic2[d-1],dic2[d])
                flp11=copy.deepcopy(dic2[d-1])
                flp01=copy.deepcopy(dic2[d])
                flsx=flp11[6]
                flsv=flp11[7]
                flet=flp01[8]

                flp11=flp11[:6]+[' ',' ',' ']
                flp01=flp01[:6]+[flsx,flsv,flet]
                dic1[lq-1]=flp11
                dic1[lq]=flp01
                lq +=1
                print(flp11,flp01,'uuuuuuu_iiii')
                continue
            if f>2 and f<fn and len(re.findall('\d\/\d{2}\/\d{3}\d?\s\d\d?\:\d\d?',dic2[d][3]))==1 and len(dic2[d][8].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][6]))==1 and len(dic2[d][6].strip())==0 and dic2[d-1][1] in sub_head:
                print('gtttttthheee111',dic2[d-1],dic2[d])
                flp11=copy.deepcopy(dic2[d-1])
                flp01=copy.deepcopy(dic2[d])
                flsx1=flp11[6:]

                flp11=flp11[:6]+[' ',' ',' ']
                flp01=flp01[:6]+flsx1
                dic1[lq-1]=flp11
                dic1[lq]=flp01
                lq +=1
                print(flp11,flp01,'uuuuuuu')
                continue

            if f>2 and f<fn and len(re.findall('\d\/\d{2}\/\d{3}\d?\s\d\d?\:\d\d?',dic2[d][3]))==1 and len(dic2[d-1][8].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d][8]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][6]))==1 and len(dic2[d][6].strip())==0 and (dic2[d-1][1] in ['LIVER KIDNEY BASIC'] or (len(dic2[d][0].strip())==0 and len(re.findall('\d{3}',dic2[d-1][0]))>=1)):
                print('gtttttthheeett',dic2[d-1],dic2[d])
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue

            dic1[lq]=dic2[d]
            lq +=1
        dicA=dic1

        dic2=dicA
        dic1={}
        lq=1
        f=0
        fn=len(dic2)
        for d in dic2:
            f += 1
            ss=''
            # print('kkkkkk',dic2[d])
            if f>3 and f<fn and len(re.findall('\d\/\d{2}\/\d{3}\d?\s\d\d?\:\d\d?',dic2[d][3]))==1 and len(dic2[d][0].strip())==0 and len(re.findall('\d{3}',dic2[d-1][0]))>=1 and dic2[d-2][1] in sub_head and ss.join(dic2[d+1]).__contains__('Dept Sub Total')==True and len(re.findall('\d\s?\.\s?\d',dic2[d-1][6]))==1 and len(dic2[d][6].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==1 and len(dic2[d][8].strip())==0:
                print('tyyyyyyqqq3333344445555',dic2[d-1],dic2[d])
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue
            if f>3 and f<fn and len(re.findall('\d\/\d{2}\/\d{3}\d?\s\d\d?\:\d\d?',dic2[d][3]))==1 and dic2[d-2][1] in sub_head and ss.join(dic2[d+1]).__contains__('Dept Sub Total')==True and len(re.findall('\d\s?\.\s?\d',dic2[d][6]))==1 and len(dic2[d-1][6].strip())==0 and len(re.findall('\d\s?\.\s?\d',dic2[d-1][8]))==1 and len(dic2[d][8].strip())==0:
                print('tyyyyyyqqq3333344445555uuuu',dic2[d-1],dic2[d])
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue
            if f>2 and f<fn and len(re.findall('\d{2}\/\d{2}\/\d{4}',dic2[d-1][2]))==1 and len(dic2[d-1][2])==10 and len(re.findall('\d{2}\s\d{2}',dic2[d][2]))==1 and len(dic2[d][2])==5 and len(re.findall('\d{2}\s\d{2}$',dic2[d-1][5]))==1 and len(dic2[d][5].strip())==0 and len(re.findall('\d{2}\s\d{2}$',dic2[d-1][8]))==1 and len(dic2[d][8].strip())==0:

                print('tyyyyyyqqq3333344445555uuuukkkk',dic2[d-1],dic2[d])
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue

            dic1[lq]=dic2[d]
            lq +=1
        dicA=dic1

        dic2=dicA
        dic1={}
        lq=1
        f=0
        fn=len(dic2)
        for d in dic2:
            f += 1
            ss=''
            if f>2 and f+1<fn and len(re.findall('\d{2}\/\d{2}\/\d{4}\s\d{2}\s\d{2}|\d{2}\/\d{2}\/\d{4}\s\d{2}\:\d{2}',dic2[d-1][2]))==1 and ss.join(dic2[d+1]).__contains__('Dept ') and len(re.findall('[A-Z]{2}\s\d{3,6}\s[A-Z]|[A-Z]{4}\d{4,8}',dic2[d][0])) and dic2[d].count(' ')==8:
                print('tyyyyyyqqq3322kkkk',dic2[d-1],dic2[d])
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue
            if f>2 and dic2[d][1]=='PLASMA' and dic2[d-1][1]=='GRBS (GRBS RANDOM BLOOD SUGAR) POTASSIUM - SERUM /':
                newy = copy.deepcopy(dic2[d-1])

                newy.pop(1)
                newy.insert(1,'GRBS (GRBS RANDOM BLOOD SUGAR)')
                dic1[lq-1]=newy
                dic2[d].pop(1)
                dic2[d].insert(1,'POTASSIUM - SERUM / PLASMA')
            dic1[lq]=dic2[d]
            lq +=1
        dicA=dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if d>1 and d<len(dic2) and dic2[d][1].__contains__('Nursing') and dic2[d].count(' ')<=5 and dic2[d+1][1]!= ' ' and dic2[d+1].count(' ')>=7:
                print('for Nurisng charges if lines divided')
                dic2[d][1] = dic2[d][1]+dic2[d+1][1]
                dic2[d+1][1] = ' '
            if d == len(dic2) and 'Dept Total' not in dic2[d][6] and 'Dept Total' not in dic2[d - 1][6]:
                print('if Dept total is absent in 6th inddex')
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', ' ', ' ', ' ', 'Dept Total :', ' ', ' ']
            if d > 1 and d != len(dic2) and (
                    dic2[d][2].__contains__('Discount/Markup') or dic2[d][3].__contains__('Discount/Markup')) and \
                    dic2[d - 1][6].__contains__('Dept T') and dic2[d + 1][6].__contains__('Dept T'):
                print('if discount/markup is present')
                dic2[d][2] = ' '
                dic2[d][3] = ' '
                dic2[d][8] = ' '
                dic2[d + 1][6] = ' '
                dic2[d + 1][8] = ' '
            if d > 1 and dic2[d][0].__contains__('Room Rent') and 'Dept Total' not in dic2[d - 1][
                6] and 'Dept Total' not in dic2[d - 2][6]:
                print('if dept total not prsent before room rent')
                listnw = [' ', ' ', ' ', ' ', ' ', ' ', 'Dept Total :', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d > 1 and 'Dept Total' in dic2[d][6] and 'Dept Total' in dic2[d - 1][6]:
                print('if two total are there line by line')
                dic2[d][6] = ' '
                dic2[d][8] = ' '
            if d > 1 and dic2[d][0].__contains__('ROOM RENT') and dic2[d][8] == ' ':
                print('for room rent in 0th indx')
                dic2[d][1] = dic2[d][0]
                dic2[d][0] = ' '
                dic2[d][8] = dic2[d][6]
                dic2[d][6] = ' '
            if d > 1 and dic2[d][0].__contains__('ROOM RENT'):
                print('for room rent in 0th indx')
                dic2[d][1] = dic2[d][0]
                dic2[d][0] = ' '
            if d > 1 and d < len(dic2) and (dic2[d][1].__contains__('ROOM RENT') or dic2[d][1].__contains__('RENT')) and \
                    dic2[d][8] == ' ' and dic2[d + 1][1].__contains__('Service'):
                print('for room rent in 1st indx')
                dic2[d][8] = dic2[d][6]
                dic2[d][6] = ' '
            if dic2[d][1].__contains__('Service Amount') or dic2[d][1].__contains__('Additional Disc') or dic2[d][
                1].__contains__('After Disc'):
                print('removing roorent lines')
                dic2[d][0] = dic2[d][1]
                dic2[d][1] = ' '
            if dic2[d][0].__contains__('CGST') and dic2[d].count(' ') >= 6:
                dic2[d][1] = dic2[d][0]
            if dic2[d][0].__contains__('SGST') and dic2[d].count(' ') >= 6:
                dic2[d][1] = dic2[d][0]
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['SEVORANE 250 ML(HSN:20400001) (PMINO16327658)']
        correct_map_known_items = {
            'SEVORANE 250 ML(HSN:20400001) (PMINO16327658)': [['34 87', '1,046.', '10'], ['34.87', ' ', '1,046.10']],
        }
        for d in dic2:
            print('mddd==', dic2[d])
            try:
                if dic2[d][1].strip(' -,.') in known_items:
                    print('fff', dic2[d][6:])
                    if dic2[d][1].strip(' -,.') in correct_map_known_items and dic2[d][6:] == \
                            correct_map_known_items[dic2[d][1].strip(' -,.')][0]:
                        print('itemssss11', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:6] + correct_map_known_items[neww[1].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

    if hospital == 'asian':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('mdd==', dic2[d])
            if dic2[d][5] != ' ' and len(dic2[d][5].split()) >= 2 and dic2[d][6] == ' ' and 'Total' not in dic2[d][5]:
                print('if mglindedic QTy and rate together in 5th indx and 6th indx empty')
                text = dic2[d][5].split()
                dic2[d][5] = text[0]
                dic2[d][6] = text[1]
            if dic2[d][6] != ' ' and len(dic2[d][6].split()) >= 2 and dic2[d][5] == ' ' and 'Total' not in dic2[d][6]:
                print('if mglindedic QTy and rate together in 6th indx and 5th indx empty')
                text = dic2[d][6].split()
                dic2[d][5] = text[0]
                dic2[d][6] = text[1]
            if d > 2 and dic2[d][0] in head_list and 'Total' not in dic2[d - 1][6] and 'Total' not in dic2[d - 1][
                7] and 'Total' not in dic2[d - 1][5]:
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', ' ', ' ', ' ', ' ', ' ', 'Total', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

    if hospital == 'medanta' or hospital == 'medanta-lucknow':
        print('mmmmmmmmmmmmm')
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if f > 2 and f < fn and dic2[d][0] == 'Charges(Subtotal)' and dic2[d].count(' ') == 5 and dic2[d - 1][
                0] == 'Specialized Medical Consumable' and len(re.findall('\d\s?\.\s?\d', dic2[d - 1][4])) == 1 and len(
                    re.findall('\d\s?\.\s?\d', dic2[d - 1][5])) == 1 and dic2[d - 1].count(' ') == 3:
                print('orrrrrrrr111', dic2[d])
                last_e = dic2[d - 1][0] + ' ' + dic2[d][0]
                last_l = copy.deepcopy(dic2[d - 1])
                last_l.pop(0)
                last_l.insert(0, last_e)
                dic1[lq - 1] = last_l
                this_l = copy.deepcopy(dic2[d])
                this_l.pop(0)
                this_l.insert(0, ' ')
                continue
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if dic2[d][5].__contains__('|'):
                dic2[d][5] = dic2[d][5].replace('|','')
            if dic2[d][0].__contains__('Packages(Subtotal)'):
                print('pcksubt with some parcticular')
                dic2[d][0] = 'Packages(Subtotal)'
            if dic2[d][0].__contains__('(Subtotal') and '(Subtotal)' not in dic2[d][0]:
                print('(subbbbbb')
                dic2[d][0] = dic2[d][0].replace('(Subtotal', '(Subtotal)')
            if dic2[d][0].__contains__('Subtotal)') and '(Subtotal)' not in dic2[d][0]:
                print('subbbbbb)')
                dic2[d][0] = dic2[d][0].replace('Subtotal)', '(Subtotal)')
            if d > 1 and d != len(dic2) and dic2[d][0] == dic2[d - 1][0] and dic2[d - 1][0] in head_list:
                print('if sub header and header are same')
                dic2[d][0] = dic2[d][0] + 's'
                sub_head.append(dic2[d][0] + 's')
            if d > 1 and dic2[d][0].__contains__('Nursing Charges') and dic2[d - 1][0].__contains__('Other Charges'):
                print('if others charges is header and nursing charges is sub header')
                dic2[d - 1][0] = 'OTHER CHARGES'
            if d > 1 and dic2[d - 1][0].__contains__('Nursing Charges(Sub') and dic2[d][0].__contains__(
                    'Other Charges(Sub'):
                print('for  others charges and nursing charges subtotal')
                dic2[d][0] = 'OTHER CHARGES(Subtotal)'
            if d > 1 and d < len(dic2) and dic2[d][0] == 'Room Charges(Subtotal)' and dic2[d + 1][
                0] == 'Nursing Charges':
                dic2[d][0] = 'Room Chargess(Subtotal)'
            if d > 1 and d != len(dic2) and dic2[d][0] == 'Treatment(Subtotal)' and dic2[d - 1][
                0] == 'PH & CON used as part of':
                dic2[d - 1][0] = dic2[d - 1][0] + ' ' + dic2[d][0]
            if d>1 and d<len(dic2) and (dic2[d][0] == 'Charges(Subtotal' or dic2[d][0] == 'Charges(Subtotal)' or dic2[d][0] == 'Charges(Subtotal),') and dic2[d].count(' ')==5 and dic2[d-1].count(' ')==3:
                print('for merging  Specialized Medical Consumable charges subtotal')
                dic2[d][0] = 'Charges(Subtotal)'
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ', ' ']
            if len(re.findall('\d+\/\d+\/\d+', dic2[d][0])) == 1:
                print('if date in 0th index')
                text = dic2[d][0]
                matchdate = re.search(r'\d+\/\d+\/\d+', text)
                dic2[d][1] = matchdate.group()
                dic2[d][0] = dic2[d][0].replace(matchdate.group(), '')

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital=='medanta_daycare':
        print('mmmmmmmmmmmmm')
        dic2=dicA
        dic1={}
        lq=1
        for d in dic2:
            print('mddd==',dic2[d])
            if d>1 and dic2[d][0] in head_list and dic2[d-1][0] in head_list:
                dic2[d][0] = dic2[d][0]+'s'
            if d>1 and dic2[d][0] in head_list and dic2[d-1][1]!='Total':
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq+=1
                dic1[lq-1] = [' ', 'Total', ' ', ' ', ' ', ' ']


            dic1[lq]=dic2[d]
            lq +=1
        dicA=dic1
    if hospital == 'medanta_daycare1':
        print('mmmmmmmmmmmmm')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if dic2[d][3].__contains__('Total'):
                dic2[d][3] = 'TOTAL'
            if d == len(dic2) and dic2[d][3] != 'TOTAL' and dic2[d - 1][3] != 'TOTAL':
                listnw = [' ', ' ', ' ', 'TOTAL', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
            if d == 1 and dic2[d][0] != 'Head':
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = ['Head', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

    if hospital == 'artemis':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            print('ddddmmm===', dic2[d])
            if d > 1 and dic2[d][0].__contains__('Subtotal'):
                print('to remove subtotal values')
                dic2[d][3] = ' '
                dic2[d][4] = ' '
                dic2[d][5] = ' '
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'artemis_daycare':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if d>1 and dic2[d][0] in head_list and dic2[d-1][1]!='Subtotal' and dic2[d][0]!=dic2[d-1][0]:
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq+=1
                dic1[lq-1] = listnw
            if d==len(dic2) and dic2[d][1]!='Subtotal' and dic2[d-1][1]!='Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq+1] = listnw



            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'artemis_daycare1':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if d>1 and dic2[d][0] in head_list and dic2[d-1][1]!='Subtotal' and dic2[d][0]!=dic2[d-1][0]:
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq+=1
                dic1[lq-1] = listnw
            if d==len(dic2) and dic2[d][1]!='Subtotal' and dic2[d-1][1]!='Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq+1] = listnw



            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////

    if hospital == 'manipal':
        # print('mmmmmmmmmmmmm')
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('mdd==', dic2[d])
            f += 1
            ss = ''
            if dic2[d][1] == 'Calcium - Total':
                dic2[d][1] = 'Calcium'
            if f > 2 and f < fn and len(re.findall('\d\s?\.\s?\d', dic2[d][3])) == 1 and len(
                    re.findall('\d\s?\.\s?\d', dic2[d][5])) == 1 and len(dic2[d - 1][3].strip()) == 0 and len(
                dic2[d - 1][5].strip()) == 0 and len(dic2[d - 1][1].strip()) > 3 and len(dic2[d][1].strip()) == 0:
                print('orrrrrrrr111', dic2[d], dic2[d - 1])
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            if len(re.findall('^\d\s\d', dic2[d][2])) == 1 and len(dic2[d][2]) >= 5 and len(
                    dic2[d][2].split()) == 2 and len(dic2[d][3].split()) == 0:
                el2, el3 = dic2[d][2].split()
                print('oqqqqqqq111', dic2[d], dic2[d - 1])
                dic2[d].pop(2)
                dic2[d].pop(2)
                dic2[d].insert(2, el3)
                dic2[d].insert(2, el2)
            if len(re.findall('^\d\s\d', dic2[d][2])) == 1 and len(dic2[d][2]) >= 5 and len(
                    dic2[d][2].split()) > 2 and len(dic2[d][3].split()) == 0:
                el5 = dic2[d][5].replace(' ', '')
                el2, el3 = dic2[d][2].split(' ', 1)
                elm2 = copy.deepcopy(el2)
                elm3 = copy.deepcopy(el3)
                el2 = el2.replace(' ', '')
                el3 = el3.replace(' ', '')
                if el2.replace('.', '').isdigit() == True and el3.replace('.', '').isdigit() == True and el5.replace(
                        '.', '').isdigit() == True:
                    el2 = float(el2)
                    el3 = float(el3)
                    el5 = float(el5)
                    if el5 == el2 * el3:
                        print('oqqqqqqq222', dic2[d], dic2[d - 1])
                        dic2[d].pop(2)
                        dic2[d].pop(2)
                        dic2[d].insert(2, elm3)
                        dic2[d].insert(2, elm2)
            if len(dic2[d][3]) > 3 and len(dic2[d][2]) > 5 and len(re.findall('\d\s?\.\s?\d', dic2[d][2])) == 1 and len(
                    re.findall('\d\s?\.\s?\d', dic2[d][3])) == 1 and dic2[d][2].count(dic2[d][3]) == 1:
                el2 = dic2[d][2]
                el3 = dic2[d][3]
                el2 = el2.replace(el3, '').strip()
                if el2 == '':
                    el2 = ' '
                dic2[d].pop(2)
                dic2[d].pop(2)
                dic2[d].insert(2, el3)
                dic2[d].insert(2, el2)
                print('bbbbbbbb', dic2[d])

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('mdd==', dic2[d])
            f += 1
            ss = ''
            # for each section subtotal
            if dic2[d][2].__contains__('SAC') and 'SAC' not in dic2[d][1]:
                print('if sac is in 2nd indx')
                dic2[d][1] = dic2[d][1] + ' ' + dic2[d][2]
            if d > 1 and dic2[d][1].__contains__('SAC') and 'Sub Total' not in dic2[d - 1][4]:
                listnw = [' ', ' ', ' ', ' ', 'Sub Total', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d>1 and dic2[d][4].__contains__('Sub Total') and dic2[d-1][4].__contains__('Sub Total'):
                print('if two sub totals are there')
                dic2[d][4] = ' '
            if dic2[d][2] == '. 2188183807439824945 483.00':
                dic2[d][2] = '. 2188183807439824945'
                dic2[d][3] = '483.00'
            if dic2[d][2] != ' ' and len(dic2[d][2]) >= 4 and dic2[d][3] == ' ' and 'SAC' not in dic2[d][2]:
                print('if rate in Qty')
                dic2[d][3] = dic2[d][2]
                dic2[d][2] = ' '
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['SEVOFLURANE anaesthetic Inhaler 250 ML, Baxter',
                       'SUPRAVA 1 GM VIAL INJ ( CEFTRIAXONE) BIOCON Packed: 10, Returned :2 charged:',
                       'CAP HOODS # AMARLYSIS', 'MICROSHIELD 0. 58 w/V TINCTURE 500 ML',
                       'SEVOFLURANE anaesthetic Inhaler 250 ML, Baxter',
                       'ORTHOPAEDICS - CONSULTATION IP (DR. MALLINATH . G)',
                       'DURAPORE TAPE 1.25 CM X 9.1 MT (1/2"X10YD) , 3M',
                       'DURAPORE TAPE 2.5 CM X 9.1 MT (1"X10YD) , 3M',
                       "GLOVES EXAMINATION (MEDIUM) POWDER FREE MICRO THIN WHITE NITRILE (200'S) REF # 313015080, ANSELL"
                       ]
        correct_map_known_items = {
            'SEVOFLURANE anaesthetic Inhaler 250 ML, Baxter': [['04', '7683.00', ' ', '307.32'],
                                                               ['0.04', '7683.00', ' ', '307.32']],
            'SUPRAVA 1 GM VIAL INJ ( CEFTRIAXONE) BIOCON Packed: 10, Returned :2 charged:': [
                ['8', '60.33*', ' ', '482.66'], ['8', '60.33', ' ', '482.66']],
            'CAP HOODS # AMARLYSIS': [['18', '40 . 01', ' ', '320.04'], ['8', '40.01', ' ', '320.04']],
            'MICROSHIELD 0. 58 w/V TINCTURE 500 ML': [[' ', '450 . 00', ' ', '90.00'], ['0.2', '450.00', ' ', '90.00']],
            'SEVOFLURANE anaesthetic Inhaler 250 ML, Baxter': [['08', '7683.00', ' ', '614.64'],
                                                               ['0.08', '7683.00', ' ', '614.64']],
            'ORTHOPAEDICS - CONSULTATION IP (DR. MALLINATH . G)': [[' ', '1500.00', ' ', '5000.00'],
                                                                   ['4', '1500.00', ' ', '6000.00']],
            'DURAPORE TAPE 1.25 CM X 9.1 MT (1/2"X10YD) , 3M': [['3282275711159737418 255.19', ' ', ' ', '83.76'],
                                                                ['0.32822', '255.19', ' ', '83.76']],
            'DURAPORE TAPE 2.5 CM X 9.1 MT (1"X10YD) , 3M': [['. 3282275711159737418 510.41', ' ', ' ', '167.53'],
                                                             ['0.32822', '510.41', ' ', '167.53']],
            "GLOVES EXAMINATION (MEDIUM) POWDER FREE MICRO THIN WHITE NITRILE (200'S) REF # 313015080, ANSELL": [
                ['73', '17.51', ' ', '1277.91'], ['73', '17.51', ' ', '1277.91']],

        }
        for d in dic2:
            print('mmddd22==', dic2[d])
            try:
                if dic2[d][1].strip(' -,.') in known_items:
                    if dic2[d][1].strip(' -,.') in correct_map_known_items and dic2[d][2:] == \
                            correct_map_known_items[dic2[d][1].strip(' -,.')][0]:
                        print('itemsss00', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:2] + correct_map_known_items[neww[1].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

    if hospital=='fortis'  or hospital == 'fortis1':
        # print('mmmmmmmmmmmmm')
        dic2=dicA
        dic1={}
        lq=1
        f=0
        fn=len(dic2)
        for d in dic2:
            f +=1
            ss=''
            if f>2 and f<fn and dic2[d][6:].count(' ')==3 and dic2[d][:3].count(' ')==0 and dic2[d-1][:3].count(' ')==0 and dic2[d-1][6:].count(' ')==0 and len(re.findall('\d\.\d',dic2[d-1][6]))==1 and len(re.findall('\d\.\d',dic2[d-1][8]))==1:
                print('orrrrrrrr111',dic2[d],dic2[d-1])
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue
            dic1[lq]=dic2[d]
            lq +=1
        dicA=dic1

    if hospital == 'srch':
        dic1_a = dicA
        la = 1
        dicA = {}
        f = 1
        for d in dic1_a:
            print('mdd===', dic1_a[d])
            f += 1
            if d > 1 and dic1_a[d][0] in head_list and 'Subtotal' not in dic1_a[d - 1][1]:
                print('if sbt not in d-1 before headlist')
                dicA[la] = dic1_a[d]
                dicA[la - 1] = dic1_a[d - 1]
                la += 1
                dicA[la - 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            if d > 1 and len(re.findall('\d+\/\d\s?\d\/\d+', dic1_a[d][0])) == 1 and len(dic1_a[d][0].split()) <= 2 and \
                    dic1_a[d - 1][1] != 'Subtotal' and len(re.findall('\d+\/\d\s?\d\/\d+', dic1_a[d - 1][0])) == 0:
                print('adding sbt before BEDCHARGES1 FOR BOX')
                dicA[la] = dic1_a[d]
                dicA[la - 1] = dic1_a[d - 1]
                la += 1
                dicA[la - 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            dicA[la] = dic1_a[d]
            la += 1

        dic1_a = dicA
        la = 1
        dicA = {}
        f = 1
        for d in dic1_a:
            print('mdd===', dic1_a[d])
            f += 1
            if f > 1 and dic1_a[d][1] == 'Subtotal' and dic1_a[d - 1][1] == 'Subtotal':
                print('srchhhyyyy_SSSSS_aftre_merge', dic1_a[d], dic1_a[d])
                continue
            if dic1_a[d][4] != ' ' and len(re.findall('\d+\.\d+', dic1_a[d][4])) >= 1:
                print('if Any gst amount is present')
                dic1_a[d][4] = ' '
            if d > 1 and len(re.findall('\d+\/\d\s?\d\/\d+', dic1_a[d][0])) == 1 and len(dic1_a[d][0].split()) <= 2 and \
                    dic1_a[d - 1][1] == 'Subtotal':
                print('adding BEDCHARGES1 FOR BOX')
                dicA[la] = dic1_a[d]
                dicA[la - 1] = dic1_a[d - 1]
                la += 1
                dicA[la - 1] = ['ROOM CHARGES', ' ', ' ', ' ', ' ', ' ']
            dicA[la] = dic1_a[d]
            la += 1

    if hospital == 'miot':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmmdd===', dic2[d])
            if d > 2 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d - 1][1] and 'Subtotal' not in \
                    dic2[d - 2][1]:
                print('yesssssssssssss')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ', ]
            # if d==len(dic2) and dic2[d-1][4]!='Sub Total' and dic2[d-2][4]!= 'Sub Total' and dic2[d][4]!= 'Sub Total':
            #     print('commented')
            #     dic1[lq] = dic2[d]
            #     dic1[lq+1] = [' ', ' ', ' ', ' ', 'Subtotal', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

    if hospital=='aig':
        # print('mmmmmmmmmmmmm')

        dic2=dicA
        dic1={}
        lq=1
        for d in dic2:
            if dic2[d][6]==' ' and len(re.split('\.\d\d|\.CO',dic2[d][5]))==3 and re.split('\.\d\d|\.CO',dic2[d][5])[2]=='' and len(re.findall('\.\d\d|\.CO',dic2[d][5]))==2 and dic2[d][5].__contains__('Total')==False:
                print('ddddfff',dic2[d])
                fv_x=re.split('\.\d\d|\.CO',dic2[d][5])[0]+re.findall('\.\d\d|\.CO',dic2[d][5])[0]
                sx_x=re.split('\.\d\d|\.CO',dic2[d][5])[1]+re.findall('\.\d\d|\.CO',dic2[d][5])[1]
                dic2[d].pop(5)
                dic2[d].pop(5)
                dic2[d].insert(5,sx_x)
                dic2[d].insert(5,fv_x)

            # if dic2[d][6]==' ' and len(re.split('\.\d\d',dic2[d][5]))==3 and re.split('\.\d\d',dic2[d][5])[2]=='' and len(re.findall('\.\d\d',dic2[d][5]))==2 and dic2[d][5].__contains__('Total')==False:
            #     print('ddddfff',dic2[d])
            #     fv_x=re.split('\.\d\d',dic2[d][5])[0]+re.findall('\.\d\d',dic2[d][5])[0]
            #     sx_x=re.split('\.\d\d',dic2[d][5])[1]+re.findall('\.\d\d',dic2[d][5])[1]
            #     dic2[d].pop(5)
            #     dic2[d].pop(5)
            #     dic2[d].insert(5,sx_x)
            #     dic2[d].insert(5,fv_x)

            elif dic2[d][6]==' ' and len(re.findall('\d\.\d',dic2[d][5]))==2:
                print('onetwo',dic2[d])
                if len(re.findall('\s\,',dic2[d][5]))==1:
                    vfv,vsx=dic2[d][5].split(' ,')
                    dic2[d].pop(5)
                    dic2[d].pop(5)
                    dic2[d].insert(5,vsx.strip())
                    dic2[d].insert(5,vfv.strip())
            dic1[lq]=dic2[d]
            lq +=1
        dicA=dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            if 'otal' in dic2[d][5] and 'Total' not in dic2[d][5]:
                dic2[d][5] = dic2[d][5].replace('otal','Total')
            if dic2[d].count(' ') == 6 and dic2[d][2] == 'SURGERY PACKAGE (09-11-2021 TO 11-11-2021)':
                dic2[d].pop(2)
                dic2[d].insert(2,' ')
                dic2[d].pop(0)
                dic2[d].insert(0,'SURGERY PACKAGE')
            if dic2[d].count(' ') == 2 and len(re.findall('\d{2}\-\d{2}\-\d{4}',dic2[d][0]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d][3]))==1 and \
                    len(re.findall('\d\s?\.\s?\d', dic2[d][6])) == 0 and len(re.findall('\d\s?\.\s?\d',dic2[d][5]))==0 and len(dic2[d][4].split()) == 3:
                print('TRUEE')
                el3a, el3b, el3c = dic2[d][4].split()
                dic2[d].pop(4)
                dic2[d].insert(4,el3a)
                dic2[d].pop(5)
                dic2[d].insert(5, el3b)
                dic2[d].pop(6)
                dic2[d].insert(6, el3c)
            if dic2[d][3] == 'Total Bed Charges' and dic2[d].count(' ') == 4 and len(re.findall('\d\s?\.\s?\d', dic2[d][4])) == 1 and len(re.findall('\d\s?\.\s?\d', dic2[d][5])) == 1 and len(re.findall('\d\s?\.\s?\d', dic2[d][6])) == 0 and len(re.findall('\d\s?\.\s?\d', dic2[d-1][6])) == 1:
                amt_val = dic2[d][5]
                dic2[d].pop(5)
                dic2[d].insert(5,' ')
                dic2[d].pop(6)
                dic2[d].insert(6,amt_val)
            #     today for 220100598235
            if d > 2 and len(re.findall('\D{4}\s?\d{9}', dic2[d][1])) == 1 and len(re.findall('\s?\.\d{2}', dic2[d][3])) == 1 and len(re.findall('\D{3}\s\D{15}', dic2[d][2])) == 1 and len(re.findall('\d{3}\.\d{2}', dic2[d][4])) == 1 and \
                    dic2[d][2] == 'LAP CHOLECYSTECTOMY' and dic2[d + 2][0] not in head_list:
                print('oooooooooooo')
                listnw1 = ['HEAD',' ',' ',' ',' ',' ',' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq] = dic2[d + 1]
                dic2[lq] = listnw1
                amtval = dic2[d+2][5].replace(',',"")
                amtval1 = dic2[d+3][5].replace(',',"")
                amtval2 = float(amtval)+float(amtval1)
                dic2[d+4][5] = dic2[d+4][5]+' '+':'+' '+str(amtval2)
            else:
                dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2=dicA
        dic1={}
        lq=1
        f=0
        fn=len(dic2)
        for d in dic2:
            f +=1
            if f>3 and f<fn and dic2[d][:4].count(' ')==4 and dic2[d][4:].count(' ')==0 and len(re.findall('\d\.\d',dic2[d][5]))==1 and len(re.findall('\d\.\d',dic2[d][6]))==1 and len(dic2[d-1][5].strip())==0 and len(dic2[d-1][6].strip())==0:
                if len(re.findall('\d\.\d',dic2[d][4]))==1 and len(re.findall('\d\.\d|\d\-\d',dic2[d-1][4]))==1 and len(dic2[d-2][4].strip())==0 and dic2[d-2][:4].count(' ')==0 and len(re.findall('\d\.\d',dic2[d-2][5]))==1 and len(re.findall('\d\.\d',dic2[d-2][6]))==1:
                    print('tttttt',dic2[d])
                    pre_2=copy.deepcopy(dic2[d-2])
                    pre_1=copy.deepcopy(dic2[d-1])
                    pre_0=copy.deepcopy(dic2[d])
                    ms1=pre_1[4]
                    pre_2.pop(4)
                    pre_2.insert(4,ms1)
                    dic1[lq-2]=pre_2
                    pre_1.pop(4)
                    pre_1.insert(4,' ')
                    new_l=copy.deepcopy(opr1(pre_1,pre_0,src_dc))
                    dic1[lq-1]=new_l
                    continue
            dic1[lq]=dic2[d]
            lq +=1
        dicA=dic1
        # print('hhhhs',hospital)
        dic2=dicA
        dic1={}
        lq=1
        for d in dic2:
            if dic2[d][2]==' ' and len(dic2[d][1])>=16 and len(re.findall('^[A-Z]{4}\d{6,10}',dic2[d][1]))==1 and len(dic2[d][1].split())>=2:
                print('kkkkk11',dic2[d])
                oe,tw=dic2[d][1].split(' ',1)
                dic2[d].pop(1)
                dic2[d].pop(1)
                dic2[d].insert(1,tw)
                dic2[d].insert(1,oe)
            if dic2[d][6]==' ' and len(re.split('\.\d\d',dic2[d][5]))==3 and re.split('\.\d\d',dic2[d][5])[2]=='' and len(re.findall('\.\d\d',dic2[d][5]))==2 and dic2[d][5].__contains__('Total')==False:
                print('ddddfff11',dic2[d])
                fv_x=re.split('\.\d\d',dic2[d][5])[0]+re.findall('\.\d\d',dic2[d][5])[0]
                sx_x=re.split('\.\d\d',dic2[d][5])[1]+re.findall('\.\d\d',dic2[d][5])[1]
                dic2[d].pop(5)
                dic2[d].pop(5)
                dic2[d].insert(5,sx_x)
                dic2[d].insert(5,fv_x)
            # if dic2[d][6]==' ' and len(re.findall('\d\.\d\d',dic2[d][5]))==2 and len(dic2[d][5].split())==2:
            #     print('kkkkk22',dic2[d])
            #     oe,tw=dic2[d][5].split()
            #     dic2[d].pop(5)
            #     dic2[d].pop(5)
            #     dic2[d].insert(5,tw)
            #     dic2[d].insert(5,oe)
            if len(dic2[d][1])>=16 and len(re.findall('^[A-Z]{4}\d{4,10}',dic2[d][1]))==1 and len(dic2[d][1].split())>=2:
                print('kkkkk333',dic2[d])
                snd_val=copy.deepcopy(dic2[d][2])
                val_itm=dic2[d][1].split()
                xc=0
                code_val=''
                item_val=''
                for vi in val_itm:
                    xc +=1
                    if xc==1 and len(re.findall('^[A-Z]{4}\d{4,10}',vi))==1:
                        code_val +=vi
                    if xc==2 and vi.isdigit()==True and len(vi)<=6:
                        code_val +=vi
                    item_val =' '+vi
                item_val=item_val+' '+snd_val
                item_val=re.sub(' +',' ',item_val)
                item_val=item_val.strip()
                dic2[d].pop(1)
                dic2[d].pop(1)
                dic2[d].insert(1,item_val)
                dic2[d].insert(1,code_val)
            dic1[lq]=dic2[d]
            lq +=1
        dicA=dic1

        dic2=dicA
        dic1={}
        lq=1
        f=0
        for d in dic2:
            f +=1
            if dic2[d][6]==' ' and len(dic2[d][5].split())==2 and len(re.findall('\.\d',dic2[d][5]))>=2 and len(re.findall('\d{2}\-\d{2}\-\d{4}',dic2[d][0]))==1:
                print('ddddfffyyy',dic2[d])
                fv_x,sx_x=dic2[d][5].split()
                dic2[d].pop(5)
                dic2[d].pop(5)
                dic2[d].insert(5,sx_x)
                dic2[d].insert(5,fv_x)
            dic1[lq]=dic2[d]
            lq +=1
        dicA=dic1

        dic2=dicA
        dic1={}
        lq=1
        f=0
        for d in dic2:
            f +=1
            if f>2 and len(re.findall('\d\d?\-\d{2}\-\d{4}',dic2[d-1][0]))==1 and dic2[d-1][4:].count(' ')==3 and len(re.findall('\d\s?\.\s?\d',dic2[d][5]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d][6]))==1 and dic2[d][:3].count(' ')==3:
                print('orrrrrrrr222',dic2[d])
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue
            if f>2 and len(re.findall('\d\d?\-\d{2}\-\d{3}\d?',dic2[d-1][0]))==1 and dic2[d-1][2:].count(' ')==5 and dic2[d][2:].count(' ')==0 and len(re.findall('\d\s?\.\s?\d',dic2[d][5]))==1 and len(re.findall('\d\s?\.\s?\d',dic2[d][6]))==1:
                print('orrrrrrrr222333',dic2[d])
                new_l=copy.deepcopy(opr1(dic2[d-1],dic2[d],src_dc))
                dic1[lq-1]=new_l
                continue
            dic1[lq]=dic2[d]
            lq +=1
        dicA=dic1

        dic2=dicA
        dic1={}
        lq=1
        f=0
        for d in dic2:
            f +=1
            ss=''
            if len(re.findall('\w{5,8}',dic2[d][3].replace('.','').replace(',','').replace(' ','')))==1 and len(re.findall('\w{1,2}\.\w{1,2}|\w{1,2}\,\w{1,2}|\w{1,2}\s\w{1,2}',dic2[d][4]))==1:
                print('kkkkkkk',dic2[d])

                newl=copy.deepcopy(dic2[d])
                newl1=newl[:3]+newl[4:]+newl[6:7]
                dic1[lq]=newl1
                lq +=1
                continue
            if len(re.findall('^Total\s?\:',ss.join(dic2[d][4:]).strip()))==1 and dic2[d][:4].count(' ')!=4:
                print('123321',dic2[d])
                newl=copy.deepcopy(dic2[d])
                newl_n=[' ',' ',' ',' ']
                newl1=newl_n+newl[4:]
                dic1[lq]=newl1
                lq +=1
                continue
            dic1[lq]=dic2[d]
            lq +=1
        dicA=dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('mdd==', dic2[d]) for hdfc
            if dic2[d][0].__contains__('Surgery Details'):
                dic2[d][0] = 'Surgery Details'
            if d > 1 and dic2[d][5] == 'Total' and dic2[d - 1][5].__contains__('Total'):
                dic2[d][5] = ' '
            if d > 1 and dic2[d][3].__contains__('Total') and dic2[d - 1][5].__contains__('Total'):
                dic2[d-1][5] = ' '
            # forr head in aaaiigg if head and total is not present
            # if d>1 and dic2[d][0] not in head_list and dic2[d-1][5].__contains__('Total'):
            #     listnw = ['Head', ' ', ' ', ' ', ' ', ' ', ' ']
            #     dic1[lq] = dic2[d]
            #     dic1[lq-1] = dic2[d-1]
            #     lq+=1
            #     dic1[lq-1] = listnw
            # if d>1 and d==len(dic2) and 'Total' not in dic2[d][5]:
            #     dic1[lq] = dic2[d]
            #     dic1[lq+1] = [' ', ' ', ' ', ' ', ' ', 'Total', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['BETADINE SOL 10% -100ML',
                       ]
        correct_map_known_items = {
            'BETADINE SOL 10% -100ML': [['1.00', '115.361', '15.36', '15.36'], ['1.00', '115.36', '15.36', '115.36']],

        }
        for d in dic2:
            print('mdd==', dic2[d])
            try:
                if dic2[d][2].strip(' -,.') in known_items:
                    if dic2[d][2].strip(' -,.') in correct_map_known_items and dic2[d][3:] == \
                            correct_map_known_items[dic2[d][2].strip(' -,.')][0]:
                        print('itemssss00', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:3] + correct_map_known_items[neww[2].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'aig1':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # forr head in aaaiigg if head and total is not present
            if d>1 and dic2[d][0] in head_list and 'Sub Total' not in dic2[d-1][1]:
                listnw = [' ', 'Sub Total', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq+=1
                dic1[lq-1] = listnw
            if d>1 and d==len(dic2) and 'Sub Total' not in dic2[d][1]:
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', 'Sub Total', ' ', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

    if hospital=='fortisjindal':
        # print('mmmmmmmmmmmmm')
        dic2=dicA
        dic1={}
        lq=1
        f=0
        fn=len(dic2)
        for d in dic2:
            print('mdd==',dic2[d])
            if dic2[d][2].__contains__('CONSUMABLE CHARG') or dic2[d][2].__contains__('PHARMACY CHARG'):
                dic2[d][3] = ' '
                dic2[d][4] = ' '
                dic2[d][5] = ' '

            dic1[lq]=dic2[d]
            lq +=1
        dicA=dic1
    if hospital=='fortisjindal-pharma':
        # print('mmmmmmmmmmmmm')
        dic2=dicA
        dic1={}
        lq=1
        fn=len(dic2)
        for d in dic2:
            print('mddd==',dic2[d])
            if d==1 and dic2[d][0]!='DRUG AND CONSUMABLES':
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq-1] = ['DRUG AND CONSUMABLES', ' ', ' ', ' ', ' ', ' ', ' ']
            if d==len(dic2) and dic2[d][4]!='Total':
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq+1] = [' ', ' ', ' ', ' ', 'Total', ' ', ' ']

            dic1[lq]=dic2[d]
            lq +=1
        dicA=dic1
    if hospital == 'ruby':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'ruby-pharma':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===',dic2[d])
            if dic2[d][0] == 'Issues' or dic2[d][0] == 'ISSUES':
                dic2[d][0] = 'PHARMACY'
            if dic2[d][0] == 'Returns' or dic2[d][0] == 'RETURNS':
                dic2[d][0] = 'PHARMACY-RETURNS'
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'kokilaben':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            print('mmdddd===',dic2[d])
            if dic2[d][6].__contains__('of'):
                dic2[d][6] = dic2[d][6].replace('of','')
            if dic2[d][5].__contains__('of'):
                dic2[d][5] = dic2[d][5].replace('of','')
            if d>1 and len(re.findall('\D{10}\s\D{7}\s\D{15}\s\/\s\D{11}', dic2[d][0])) == 1 and len(re.findall('\d{2}\/\d{2}\/\d{4}\s\d{2}\:\d{2}', dic2[d][1])) == 1 and dic2[d].count(' ')==2 and dic2[d-1].count(' ')==3:
                print('packages 222')
                dic2[d-1][0] = dic2[d][0]
                dic2[d-1][1] = dic2[d][1]
                dic2[d-1][3] = dic2[d][3]
                dic2[d-1][4] = dic2[d][4]
                dic2[d-1][6] = dic2[d][6]
                dic2[d][0] = 'Packages(Subtotal)'
                dic2[d][1] = ' '
                dic2[d][3] = dic2[d-2][3]
                dic2[d][4] = str(float(dic2[d][4])+float(dic2[d-2][4]))
                dic2[d][6] = str(float(dic2[d][6])+float(dic2[d-2][6]))
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['Oct- Macula and Disc Evaluation Per Eye','ROSUVAS 20MG TAB','SAFESET J.V.SET w/o BACK FLOW B BRAUN',
                       'dli','Pharmacy Charges (details attached)','DIAPER ADULT MEDIUM (PKG-2) KOSMOCARE','VEG.SANDWICH',
                       'JMS/RMO Charge','IMS/RMO Charge','EMESET INJ 4MG 2ML (ONDANSETRAN)','ROPIZUVA 0.2 % INJ (HRM',
                       "Surgeon Fees Supra Major/Arthroscopic ACL/PCL' reconstru/Dr.DINSHAW PARDIWALA",'Doctor Routine Visit - Nephrology/Dr.NIRANJAN KULKARNI 1',
                       'OT Time Major Plus/URS Upper Ureteric Stone/Dr.Attar Mohammad Ismail','PARAGLASS 100ML IV'

                       ]
        correct_map_known_items = {
            'Oct- Macula and Disc Evaluation Per Eye': [['1.00', '300.00', '0.00', '300.00'], ['1.00', '3300.00', '0.00', '3300.00']],
            'ROSUVAS 20MG TAB': [['1.00', '330.00', '0.00', '830,00'], ['1.00', '330.00', '0.00', '330.00']],
            'SAFESET J.V.SET w/o BACK FLOW B BRAUN': [['1.00', '338.00', '0.00', '38.00'], ['1.00', '338.00', '0.00', '338.00']],
            'dli': [['1.00', '52.38', '0.00', '$5.00'], ['1.00', '52.38', '0.00', '55.00']],
            'Pharmacy Charges (details attached)': [['1.00', '42475.50', '0.00', '42475.50|'], ['1.00', '42475.50', '0.00', '42475.50']],
            'DIAPER ADULT MEDIUM (PKG-2) KOSMOCARE': [['3.00 .', '420.00', '0.00', '420.00'], ['3.00', '420.00', '0.00', '420.00']],
            'VEG.SANDWICH': [['2.00', '89.98', ' ', '4.48'], ['2.00', '89.98', '0.00', '94.48']],
            'JMS/RMO Charge': [['1.00', '750.00', '0.00', '750,00'], ['1.00', '750.00', '0.00', '750.00']],
            'IMS/RMO Charge': [['1.00', '750.00', '0.00', '750.00.'], ['1.00', '750.00', '0.00', '750.00']],
            'EMESET INJ 4MG 2ML (ONDANSETRAN)': [['2.00', '26.10', '0.00', '6.10'], ['2.00', '26.10', '0.00', '26.10']],
            'ROPIZUVA 0.2 % INJ (HRM': [['2.00', '260.04', '0.00', '260,04'], ['2.00', '260.04', '0.00', '260.04']],
            "Surgeon Fees Supra Major/Arthroscopic ACL/PCL' reconstru/Dr.DINSHAW PARDIWALA": [['1.25', '68750.00', '0.00', '58750.00'], ['1.25', '68750.00', '0.00', '68750.00']],
            'Doctor Routine Visit - Nephrology/Dr.NIRANJAN KULKARNI 1': [['1.00', '1000.00', '0.00', '1000.00.'], ['1.00', '1000.00', '0.00', '1000.00']],
            'OT Time Major Plus/URS Upper Ureteric Stone/Dr.Attar Mohammad Ismail': [['1.00', '33000.00', '0,00', '33000.00'], ['1.00', '33000.00', '0.00', '33000.00']],
            'PARAGLASS 100ML IV': [['1.00', '490.43', '0.00', '90.43'], ['1.00', '490.43', '0.00', '490.43']],

        }
        for d in dic2:
            print('mdd==', dic2[d])
            try:
                if dic2[d][0].strip(' -,.') in known_items:
                    if dic2[d][0].strip(' -,.') in correct_map_known_items and dic2[d][3:] == \
                            correct_map_known_items[dic2[d][0].strip(' -,.')][0]:
                        print('itemssss00', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:3] + correct_map_known_items[neww[0].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['EMESET INJ 4MG 2ML (ONDANSETRAN)','GLOVES POWDER FREE 6.5 INCH ENCORE','MYO-PYROLATE',
                       'SOLID GEL DISP ELECTRODE MEDICO MSGLT-05','SUPACEF 1.5 GM INJ','THEMICAINE 2% JELLY',
                       'URINE BAG w DRIP CHAMBER & PORT UROFLOW','CRP','CD4/CD8 Counts','D-Dimer, Quantitative','1.5GM INJ (H1)',
                       'ARM POUCH MEDIUM VISSCO 805','PARAGLASS 100ML IV','VENFLON PRO SAFETY 20G X 32Mm 393224 BD',
                       'SUPRIDOL INJ 1ML (H1)','INTRO SHEATH AVANTI PLUS 7F 504607X J&J','CLIPER BLADE 9680 3M','DEXONA INJ (Dexamethasone)',
                       'DEXTROSE 25% 100ML ACULIFE (HRM)','GLOVES POWDER FREE 6.0 INCH ENCORE','GLOVES POWDER FREE 6.0 INCH ENCORE',
                       'VEIN O LINE 200CM ROMSONS','CLEXANE 40MG INJ (HRM)','NS 0.9% 100ML FLEXIDRIP','SYRINGE 2 ML WITH NEEDLE 24 X 1" BD'

                       ]
        correct_map_known_items = {
            'EMESET INJ 4MG 2ML (ONDANSETRAN)': [['-1.00', '-13,05', '0.00', '13.05'],['-1.00', '-13.05', '0.00', '-13.05']],
            'GLOVES POWDER FREE 6.5 INCH ENCORE': [['2.00', '190.00', '0.00', '190,00'],['2.00', '190.00', '0.00', '190.00']],
            'MYO-PYROLATE': [['. 1.00 -', '84.80.', '0.00', '84,80'],['1.00', '84.80', '0.00', '84.80']],
            'SOLID GEL DISP ELECTRODE MEDICO MSGLT-05': [['5.00', '120.00', '0.00', '120.00.'],['5.00', '120.00', '0.00', '120.00']],
            'SUPACEF 1.5 GM INJ': [['1.00', '379.70', '0.00', '879.70'],['1.00', '379.70', '0.00', '379.70']],
            'THEMICAINE 2% JELLY': [['3.00', '105.21', '0.00', '105,21'],['3.00', '105.21', '0.00', '105.21']],
            'URINE BAG w DRIP CHAMBER & PORT UROFLOW': [['1.00', '331:00', '0.00', '331.00'],['1.00', '331.00', '0.00', '331.00']],
            'CRP': [['1.00 .', '600.00', '0.00', '600.00 .'],['1.00', '600.00', '0.00', '600.00']],
            'CD4/CD8 Counts': [['1.00', '6112.50', '0.00', '61 12.50'],['1.00', '6112.50', '0.00', '6112.50']],
            'D-Dimer, Quantitative': [['1.00 .', '2775.00', '0.00', '2775.00'],['1.00', '2775.00', '0.00', '2775.00']],
            '1.5GM INJ (H1)': [['3.00', '1853.76', '0.00', '1853,76'],['3.00', '1853.76', '0.00', '1853.76']],
            'ARM POUCH MEDIUM VISSCO 805': [['1.00', '325.00', '0,00', '825.00'],['1.00', '325.00', '0.00', '325.00']],
            'VENFLON PRO SAFETY 20G X 32Mm 393224 BD': [['1.00', '365.00', '0.00', '865.00'],['1.00', '365.00', '0.00', '365.00']],
            'SUPRIDOL INJ 1ML (H1)': [['2.00 .', '23.00', '0.00', '23.00'],['2.00', '23.00', '0.00', '23.00']],
            'PARAGLASS 100ML IV': [['2.00 .', '1078.84', '0.00', '1078.8'],['2.00', '1078.84', '0.00', '1078.8']],
            'INTRO SHEATH AVANTI PLUS 7F 504607X J&J': [['1.00', '1165.00', '. 40.00', '1 165.00'],['1.00', '1165.00', '0.00', '1165.00']],
            'CLIPER BLADE 9680 3M': [['.oo', '658.00', '0,00', '658,00.'],['1.00', '658.00', '0.00', '658.00']],
            'DEXONA INJ (Dexamethasone)': [['-28.00', '-291.20', '0.00', '291.20'],['-28.00', '-291.20', '0.00', '-291.20']],
            'DEXTROSE 25% 100ML ACULIFE (HRM)': [['-1.00', '19.04', '0.00', '19.04'],['-1.00', '-19.04', '0.00', '-19.04']],
            'GLOVES POWDER FREE 6.0 INCH ENCORE': [['1.00', '95.00', '0.00', '5.00'],['1.00', '95.00', '0.00', '95.00']],
            'GLOVES POWDER FREE 6.0 INCH ENCORE': [['6.00', '570.00', '0.00', '$70.00'],['6.00', '570.00', '0.00', '570.00']],
            'VEIN O LINE 200CM ROMSONS': [['1.00', '331.00', '0.00', '831.00'],['1.00', '331.00', '0.00', '331.00']],
            'CLEXANE 40MG INJ (HRM)': [[' ', '425.67', '0.00', '-425,67'],['1.00', '425.67', '0.00', '-425.67']],
            'NS 0.9% 100ML FLEXIDRIP': [[' ', '-113.16', '0.00', '-113,16'],['3.00', '-113.16', '0.00', '-113.16']],
            'SYRINGE 2 ML WITH NEEDLE 24 X 1" BD': [['1.00', '-12.00', '0.00', '-12.00.'],['1.00', '-12.00', '0.00', '-12.00']],

        }
        for d in dic2:
            print('mdd==', dic2[d])
            try:
                if dic2[d][0].strip(' -,.') in known_items:
                    if dic2[d][0].strip(' -,.') in correct_map_known_items and dic2[d][3:] == \
                            correct_map_known_items[dic2[d][0].strip(' -,.')][0]:
                        print('itemssss11', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:3] + correct_map_known_items[neww[0].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'paras':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            print('ddddmmm===', dic2[d])
            if dic2[d][2].__contains__('Total for') and dic2[d][5] != ' ' and dic2[d].count(' ') >= 3:
                dic2[d][5] = ' '
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'blk-max':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd', dic2[d])
            if d > 1 and len(re.findall('\d{2}\/\d{2}\/\d{2}', dic2[d][0])) == 1 and dic2[d][1] == ' ':
                print('if date merged with 0th indx in surgery lines')
                text = dic2[d][0]
                matchdate = re.search(r'\d{2}\/\d{2}\/\d{2}', text)
                dic2[d][1] = matchdate.group()
                dic2[d][0] = dic2[d][0].replace(matchdate.group(), '')
            if d > 1 and (dic2[d][1].__contains__('Surgeon Fee') or dic2[d][1].__contains__('Anesthestist Fee') or
                          dic2[d][1].__contains__('T Charges') or dic2[d][1].__contains__('Equipment Fee')) and dic2[d][
                5] != ' ' and dic2[d].count(' ') >= 3:
                # print('for surgery line items')
                if dic2[d][0] != ' ':
                    dic2[d - 1][0] = dic2[d - 1][0] + ' ' + dic2[d][0]
                    dic2[d][0] = dic2[d][1]
                    dic2[d][1] = ' '
                else:
                    dic2[d][0] = dic2[d][1]
                    dic2[d][1] = ' '
            if d > 1 and (
                    dic2[d][0].__contains__('(') or dic2[d][0].__contains__(')') or dic2[d][0].__contains__('-')) and \
                    dic2[d][5] == ' ' and dic2[d][1] != ' ' and \
                    dic2[d].count(' ') >= 3 and (
                    dic2[d - 1][3].__contains__('Sub To') or dic2[d - 1][2].__contains__('Sub To')):
                print('for surgery sbtss')
                dic2[d - 1][2] = ' '
                dic2[d - 1][3] = ' '
                dic2[d - 1][5] = ' '
            if dic2[d][0] != ' ' and len(re.findall('^\d+\s?\,?\.?\s', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()[0]) <= 3:
                # print('to remove sno and brackets')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\s?\,?\.?\s', text)
                dic2[d][0] = dic2[d][0].replace(matchsno.group(), '')
                dic2[d][0] = dic2[d][0].strip()
            if dic2[d][1] in dic2[d][0] and dic2[d][1] != ' ' and dic2[d][0] != ' ' and len(
                    re.findall('\d\/\d\s?\d\/\d', dic2[d][1])) >= 1:
                print('for room rent dates')
                dic2[d][0] = dic2[d][0].replace(dic2[d][1], '')

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'blk' or hospital == 'Sharda_N17138':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['TWIN SHARING', 'GLOVES SURGICAL STERILE 7.0 SAFE CURE',
                       'MALIDENS (PARACETAMOL) INJ 1GM/100 ML PLASTIC BOTTLE 1X1 - ABBOTT'
                       ]
        correct_map_known_items = {
            'TWIN SHARING': [['5600.00', '1.00', '6600.00'], ['6600.00', '1.00', '6600.00']],
            'GLOVES SURGICAL STERILE 7.0 SAFE CURE': [['50.00', ' ', '300.00'], ['60.00', ' ', '300.00']],
            'MALIDENS (PARACETAMOL) INJ 1GM/100 ML PLASTIC BOTTLE 1X1 - ABBOTT': [['470.26', '3.00', '1410,78'],
                                                                                  ['470.26', '3.00', '1410.78']],

        }
        for d in dic2:
            print('mdd==', dic2[d])
            try:
                if dic2[d][1].strip(' -,.') in known_items:
                    if dic2[d][1].strip(' -,.') in correct_map_known_items and dic2[d][3:] == \
                            correct_map_known_items[dic2[d][1].strip(' -,.')][0]:
                        print('itemssss00', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:3] + correct_map_known_items[neww[1].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['GLOVES SURGICAL STERILE 7.0 SAFE CURE', 'TRD CONJECT (TRAMADOL) INJ 50MG/1ML 1X1 - MODI MUNDI',
                       'GLOVES MICRO OPTIC (SIZE: 7.5) (POWDER FREE) ANSELL',
                       'RL (RINGER LACTATE) INJ 500 ML EUROHEAD 1X1 - NIRLIFE',
                       'Surgical BLADE No.20', 'ANAESTHESIA CHARGES (GENERAL)'
                       ]
        correct_map_known_items = {
            'GLOVES SURGICAL STERILE 7.0 SAFE CURE': [['60.005', ' ', '300.00'], ['60.00', ' ', '300.00']],
            'TRD CONJECT (TRAMADOL) INJ 50MG/1ML 1X1 - MODI MUNDI': [['11,48', '3.00', '34.44'],
                                                                     ['11.48', '3.00', '34.44']],
            'GLOVES MICRO OPTIC (SIZE: 7.5) (POWDER FREE) ANSELL': [[' ', '5.00', '475.00'],
                                                                    ['95.00', '5.00', '475.00']],
            'RL (RINGER LACTATE) INJ 500 ML EUROHEAD 1X1 - NIRLIFE': [['1.00', '1.00', '19.73'],
                                                                      ['49.73', '1.00', '49.73']],
            'Surgical BLADE No.20': [['5.00', '2.00', '0.00'], ['5.00', '2.00', '10.00']],
            'ANAESTHESIA CHARGES (GENERAL)': [['3369.00', '1.00', '8369.00'], ['8369.00', '1.00', '8369.00']],

        }
        for d in dic2:
            print('mdd==', dic2[d])
            try:
                if dic2[d][1].strip(' -,.') in known_items:
                    if dic2[d][1].strip(' -,.') in correct_map_known_items and dic2[d][3:] == \
                            correct_map_known_items[dic2[d][1].strip(' -,.')][0]:
                        print('itemssss00', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:3] + correct_map_known_items[neww[1].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'CHRISTIAN':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            print('ddddmmm===', dic2[d])
            if len(dic2[d][3].split()) == 2 and dic2[d][4] == ' ':
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if d > 1 and len(re.findall('\d{2}\/\d{2}\/\d{2}', dic2[d][0])) == 1 and dic2[d - 1][2] == 'Total' and len(
                    re.findall('\d\.\d', dic2[d][5])) == 1 and len(re.findall('\d\.\d', dic2[d - 1][5])) == 1 and dic2[
                d - 1].count(' ') >= 3:
                print('for adding PHARMACY DRUGS')
                listnw = ['PHARMACY DRUGS', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d > 1 and len(re.findall('\d{2}\/\d{2}\/\d{2}', dic2[d][0])) == 1 and dic2[d - 1][2] != 'Total' and len(
                    re.findall('\d\.\d', dic2[d][5])) == 1 and len(re.findall('\d\.\d', dic2[d - 1][5])) == 1 and dic2[
                d - 1].count(' ') >= 3 and dic2[d - 2][0].__contains__('Surgery'):
                print('for adding PHARMACY DRUGS and total')
                listnw = ['PHARMACY DRUGS', ' ', ' ', ' ', ' ', ' ']
                listnw1 = [' ', ' ', 'Total', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw1
                lq += 1
                dic1[lq - 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['CTG', 'RINGER LACTATE SOLUTION (', '4Days-4 BED-BED NURSING', 'RINGER LACTATE (FREEFLEX)',
                       'BACTILEM-INJECTION, 750 m',
                       'SODIUM CHLORIDE 0.9% (BB)', 'GENTICYN [NICHOLAS]-INJEC', 'CAMPICILLIN-INJECTION, 50',
                       'MISOPROST-25-TABLET, 25 u',
                       'DISP.SYRINGE & NEEDLE-5 M', 'PERISET-INJECTION,2mg/1ml', 'KABIMOL-INJECTION, 10mg/ Im',
                       'DEXTROSE 5% (B.BRAUN) ECO',
                       'DISP.SYRINGE & NEEDLE-2 M', 'CAREFOR BELTED SANITARY N', 'DISP.SYRINGE & NEEDLE-10',
                       'PITOCIN-INJECTION,5units/',
                       'PPE AND INFECTION CONTROL CHARGES (GEN WARD)', 'INFUSION SET WITH LUER LO']
        correct_map_known_items = {
            'CTG': [[' ', ' ', '1875.00 ------'], [' ', ' ', '1875.00']],
            'RINGER LACTATE SOLUTION (': [['B', ' ', '149.22'], ['3', ' ', '149.22']],
            '4Days-4 BED-BED NURSING': [[' ', ' ', '5820.00 ------'], [' ', ' ', '5820.00']],
            'BACTILEM-INJECTION, 750 m': [['D', ' ', '411.50'], ['2', ' ', '411.50']],
            'RINGER LACTATE (FREEFLEX)': [['N', ' ', '114.40'], ['2', ' ', '114.40']],
            'SODIUM CHLORIDE 0.9% (BB)': [['N', ' ', '154.84'], ['2', ' ', '154.84']],
            'GENTICYN [NICHOLAS]-INJEC': [['4', ' ', '86.84'], ['4', ' ', '36.84']],
            'CAMPICILLIN-INJECTION, 50': [['6', ' ', '36.46'], ['6', ' ', '86.46']],
            'MISOPROST-25-TABLET, 25 u': [['O', ' ', '41.76'], ['6', ' ', '41.76']],
            'DISP.SYRINGE & NEEDLE-5 M': [['UI', ' ', '70.00'], ['5', ' ', '70.00']],
            'DISP.SYRINGE & NEEDLE-5 M': [['13', ' ', '45.00'], ['3', ' ', '45.00']],
            'PERISET-INJECTION,2mg/1ml': [['W', ' ', '78.36'], ['3', ' ', '78.36']],
            'KABIMOL-INJECTION, 10mg/ Im': [['A', ' ', '1808.00'], ['4', ' ', '1808.00']],
            'DEXTROSE 5% (B.BRAUN) ECO': [['W', ' ', '217.32'], ['3', ' ', '217.32']],
            'DISP.SYRINGE & NEEDLE-2 M': [['U', ' ', '55.00'], ['5', ' ', '55.00']],
            'CAREFOR BELTED SANITARY N': [['N', ' ', '160.00'], ['2', ' ', '160.00']],
            'RINGER LACTATE (FREEFLEX)': [['W', ' ', '171.60'], ['3', ' ', '171.60']],
            'DISP.SYRINGE & NEEDLE-10': [['W', ' ', '78.00'], ['3', ' ', '78.00']],
            'PITOCIN-INJECTION,5units/': [['W', ' ', '58.95'], ['3', ' ', '58.95']],
            'PPE AND INFECTION CONTROL CHARGES (GEN WARD)': [[' ', ' ', '800.00'], [' ', ' ', '300.00']],
            'INFUSION SET WITH LUER LO': [['N', ' ', '302.00'], ['2', ' ', '302.00']],

        }
        for d in dic2:
            print('mdd==', dic2[d])
            if dic2[d][3] == 'Total Returns:':
                dic2[d][3] = 'Returns'
            if dic2[d][3] == 'Total Conc Taken from returns(-) :':
                dic2[d][3] = 'Conc Taken from returns(-)'
            if d == len(dic2) and dic2[d][3].__contains__('Total for Returns') and dic2[d - 1][3].__contains__(
                    'Total for Dispensary'):
                dic2[d][3] = 'Returns'
            if (len(re.findall('\d{2}\/\d{2}\/\d{2}', dic2[d][0])) == 1 or len(
                    re.findall('\/\d{2}\/\d{2}', dic2[d][0])) == 1) and dic2[d][1] != ' ' and (
                    dic2[d][2] == ' ' or dic2[d][2] != ' '):
                print('for pharmacy items moving from 1st to 2nd index')
                dic2[d][2] = dic2[d][1]
                dic2[d][1] = ' '
            if d > 1 and d < len(dic2) and dic2[d][0] != ' ' and len(dic2[d][0].split()) > 4 and dic2[d].count(
                    ' ') >= 3 and dic2[d - 1][0] == 'Surgery name & Type':
                print('for surgery particular')
                dic2[d][2] = dic2[d][0]
                dic2[d][0] = ' '
            try:
                if dic2[d][2].strip(' -,.') in known_items:
                    if dic2[d][2].strip(' -,.') in correct_map_known_items and dic2[d][3:] == \
                            correct_map_known_items[dic2[d][2].strip(' -,.')][0]:
                        print('itemssss', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:3] + correct_map_known_items[neww[2].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'krishna':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mdd==', dic2[d])
            if dic2[d][0] != ' ' and dic2[d][1] != ' ' and dic2[d][1] in dic2[d][0]:
                dic2[d][0] = dic2[d][0].replace(dic2[d][1], '')
            if d > 2 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d - 1][2]:
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'jupiter':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmmdd===', dic2[d])
            if dic2[d][2].__contains__('MEDICINES FROM'):
                dic2[d][6] = ' '
                dic2[d][5] = ' '
            if dic2[d][4].__contains__('0.0'):
                dic2[d][4] = ' '
            if d > 1 and dic2[d][0].__contains__('MEDICINES') and len(dic2[d][0].split()) == 2 and len(
                    re.findall('\d{8}', dic2[d][0])) == 1:
                print('if MEDICINES and line item is merged')
                listnw = ['MEDICINES', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic2[d][0] = dic2[d][0].replace('MEDICINES', '')
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d > 2 and dic2[d][0] in head_list and 'Sub Total' not in dic2[d - 1][4] and 'Sub Total' not in \
                    dic2[d - 2][4] and 'Sub Total' not in dic2[d - 1][5] and 'Sub Total' not in dic2[d - 1][3]:
                print('yesssssssssssss')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', ' ', ' ', ' ', 'Sub Total', ' ', ' ']
            if dic2[d][5] != ' ' and len(re.findall('\D+\s\D+', dic2[d][5])) >= 1 and 'Sub' not in dic2[d][5] and len(
                    re.findall('\d', dic2[d][5])) >= 1:
                print('if . . in 5th indx')
                text = dic2[d][5]
                matchrate = re.search(r'\D+\s\D+', text)
                dic2[d][5] = text.replace(matchrate.group(), '')
            if dic2[d][6] != ' ' and len(re.findall('\D+\s\D+', dic2[d][6])) >= 1 and 'Sub' not in dic2[d][5] and len(
                    re.findall('\d', dic2[d][6])) >= 1:
                print('if . . in 6th indx')
                text = dic2[d][6]
                matchrate = re.search(r'\D+\s\D+', text)
                dic2[d][6] = text.replace(matchrate.group(), '')
            if d > 1 and dic2[d][5] != ' ' and dic2[d][6] != ' ' and dic2[d][3] != ' ' and dic2[d - 1][0] != ' ' and \
                    dic2[d - 1][2] != ' ' and (dic2[d - 1][6] == ' ' or dic2[d][6] != ' ') and \
                    (dic2[d].count(' ') == 4 or dic2[d].count(' ') == 3) and (
                    dic2[d - 1].count(' ') == 4 or dic2[d - 1].count(' ') == 3):
                print('if lines divided 4,3 and 4,3')
                dic2[d - 1][3:] = dic2[d][3:]
                dic2[d][3:] = [' ', ' ', ' ', ' ']
            if d == len(dic2) and dic2[d - 1][4] != 'Sub Total' and dic2[d - 2][4] != 'Sub Total' and dic2[d][
                4] != 'Sub Total':
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', ' ', 'Sub Total', ' ', ' ']
            # if len(re.findall('\.\s?', dic2[d][2])) >= 1:
            #       commented need to ask mohit about dots in lines
            #     text = dic2[d][2]
            #     matchdot = re.search('\.\s?',text)
            #     dic2[d][2] = dic2[d][2].replace(matchdot.group(),'').replace(' ','',1)

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # /////////////////////////
    if hospital == 'hinduja':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('md111==', dic2[d])
            for i in head_list:
                if d > 1 and i in dic2[d][0] and dic2[d].count(' ') >= 3 and 'Subtotal' not in dic2[d - 1][2]:
                    print('adding sbt if header and line item merged')
                    listnw = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
                    dic1[lq] = dic2[d]
                    dic1[lq - 1] = dic2[d - 1]
                    lq += 1
                    dic1[lq - 1] = listnw
            if d > 1 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d - 1][2]:
                print('if abt not present above headers')
                listnw = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if dic2[d][4] != ' ' and (dic2[d][4] == '00.00' or dic2[d][4] == '000.00'):
                print('removing zeross')
                dic2[d][4] = ' '

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('md111==', dic2[d])
            for i in head_list:
                if i in dic2[d][0] and dic2[d].count(' ') <= 4 and dic2[d - 1][
                    2].__contains__('Subt'):
                    print('if page is tilted and header and lineitem in same line with sbt in d-1[2]')
                    listnw = [i, ' ', ' ', ' ', ' ', ' ']
                    dic2[d][0] = dic2[d][0].replace(i, '')
                    dic1[lq] = dic2[d]
                    dic1[lq - 1] = dic2[d - 1]
                    lq += 1
                    dic1[lq - 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'akash':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('md111==', dic2[d])
            for i in head_list:
                if i in dic2[d][0] and dic2[d].count(' ') != 7 and dic2[d].count(' ') <= 2 and dic2[d - 1][
                    2].__contains__('Sub T'):
                    print('if page is tilted and header and lineitem in same line')
                    listnw = [i, ' ', ' ', ' ', ' ', ' ', ' ', ' ']
                    dic2[d][0] = dic2[d][0].replace(i, '')
                    dic1[lq] = dic2[d]
                    dic1[lq - 1] = dic2[d - 1]
                    lq += 1
                    dic1[lq - 1] = listnw
            if dic2[d][4] != ' ' and (dic2[d][4] == '00.00' or dic2[d][4] == '000.00'):
                print('removing zeross')
                dic2[d][4] = ' '

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'akash_daycare':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if dic2[d][1]!= ' ' and len(dic2[d][1].split())>=2:
                text = dic2[d][1].split()
                dic2[d][1] = text[0]
            if d==1 and dic2[d][0] != 'Head':
                listnw = ['Head', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq-1] = listnw
            if d==len(dic2) and dic2[d][1]!='Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq+1] = listnw


            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'continental':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('md111==', dic2[d])

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'hiranandani':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('md111==', dic2[d])
            if dic2[d][4] == '000.00' or dic2[d][4] == '00.00' or dic2[d][4] == '0.00' or dic2[d][4] == '00' or dic2[d][
                4] == '.00':
                print('if zeros presnet in rate')
                dic2[d][4] = ' '
            if dic2[d][1] != ' ' and len(re.findall('\d+\-\d+\-\d+', dic2[d][1])) == 0 and len(
                    re.findall('\d+\-\d+\-\d+', dic2[d][0])) == 1:
                print('for package and accomodation charges')
                dic2[d][2] = dic2[d][1]
                dic2[d][1] = ' '
            if d > 1 and dic2[d][0] in head_list and 'Total' not in dic2[d - 1][0] and 'Total' not in dic2[d - 2][0]:
                listnw = ['Total', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'reliance':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('md111==', dic2[d])
            if d == 1 and len(re.findall('\d\.\d', dic2[d][5])) == 1 and (
                    dic2[d + 1][2] == 'Package Exclusions Subtotal' or dic2[d + 2][2] == 'Package Exclusions Subtotal'):
                print('for adding header package exclusions')
                listnw = ['Package Exclusions', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if dic2[d][1] in dic2[d][2] and 'Caesar' not in dic2[d][1] and dic2[d][1] != ' ' and dic2[d][2] != ' ':
                dic2[d][2] = dic2[d][2].replace(dic2[d][1], '')

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['SURGICAL BLADE 15 SWAN MARTON', 'Chemotherapy Level 3- Hospital Admin Cha', 'Renal Profile',
                       'CORTEX SCREW 3.5M SELF TAP 404.810-50 AO',
                       'Cross match', 'Thyroid stimulating hormone (TSH)', 'HGT (Haemo Glucose Test)']
        correct_map_known_items = {
            'SURGICAL BLADE 15 SWAN MARTON': [[' ', '35.00', '5.00'], ['1', '35.00', '35.00']],
            'Chemotherapy Level 3- Hospital Admin Cha': [[' ', '3.000.00', '3,000.00'], ['1', '3,000.00', '3,000.00']],
            'Renal Profile': [[' ', '1,820.00', ',820.00'], ['1', '1,820.00', '1,820.00']],
            'CORTEX SCREW 3.5M SELF TAP 404.810-50 AO': [['2', '651-42', '1,302.84'], ['2', '651.42', '1,302.84']],
            'Cross match': [[' ', '80.00', '280.00'], ['1', '280.00', '280.00']],
            'Thyroid stimulating hormone (TSH)': [[' ', '650.00', '550.00'], ['1', '550.00', '550.00']],
            'HGT (Haemo Glucose Test)': [[' ', '100.Q0', '100.00'], ['1', '100.00', '100.00']],

        }
        for d in dic2:
            # print('mmddd22==', dic2[d])
            try:
                if dic2[d][1].strip(' -,.') in known_items:
                    if dic2[d][1].strip(' -,.') in correct_map_known_items and dic2[d][3:] == \
                            correct_map_known_items[dic2[d][1].strip(' -,.')][0]:
                        print('for parti in index 1', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:3] + correct_map_known_items[neww[1].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['Economy 5 Bed- Half day']
        correct_map_known_items = {
            'Economy 5 Bed- Half day': [[' ', '350.00', '850.00'], ['1', '850.00', '850.00']],

        }
        for d in dic2:
            try:
                if dic2[d][1].strip(' -,.') in known_items:
                    if dic2[d][1].strip(' -,.') in correct_map_known_items and dic2[d][3:] == \
                            correct_map_known_items[dic2[d][1].strip(' -,.')][0]:
                        print('for parti in index 2 like accomodations ', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:3] + correct_map_known_items[neww[1].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['9 Statement Reference No : 200000141934', 'Statement Reference No : 190000327507',
                       'WN Statement Reference No : 190000327554',
                       '10 00 Statement Reference No : 200000286770']
        correct_map_known_items = {
            '9 Statement Reference No : 200000141934': [[' ', '200.52-'], [' ', '2200.52-']],
            'Statement Reference No : 190000327507': [[' ', '1.781.95'], [' ', '1,781.95']],
            'WN Statement Reference No : 190000327554': [[' ', '50.84'], [' ', '150.84']],
            '10 00 Statement Reference No : 200000286770': [[' ', '15.48-'], [' ', '45.48-']],

        }
        for d in dic2:
            try:
                if dic2[d][1].strip(' -,.') in known_items:
                    if dic2[d][1].strip(' -,.') in correct_map_known_items and dic2[d][4:] == \
                            correct_map_known_items[dic2[d][1].strip(' -,.')][0]:
                        print('for medicalconsumable itemssss', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:4] + correct_map_known_items[neww[1].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        # //////////////////////////
    # //////////////////////////
    if hospital == 'reliance_1':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('md111==', dic2[d])
            if d==1 and dic2[d][0] not in head_list:
                listnw = ['Head', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq-1] = listnw
            if d>2 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d-1][2] and 'Subtotal' not in dic2[d-1][3] and 'Subtotal' not in dic2[d-1][4] and \
                     'Subtotal' not in dic2[d-2][2] and 'Subtotal' not in dic2[d-2][3] and 'Subtotal' not in dic2[d-2][4]:
                print('add abt')
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq+=1
                dic1[lq-1] = listnw
            if d==len(dic2) and dic2[d][1]!='Subtotal' and dic2[d-1][1]!='Subtotal':
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq+1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            if dic2[d][1].__contains__('tatement Ref') and 'tatement Ref' not in dic2[d][0]:
                dic2[d][0] = dic2[d][0]+' '+dic2[d][1]
                dic2[d][1] = ' '
            if dic2[d][0].__contains__('tatement Ref') and (dic2[d][5]== ' ' or dic2[d][5]!= ' '):
                dic2[d][3] = ' '
                dic2[d][4] = ' '
            if dic2[d][0].__contains__('tatement Ref'):
                dic2[d][1] = dic2[d][0]
            if dic2[d][0].__contains__('tatement Ref'):
                dic2[d][4] = dic2[d][5]

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'reliance_daycare':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('md111==', dic2[d])
            if d > 2 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d-1][2] and 'Subtotal' not in dic2[d - 2][2]:
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            if d==len(dic2) and dic2[d][2]!='Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'SIMS':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('md111==', dic2[d])
            if dic2[d][0] == 'Service Total':
                dic2[d][5] = ' '
            if d > 1 and len(re.findall('\d\s?\.\s?\d', dic2[d][5])) == 1 and dic2[d][0] != ' ' and (
                    'Insurance' in dic2[d][0] or 'insurance' in dic2[d][0]) and dic2[d - 1][0] not in head_list:
                print('for adding Head before Insurance Line')
                listnw = ['Head', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['11 OT MISCELLANEOUS', '14 UREA', '3 SINGLE 600']
        correct_map_known_items = {
            '11 OT MISCELLANEOUS': [['1.00', '2500.01'], ['1.00', '2500.00']],
            '14 UREA': [['1.00', '270:00'], ['1.00', '270.00']],
            '3 SINGLE 600': [[' ', '2400.01'], [' ', '2400.0']],
        }
        for d in dic2:
            print('mmddd22==', dic2[d])
            try:
                if dic2[d][0].strip(' -,.') in known_items:
                    if dic2[d][0].strip(' -,.') in correct_map_known_items and dic2[d][4:] == \
                            correct_map_known_items[dic2[d][0].strip(' -,.')][0]:
                        print('itemsss00', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:4] + correct_map_known_items[neww[0].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'SIMS-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('md111==', dic2[d])
            if dic2[d][3] in dic2[d][2]:
                dic2[d][2] = dic2[d][2].replace(dic2[d][3], ' ')
            if dic2[d][3] != ' ' and (
                    len(re.findall('\d{1}', dic2[d][3][0])) == 1 or len(re.findall('\d{2}', dic2[d][3][0])) == 1):
                print('if qty is with particular')
                text = dic2[d][3]
                if len(re.findall('\d{2}', dic2[d][3].split()[0])) == 1:
                    matchqty = re.search(r'\d{2}\s', text)
                elif len(re.findall('\d{1}', dic2[d][3].split()[0])) == 1:
                    matchqty = re.search(r'\d{1}\s', text)
                dic2[d][2] = matchqty.group().replace(' ', '')
                dic2[d][3] = dic2[d][3].replace(matchqty.group(), '')
            if dic2[d][2] != ' ' and (
                    len(re.findall('\d{1}', dic2[d][2][0])) == 1 or len(
                re.findall('\d{2}', dic2[d][2][0])) == 1) and len(dic2[d][2].split()) >= 2:
                print('if qty is with particular in 2nd indx')
                text = dic2[d][2]
                if len(re.findall('\d{2}', dic2[d][2][0])) == 1:
                    matchqty = re.search(r'\d{2}', text)
                elif len(re.findall('\d{1}', dic2[d][2][0])) == 1:
                    matchqty = re.search(r'\d{1}', text)
                dic2[d][2] = matchqty.group().replace(' ', '')

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['PAN 40MG TAB', 'RAPITUS 30MG 100ML SYRUP', 'MEZOLAM 5MG 5ML INJ', 'OPSITE - 45 CM X 55 CM',
                       'ROCUNIUM 50MG SML INJ',
                       'RESPIROMETER', 'ORSAID 8MG 2ML INJ', 'IV SET VENTED WITH LUER LOCK - RMS', 'SUPACEF 1.5GM INJ',
                       'WATER FOR INJECTION - 10ML',
                       'VICRYL 3-0 NW 2328 - J&J', 'ARKAMIN 100MCG TAB', 'NS 100ML - CLARIS', 'OPSITE - 45 CM x 55 CN',
                       'JLTRASOUND STERILE GEL 20ML SACHET - AL 090118',
                       'BUPICAIN HEAVY INJ', 'PALACOS BONE CEMENT GENTAMYCIN - 40 ( 94784926', 'POSIFLUSH SP 3ML - BD',
                       'ARKAMIN 100MCG TAB',
                       'BLOOD SET - ROMSON', 'IV SET VENTED WITH LUER', 'PREGAMET 75MG CAP', 'EMESET 4MG 2ML INJ',
                       'MYOSTIGMIN 2.5MG SML INJ',
                       'ARTACIL 25MG 2.5ML INJ']
        correct_map_known_items = {
            'PAN 40MG TAB': [['12.00', '8.40'], ['12.00', '18.40']],
            'RAPITUS 30MG 100ML SYRUP': [['12.00', 'go.C'], ['12.00', '90.0']],
            'MEZOLAM 5MG 5ML INJ': [['12.00', ' '], ['12.00', '32.00']],
            'OPSITE - 45 CM X 55 CM': [['5.00', '374.!'], ['5.00', '874.5']],
            'ROCUNIUM 50MG SML INJ': [['5.00', '$29.00'], ['5.00', '629.00']],
            'RESPIROMETER': [['5.00', '$50.00'], ['5.00', '550.00']],
            'ORSAID 8MG 2ML INJ': [['12.00', '68.18'], ['12.00', '168.18']],
            'IV SET VENTED WITH LUER LOCK - RMS': [['5.00', '$14.00'], ['5.00', '414.00']],
            'SUPACEF 1.5GM INJ': [['12.00', '590.70'], ['12.00', '690.70']],
            'WATER FOR INJECTION - 10ML': [['5.00', '2.10'], ['5.00', '32.10']],
            'VICRYL 3-0 NW 2328 - J&J': [['5.00', '$30.00'], ['5.00', '630.00']],
            'ARKAMIN 100MCG TAB': [['12.00', '4.0C'], ['12.00', '4.00']],
            'NS 100ML - CLARIS': [['5.00', '17.3:'], ['5.00', '17.33']],
            'OPSITE - 45 CM x 55 CN': [['5.00', '$74.50'], ['5.00', '874.50']],
            'JLTRASOUND STERILE GEL 20ML SACHET - AL 090118': [['5.00', '250.0c'], ['5.00', '250.00']],
            'BUPICAIN HEAVY INJ': [['0.00', '25.3C'], ['0.00', '25.30']],
            'PALACOS BONE CEMENT GENTAMYCIN - 40 ( 94784926': [['5.00', '1,940.OC'], ['5.00', '4,940.00']],
            'POSIFLUSH SP 3ML - BD': [['12.00', '97.5'], ['12.00', '197.5']],
            'ARKAMIN 100MCG TAB': [['12.00', '12.0C'], ['12.00', '12.00']],
            'BLOOD SET - ROMSON': [['5.00', '149.0C'], ['5.00', '149.00']],
            'IV SET VENTED WITH LUER': [['12.00', '302.0C'], ['12.00', '302.00']],
            'PREGAMET 75MG CAP': [['12.00', '16.8:'], ['12.00', '16.83']],
            'EMESET 4MG 2ML INJ': [['12.00', '12.1'], ['12.00', '12.00']],
            'MYOSTIGMIN 2.5MG SML INJ': [['12.00', '23.1'], ['12.00', '23.00']],
            'ARTACIL 25MG 2.5ML INJ': [['12.00', '144.!'], ['12.00', '144.5']],
        }
        for d in dic2:
            print('mmddd22==', dic2[d])
            try:
                if dic2[d][4].strip(' -,.') in known_items:
                    if dic2[d][4].strip(' -,.') in correct_map_known_items and dic2[d][7:] == \
                            correct_map_known_items[dic2[d][4].strip(' -,.')][0]:
                        print('itemsss00', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:7] + correct_map_known_items[neww[4].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'QRG':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('md111==', dic2[d])

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'action':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('md111==', dic2[d])

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'bombay':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('md111==', dic2[d])
            if dic2[d][4] != ' ' and dic2[d][5] != ' ' and dic2[d][5] in dic2[d][4] and dic2[d][4] != dic2[d][5]:
                dic2[d][4] = dic2[d][4].replace(dic2[d][5], '')
            if dic2[d][1].__contains__('MEDICINES'):
                dic2[d][4] = ' '
            if dic2[d][1].__contains__('Total For') and dic2[d][4]!= ' ':
                dic2[d][4] = ' '

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'bombay-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('md111==', dic2[d])
            if d == 1 and dic2[d][0] != 'Pharmacy':
                listnw = ['Pharmacy', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                listnw = [' ', 'Total', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'jaypee':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if dic2[d][0] != ' ' and dic2[d][0] not in head_list and dic2[d].count(' ') <= 3 and 'Total' in dic2[d][0]:
                dic2[d][0] = dic2[d][0].replace('Total', 'total')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'rainbow':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            for i in head_list:
                if d > 1 and i in dic2[d][0] and 'Total' in dic2[d - 1][2] and dic2[d].count(' ') <= 3 and i == \
                        dic2[d][0].split()[0]:
                    print('header and line merged')
                    listnw = [i, ' ', ' ', ' ', ' ', ' ']
                    dic1[lq] = dic2[d]
                    dic1[lq - 1] = dic2[d - 1]
                    lq += 1
                    dic1[lq - 1] = listnw
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][0] == dic2[d][0]:
                dic2[d][0] = dic2[d][0].lower()
            if d > 1 and d < len(dic2) and dic2[d][0] in src_dc['merge_set'].split(',') and dic2[d - 1][2].__contains__(
                    'Total'):
                dic2[d - 1][2] = dic2[d - 1][2].replace('Total', 'SUBTOTAL')
            if d>1 and d<len(dic2) and dic2[d][0] in src_dc['merge_set'].split(',') and dic2[d-1][3].__contains__('Total'):
                dic2[d-1][3] = dic2[d-1][3].replace('Total','SUBTOTAL')
            if d > 1 and dic2[d][2].__contains__('Total') and dic2[d - 1][2].__contains__('Total'):
                print('replacing total in d-1 2nd indx')
                dic2[d - 1][2] = dic2[d - 1][2].replace('Total', 'SUBTOTAL')
            if d > 1 and dic2[d][3].__contains__('Total') and dic2[d - 1][1].__contains__('Total'):
                print('replacing total in d-1 1st indx')
                dic2[d - 1][1] = dic2[d - 1][1].replace('Total', 'SUBTOTAL')
            if d > 1 and dic2[d][2].__contains__('Total') and dic2[d - 1][1].__contains__('Total'):
                print('replacing total in d-1 1st indx')
                dic2[d - 1][1] = dic2[d - 1][1].replace('Total', 'SUBTOTAL')
            if d > 1 and dic2[d][2].__contains__('Total') and dic2[d - 1][3].__contains__('Total'):
                print('replacing total in d-1 3rd indx')
                dic2[d - 1][3] = dic2[d - 1][3].replace('Total', 'SUBTOTAL')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'rainbow1':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if d > 1 and dic2[d][2] == 'TOTAL':
                print('moving total form 2nd index to 0th index')
                dic2[d][0] = dic2[d][2]
                dic2[d][2] = ' '
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'rainbow_daycare':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])

            if d == len(dic2) and dic2[d][2] != 'Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'sarvodaya_1':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmddd', dic2[d])
            if dic2[d][1] == dic2[d][2]:
                dic2[d][1] = ' '
            if dic2[d][4].__contains__(' Days'):
                dic2[d][4] = dic2[d][4].replace(' Days', '')
            if dic2[d][1] in dic2[d][2] and dic2[d][1] != ' ' and dic2[d][2] != ' ':
                dic2[d][2] = dic2[d][2].replace(dic2[d][1], '')
            if dic2[d][1] == ' ' and len(dic2[d][0].split()) >= 2 and dic2[d][2] != ' ' and len(
                    re.findall('\w+\d+', dic2[d][0].split()[1])) == 1 and \
                    dic2[d].count(' ') <= 3:
                print('if date and code togther and in 0th indx')
                text = dic2[d][0]
                if len(re.findall('\w+\d+', dic2[d][0].split()[1])) == 1:
                    matchcode = re.search(r'\w+\d+', text.split()[1])
                dic2[d][1] = matchcode.group()
                dic2[d][0] = dic2[d][0].replace(matchcode.group(), '')
                print('mactcode', matchcode.group())
            if dic2[d][2] not in dic2[d][0] and len(re.findall('\d+\-\d+\-\d+', dic2[d][0])) == 1 and dic2[d][
                2] != ' ' and len(dic2[d][0].split()) > 3:
                print('if line divided in 0th and 2nd indx')
                text = dic2[d][0]
                if len(re.findall('\d+\-\d+\-\d+', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d+\-\d+\-\d+', text)
                dic2[d][2] = text.replace(matchdate.group(), '') + ' ' + dic2[d][2]
                dic2[d][0] = matchdate.group()

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'sarvodaya-pharma' or hospital == 'Felix_N15239-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmddd22==', dic2[d])
            try:
                if dic2[d][0] == 'Sales':
                    dic2[d][0] = 'MEDICINE'
                if dic2[d][0] == 'Return':
                    dic2[d][0] = 'MEDICINE-RETURN'
                if dic2[d][4]==' ' and dic2[d][5]==' ' and len(dic2[d][3])>10 and dic2[d][3].__contains__('NOS'):
                    print('lllllnnnnnmmmmmmm',dic2[d],len(dic2[d][3].split('NOS')[1].split()))
                    if len(dic2[d][3].split('NOS')[1].split())==2:
                        print('lllllnnnnnmmmmmmm111',dic2[d])
                        four,five=dic2[d][3].split('NOS')[1].split()
                        three = dic2[d][3].split('NOS')[0]+' NOS'
                        thl = copy.deepcopy(dic2[d])
                        thl.pop(3)
                        thl.insert(3,three)
                        thl.pop(4)
                        thl.insert(4,four)
                        thl.pop(5)
                        thl.insert(5,five)
                        dic1[lq] = thl
                        lq += 1
                        print('coooobbb',dic2[d],thl)
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'sarvodaya_2':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmddd', dic2[d])
            if dic2[d][1] == dic2[d][2]:
                dic2[d][1] = ' '
            if dic2[d][1] != ' ' and dic2[d][1].__contains__('Room Rent') and dic2[d][2] == ' ':
                dic2[d][2] = dic2[d][1]
                dic2[d][1] = ' '
            # if d>1 and dic2[d][0] == ' ' and dic2[d][1] == ' ' and dic2[d-1][2]!= ' ' and dic2[d].count(' ')<=4 and dic2[d-1].count(' ')>=5:
            #     print('line merge with <=4 and >=5 commented')
            #     dic2[d-1][3:] = dic2[d][3:]
            #     dic2[d][3:] = [' ', ' ', ' ', ' ', ' ']
            if dic2[d][1] == ' ' and len(dic2[d][0].split()) >= 2 and dic2[d][2] != ' ' and len(
                    re.findall('\w+\d+', dic2[d][0].split()[1])) == 1 and \
                    dic2[d].count(' ') <= 3:
                print('if date and code togther and in 0th indx')
                text = dic2[d][0]
                if len(re.findall('\w+\d+', dic2[d][0].split()[1])) == 1:
                    matchcode = re.search(r'\w+\d+', text.split()[1])
                dic2[d][1] = matchcode.group()
                dic2[d][0] = dic2[d][0].replace(matchcode.group(), '')
                print('mactcode', matchcode.group())
            if dic2[d][2] not in dic2[d][0] and len(re.findall('\d+\-\d+\-\d+', dic2[d][0])) == 1 and dic2[d][
                2] != ' ' and len(dic2[d][0].split()) > 3:
                print('if line divided in 0th and 2nd indx')
                text = dic2[d][0]
                if len(re.findall('\d+\-\d+\-\d+', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d+\-\d+\-\d+', text)
                dic2[d][2] = text.replace(matchdate.group(), '') + ' ' + dic2[d][2]
                dic2[d][0] = matchdate.group()
            if dic2[d][3] != ' ' and len(dic2[d][3].split()) == 3 and dic2[d][3].split()[-1] == 'Days':
                print('if rate qty together')
                a, b, c = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if dic2[d][4].__contains__(' Days'):
                dic2[d][4] = dic2[d][4].replace(' Days', '')
            if dic2[d][1] in dic2[d][2] and dic2[d][1] != ' ' and dic2[d][2] != ' ':
                dic2[d][2] = dic2[d][2].replace(dic2[d][1], '')
                dic2[d][2] = dic2[d][2].strip()
            # if d > 2 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal' and dic2[d - 2][1] != 'Subtotal':
            #     print('yesssssssssssss if tot not before header commented')
            #     dic1[lq] = dic2[d]
            #     dic1[lq - 1] = dic2[d - 1]
            #     lq += 1
            #     dic1[lq - 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ', ' ', ' ']
            if dic2[d][6] != ' ' and dic2[d][7] != ' ':
                dic2[d][6] = ' '
                dic2[d][7] = ' '

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'sarvodaya-2':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmddd', dic2[d])
            if dic2[d][3]!= ' ' and len(dic2[d][3].split()) == 3 and dic2[d][3].split()[-1] == 'Days':
                print('if rate qty together')
                a,b,c = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if dic2[d][4].__contains__(' Days'):
                dic2[d][4] = dic2[d][4].replace(' Days','')

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'metro':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('mmdddd===', dic2[d])
            if d > 1 and d==len(dic2) and  dic2[d][2].__contains__('Total Amount') and dic2[d-1][2].__contains__('Total Amount'):
                print('changing total amount to uppercase')
                dic2[d][2] = ' '
            if dic2[d][3]!= ' ' and len(dic2[d][3].split())>=2 and dic2[d][4]== ' ':
                print('if Expiry and rate in 3rd indx')
                text = dic2[d][3].split()
                dic2[d][4] = text[-1]
            if dic2[d][2]!= ' ' and len(dic2[d][2].split())>=3 and dic2[d][4]== ' ' and dic2[d][3]== ' ':
                print('if batch Expiry and rate in 2nd indx')
                text = dic2[d][2].split()
                dic2[d][4] = text[-1]
                dic2[d][3] = text[-2]
            print('mmdddd===', dic2[d])
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'mazumdarbangalore':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Narayana_N14358':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f>2 and dic2[d][0] in head_list and dic2[d-1][4] != 'Total':
                print('add sbt',dic2[d-1],dic2[d])
                #dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', ' ', ' ', 'Total', ' ']
                lq += 1
            if f > 1 and d==fn  and dic2[d][4]!='Total' :
                print('add sbt',dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', ' ', ' ', ' ', 'Total', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Breach':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['410-Bed Charges - DELUXE-A',

                       ]
        correct_map_known_items = {
            '410-Bed Charges - DELUXE-A': [['1', '500.00', '9500.00'], ['1', '9500.00', '9500.00']],


        }
        for d in dic2:
            print('mmddd22==', dic2[d])
            try:
                if dic2[d][0].strip(' -,.') in known_items:
                    if dic2[d][0].strip(' -,.') in correct_map_known_items and dic2[d][3:] == \
                            correct_map_known_items[dic2[d][0].strip(' -,.')][0]:
                        print('itemsss', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:3] + correct_map_known_items[neww[0].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'star':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if d > 1 and dic2[d][3].__contains__('Total') and dic2[d - 1][3].__contains__('Total'):
                dic2[d][3] = dic2[d][3].replace('Total', '')
            if d == len(dic2) and 'Total' not in dic2[d][3] and 'Total' not in dic2[d - 1][3] and 'Total' not in \
                    dic2[d - 2][3]:
                listnw = [' ', ' ', ' ', 'Total', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'star-pharma':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if d == 1 and dic2[d][0] != 'MEDICINES/CONSUMABLES':
                listnw = ['MEDICINES/CONSUMABLES', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'star_daycare':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if d==1 and dic2[d][0] != 'Head':
                listnw = ['Head', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq-1] = listnw
            if d==len(dic2) and dic2[d][1]!='Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq+1] = listnw


            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'lilavati':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if dic2[d][2].__contains__('Food Services'):
                dic2[d][5] = ' '
            if d>1 and dic2[d][0] in head_list and dic2[d-1][1]!= 'Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq+=1
                dic1[lq-1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']


            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'lilavati-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        for d in dic2:
            f +=1
            if f==1:
                dic1[lq] = ['MEDICINES / CONSUMABLES',' ',' ',' ',' ',' ']
                lq +=1
            # print('mmddd22==', dic2[d])
            try:
                if (len(dic2[d][0])>=2 and dic2[d].count(' ')==5 and dic2[d][0] not in head_list) or dic2[d][1]=='Subtotal':
                    print('iiiiiiiitttttssss',dic2[d])
                    continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
        ld=len(dicA)
        dicA[ld+1]=[' ','Subtotal',' ',' ',' ',' ']
    # //////////////////////////
    if hospital == 'kailash':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if len(re.findall('\d\/\w{3}\/\d', dic2[d][0])) == 2 and 'to' in dic2[d][0]:
                dic2[d][0] = dic2[d][0].replace('to', '-')
            if dic2[d][0] == '29/@ct/2021 to 01/Nov/2021':
                dic2[d][0] = '29/Oct/2021 to 01/Nov/2021'
            for i in head_list:
                if d > 1 and i in dic2[d][0] and dic2[d].count(' ') != 5 and dic2[d].count(' ') <= 2:
                    print('if page is tilted and header and lineitem in same line')
                    listnw = [i, ' ', ' ', ' ', ' ', ' ']
                    dic2[d][0] = dic2[d][0].replace(i, '')
                    dic1[lq] = dic2[d]
                    dic1[lq - 1] = dic2[d - 1]
                    lq += 1
                    dic1[lq - 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'kailash-pharma':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['$ 5ML OMNIVAN', 'SUCTION CATH 16 NO.(POLYMED)', 'VACCU SUCK SUCTION SET', 'EMESET INJ 4MG'

                       ]
        correct_map_known_items = {
            '$ 5ML OMNIVAN': [['1.0', 'PCS', '14.00.', '14.00'], ['1.0', 'PCS', '14.00', '14.00']],
            'SUCTION CATH 16 NO.(POLYMED)': [['1.0', 'PCS', '61.00 .', '61.00'], ['1.0', 'PCS', '61.00', '61.00']],
            'VACCU SUCK SUCTION SET': [['1.0', 'PCS', '106.00', '406.00'], ['1.0', 'PCS', '406.00', '406.00']],
            'EMESET INJ 4MG': [['3.0', 'PCS', '12.81 .', '-38.43'], ['3.0', 'PCS', '12.81', '-38.43']],

        }
        for d in dic2:
            print('mmddd22==', dic2[d])
            try:
                if dic2[d][0].strip(' -,.') in known_items:
                    if dic2[d][0].strip(' -,.') in correct_map_known_items and dic2[d][5:] == \
                            correct_map_known_items[dic2[d][0].strip(' -,.')][0]:
                        print('itemsss', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:5] + correct_map_known_items[neww[0].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['$ 5ML OMNIVAN',

                       ]
        correct_map_known_items = {
            '$ 5ML OMNIVAN': [['2.0', 'PCS', '14.00 .', '28.00'], ['2.0', 'PCS', '14.00', '28.00']],

        }
        for d in dic2:
            print('mmddd22==', dic2[d])
            try:
                if dic2[d][0].strip(' -,.') in known_items:
                    if dic2[d][0].strip(' -,.') in correct_map_known_items and dic2[d][5:] == \
                            correct_map_known_items[dic2[d][0].strip(' -,.')][0]:
                        print('itemsss', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:5] + correct_map_known_items[neww[0].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'bhailal':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if d > 1 and d < len(dic2) and dic2[d][2] == 'Subtotal' and dic2[d - 1][0] == dic2[d + 1][0] and dic2[
                d - 1].count(' ') == dic2[d + 1].count(' '):
                print('if same headers repeating example 220100570496 operation charges')
                dic2[d][2] = ' '
                dic2[d][5] = ' '
            if d > 1 and dic2[d][2] == 'Subtotal' and dic2[d - 1][0] in head_list and len(
                    re.findall('\d\.\d', dic2[d][5])) == 1:
                print('adding line item')
                listnw = [dic2[d - 1][0] + 's', ' ', ' ', ' ', dic2[d][5], dic2[d][5]]
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d > 1 and d < len(dic2) and len(re.findall('\D{8}\s\D{2}\s\D{3}\s\D{3}', dic2[d][0])) == 1 and len(
                    re.findall('\D{8}\/\D{8}\s\D{5}', dic2[d - 1][0])) == 1 and dic2[d - 1][
                0] == 'Medicine/Surgical Items':
                print('removing discount line and adding header with s')
                dic2[d][0] = dic2[d - 1][0] + 's'
                dic2[d][4] = dic2[d][5]

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['Radiology Chargess', 'Op. Theatre Charge - O.T. No.1 [35% of 6350]', '1.V Drip (Per Day)'

                       ]
        correct_map_known_items = {
            'Radiology Chargess': [[' ', '900.00', '900.00'], ['1', '7900.00', '7900.00']],
            'Op. Theatre Charge - O.T. No.1 [35% of 6350]': [[' ', '5722.50."5', '5722.501"'],
                                                             ['1', '5722.5', '5722.5']],
            '1.V Drip (Per Day)': [[' ', '250.00', '500.00:'], ['2', '250.00', '500.00']],

        }
        for d in dic2:
            print('mmdddafter==', dic2[d])
            try:
                if dic2[d][0].strip(' -,.') in known_items:
                    if dic2[d][0].strip(' -,.') in correct_map_known_items and dic2[d][3:] == \
                            correct_map_known_items[dic2[d][0].strip(' -,.')][0]:
                        print('itemsss', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:3] + correct_map_known_items[neww[0].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'bhailal1':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d], lq)
            if dic2[d][3].__contains__('Total'):
                # print('removing 1st and 0th index values in Total line')
                dic2[d][0] = ' '
                dic2[d][1] = ' '
            if dic2[d][3].__contains__('Total') and dic2[d - 1][3].__contains__('Total'):
                # print('removing extra Total')
                dic2[d][3] = ' '
                dic2[d][5] = ' '
            if d == len(dic2) and dic2[d][0] == 'Medicine' and len(re.findall('\d{4}\s\d{4}', dic2[d][5])) == 1 and \
                    dic2[d].count(' ') >= 2:
                # print('adding line below')
                listnw = [dic2[d][0] + 's', ' ', ' ', dic2[d][5].split()[-1], ' ', dic2[d][5].split()[-1]]
                listnw1 = [' ', ' ', ' ', 'Total', ' ', dic2[d][5].split()[-1]]
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
                dic1[lq + 2] = listnw1

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['COVID-19 Rose (General Ward) By Dr. Manish Mittal, By Dr. Atul Jani', 'Marigold ( General )',
                       'Followup Visit - Senior Consultants Dr. Sonia Golani', 'Isolation Grade - Il',
                       'Emergency Processing Fees - RT PCT',
                       'Qualitative detection of SARS-CoV-2 by GeneXpert RT-PCR "',
                       'Creatinine', 'Qualitative detection of SARS-CoV-2 by GeneXpert RT-PCR', 'ECG',
                       'Strip Method R.B.S',
                       'I.V. Drip (Per Day)'

                       ]
        correct_map_known_items = {
            'COVID-19 Rose (General Ward) By Dr. Manish Mittal, By Dr. Atul Jani': [[' ', '850', ' ', '8500'],
                                                                                    ['1', '8500', ' ', '8500']],
            'Marigold ( General )': [['. . . ... .', '.1200', ' ', '1200'], ['1', '1200', ' ', '1200']],
            'Followup Visit - Senior Consultants Dr. Sonia Golani': [['. .. . . .', '350 . .. . . .', ' ', '700'],
                                                                     ['2', '350', ' ', '700']],
            'Isolation Grade - Il': [[' ', ' ', ' ', '. 1800'], ['1', '1800', ' ', '1800']],
            'Emergency Processing Fees - RT PCT': [[' ', '1 100', ' ', '1 100'], ['1', '1100', ' ', '1100']],
            'Qualitative detection of SARS-CoV-2 by GeneXpert RT-PCR "': [[' ', '1 100', ' ', '1 100'],
                                                                          ['1', '1100', ' ', '1100']],
            'Creatinine': [[' ', '..160', ' ', '160 '], ['1', '160', ' ', '160']],
            'Qualitative detection of SARS-CoV-2 by GeneXpert RT-PCR': [[' ', '1 100', ' ', '100'],
                                                                        ['1', '1100', ' ', '1100']],
            'ECG': [[' ', '90,', ' ', '90'], ['1', '330', ' ', '330']],
            'Strip Method R.B.S': [[' ', '330', ' ', '330'], ['1', '90', ' ', '90']],
            'I.V. Drip (Per Day)': [[' ', '259.......', ' ', '250'], ['1', '250', ' ', '250']],

        }
        for d in dic2:
            print('mmddd22==', dic2[d])
            try:
                if dic2[d][0].strip(' -,.') in known_items:
                    if dic2[d][0].strip(' -,.') in correct_map_known_items and dic2[d][2:] == \
                            correct_map_known_items[dic2[d][0].strip(' -,.')][0]:
                        print('itemsss', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:2] + correct_map_known_items[neww[0].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['ECG', '1.V. Drip (Per Day)', 'Tea'

                       ]
        correct_map_known_items = {
            'ECG': [[' ', '250', ' ', '250'], ['1', '330', ' ', '330']],
            '1.V. Drip (Per Day)': [[' ', ' ', ' ', ' '], ['1', '250', ' ', '250']],
            'Tea': [[' ', ' ', ' ', '15'], ['1', '15', ' ', '15']],

        }
        for d in dic2:
            print('mmddd22==', dic2[d])
            try:
                if dic2[d][0].strip(' -,.') in known_items:
                    if dic2[d][0].strip(' -,.') in correct_map_known_items and dic2[d][2:] == \
                            correct_map_known_items[dic2[d][0].strip(' -,.')][0]:
                        print('itemsss', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:2] + correct_map_known_items[neww[0].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'bhailal-pharma':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d], lq)
            if d > 1 and d < len(dic2) and len(re.findall('\d\.\d', dic2[d][4])) == 1 and len(
                    re.findall('\d\.\d', dic2[d][5])) == 1 and len(
                    re.findall('\D{5}\s\D{5}\s', dic2[d - 1][3])) == 1 and \
                    dic2[d - 1][3].__contains__('Total'):
                print('adding returns')
                listnw = ['Returns', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == 1 and len(re.findall('\d\.\d', dic2[d][4])) == 1 and len(re.findall('\d\.\d', dic2[d][5])) == 1:
                print('Issues in first line')
                listnw = ['Issues', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['ELECTRO SURGICAL PENCIL (NEW)', 'SOD.CHLORIDE 0.9% 100 ML ECOFLAC PLUS B20B073E'

                       ]
        correct_map_known_items = {
            'ELECTRO SURGICAL PENCIL (NEW)': [['1.00', '1.00', '180.00', '80.00'],
                                              ['1.00', '1.00', '180.00', '180.00']],
            'SOD.CHLORIDE 0.9% 100 ML ECOFLAC PLUS B20B073E': [['1.00', '1.00', '87.02', '37.02'],
                                                               ['1.00', '1.00', '37.02', '37.02']],

        }
        for d in dic2:
            print('mmddd==', dic2[d])
            try:
                if dic2[d][0].strip(' -,.') in known_items:
                    if dic2[d][0].strip(' -,.') in correct_map_known_items and dic2[d][2:] == \
                            correct_map_known_items[dic2[d][0].strip(' -,.')][0]:
                        print('itemsss', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:2] + correct_map_known_items[neww[0].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Holyspirit':
        dic2 = dicA
        dic0 = {}
        dic3 = {}
        dic4 = {}
        dic5 = dict()
        lq = 1
        k = 0
        sliceddict = {}
        for d in dic2:
            print('mmdd===', dic2[d])
            if len(re.findall('\d\/\d{2}\/\d', dic2[d][5])) == 1 or dic2[d][5] == ' ' or len(re.findall('\d\/\d\s\d\/\d', dic2[d][5])) == 1:
                dic2[d][5] = ' '
            if len(re.findall('\D', dic2[d][4])) >= 1:
                dic2[d][4] = ' '
            if dic2[d][0].__contains__('TOTAL') and len(re.findall('\d\s?\.\s?\d', dic2[d][6])) == 1:
                listnw = [dic2[d][0].replace('TOTAL ', '', 1), ' ', ' ', ' ', ' ', ' ', ' ']
                dic0[k + 1111] = listnw
                sliceddict = dict(itertools.islice(dic2.items(), k, d))
                dic3 = {**dic0, **sliceddict}
                for i, j in dic3.items():
                    dic4[i] = j
                dic0.popitem()
                k = d
                l = 0
                for i, j in dic4.items():
                    dic5[l] = j
                    l += 1
            # print('dic5==', dic5)
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic5

        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd22===', dic2[d])
            if d > 1 and d < len(dic2) and dic2[d][0] == 'SURGERY CHARGES':
                print('for surgery charges next line amount')
                dic2[d + 1][6] = '0.00'
            if d>1 and dic2[d][3]!= ' ' and dic2[d][6]!= ' ' and dic2[d].count(' ')==5 and dic2[d-1][6]==' ':
                print('if d == 5 d-1 3')
                dic2[d-1][6] = dic2[d][6]
                dic2[d][6] = ' '
            #

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Bellevue':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d], lq)
            if dic2[d][1] == 'Subtotal B1329081':
                dic2[d][1] = 'B1329081'
            if d > 2 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal' and dic2[d - 2][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Bellevue-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d], lq)
            if dic2[d][5] == '0.00' or dic2[d][5] == '00' or dic2[d][5] == '.00':
                dic2[d][5] = ' '
            if dic2[d][5].__contains__('Sales lota'):
                dic2[d][5] = 'Sales Total'
            if d == 1 and dic2[d][0] != 'Pharmacy':
                print('if sales is missing')
                listnw = ['Pharmacy', ' ', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d > 1 and dic2[d][0] == 'Sales Returns' and 'Total' not in dic2[d - 1][5]:
                print('if sales total is missing')
                listnw = [' ', ' ', ' ', ' ', ' ', 'Sales Total', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d > 1 and len(re.findall('\d\.\d', dic2[d][5])) == 1 and dic2[d][6] == ' ':
                print('changing rate value')
                dic2[d][6] = dic2[d][5]
                dic2[d][5] = ' '
            if d > 1 and dic2[d][5] == ' ' and dic2[d][6] != ' ' and dic2[d][7] != ' ' and dic2[d - 1][5] == ' ' and \
                    dic2[d - 1][6] == ' ' and dic2[d - 1][7] == ' ' and dic2[d][0] not in head_list and dic2[d - 1][
                0] not in head_list and \
                    dic2[d][2] != ' ' and dic2[d - 1][2] != ' ':
                print('if qty,rate,amt ared divided')
                dic2[d - 1][5] = dic2[d][5]
                dic2[d - 1][6] = dic2[d][6]
                dic2[d - 1][7] = dic2[d][7]
                dic2[d - 1][2] = dic2[d - 1][2] + dic2[d][2]
                dic2[d][2] = ' '
                dic2[d][5] = ' '
                dic2[d][6] = ' '
                dic2[d][7] = ' '

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'woodlands':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d], lq)

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'woodlands-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d], lq)

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'wockhardt':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if d>1 and dic2[d][0] in head_list and dic2[d][7]!= ' ' and 'Total' not in dic2[d][0]:
                print('if Total is absent')
                dic2[d][0] = dic2[d][0]+'Total'
            if dic2[d][0].__contains__('Total') and dic2[d].count(' ') <= 4:
                dic2[d][0] = dic2[d][0].replace('Total', 'TOTAL')
            if dic2[d][0].__contains__('total') and dic2[d].count(' ') == 6 and dic2[d][7] != ' ':
                dic2[d][0] = dic2[d][0].replace('total', 'Total')
            if d > 2 and dic2[d][0] in head_list and 'Tota' not in dic2[d - 1][0] and 'Tota' not in dic2[d - 2][0]:
                listnw = ['Total', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'wockhardt1':
        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['Emergency Charges',

                       ]
        correct_map_known_items = {
            'Emergency Charges': [['18700.00', ' ', '18700.00'], ['1', '18700.00', '18700.00']],

        }
        for d in dic2:
            print('mmddd22==', dic2[d])
            try:
                if dic2[d][0].strip(' -,.') in known_items:
                    if dic2[d][0].strip(' -,.') in correct_map_known_items and dic2[d][6:] == \
                            correct_map_known_items[dic2[d][0].strip(' -,.')][0]:
                        print('itemsss', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:6] + correct_map_known_items[neww[0].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'wockhardt2':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][0] in head_list:
                dic2[d][0] = dic2[d][0].lower()
            if dic2[d][3]!= ' ' and dic2[d][3].split()[0] == dic2[d][2]:
                print('if QTy in rate indx')
                text = dic2[d][3].split()
                dic2[d][3] = text[-1]
            if d > 1 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d - 1][2]:
                listnw = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'rubygeneral':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d], lq)
            if d > 1 and dic2[d][2].__contains__('TOTAL') and dic2[d - 1][2].__contains__('TOTAL'):
                dic2[d][2] = ' '
                dic2[d][5] = ' '
            if dic2[d][2] == '00' or dic2[d][2] == '0':
                print('if QTy is captured as 00')
                dic2[d][2] = ' '

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'kamakshi':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d], lq)

            if dic2[d][2] != ' ' and len(re.findall('\d+\.\d+', dic2[d][2])) == 1 and len(dic2[d][2].split()) >= 2:
                print('qty qith garbage value')
                text = dic2[d][2]
                if len(re.findall('\d+\.\d+', dic2[d][2])) == 1:
                    matchqty = re.search(r'\d+\.\d+', text)
                dic2[d][2] = matchqty.group()
            if dic2[d][0] != ' ' and len(re.findall('\d+\/\d+\/\d+', dic2[d][0])) == 1 and len(dic2[d][0].split()) >= 2:
                print('if date parti in 0th index')
                text = dic2[d][0]
                if len(re.findall('\d+\/\d+\/\d+', dic2[d][0])) == 1:
                    matchdate = re.search(r'\d+\/\d+\/\d+', text)
                dic2[d][1] = matchdate.group()
                dic2[d][0] = dic2[d][0].replace(matchdate.group(), '')
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and 'Subtotal' not in dic2[d - 1][1] and 'Subtotal' not in dic2[d - 2][1]:
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
            if len(dic2[d][3].split()) == 2 and len(re.findall('\d\.\d', dic2[d][3])) == 2:
                a, b = dic2[d][3].split()
                dic2[d][2] = a
                dic2[d][3] = b
            if len(dic2[d][2].split()) == 2 and len(re.findall('\d\.\d', dic2[d][2])) >= 1:
                a, b = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = b

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd11===', dic2[d])
            if len(re.findall('\d\.\d', dic2[d][3])) == 1 and (
                    dic2[d][2] == ' ' or len(re.findall('\D+\/\d+', dic2[d][2])) == 1):
                print('chainging rate values from 3rd to 2nd index')
                dic2[d][2] = dic2[d][3]
                dic2[d][3] = ' '
            if d > 2 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if dic2[d][2] != ' ' and dic2[d][3] == ' ' and dic2[d][5] == ' ' and dic2[d][0] != ' ' and dic2[d].count(
                    ' ') == 4:
                print('if extra val is added')
                dic2[d][2] = ' '
                dic2[d][0] = ' '

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'hinduja_N10188':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if dic2[d][0] in head_list and dic2[d].count(' ') <= 3:
                dic2[d][0] = dic2[d][0].lower()
            if d == len(dic2) and dic2[d][1] != 'Subtotal' and dic2[d - 1][1] != 'Subtotal':
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq + 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            if d > 2 and dic2[d][0] != ' ' and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal' and dic2[d - 2][
                1] != 'Subtotal':
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Sahyadri1':
        dic2 = dicA
        dic1 = {}
        # print('aaaannnuuusshhaa',dic2)
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if d >= 1 and d < len(dic2) and dic2[d][0] in head_list and dic2[d + 1][0] in head_list and dic2[d][0] == \
                    dic2[d + 1][0]:
                print('if header and subheader are same d, d+1')
                dic2[d + 1][0] = dic2[d + 1][0].lower()
            dic1[lq] = dic2[d]
            lq += 1
        # print('aaaannnuuusshhaa',dic1)
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['Administration Charges', 'Post Surgical Upto 2 Hrs'

                       ]
        correct_map_known_items = {
            'Administration Charges': [['1', '10,676.55 10,676.55* - ---', ' '], ['1', '10,676.55', '10,676.55']],
            'Post Surgical Upto 2 Hrs': [['1', '100.00', '400.00'], ['1', '400.00', '400.00']],

        }
        for d in dic2:
            print('mmddd22==', dic2[d])
            try:
                if dic2[d][0].strip(' -,.') in known_items:
                    if dic2[d][0].strip(' -,.') in correct_map_known_items and dic2[d][3:] == \
                            correct_map_known_items[dic2[d][0].strip(' -,.')][0]:
                        print('itemsss', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:3] + correct_map_known_items[neww[0].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Sahyadri1-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if d > 1 and (len(re.findall('\D\d{8}\s\D\d{8}\s\D{7}', dic2[d][0])) == 1) and (
                    len(re.findall('\d\/\d{2}\/\d', dic2[d - 1][1])) == 0 or len(
                re.findall('\d\/\d{2}\/\d', dic2[d - 1][1])) == 1) and (
                    len(re.findall('\D\s\D{3}\s\(\D{6}\)\s\D{9}\s\D{2}\s\d\s\D{2}\s\D{5}\s\D{4}\s\(\D{3}\s\D{2}',
                                   dic2[d - 1][0])) == 1) and len(re.findall('\d\.\d', dic2[d][5])) == 1 and \
                    dic2[d].count(' ') >= 3 and dic2[d - 1].count(' ') <= 2:
                print('for 220100769407 with 5th index replaced in d-1 5th index')
                dic2[d - 1][5] = dic2[d][5]
                dic2[d][5] = ' '
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue
            # if d>1 and dic2[d][0]=='Drugs/Medicines Avagard CHG Handrub 100ml Solution'

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['Ouphalac 150ml Syrup',
                       'Alliance II inflation / litho device (M00550620) Alliance || Inflation Syringe',
                       'MULTI 3V Plus Balloon Biliary Drainge Catheter 10', 'Germs Go 5Lit Hand Sanitizer', 'Optic)',
                       'Syringe 5ml Emerald Blister (BD', 'Myo Pyrolate 5ml Injection', 'Posiflush 10ml (BD)',

                       ]
        correct_map_known_items = {
            'Ouphalac 150ml Syrup': [[' ', '172.59', '72.59'], ['1', '172.59', '172.59']],
            'Alliance II inflation / litho device (M00550620) Alliance || Inflation Syringe': [
                ['.2', '.2 1 1,600.00', '11,600.00'], ['.2', '11,600.00', '11,600.00']],
            'MULTI 3V Plus Balloon Biliary Drainge Catheter 10': [['115,239.00', '15,239.00', '15,239.00'],
                                                                  ['1', '15,239.00', '15,239.00']],
            'Germs Go 5Lit Hand Sanitizer': [['50.00', '02', '50.00 0.00'], ['0.2', '50.00', '50.00']],
            'Optic)': [['1', ' ', '104.00'], ['1', '104.00', '104.00']],
            'Syringe 5ml Emerald Blister (BD': [['1', '10.00', '110.00'], ['1', '110.00', '110.00']],
            'Myo Pyrolate 5ml Injection': [['1', '02.40', '102.40'], ['1', '102.40', '102.40']],
            'Posiflush 10ml (BD)': [['1', '02.40', '102.40'], ['1', '102.40', '102.40']],
            'Posiflush 10ml (BD)': [['-11', '1.00', '-111.00'], ['-2', '-111.00', '-111.00']],

        }
        for d in dic2:
            print('mmddd22==', dic2[d])
            try:
                if dic2[d][0].strip(' -,.') in known_items:
                    if dic2[d][0].strip(' -,.') in correct_map_known_items and dic2[d][3:] == \
                            correct_map_known_items[dic2[d][0].strip(' -,.')][0]:
                        print('itemsss', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:3] + correct_map_known_items[neww[0].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    # if Issue is present then it is Sahyadri if issue is absent then it is sahyadri 1
    # //////////////////////////
    # //////////////////////////
    if hospital == 'Sahyadri-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if d > 1 and (len(re.findall('\D\d{8}\s\D\d{8}\s\D{7}', dic2[d][0])) == 1) and (
                    len(re.findall('\d\/\d{2}\/\d', dic2[d - 1][1])) == 0 or len(
                re.findall('\d\/\d{2}\/\d', dic2[d - 1][1])) == 1) and (
                    len(re.findall('\D\s\D{3}\s\(\D{6}\)\s\D{9}\s\D{2}\s\d\s\D{2}\s\D{5}\s\D{4}\s\(\D{3}\s\D{2}',
                                   dic2[d - 1][0])) == 1) and len(re.findall('\d\.\d', dic2[d][5])) == 1 and \
                    dic2[d].count(' ') >= 3 and dic2[d - 1].count(' ') <= 2:
                print('for 220100769407 with 5th index replaced in d-1 5th index')
                dic2[d - 1][5] = dic2[d][5]
                dic2[d][5] = ' '
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['Ouphalac 150ml Syrup',
                       'Alliance II inflation / litho device (M00550620) Alliance || Inflation Syringe',
                       'MULTI 3V Plus Balloon Biliary Drainge Catheter 10', 'Germs Go 5Lit Hand Sanitizer', 'Optic)',
                       'Syringe 5ml Emerald Blister (BD', 'Myo Pyrolate 5ml Injection', 'Posiflush 10ml (BD)',

                       ]
        correct_map_known_items = {
            'Ouphalac 150ml Syrup': [[' ', '172.59', '72.59'], ['1', '172.59', '172.59']],
            'Alliance II inflation / litho device (M00550620) Alliance || Inflation Syringe': [
                ['.2', '.2 1 1,600.00', '11,600.00'], ['.2', '11,600.00', '11,600.00']],
            'MULTI 3V Plus Balloon Biliary Drainge Catheter 10': [['115,239.00', '15,239.00', '15,239.00'],
                                                                  ['1', '15,239.00', '15,239.00']],
            'Germs Go 5Lit Hand Sanitizer': [['50.00', '02', '50.00 0.00'], ['0.2', '50.00', '50.00']],
            'Optic)': [['1', ' ', '104.00'], ['1', '104.00', '104.00']],
            'Syringe 5ml Emerald Blister (BD': [['1', '10.00', '110.00'], ['1', '110.00', '110.00']],
            'Myo Pyrolate 5ml Injection': [['1', '02.40', '102.40'], ['1', '102.40', '102.40']],
            'Posiflush 10ml (BD)': [['1', '02.40', '102.40'], ['1', '102.40', '102.40']],
            'Posiflush 10ml (BD)': [['-11', '1.00', '-111.00'], ['-2', '-111.00', '-111.00']],

        }
        for d in dic2:
            print('mmddd22==', dic2[d])
            try:
                if dic2[d][0].strip(' -,.') in known_items:
                    if dic2[d][0].strip(' -,.') in correct_map_known_items and dic2[d][3:] == \
                            correct_map_known_items[dic2[d][0].strip(' -,.')][0]:
                        print('itemsss', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:3] + correct_map_known_items[neww[0].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'yashoda' or hospital == 'yashodamalakpet_N3060':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if len(re.findall('\d\s?\.\s?\d', dic2[d][5])) == 1:
                dic2[d][5] = dic2[d][5].replace(' ', '')
            if d>1 and dic2[d][0] == dic2[d-1][0] and dic2[d][0] in head_list:
                print('to lowerrrr')
                dic2[d][0] = dic2[d][0].lower()

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['DR KASHINADHAM', 'HISTOPATHOLOGY - IV (PARAIFIN SECTION)', 'TOTAL ABDOMINAL HYSTRECTOMY',
                       'BILATERAL SAI PHINGO OOPHARECTOMY', 'ECG', 'SASHI KIRAN A', 'PATEN D_ET', 'LEFT',
                       'RIGID SIGMODOSCOPY'

                       ]
        correct_map_known_items = {
            'DR KASHINADHAM': [[' ', '20, 080.80'], [' ', '20,000.00']],
            'HISTOPATHOLOGY - IV (PARAIFIN SECTION)': [[' ', '35100.00'], [' ', '3510.00']],
            'TOTAL ABDOMINAL HYSTRECTOMY': [[' ', '1020000.00'], [' ', '102000.00']],
            'BILATERAL SAI PHINGO OOPHARECTOMY': [[' ', '250000.09'], [' ', '25000.0']],
            'ECG': [[' ', '892.00'], [' ', '392.00']],
            'SASHI KIRAN A': [[' ', '20,900.00'], [' ', '20,000.00']],
            'PATEN D_ET': [[' ', '230.30'], [' ', '200.00']],
            'LEFT': [[' ', '105,070.70'], [' ', '105,000.0']],
            'RIGID SIGMODOSCOPY': [[' ', '50000.00'], [' ', '5000.00']],

        }
        for d in dic2:
            print('mmddd==', dic2[d])
            try:
                if dic2[d][0].strip(' -,.') in known_items:
                    if dic2[d][0].strip(' -,.') in correct_map_known_items and dic2[d][4:] == \
                            correct_map_known_items[dic2[d][0].strip(' -,.')][0]:
                        print('itemsss', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:4] + correct_map_known_items[neww[0].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['ECG', 'Patient Diet', 'SERUM METHOTREXATE /'

                       ]
        correct_map_known_items = {
            'ECG': [[' ', '192.00'], [' ', '392.00']],
            'Patient Diet': [[' ', '10000.00'], [' ', '1000.00']],
            'SERUM METHOTREXATE /': [[' ', '1,455.00'], [' ', '4,455.00']],

        }
        for d in dic2:
            print('mmddd==', dic2[d])
            try:
                if dic2[d][0].strip(' -,.') in known_items:
                    if dic2[d][0].strip(' -,.') in correct_map_known_items and dic2[d][4:] == \
                            correct_map_known_items[dic2[d][0].strip(' -,.')][0]:
                        print('itemsss', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:4] + correct_map_known_items[neww[0].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'yashoda-pharma' or hospital == 'yashodamalakpet_N3060-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if dic2[d][0] == 'Iten. Issues':
                dic2[d][0] = 'Item Issues'
            if dic2[d][2] == 'Item Issues > > > > > 3694945 09/07/2020':
                dic2[d][0] = 'Item Issues'
                dic2[d][2] = ' '
            if dic2[d][0] == 'Item Issues' or dic2[d][0].__contains__('Item Iss'):
                dic2[d][0] = 'Pharmacy Issues'
            if dic2[d][0] == 'Item Returns' or dic2[d][0].__contains__('Item Retur'):
                dic2[d][0] = 'Pharmacy Returns'
            if len(re.findall('\d\s?\.\s?\d', dic2[d][4])) == 1:
                dic2[d][4] = dic2[d][4].replace(' ', '')

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['SERVO DUO GUARD ( MAQUET)', 'SURGEON GOWN (MEDTBLUE)', 'SMALL GAUZE 24CM X24 CM', 'I-GEL (O" )',
                       'SAFE TOUCH GLOVES ( PATR)', 'SYRINGE 10ML- (EMERALD)', 'RL 50OML IV', 'MYO-PYROLATE INJ',
                       'GUIDE WIRE (OT)',
                       'ALCOHOL SWABS', 'SURGICAL GLOVES 7. 5 (TRUSKIN CARE)', 'SOBISIS 500MG TAB', 'BIOVORIN SONG IN',
                       'SODIUM BICORBONATE. 25ML INJ', 'NS 0. 453 { PLASTIC) =V', 'MASK ( DISPOSABLE;',
                       'SAFE TOUCH GLOVES : PAIR;',
                       'ONDOKIND 2ML INJ', 'SODIUM BICORBONATE 25ML INJ', 'SURGEON CONN :MEDIBLUE )',
                       'MASK ( DISPOSABLE;',
                       'SAFE TOUCH GLOVES (PAIR)', 'SUPER TOUCH GLOVES (M)', 'EASY FIX MEDIUM', 'TV SET',
                       'SYRINGE 1 0ML - { EMERALD;',
                       'BAND AID (ROUND)', 'MASK ( DISPOSABLE;', 'CAP', 'MASK (DISPOSABLE)',
                       'MEDIUM TOWEL 120CM X 160CM (ANTHEM)',
                       'SURGICAL GLOVES', '(OT)'

                       ]
        correct_map_known_items = {
            'SERVO DUO GUARD ( MAQUET)': [[' ', '1,:30.00', ' '], [' ', '1,100.00', ' ']],
            'SURGEON GOWN (MEDTBLUE)': [[' ', '1co. CO', ' '], ['1', '100.00', ' ']],
            'SMALL GAUZE 24CM X24 CM': [[' ', '80. CO C/E Total', ' '], [' ', '80.00', ' ']],
            'I-GEL (O" )': [[' ', '600.30', ' '], [' ', '500.0', ' ']],
            'SURGEON CONN :MEDIBLUE )': [[' ', '350.30', ' '], [' ', '300.0', ' ']],
            'SAFE TOUCH GLOVES ( PATR)': [['H W N', '90.00', ' '], ['3', '90.00', ' ']],
            'SYRINGE 10ML- (EMERALD)': [[' ', ':10.30', ' '], ['4', '110.00', ' ']],
            'RL 50OML IV': [[' ', '101.3/', ' '], [' ', '101.34', ' ']],
            'MYO-PYROLATE INJ': [[' ', 'B4.80', ' '], [' ', '84.80', ' ']],
            'GUIDE WIRE (OT)': [[' ', '350.CO', ' '], [' ', '950.00', ' ']],

            'ALCOHOL SWABS': [[' ', ':2.50', ' '], [' ', '12.50', ' ']],
            'SURGICAL GLOVES 7. 5 (TRUSKIN CARE)': [[' ', 'B4 .DO', ' '], [' ', '84.00', ' ']],
            'SOBISIS 500MG TAB': [[' ', '35 . CO', ' '], [' ', '35.00', ' ']],
            'BIOVORIN SONG IN': [['12', '1,725.60', ' '], ['12', '4,725.60', ' ']],
            'SODIUM BICORBONATE. 25ML INJ': [[' ', '39.35', ' '], [' ', '38.35', ' ']],
            'NS 0. 453 { PLASTIC) =V': [[' ', ':36.58', ' '], [' ', '186.58', ' ']],
            'MASK ( DISPOSABLE;': [[' ', '24 . CO', ' '], [' ', '24.00', ' ']],
            'SAFE TOUCH GLOVES : PAIR;': [[' ', ':50.00', ' '], [' ', '150.00', ' ']],
            'ONDOKIND 2ML INJ': [[' ', '39. : B', ' '], [' ', '39.18', ' ']],
            'SODIUM BICORBONATE 25ML INJ': [['NST AMOUNT :', '-153.40/FTotal', ' '], ['4', '-153.40', ' ']],

            'MASK ( DISPOSABLE;': [[' ', '10.co', ' '], [' ', '10.00', ' ']],
            'SAFE TOUCH GLOVES (PAIR)': [[' ', '32.CO', ' '], [' ', '72.00', ' ']],
            'SUPER TOUCH GLOVES (M)': [[' ', '15. CO', ' '], [' ', '75.00', ' ']],
            'EASY FIX MEDIUM': [[' ', '60.CO', ' '], [' ', '60.00', ' ']],
            'TV SET': [[' ', '138 . CO', ' '], [' ', '138.00', ' ']],
            'SYRINGE 1 0ML - { EMERALD;': [[' ', '50 . CO', ' '], [' ', '50.00', ' ']],
            'BAND AID (ROUND)': [[' ', '5.00', ' '], [' ', '8.00', ' ']],

            'MASK ( DISPOSABLE;': [[' ', '24 . CO', ' '], [' ', '24.00', ' ']],
            'CAP': [[' ', '5100.00', ' '], [' ', '100.00', ' ']],

            'MASK (DISPOSABLE)': [[' ', '10.00', ' '], ['4', '40.00', ' ']],
            'MEDIUM TOWEL 120CM X 160CM (ANTHEM)': [[' ', 'N90.00', ' '], [' ', '90.00', ' ']],
            'SURGICAL GLOVES': [[' ', '130.00HN', ' '], [' ', '130.00', ' ']],
            '(OT)': [[' ', '570.50', ' '], [' ', ' ', ' ']],

        }
        for d in dic2:
            print('mmddd11==', dic2[d])
            try:
                if dic2[d][2].strip(' -,.') in known_items:
                    if dic2[d][2].strip(' -,.') in correct_map_known_items and dic2[d][3:] == \
                            correct_map_known_items[dic2[d][2].strip(' -,.')][0]:
                        print('itemsss', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:3] + correct_map_known_items[neww[2].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['CAP', 'MASK (DISPOSABLE)'

                       ]
        correct_map_known_items = {
            'CAP': [[' ', '6120.00', ' '], ['6', '120.00', ' ']],
            'MASK (DISPOSABLE)': [['10', '30.00', ' '], ['10', '80.00', ' ']],

        }
        for d in dic2:
            print('mmddd11==', dic2[d])
            try:
                if dic2[d][2].strip(' -,.') in known_items:
                    if dic2[d][2].strip(' -,.') in correct_map_known_items and dic2[d][3:] == \
                            correct_map_known_items[dic2[d][2].strip(' -,.')][0]:
                        print('itemsss', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:3] + correct_map_known_items[neww[2].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'yashoda-2':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if dic2[d][1].__contains__('Total for'):
                dic2[d][4] = ' '
                dic2[d][5] = ' '
                dic2[d][6] = ' '
                dic2[d][7] = ' '

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Zen':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if dic2[d][3]!= ' ' and len(dic2[d][3].split())==2 and dic2[d][2]==' ' and len(re.findall('\d?\D?\s\d+\D?\d+\.\d+', dic2[d][3])) == 1:
                print('if QTy rate in 3rd indx')
                text = dic2[d][3].split()
                dic2[d][2] = text[0]
                dic2[d][3] = text[1]
            if dic2[d][5] != ' ' and len(dic2[d][5].split()) == 2 and (
                    len(re.findall('\d?\D?\s\d+\D?\d+\.\d+', dic2[d][5])) == 1 or len(
                    re.findall('\d?\D?\s\d+\D?\d+\D\d+', dic2[d][5])) == 1) and len(dic2[d][5].split()[0]) == 1:
                print('To remove rupee symbol from 5th indx')
                text = dic2[d][5].split()
                dic2[d][5] = dic2[d][5].replace(text[0], '')
                dic2[d][5] = dic2[d][5].strip()
            if d>1 and dic2[d][0] in head_list and dic2[d-1][0] in head_list:
                print('if d in head_list and d-1 in head_list')
                dic2[d][0] = dic2[d][0]+dic2[d][0][-1]
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Sunshine':
        dicone = dic1
        dic1 = {}
        cl = 1
        f = 0
        for d in dicone:
            f += 1
            if f > 2 and dicone[d][0] in head_list and dicone[d][1:].count(' ') == 5 and dicone[d - 1][:-1].count(
                    ' ') == 5 and len(re.findall('\d\s?\.\s?\d', dicone[d - 1][5])) == 1:
                last_line = opr1(dicone[d - 1], dicone[d], src_dc)
                print('lastttttlnn', dicone[d - 1], dicone[d])
                dic1[cl - 1] = last_line
                continue
            dic1[cl] = dicone[d]
            cl += 1

        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if dic2[d][2] == 'Subtotal':
                dic2[d][5] = ' '
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][2] != 'Subtotal':
                listnw = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['VIMALAKAR REDDY E', 'MEDICAL RECORDS', 'ARTHOSCOPY-MAJOR > 1 hr', 'TV SET (ROMSONS)',
                       'TRD CONJECT 2ML INJ',
                       'SHOE COVERS'
                       ]
        correct_map_known_items = {
            'VIMALAKAR REDDY E': [[' ', '40,000.00', '40,000,00'], ['1', '40,000.00', '40,000.00']],
            'MEDICAL RECORDS': [[' ', '1,000.00', '1,000.091'], [' ', '1,000.00', '1,000.00']],
            'ARTHOSCOPY-MAJOR > 1 hr': [[' ', '6,665.00', '3,665.00'], ['1', '8,665.00', '8,665.00']],
            'TV SET (ROMSONS)': [[' ', '162.00', '167.00'], ['1', '162.00', '162.00']],
            'TRD CONJECT 2ML INJ': [[' ', '23.38', '93.57'], ['4', '23.38', '93.52']],
            'SHOE COVERS': [[' ', '12.50', ' '], ['4', '12.50', '50.0']],

        }
        for d in dic2:
            try:
                if dic2[d][1].strip(' -,.') in known_items:
                    if dic2[d][1].strip(' -,.') in correct_map_known_items and dic2[d][3:] == \
                            correct_map_known_items[dic2[d][1].strip(' -,.')][0]:
                        print('itemssss', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:3] + correct_map_known_items[neww[1].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Sunshine1':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if dic2[d][2] == 'Subtotal':
                dic2[d][5] = ' '

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['FOOD CHARGES', 'MEALS'
                       ]
        correct_map_known_items = {
            'FOOD CHARGES': [[' ', '187.50 JN', '375.00'], ['2', '187.50', '375.00']],
            'MEALS': [[' ', '30.00', '60.00'], ['1', '80.00', '80.00']],

        }
        for d in dic2:
            try:
                if dic2[d][1].strip(' -,.') in known_items:
                    if dic2[d][1].strip(' -,.') in correct_map_known_items and dic2[d][3:] == \
                            correct_map_known_items[dic2[d][1].strip(' -,.')][0]:
                        print('itemssss', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:3] + correct_map_known_items[neww[1].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Billroth' or hospital =='billroth_N2259':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if d >= 1 and d < len(dic2) and dic2[d][0] in head_list and dic2[d + 1][0] in head_list and dic2[d][0] == \
                    dic2[d + 1][0]:
                print('if header and subheader are same d, d+1')
                dic2[d + 1][0] = dic2[d + 1][0].lower()
            if d >= 1 and d < len(dic2) and dic2[d][0] in head_list and dic2[d + 1][0].lower() in src_dc[
                'merge_set'].split(','):
                print('if header and subheader d, d+1 and d+1 in merge_set')
                dic2[d + 1][0] = dic2[d + 1][0].lower()
            if d >= 1 and d < len(dic2) and dic2[d][0] != ' ' and dic2[d][0].lower() in src_dc['merge_set'].split(
                    ',') and dic2[d][0] in head_list and \
                    dic2[d - 1][5] != ' ' and dic2[d - 1].count(' ') <= 3:
                print('if header and subheader are same')
                dic2[d][0] = dic2[d][0].lower()
            if d > 2 and d < len(dic2) and dic2[d][0] in head_list and dic2[d - 1][1] != ' ' and dic2[d - 1][
                5] != ' ' and dic2[d - 1].count(' ') == 4:
                print('for sbt value 1st indx not empty')
                dic2[d - 2][1] = dic2[d - 2][1] + ' ' + dic2[d - 1][1]
                dic2[d - 1][1] = ' '

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd111===', dic2[d])
            if d > 1 and d < len(dic2) and dic2[d].count(' ') == 5 and len(re.findall('\d\.\d', dic2[d][5])) == 1 and \
                    dic2[d + 1][0] in head_list:
                dic2[d][2] = 'Subtotal'
            if dic2[d][2] == 'Subtotal' and dic2[d][5]!= ' ':
                dic2[d][5] = ' '
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][2] != 'Subtotal':
                listnw = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2):
                listnw = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital=='Columbia':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd111===', dic2[d])
            if dic2[d][3] == ' ' and dic2[d][4] != ' ':
                dic2[d][3] = dic2[d][4]
            if dic2[d][0] in head_list and dic2[d].count(' ')!=5 and dic2[d][2]!= ' ' and dic2[d].count(' ')<=3:
                print('if line item is == header')
                dic2[d][0] = dic2[d][0].lower()
            if (len(re.findall('\d\.\d', dic2[d][2])) == 1 or len(re.findall('\d\s\d', dic2[d][2])) == 1 or len(re.findall('\.\d{2}', dic2[d][2])) == 1) and len(dic2[d][2].split()) >=1:
                text = dic2[d][2]
                if len(re.findall('\d{3}\.\d{2}', dic2[d][2])) == 1:
                    matchqty = re.search(r'\d{3}\.\d{2}',text)
                elif len(re.findall('\d{2}\.\d{2}', dic2[d][2])) == 1:
                    matchqty = re.search(r'\d{2}\.\d{2}',text)
                elif len(re.findall('\d{1}\.\d{2}', dic2[d][2])) == 1:
                    matchqty = re.search(r'\d{1}\.\d{2}',text)
                elif len(re.findall('\d\s\d{2}', dic2[d][2])) == 1:
                    matchqty = re.search(r'\d\s\d{2}',text)
                elif len(re.findall('\.\d{2}', dic2[d][2])) == 1:
                    matchqty = re.search(r'\.\d{2}',text)
                elif len(re.findall('\d{1}\.\d{1}', dic2[d][2])) == 1:
                    matchqty = re.search(r'\d{1}\.\d{1}',text)
                val = matchqty.group()
                print('val==',val)
                dic2[d][2] = val
            if dic2[d][2].__contains__('Sub To'):
                dic2[d][3] = ' '
                dic2[d][5] = ' '


            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital=='Bethany':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd111===', dic2[d])
            if dic2[d][1].__contains__('PHARMACY') or dic2[d][1].__contains__('PILARMACY'):
                dic2[d][5] = ' '


            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital=='Bethany-pharma' or hospital =='Sterling_N0704-pharma' or hospital=='Surana_N4358-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd111===', dic2[d])
            if d==1 and dic2[d][0]!='Medicines':
                listnw = ['Medicines', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq-1] = listnw


            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Basavatarakam':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd111===', dic2[d])
            if dic2[d][2] != ' ' and len(dic2[d][2]) > 3:
                # print('if any unneccesary value comes in QTy indx')
                dic2[d][2] = ' '
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Basavatarakam-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd111===', dic2[d])
            if dic2[d][3] != ' ' and len(dic2[d][3]) > 3:
                # print('if any unneccesary value comes in QTy indx')
                dic2[d][3] = ' '
            if d == 1 and dic2[d][0] != 'Pharmacy':
                listnw = ['Pharmacy', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][4] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'dayanand' or hospital=='dayanand_daycare':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if d == len(dic2) and dic2[d][0] == 'PHARMACY CHARGES' and (len(re.findall('\d\.\d', dic2[d][6])) == 1 or len(re.findall('\d\s\d', dic2[d][6])) == 1 or len(re.findall('\d\.\s\d', dic2[d][6])) == 1):
                listnw = ['PHARMACY CHARGESS', ' ', dic2[d][6], ' ', ' ', ' ', dic2[d][6]]
                listnw1 = [' ', ' ', ' ', ' ', 'Sub total', ' ', dic2[d][6]]
                dic2[d][6] = ' '
                dic1[lq] = dic2[d]
                dic1[lq+1] = listnw
                dic1[lq+2] = listnw1


            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital=='dayanand-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd111===', dic2[d])
            if dic2[d][5].__contains__('%'):
                dic2[d][5] = dic2[d][5].replace('%','')
            if dic2[d][3]!=' ' and 'Total' not in dic2[d][3]:
                dic2[d][3] = ' '
            if dic2[d][3].__contains__('Total Amount'):
                dic2[d][1] = ' '
            if len(re.findall('\d{1}', dic2[d][1][0])) == 1 and len(dic2[d][1].split())>=2:
                text = dic2[d][1].split()[0]
                dic2[d][1] = dic2[d][1].replace(text,'',1)
            if d==1 and dic2[d][0]!='Pharmacy':
                listnw = ['Pharmacy', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq-1] = listnw


            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'dayanand_daycare-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if d==1 and dic2[d][0] != 'Pharmacy':
                listnw = ['Pharmacy', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq-1] = listnw
            if d>1 and dic2[d][0] != ' ' and dic2[d][1] == ' ' and len(dic2[d][0].split())>=2:
                print('if date parti together in 0th indx')
                text = dic2[d][0]
                matchdate = re.search(r'\d+\-\w+\-\d+',text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(),'')
            if d==len(dic2) and dic2[d][4]!='Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq+1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'deenanath_1':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if dic2[d][4].__contains__('Sub total') and dic2[d][5] != ' ':
                dic2[d][5] = ' '
            if d > 1 and dic2[d][0] == 'OXYGEN CHARGES' and dic2[d - 1][0] == 'OXYGEN CHARGES':
                dic2[d][0] = 'OXYGEN CHARGESS'

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'deenanath_1-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd111===', dic2[d])
            if d == 1 and dic2[d][0] != 'Pharmacy':
                listnw = ['Pharmacy', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][3] != 'Sub total':
                listnw = [' ', ' ', ' ', 'Sub total', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
            if len(dic2[d][2].split()) == 2 and dic2[d][3] in dic2[d][2]:
                print('if qty are still merged with 3rd in 2nd')
                a, b = dic2[d][2].split()
                dic2[d][2] = a
            if len(dic2[d][3].split()) == 2 and dic2[d][2] in dic2[d][3]:
                print('if qty are still merged with 2nd in 3rd')
                a, b = dic2[d][3].split()
                dic2[d][3] = b
            if dic2[d][3] == '0.000' and dic2[d][4] == ' ' and dic2[d][5] != ' ':
                print('if rtqty is 0.0 and total 4th index is empty')
                dic2[d][4] = dic2[d][5]
            if dic2[d][3] == '0.000' and dic2[d][4] != ' ' and dic2[d][5] == ' ':
                print('if rtqty is 0.0 and amount 5th index is empty')
                dic2[d][5] = dic2[d][4]

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'deenanath':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if d > 2 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal' and dic2[d - 2][1] != 'Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            if d > 1 and dic2[d][1].__contains__('Subtotal') and dic2[d - 1][1].__contains__('Subtotal'):
                dic2[d][1] = ' '
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][0] in head_list and dic2[d][0] == dic2[d - 1][0]:
                dic2[d][0] = dic2[d][0] + 'S'
            if d > 1 and dic2[d][0] == 'OXYGEN CHARGES' and dic2[d - 1][0] == 'OXYGEN CHARGES':
                dic2[d][0] = 'OXYGEN CHARGESS'
            if dic2[d][1].__contains__('Subtotal') and dic2[d][5]!= ' ':
                dic2[d][5] = ' '
            if dic2[d][4] == '10':
                dic2[d][4] = '1.0'

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['CYTOLOGY (BY CYTOSPIN)', 'HAEMOGRAM[PANEL]', 'SERUM ELECTROLYTES[PANEL)', 'DRUGS USED IN WARDS',
                       'SURGICAL SHAVING CHARGES'

                       ]
        correct_map_known_items = {
            'CYTOLOGY (BY CYTOSPIN)': [[' ', ' ', '1.0', '50.00'], [' ', ' ', '1.0', '450.00']],
            'HAEMOGRAM[PANEL]': [[' ', ' ', '1.0', '300.00.'], [' ', ' ', '1.0', '300.00']],
            'SERUM ELECTROLYTES[PANEL)': [[' ', ' ', '1.0', '440.00.'], [' ', ' ', '1.0', '440.00']],
            'DRUGS USED IN WARDS': [[' ', ' ', '2.0', '150.00. #2'], [' ', ' ', '2.0', '150.00']],
            'SURGICAL SHAVING CHARGES': [[' ', ' ', '1.0', '100.00e'], [' ', ' ', '1.0', '100.00']],

        }
        for d in dic2:
            print('mmddd22==', dic2[d], dic2[d][0].strip(' -,.'))
            try:
                if dic2[d][0].strip(' -,.') in known_items:
                    print('dic2[d][2:]', dic2[d][2:])
                    print('dic2[d][2:]', dic2[d][2:], correct_map_known_items[dic2[d][0].strip(' -,.')][0])
                    if dic2[d][0].strip(' -,.') in correct_map_known_items and dic2[d][2:] == \
                            correct_map_known_items[dic2[d][0].strip(' -,.')][0]:
                        print('itemsss', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:2] + correct_map_known_items[neww[0].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'deenanath-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd111===', dic2[d])
            if d == 1 and dic2[d][0] != 'Pharmacy':
                listnw = ['Pharmacy', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][3] != 'Sub total':
                listnw = [' ', ' ', ' ', 'Sub total', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
            if len(dic2[d][2].split()) == 2 and (dic2[d][3] in dic2[d][2] or dic2[d][2].split()[1] in dic2[d][3]):
                print('if qty are still merged with 3rd in 2nd')
                a, b = dic2[d][2].split()
                dic2[d][2] = a
            if len(dic2[d][3].split()) == 2 and (dic2[d][2] in dic2[d][3] or dic2[d][3].split()[0] in dic2[d][2]):
                print('if qty are still merged with 2nd in 3rd')
                a, b = dic2[d][3].split()
                dic2[d][3] = b
            if dic2[d][4].__contains__('Nos '):
                dic2[d][4] = dic2[d][4].replace('Nos ', '')
            if dic2[d][3] == '0.000' and dic2[d][4] == ' ' and dic2[d][5] != ' ':
                print('if rtqty is 0.0 and total 4th index is empty')
                dic2[d][4] = dic2[d][5]
            if dic2[d][3] == '0.000' and dic2[d][4] != ' ' and dic2[d][5] == ' ':
                print('if rtqty is 0.0 and amount 5th index is empty')
                dic2[d][5] = dic2[d][4]

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital =='srch-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        sale_return = 0
        for d in dic2:
            if dic2[d][2]!= ' ' and dic2[d][3]!= ' ' and dic2[d][2] == dic2[d][3]:
                print('if sales rate is not present i.e diff pharmacy format')
                dic2[d][3] = ' '
            if 'return' in dic2[d][0].lower() and dic2[d][1:].count(' ')==5:
                sale_return = 2
                print('returnnnnn',dic2[d])
            if 'sales' in dic2[d][0].lower() and dic2[d][1:].count(' ')==5:
                print('salesss',dic2[d])
                sale_return = 1
            if sale_return==2 and len(dic2[d][4].strip())>2 and len(dic2[d][5].strip())>2:
                nevv = copy.deepcopy(dic2[d])
                print('returnnnnn_innnn',nevv)
                nvv_fv = '-' + nevv[5]
                nevv.pop(4)
                nevv.insert(4,' ')
                nevv.pop(5)
                nevv.insert(5,nvv_fv)
                dic1[lq] = nevv
                lq += 1
                continue
            if sale_return==1 and len(dic2[d][4].strip())>2 and len(dic2[d][5].strip())>2:
                nevv = copy.deepcopy(dic2[d])
                print('salessss_innnn',nevv)
                nvv_fv = nevv[4]
                nevv.pop(4)
                nevv.insert(4,' ')
                nevv.pop(5)
                nevv.insert(5,nvv_fv)
                dic1[lq] = nevv
                lq += 1
                continue
            dic1[lq] = dic2[d]
            lq += 1
        dicA=dic1
        for d in dicA:
            print('iiiiii',dicA[d])
    # //////////////////////////
    if hospital == 'Gleneagles_GHC' or hospital == 'Gleneagles_GHC1' or hospital == 'Global' or hospital == 'BGS_N0865':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][0] in head_list and dic2[d][0] == dic2[d - 1][0]:
                dic2[d][0] = dic2[d][0].lower()
            if dic2[d][2] == dic2[d][3] and dic2[d][2] != ' ' and dic2[d][3] != ' ' and dic2[d][2].__contains__('931'):
                # print('remove 999311 from 3rd indx')
                dic2[d][3] = ' '
            if dic2[d][3].__contains__('9931') and len(dic2[d][3].split())==1:
                # print('If Only 999311 in 3rd indx')
                dic2[d][3] = ' '
            if dic2[d][1].__contains__('Subtotal') and len(dic2[d][1]) > 8:
                dic2[d][1] = 'Subtotal'
            if dic2[d][0] in head_list:
                dic2[d][1] = ' '
            if d == len(dic2) and dic2[d][1] != 'Subtotal' and dic2[d - 1][1] != 'Subtotal':
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq + 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            if d > 2 and dic2[d][0] != ' ' and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal' and dic2[d - 2][
                1] != 'Subtotal':
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd111===', dic2[d])
            if dic2[d][1].__contains__('MEDICINE CHARGES') or dic2[d][1].__contains__('MEDICINE RETURN') or dic2[d][
                1].__contains__('Pharmacy Indent') or \
                    dic2[d][1].__contains__('Ward Indent') or dic2[d][1].__contains__('Pharmacy Refund'):
                dic2[d][3] = ' '
                dic2[d][4] = ' '
                dic2[d][5] = ' '

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Gleneagles_GHC-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if d == 1 and dic2[d].count(' ') != 5:
                listnw = ['PHARMACY', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][3] == ' ' and dic2[d][4] != ' ' and len(
                    re.findall('\d\s?\.\s?\d', dic2[d][4])) == 1:
                dic2[d - 1][1] = dic2[d - 1][1] + ' ' + dic2[d][1]
                dic2[d][1] = ' '
                dic2[d][3] = 'Total'
            if d == len(dic2) and dic2[d][3] != 'Total' and dic2[d][4] != ' ' and dic2[d].count(' ') <= 3:
                listnw = [' ', ' ', 'Total', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Gleneagles_GHC1-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if d == 1 and dic2[d][0] != 'Pharmacy':
                listnw = ['Pharmacy', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Global-pharma' or hospital=='Global1-pharma' or hospital=='BGS_N0865-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if d==1 and len(re.findall('\d\-\d{2}\-\d', dic2[d][0])) == 1 and len(re.findall('\d\.\d', dic2[d][6])) == 1 and dic2[d].count(' ')<=2:
                listnw = ['DRUGS AND DISPOSABLES', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq-1] = listnw


            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Global1':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            # print('mmdddd===', dic2[d])
            if d==1 and len(re.findall('\d\/\d{2}\/\d', dic2[d][0])) == 1 and dic2[d].count(' ')<=3:
                print('yes1111')
                listnw = ['HEAD', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq-1] = listnw
            if d>1 and d!=len(dic2) and len(re.findall('\d\/\d{2}\/\d', dic2[d][0])) == 1 and dic2[d-1][3] == 'SUB TOTAL' and len(re.findall('\d\.\d', dic2[d][5])) == 1 and len(re.findall('\d\.\d', dic2[d-1][5])) == 1:
                print('yessss')
                listnw = ['HEAD', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq-1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Global2':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])


            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'pushpawati':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if f > 3 and ss.join(dic2[d - 1]).__contains__('Total for ICICI NON PACKAGE') and len(
                    re.findall('\d\/\d{1,2}\/\d{1,4}\s?\d{1,2}\:\d{1,2}\s?\-\s?\w{1,2}\d{1,2}\/\d{5}',
                               dic2[d][0])) == 1 and dic2[d].count(' ') == 1:
                dic1[lq] = ['SURGEON FEES', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ']
                lq += 1
                print('lqqqqqqq', dic2[d - 1], dic2[d])

            if f > 3 and ss.join(dic2[d - 1]).__contains__('Total for SURGRY PACKAGE ICICI') and len(
                    re.findall('\d\/\d{1,2}\/\d{1,4}\s?\d{1,2}\:\d{1,2}\s?\-\s?\w{1,2}\d{1,2}\/\d{5}',
                               dic2[d][0])) == 1 and dic2[d].count(' ') == 1:
                dic1[lq] = ['SURGEON FEES', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ']
                lq += 1
                print('lqqqqqqq', dic2[d - 1], dic2[d])

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'venkateshwar':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if len(re.findall('\d+\.\d+\s', dic2[d][3])) == 1 and dic2[d][3]!= ' ' and len(re.findall('\d\.\d', dic2[d][3])) < 2:
                print('cleaning rate')
                text = dic2[d][3]
                if len(re.findall('\d+\.\d+\s', dic2[d][3])) == 1:
                    matchrate = re.search(r'\d+\.\d+\s',text)
                dic2[d][3] = matchrate.group()
                dic2[d][3] = dic2[d][3].replace(' ','')
            if len(re.findall('\d+\.\d+\s', dic2[d][5])) == 1 and dic2[d][5]!= ' ' and len(re.findall('\d\.\d', dic2[d][5])) < 2:
                print('cleaning amount')
                text = dic2[d][5]
                if len(re.findall('\d+\.\d+\s', dic2[d][5])) == 1:
                    matchamount = re.search(r'\d+\.\d+\s',text)
                dic2[d][5] = matchamount.group()
                dic2[d][5] = dic2[d][5].replace(' ','')
            if dic2[d][0] in head_list and dic2[d].count(' ')!=5 and dic2[d].count(' ')<=2:
                print('if page is tilted and header and lineitem in same line')
                listnw = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic2[d][0] = ' '
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq+=1
                dic1[lq-1] = listnw


            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'venkateshwar_daycare':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if d==1 and dic2[d][0] != 'Head':
                listnw = ['Head', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq-1] = listnw
            if dic2[d][0].__contains__('Particul'):
                dic2[d][0] = ' '
            if d==len(dic2) and dic2[d][4]!='Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq+1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'sakra':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if dic2[d][3] == ' ' and dic2[d][5] == ' ' and dic2[d][4]!= ' ' and dic2[d].count(' ')>=3 and dic2[d][0] not in head_list:
                print('In surgery package only amount is present')
                dic2[d][5] = dic2[d][4]
                dic2[d][4] = ' '
            if d>1 and dic2[d][0] in head_list and dic2[d-1][2]!='Subtotal':
                listnw = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq+=1
                dic1[lq-1] = listnw


            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'yatharth':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal' and dic2[d - 2][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'medicover':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f > 2 and dic2[d][0] in head_list and dic2[d - 1][2] != 'Subtotal':
                print('add sbt', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][2] != 'Subtotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Mahatmagandhi_N12944':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f > 2 and dic2[d][0] in head_list and dic2[d - 1][2] != 'Subtotal':
                print('add sbt', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][2] != 'Subtotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'medicover1':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])



            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'aster_rv':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if dic2[d][3]!= ' ' and len(dic2[d][3].split())>=2:
                print('if rate, discount, Qty merge in 3rd indx')
                text = dic2[d][3].split()
                dic2[d][3] = text[0]
                dic2[d][4] = text[-1]

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'aster_rv_daycare':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if len(dic2[d][4].split()) == 2 and dic2[d][5] == ' ':
                a,b = dic2[d][4].split()
                dic2[d][4] = a
                dic2[d][5] = b
            if d==1 and dic2[d][0] != 'Head':
                listnw = ['Head', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq-1] = listnw
            if d==len(dic2) and dic2[d][1]!='Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq+1] = listnw


            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'vijaya_chennai':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if dic2[d][2].__contains__(' ()'):
                dic2[d][2] = dic2[d][2].replace(' ()', '')
            if d > 1 and dic2[d][2] == ' ' and dic2[d][0] not in head_list and dic2[d][0].__contains__('-') and len(
                    dic2[d][0].split()) >= 2 and len(re.findall('\d+\.\d+', dic2[d][5])) == 1:
                print('for Investigation chrages diff format')
                dic2[d][2] = dic2[d][0]
                dic2[d][0] = ' '
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][2] != 'Subtotal':
                listnw = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'jaslok2':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if f > 3 and ss.join(dic2[d - 1]).__contains__(sbt) and len(
                    re.findall('\d+\s?\D?\s?\w{6}\s?\w{7}\s?\w{4}\s?\w{5}\D+',dic2[d][2])) == 1 and dic2[d].count(' ') >= 0:
                dic1[lq] = ['STORES CHARGES', ' ', ' ', ' ', ' ', ' ']
                lq += 1

                print('lqqqqqqq', dic2[d - 1], dic2[d])
            if f > 3 and ss.join(dic2[d - 1]).__contains__('Sub Total For:- CHEST DISEASE') and len(
                    re.findall('\d{4}',dic2[d][0])) == 1 and dic2[d].count(' ') == 1:
                dic1[lq] = ['Rounding Off', ' ', ' ', ' ', ' ', ' ']
                lq += 1
                print('lqqqq', dic2[d - 1], dic2[d])
            if f > 3 and ss.join(dic2[d - 1]).__contains__('Sub Total For:- C.S.S.D') and len(
                    re.findall('\d{4}',dic2[d][0])) == 1 and dic2[d].count(' ') == 1:
                dic1[lq] = ['Rounding Off', ' ', ' ', ' ', ' ', ' ']
                lq += 1
                print('lqqqqqqq', dic2[d - 1], dic2[d])
            if f > 3 and ss.join(dic2[d - 1]).__contains__('Sub Total For:- ') and len(
                    re.findall('\d{1,2}\/\d{2}\/\d{4}',dic2[d][1])) == 1 and dic2[d].count(' ') == 2:
                dic1[lq] = ['Rounding Off', ' ', ' ', ' ', ' ', ' ']
                lq += 1
                print('lTTTTT', dic2[d - 1], dic2[d])
            if f > 2 and ss.join(dic2[d - 1]).__contains__('Sub Total For:- MAIN STORE (ITEMS)-5th Floor') and len(
                    re.findall('\d{1,2}\/\d{2}\/\d{4}',dic2[d][1])) == 1 and dic2[d][2].__contains__("90001001 - STORES CHARGES FROM FLOOR'S/ICU'S")==False  and dic2[d].count(' ') == 1:
                dic1[lq] = ['Rounding Off', ' ', ' ', ' ', ' ', ' ']
                lq += 1
                print('lqqqqqqq', dic2[d - 1], dic2[d],dic2[d+1])
            if dic2[d][2].__contains__('CSSD CHARGES') or dic2[d][2].__contains__('MAIN STORE ITEM MANUAL') or dic2[d][2].__contains__('MEDICINE FROM DRUGS STORE') or dic2[d][2].__contains__('STORES CHARGES FROM FLOOR'):
                dic2[d][2] = ' '



            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'regency':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd11==', dic2[d])
            if dic2[d][0] in head_list and dic2[d][1] != ' ' and dic2[d][2] != ' ' and dic2[d].count(' ') == 1:
                print('if header with lines', dic2[d])
                dic1[lq] = dic2[d]
                # dic1[lq-1] = dic2[d-1]
                lq += 1
                dic1[lq - 1] = [dic2[d][0], ' ', ' ', ' ', ' ', ' ', ' ']
                dic2[d][0] = ' '

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd22==', dic2[d])
            if d > 2 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal' and dic2[d - 2][1] != 'Subtotal':
                print('yesssssssssssss', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ', ' ']
            if d == len(dic2) and dic2[d][1].__contains__('Pharmacy'):
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'regency3':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd11==', dic2[d])
            if dic2[d][0] in head_list and dic2[d][1] != ' ' and dic2[d].count(' ') >= 1:
                print('if headerss with lines', dic2[d])
                dic1[lq] = dic2[d]
                # dic1[lq-1] = dic2[d-1]
                lq += 1
                dic1[lq - 1] = [dic2[d][0], ' ', ' ', ' ', ' ', ' ', ' ']
                dic2[d][0] = ' '

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
    # //////////////////////////
    if hospital == 'regency-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd11==', dic2[d])
            if d == 1 and dic2[d][0] != 'Pharmacy':
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = ['Pharmacy', ' ', ' ', ' ', ' ', ' ', ' ', ' ']
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                dic2[d][1] = 'Subtotal'

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'golden-jaipur':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if f > 1 and ss.join(dic2[d - 1]).__contains__(sbt) and dic2[d][0] not in head_list and dic2[d].count(' ') < 2 and dic2[d][1].__contains__('ECG'):
                dic1[lq] = ['ECG', ' ', ' ', ' ', ' ', ' ']
                lq += 1
                print('EFFFFFF', dic2[d - 1], dic2[d])
            if f > 1 and ss.join(dic2[d - 1]).__contains__(sbt) and dic2[d][0] not in head_list and dic2[d].count(' ') < 2 and dic2[d][0].__contains__('ROUND OFF'):
                dic1[lq] = ['ROUND OFF', ' ', ' ', ' ', ' ', ' ']
                lq += 1
                print('EFFFFFF', dic2[d - 1], dic2[d])
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'care_hitechcity' or hospital == 'care_banjarahills':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==',dic2[d])
            if len(dic2[d][3].split()) == 2 and len(re.findall('\d+\.\d+', dic2[d][3])) == 2 and dic2[d][4] in dic2[d][3]:
                print('if amt and qty together and qty 4th indx not empty')
                dic2[d][4] = ' '
                a,b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if dic2[d][2].__contains__('TOTAL FOR'):
                dic2[d][3] = ' '
                dic2[d][4] = ' '
                dic2[d][8] = ' '
            # if d > 1 and len(re.findall('\d+\/\d+\/\d+', dic2[d][0])) == 1 and len(re.findall('\d+\.\d+', dic2[d][3])) == 1 and len(re.findall('\d+\.\d+', dic2[d][8])) == 1 and \
            #         len(dic2[d][0].split()) >= 2 and dic2[d][0].split()[0] in col:
            #     print('for headers merged with 1st lines in merge_set')
            #     header = ''
            #     for i in col:
            #         if i in dic2[d][0]:
            #             dic2[d][0] = dic2[d][0].replace(i, '')
            #             header += i
            #     listnw = [header, ' ', ' ', ' ', ' ', ' ']
            #     dic1[lq] = dic2[d]
            #     dic1[lq - 1] = dic2[d - 1]
            #     lq += 1
            #     dic1[lq - 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'care_banjarahills':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if len(dic2[d][8].split()) == 2:
                a,b = dic2[d][8].split()
                dic2[d][8]= a
            if len(dic2[d][3].split()) == 2:
                a, b = dic2[d][3].split()
                dic2[d][3] = a
            dic1[lq] = dic2[d]
            lq += 1
    # /////////////////////////
    if hospital == 'Dr_rela':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if re.findall('\d\/\d{2}\/\d',dic2[d][0]) and dic2[d].count(' ')==5:
                print('date_merge',dic2[d])
                dic2[d-1][0]= dic2[d-1][0]  +" " + dic2[d][0]
                dic2[d][0]= ' '

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Instituteofliver':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d > 1 and dic2[d][0] == 'Pharmacy Return' and dic2[d - 1].count(' ') == 2 and len(
                    re.findall('\d\.\d', dic2[d - 1][5])):
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq - 1] = [' ', ' ', 'Total', ' ', ' ', ' ']
            if d > 1 and dic2[d][2].__contains__('Total') and dic2[d - 1][2].__contains__('Total'):
                dic2[d][2] = ' '
                dic2[d][5] = ' '
            col = ['DIETICIS', 'UGI.', 'X-RAY', 'Biliary']
            if d > 1 and len(re.findall('\d+\-\w+\-\d+', dic2[d][1])) == 1 and len(
                    re.findall('\d+\.\d+', dic2[d][3])) == 1 and len(re.findall('\d+\.\d+', dic2[d][5])) == 1 and \
                    len(dic2[d][0].split()) >= 2 and dic2[d][0].split()[0] in col:
                print('for headers merged with 1st lines in merge_set')
                header = ''
                for i in col:
                    if i in dic2[d][0]:
                        dic2[d][0] = dic2[d][0].replace(i, '')
                        header += i
                listnw = [header, ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'thunga' or hospital=='Thunga_N1700':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if dic2[d][0] not in head_list and len(re.findall('\d\.\d',dic2[d][5]))==1 and dic2[d-1][2].__contains__(sbt):
                print('ddddssc', dic2[d])
                dic1[lq] = ['Head', ' ', ' ', ' ', ' ', ' ']
                lq += 1
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'sancheti':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if dic2[d][0].__contains__('Drugs') and dic2[d].count(' ') != 5 :
                print('ddddssc',dic2[d])
                dic1[lq] = ['Drugs', ' ', ' ', ' ', ' ', ' ']
                lq += 1
                print('lqqqqqqq', dic2[d])
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

    if hospital == 'lakeshore_kochi':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mdd==',dic2[d])
            if dic2[d][0]!= ' '  and dic2[d][0].__contains__('RETURN DETAILS') and dic2[d][5]!= ' ':
                dic2[d][5] =  ' '
            if len(dic2[d][2].split())>=2 and (len(re.findall('\d+\/\d\s?\d\/\d+', dic2[d][2])) == 1 or len(re.findall('\d+\/\d+\/\d+', dic2[d][2])) == 1):
                # print('date and qty merged')
                text = dic2[d][2].split()
                if len(re.findall('\d+\/\d+\/\d+', dic2[d][2])) == 1:
                    dic2[d][3] = text[-1]
                    dic2[d][2] = text[0]
                elif len(re.findall('\d+\/\d\s\d\/\d+', dic2[d][2])) == 1:
                    print('date with space')
                    dic2[d][3] = text[-1]
                    dic2[d][2] = text[0]+text[1]
            if d>1 and len(re.findall('\d+\/\d\s?\d\/\d+', dic2[d][2])) == 1 and len(re.findall('\d+\.\d+', dic2[d][4])) == 1 and len(re.findall('\d+\.\d+', dic2[d][5])) == 1 and \
                    dic2[d].count(' ')==1 and len(dic2[d][0].split())>=2 and dic2[d-1][2].__contains__('Category Total'):
                print('for headers merged with 1st lines')
                header = ''
                for i in head_list:
                    if i in dic2[d][0]:
                        dic2[d][0] = dic2[d][0].replace(i,'')
                        header+=i
                listnw = [header, ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq+=1
                dic1[lq-1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'HCG':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd11==', dic2[d])
            if dic2[d][5] != ' ' and (dic2[d][6] == ' ' or dic2[d][6] != ' ') and len(
                    dic2[d][5].split()) == 2 and 'Total' not in dic2[d][5] and \
                    len(re.findall('\d+\.\d+', dic2[d][5])) == 2:
                print('unit price and tarrif in 5th indx == 5,6 in mddd')
                a, b = dic2[d][5].split()
                dic2[d][5] = a
                dic2[d][6] = b
            if dic2[d][6] != ' ' and (dic2[d][7] == ' ' or dic2[d][7] != ' ') and len(
                    dic2[d][6].split()) == 2 and 'Total' not in dic2[d][5] and \
                    len(re.findall('\d+\.\d+', dic2[d][6])) == 1:
                print('tarrif , discuount in 6th indx == 6,7 in mddd')
                a, b = dic2[d][6].split()
                dic2[d][6] = a
                dic2[d][7] = b
            for i in head_list:
                if d > 1 and i in dic2[d][0] and len(i) != len(dic2[d][0]) and dic2[d].count(' ') <= 8:
                    print('if page is tilted and header and lineitem in same line with sbt in d-1[2]')
                    listnw = [i, ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ']
                    dic2[d][0] = dic2[d][0].replace(i, '')
                    dic1[lq] = dic2[d]
                    dic1[lq - 1] = dic2[d - 1]
                    lq += 1
                    dic1[lq - 1] = listnw
            if dic2[d][4] != ' ' and dic2[d][5] != ' ' and dic2[d][4] == dic2[d][5] and len(
                    re.findall('\d+\.\d+', dic2[d][5])) == 1:
                print('if rate in qty')
                dic2[d][4] = ' '

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd11==', dic2[d])
            if d > 1 and dic2[d][0] in head_list and 'Dept Total' not in dic2[d - 1][5]:
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', ' ', ' ', ' ', ' ', 'Dept Total', ' ', ' ', ' ']
            if d == len(dic2) and 'Dept Total' not in dic2[d][5] and 'Dept Total' not in dic2[d - 1][5]:
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq + 1] = [' ', ' ', ' ', ' ', ' ', 'Dept Total', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'manipalhospital_N0477':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mdd==',dic2[d])


            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'alchemist':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd11==',dic2[d])
            if dic2[d][1]!= ' ' and dic2[d][1].__contains__('SA Code - 99931') and dic2[d][5]!= ' ' and dic2[d][0]!= ' ' and dic2[d].count(' ')==3:
                print('if sac is present in 1st indx')
                dic2[d][5] = ' '
            if d>1 and dic2[d][0] != ' ' and dic2[d][1] != ' ' and dic2[d][0] in head_list and dic2[d][1] in sub_head:
                print('if header and subheader in same line')
                listnw = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic2[d][0] = ' '
                dic1[lq]  =dic2[d]
                # dic1[lq-1] = dic2[d-1]
                lq+=1
                dic1[lq-1] = listnw
            if d==len(dic2) and dic2[d][1]!='Subtotal' and dic2[d-1][1]!= 'Subtotal':
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq+1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd22==', dic2[d])
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal' and dic2[d - 2][1] != 'Subtotal':
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Neotia':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d == len(dic2) and dic2[d][2].__contains__(sbt) == False:
                print('smms', dic2[d], dic2[d - 1])
                listnw = [' ', ' ', 'Total', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Saroj_N0440':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd11==', dic2[d])
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal' and dic2[d - 2][1] != 'Subtotal':
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            if d==len(dic2) and dic2[d][1]!='Subtotal' and dic2[d-1][1]!= 'Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']


            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd11==', dic2[d])
            if d > 1 and dic2[d][1] == 'Subtotal' and len(dic2[d - 1][5].split()) == 2 and len(
                    re.findall('\d\.\d', dic2[d - 1][5])) == 2:
                print('if header above total is merged with d-1 5th indx')
                a, b = dic2[d - 1][5].split()
                dic2[d - 1][5] = a

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Oyster_N5539-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d==len(dic2) and dic2[d][1]!='Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq+1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Chandan_N16310':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if dic2[d][5]!= ' ' and len(re.findall('\d+\.\d+', dic2[d][5])) == 1 and len(dic2[d][5].split())>=2:
                text = dic2[d][5]
                if len(re.findall('\d+\D\d+\.\d+', dic2[d][5])) == 1:
                    matchamt = re.search(r'\d+\D\d+\.\d+',text)
                elif len(re.findall('\d+\.\d+', dic2[d][5])) == 1:
                    matchamt = re.search(r'\d+\.\d+',text)
                dic2[d][5] = matchamt.group()
            if dic2[d][4]!= ' ' and len(re.findall('\d+\.\d+', dic2[d][4])) == 1 and len(dic2[d][4].split())>=2:
                text = dic2[d][4]
                if len(re.findall('\d+\D\d+\.\d+', dic2[d][4])) == 1:
                    matchamt = re.search(r'\d+\D\d+\.\d+',text)
                elif len(re.findall('\d+\.\d+', dic2[d][4])) == 1:
                    matchamt = re.search(r'\d+\.\d+',text)
                dic2[d][4] = matchamt.group()
            if d>1 and dic2[d][4].__contains__('Total') and (dic2[d-1][3].__contains__('Total') or dic2[d-1][2].__contains__('Total')):
                dic2[d][4] = ' '

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Pranaam_N0091':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if  dic2[d][4]!= ' ' and len(re.findall('\d+\.\d+', dic2[d][4])) ==2 and len(dic2[d][4].split())==2:
                # print('splitting rate and gst % in 4th indx and assigning rate to 4th indx')
                text = dic2[d][4].split()
                dic2[d][4] = text[0]
            if  dic2[d][4]!= ' ' and len(re.findall('\d+\.\d+', dic2[d][4])) ==3 and len(dic2[d][4].split())==3:
                # print('splitting rate, gst % , gst amt in 4th indx and assigning rate to 4th indx, gst amt to 5th indx')
                text = dic2[d][4].split()
                dic2[d][4] = text[0]
                dic2[d][5] = text[-1]
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Pranaam_N0091_1':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d > 2 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal' and dic2[d - 2][1] != 'Subtotal':
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            if d==len(dic2) and dic2[d][1]!='Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Pranaam_N0091_2':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d==len(dic2) and dic2[d][1]!='Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Delhi_N0383':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if dic2[d][0]!=' ' and len(re.findall('\d+\/\d\s?\d\/\d+\s\D+\s\d+\/\d\s?\d\/\d+', dic2[d][0])) == 1 and len(dic2[d][0].split())>2:
                print('for room charge')
                text = dic2[d][0]
                matchdate = re.search(r'\d+\/\d\s?\d\/\d+\s\D+\s\d+\/\d\s?\d\/\d+',text)
                dic2[d][1] = dic2[d][0].replace(matchdate.group(),'')+dic2[d][1]
                dic2[d][0] = matchdate.group()
                text1 = dic2[d][3]
                dic2[d][3] = dic2[d][2]
                dic2[d][2] = text1



            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Deep_N13653':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if dic2[d][2] != ' ' and (dic2[d][3] != ' ' or dic2[d][3] == ' ') and len(
                    re.findall('\d+\.\d+', dic2[d][2])) == 2 and len(dic2[d][2].split()) >= 2 and dic2[d][3] in dic2[d][
                2]:
                print('if qty in rate i.2 3 in 2nd indx and 3rd indx not empty')
                text = dic2[d][2].split()
                dic2[d][2] = text[0]
            if d > 1 and dic2[d][4].__contains__('Total') and (
                    dic2[d - 1][3].__contains__('Total') or dic2[d - 1][2].__contains__('Total')):
                dic2[d][4] = ' '
            if d > 2 and dic2[d][0] in head_list and 'Total' not in dic2[d][3] and 'Total' not in dic2[d - 1][
                3] and 'Total' not in dic2[d - 1][2]:
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', ' ', ' ', 'Total', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'omnihospital_N12946':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d > 1 and dic2[d][0].__contains__('PHARMACY') and dic2[d - 1][0].__contains__('RETURN'):
                dic2[d][0] = 'PHARMACY RETURNS'
                dic2[d - 1][0] = ' '
            if d > 2 and dic2[d][0] in head_list and 'Sub Total' not in dic2[d][3] and 'Sub Total' not in dic2[d - 1][
                3]:
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', ' ', ' ', 'Sub Total', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'omnihospital_N12946_1':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d > 1 and len(re.findall('\d+\-\d+\-\d+', dic2[d][0])) == 1 and dic2[d - 1][4].__contains__(
                    'Sub Total') and dic2[d][0] not in head_list:
                print('removing unneccessary sbts')
                dic2[d - 1][4] = ' '
                dic2[d - 1][5] = ' '
            if d > 2 and dic2[d][0] in head_list and dic2[d - 1][4] != 'Sub Total' and dic2[d - 2][1] != 'Sub Total':
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', ' ', ' ', ' ', 'Sub Total', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'omni_hospital':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            print('mddd==', dic2[d])
            if d > 1 and dic2[d][0].__contains__('PHARMACY') and dic2[d - 1][0].__contains__('RETURN'):
                dic2[d][0] = 'PHARMACY RETURNS'
                dic2[d - 1][0] = ' '
            # if f>1 and dic2[d][0] in head_list and dic2[d-1][1] != 'Subtotal':
            #     print('add sbt',dic2[d-1],dic2[d])
            #     #dic1[lq] = dic2[d]
            #     dic1[lq] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            #     lq += 1
            # if f > 1 and d==fn  and dic2[d][1]!='Subtotal' :
            #     print('add sbt',dic2[d])
            #     dic1[lq] = dic2[d]
            #     dic1[lq+1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Bhandup_N16963' or hospital == 'siddhivinayak_N16078':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d>1 and dic2[d][0] in head_list and dic2[d].count(' ')!=5:
                print('if header and line items are merged')
                listnw = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq+=1
                dic1[lq-1] = listnw
                dic2[d][0] = ' '


            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Apollospectra_N7036':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d > 2 and dic2[d][0] in head_list and 'Sub Total' not in dic2[d-1][2] and 'Sub Total' not in dic2[d - 2][2]:
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', ' ', 'Sub Total', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Apollospectra_N7036_1':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if dic2[d][3]!= ' ' and dic2[d][4] == ' ' and len(re.findall('\d\.\d', dic2[d][3])) == 2:
                print('if rate quantity together in 3rd indx')
                text = dic2[d][3]
                matchrate = re.search(r'\d+\D?\d+\.\d{2}',text)
                dic2[d][3] = matchrate.group()
                dic2[d][4] = text.replace(matchrate.group(),'')
            if d > 2 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d-1][2] and 'Subtotal' not in dic2[d - 2][2]:
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            if d==len(dic2) and dic2[d][1]!='Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Apollospectra_N7036_2':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d==len(dic2) and dic2[d][1]!='Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Mayom_N9522':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Mayom_N9522-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d == 1 and dic2[d][0] != 'Pharmacy':
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = ['Pharmacy', ' ', ' ', ' ', ' ', ' ']
            if d==len(dic2) and dic2[d][1]!='Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'SGHS_N5327':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if dic2[d][2]!= ' ' and (dic2[d][3]!= ' ' or dic2[d][3]== ' ') and len(re.findall('\d\.\d', dic2[d][2])) == 2 and dic2[d][3] in dic2[d][2] and len(dic2[d][2].split())==2:
                # print('if rate and qty in 2nd indx')
                text = dic2[d][2].split()
                dic2[d][2] = text[0]
                dic2[d][3] = text[1]

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Apex_N16023':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d > 2 and dic2[d][0] in head_list and 'Total' not in dic2[d - 1][4] and 'Total' not in dic2[d - 2][2]:
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', ' ', ' ', ' ', 'Total', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Signature_N17192':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d > 1 and dic2[d][3] != ' ' and dic2[d][4] != ' ' and dic2[d][5] != ' ' and dic2[d - 1][3] == ' ' and \
                    dic2[d - 1][4] == ' ' and dic2[d - 1][5] == ' ' and \
                    dic2[d][1] == ' ' and dic2[d - 1][1] != ' ' and dic2[d].count(' ') == 2 and dic2[d - 1].count(
                ' ') == 4:
                print('if 2 lines divided d 2, d-1 4')
                new_l = copy.deepcopy(opr1(dic2[d - 1], dic2[d], src_dc))
                dic1[lq - 1] = new_l
                continue

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Signature_N17192_daycare':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d == 1 and dic2[d][0] != 'Head':
                listnw = ['Head', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][4] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Bhagat_N3879':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d > 2 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d - 1][2] and 'Subtotal' not in dic2[d - 2][
                2]:
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
            if d == len(dic2) and dic2[d][2] != 'Subtotal':
                listnw = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Sunshine_N10387' or hospital == 'Sunshine_N10387_1':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d > 1 and d < len(dic2) and dic2[d][0] in head_list and dic2[d + 1][0] == dic2[d][0]:
                dic2[d + 1][0] = dic2[d + 1][0].upper()
            if d > 2 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d - 1][2] and 'Subtotal' not in dic2[d - 2][
                2]:
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
            if d == len(dic2) and dic2[d][2] != 'Subtotal':
                listnw = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Sunshine_N10387-pharma' or hospital == 'Sunshine_N10387_1-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d > 1 and d < len(dic2) and dic2[d][0] == 'Item' and dic2[d + 1][0] == 'Item Return' and dic2[d][
                5] != ' ':
                dic2[d][0] = 'Subtotal'
            if d == len(dic2) and dic2[d][0] == 'Item Return' and dic2[d][5] != ' ':
                dic2[d][0] = 'Subtotal'
            if dic2[d][0] == 'Item' and dic2[d].count(' ') == 5:
                dic2[d][0] = 'Pharmacy'
            if dic2[d][0] == 'Item Return' and dic2[d].count(' ') == 5:
                dic2[d][0] = 'Pharmacy Return'
            if d > 2 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d - 1][0]:
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = ['Subtotal', ' ', ' ', ' ', ' ', ' ']
            if d == len(dic2) and dic2[d][0] != 'Subtotal':
                listnw = ['Subtotal', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Sarvodaya_N2958':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Sarvodaya_N2958-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if dic2[d][2] != ' ' and len(dic2[d][2].split()) == 2 and len(re.findall('\d\.\d', dic2[d][2])) == 2:
                print('if rate qty in 2nd indx')
                a, b = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = b
            if dic2[d][4] != ' ' and len(dic2[d][4].split()) >= 2:
                print('if amount, tax% and tax in 4th indx')
                text = dic2[d][4].split()
                dic2[d][4] = text[0]
                if dic2[d][5] == ' ':
                    dic2[d][5] = text[-1]

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'rjnapollo_N17864':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d > 1 and d < len(dic2) and dic2[d][1] == ' ' and dic2[d - 1][0].__contains__('General Registration'):
                dic2[d][1] = 'General Registration'
            if d > 1 and d < len(dic2) and dic2[d][1] == ' ' and dic2[d - 1][0].__contains__('Admission Charge'):
                dic2[d][1] = 'Admission Charge'
            if d > 2 and dic2[d][0] in head_list and 'Sub Total' not in dic2[d - 1][2] and 'Sub Total' not in \
                    dic2[d - 1][3]:
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', ' ', 'Sub Total', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Kalyani_N0731':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d > 1 and dic2[d][0] in head_list and dic2[d][0] == dic2[d + 1][0]:
                dic2[d + 1][0] = dic2[d + 1][0] + 'S'
            if d > 1 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d - 1][3] and dic2[d].count(' ') >= 4:
                # print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', ' ', ' ', 'Subtotal', ' ', ' ']
            if d == len(dic2) and dic2[d][5] != ' ' and len(dic2[d][5].split()) >= 2 and len(
                    re.findall('\d\s?\.\s?\d', dic2[d][5])) >= 1:
                # print('if final total is added to last line')
                text = dic2[d][5].split()
                dic2[d][5] = text[0]
            if d == len(dic2) and dic2[d][3] != 'Subtotal' and dic2[d - 1][3] != 'Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', 'Subtotal', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'apollo_N12340':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d > 1 and d < len(dic2) and dic2[d][1] == ' ' and dic2[d - 1][0].__contains__('General Registration'):
                dic2[d][1] = 'General Registration'
            if d > 1 and d < len(dic2) and dic2[d][1] == ' ' and dic2[d - 1][0].__contains__('Admission Charge'):
                dic2[d][1] = 'Admission Charge'
            if d > 1 and d < len(dic2) and dic2[d][1] == ' ' and dic2[d - 1][0].__contains__('EMR Charge'):
                dic2[d][1] = 'EMR Charge'
            if d > 1 and dic2[d][0] in head_list and 'Sub Total' not in dic2[d - 1][4] and dic2[d].count(' ') >= 4:
                # print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', ' ', ' ', ' ', 'Sub Total', ' ']
            if d == len(dic2) and 'Sub Total' not in dic2[d][4] and 'Sub Total' not in dic2[d - 1][4]:
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', ' ', 'Sub Total', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Imax_N13295':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d > 1 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d - 1][4] and dic2[d].count(' ') >= 4:
                # print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', ' ', ' ', ' ', 'Subtotal', ' ']
            if d == len(dic2) and dic2[d][4] != 'Sub Total' and dic2[d - 1][4] != 'Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', ' ', 'Subtotal', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Imax_N13295_1':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if dic2[d][0]!= ' ' and dic2[d][0] in head_list and dic2[d].count(' ')<=4:
                print('if header line item same')
                dic2[d][0] = dic2[d][0].lower()
            if d > 1 and dic2[d][0] in head_list and 'Sub Total' not in dic2[d - 1][3] and dic2[d].count(' ') >= 4:
                # print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', ' ', ' ', 'Sub Total', ' ', ' ']
            if d == len(dic2) and dic2[d][3] != 'Sub Total' and dic2[d - 1][3] != 'Sub Total':
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', 'Sub Total', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Jaiprakash_N18187':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d > 1 and dic2[d][0] != ' ' and dic2[d][0] in head_list and dic2[d - 1][0] in head_list and dic2[d][0] == \
                    dic2[d - 1][0]:
                dic2[d][0] = dic2[d][0] + dic2[d][0][-1]
            if d > 1 and dic2[d][4] != ' ' and len(dic2[d][4].split()) >= 2 and len(
                    re.findall('\d+\.\d+', dic2[d][4])) == 2:
                text = dic2[d][4].split()
                dic2[d][4] = text[0]
            if d > 1 and dic2[d][0] in head_list and 'Sub Total' not in dic2[d - 1][3] and dic2[d].count(' ') >= 4:
                # print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', ' ', ' ', 'Sub Total', ' ', ' ']
            if d == len(dic2) and dic2[d][3] != 'Sub Total' and dic2[d - 1][3] != 'Sub Total':
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', 'Sub Total', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Kolekar_N13498':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d > 1 and d < len(dic2) and dic2[d][0] in head_list and dic2[d - 1][0] in head_list and dic2[d][0] == \
                    dic2[d - 1][0]:
                dic2[d][0] = dic2[d][0].lower()

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'apollocradle_N11090':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d > 1 and d < len(dic2) and dic2[d][1] == ' ' and dic2[d - 1][0].__contains__('Admission Charge'):
                dic2[d][1] = 'Admission Charge'
            if d > 1 and d < len(dic2) and dic2[d][1] == ' ' and dic2[d - 1][0].__contains__('EMR Charge'):
                dic2[d][1] = 'EMR Charge'
            if d > 1 and d < len(dic2) and dic2[d][1] == ' ' and dic2[d - 1][0].__contains__('Round Off'):
                dic2[d][1] = 'Round Off'
            if d > 2 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d - 1][2] and 'Subtotal' not in dic2[d - 2][
                2]:
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'apollocradle_N11090_1':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d > 1 and dic2[d][0].__contains__('PHARMACY') and dic2[d - 1][0].__contains__('RETURN'):
                dic2[d][0] = 'PHARMACY RETURNS'
                dic2[d - 1][0] = ' '

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Felix_N15239':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Smt_N1586':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if dic2[d][2] != ' ' and dic2[d][0] != ' ' and len(re.findall('\d+\-\d+\-\d+', dic2[d][2])) >= 1 and len(
                    re.findall('\d+\-\d+\-\d+', dic2[d][0])) == 0:
                print('changing items for bedcharges and package')
                text = dic2[d][2]
                dic2[d][2] = dic2[d][0]
                dic2[d][0] = text
            if dic2[d][4] != ' ' and dic2[d][5] != ' ' and len(re.findall('\d+\-\d+\-\d+', dic2[d][0])) == 1 and dic2[
                d].count(' ') <= 3 and len(dic2[d][4]) <= 5:
                print('changing qty from 4th indx to 3rd indx')
                dic2[d][3] = dic2[d][4]
                dic2[d][4] = ' '

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Dr.rao_N10644':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d > 2 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d - 1][2] and 'Subtotal' not in dic2[d - 2][
                2]:
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Kamakshi_N1061':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][0] in head_list and dic2[d][0] == dic2[d - 1][0]:
                dic2[d][0] = dic2[d][0].lower()
            if dic2[d][5] != ' ' and len(dic2[d][5].split()) >= 2 and len(
                    re.findall('\d+\s?\.?\d+\s?\d+\D?\.?\d+\.?\s?\d+', dic2[d][5])) >= 1 and len(dic2[d][5]) > 11:
                print('if extra total is added to 5th indx')
                text = dic2[d][5].split()
                dic2[d][5] = dic2[d][5].replace(dic2[d][5].split()[-1], '')
                dic2[d][5] = dic2[d][5].strip()
            if d > 2 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d - 1][2] and 'Subtotal' not in dic2[d - 2][
                2]:
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Rao_N11371':
        dic2 = dicA
        dic0 = {}
        dic3 = {}
        dic4 = {}
        dic5 = dict()
        lq = 1
        k = 0
        sliceddict = {}
        for d in dic2:
            print('mmdd0000===', dic2[d])
            if dic2[d][0].__contains__('Sub Total For') and len(re.findall('\d\s?\.\s?\d', dic2[d][5])) == 1:
                print('yesss for sbtss')
                listnw = [dic2[d][0].replace('Sub Total For ', '', 1), ' ', ' ', ' ', ' ', ' ']
                dic0[k + 1111] = listnw
                sliceddict = dict(itertools.islice(dic2.items(), k, d))
                dic3 = {**dic0, **sliceddict}
                for i, j in dic3.items():
                    dic4[i] = j
                dic0.popitem()
                k = d
                l = 0
                for i, j in dic4.items():
                    dic5[l] = j
                    l += 1
            # print('dic5==', dic5)
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic5

        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd111==', dic2[d])
            if dic2[d][0] != ' ' and len(dic2[d][0].split()) >= 2 and len(
                    re.findall('\d+\/\d\s?\d\/\d+', dic2[d][0])) == 1:
                # print('if date parti together in 0th indx')
                text = dic2[d][0]
                matchdate = re.search(r'\d+\/\d\s?\d\/\d+', text)
                dic2[d][0] = matchdate.group()
                dic2[d][1] = text.replace(matchdate.group(), '')
                dic2[d][1] = dic2[d][1].strip()
            if d > 1 and d < len(dic2) and dic2[d][0].__contains__('Sub Total') and dic2[d - 1][0] in head_list and \
                    dic2[d - 1].count(' ') == 5:
                print('1 line header and sub total')
                dic2[d][1] = dic2[d - 1][0]

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Rao_N11371-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd00==', dic2[d])
            if dic2[d][4] != ' ' and len(dic2[d][4].split()) >= 2:
                print('if 3rd indx rate and amounts are present')
                text = dic2[d][4].split()
                dic2[d][4] = text[0]
            if d == 1 and dic2[d][0] != 'Medicine':
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = ['Medicine', ' ', ' ', ' ', ' ']
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Rao_N11371_1':
        dic2 = dicA
        dic0 = {}
        dic3 = {}
        dic4 = {}
        dic5 = dict()
        lq = 1
        k = 0
        sliceddict = {}
        for d in dic2:
            print('mmdd0000===', dic2[d])
            if dic2[d][0].__contains__('Subtotal') and len(re.findall('\d\s?\.\s?\d', dic2[d][5])) == 1:
                print('yesss for sbtss')
                listnw = [dic2[d][0].replace('Subtotal ', '', 1), ' ', ' ', ' ', ' ', ' ']
                dic0[k + 1111] = listnw
                sliceddict = dict(itertools.islice(dic2.items(), k, d))
                dic3 = {**dic0, **sliceddict}
                for i, j in dic3.items():
                    dic4[i] = j
                dic0.popitem()
                k = d
                l = 0
                for i, j in dic4.items():
                    dic5[l] = j
                    l += 1
            # print('dic5==', dic5)
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic5
        # dic2 = dicA
        # dic1 = {}
        # lq = 1
        # for d in dic2:
        #     print('mddd00==', dic2[d])
        #     if d > 2 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d - 1][2] and 'Subtotal' not in dic2[d - 2][
        #         2]:
        #         print('add sbt')
        #         dic1[lq] = dic2[d]
        #         dic1[lq - 1] = dic2[d - 1]
        #         lq += 1
        #         dic1[lq - 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
        #     if d == len(dic2) and dic2[d][1] != 'Subtotal':
        #         dic1[lq] = dic2[d]
        #         dic1[lq + 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
        #
        #     dic1[lq] = dic2[d]
        #     lq += 1
        # dicA = dic1
    # //////////////////////////
    if hospital == 'Divya_N3993':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd00==', dic2[d])

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Aster_N3405':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd00==', dic2[d])

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Chandra_N4134':
        dic2 = dicA
        dic1 = {}
        lq = 1
        Header = []
        for d in dic2:
            print('mddd00==', dic2[d])
            if dic2[d][0] in head_list:
                if dic2[d][0] not in Header:
                    Header.append(dic2[d][0])
                else:
                    dic2[d][0] = ' '
                    dic2[d][1] = ' '
            if d > 2 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d - 1][2] and 'Subtotal' not in dic2[d - 2][
                2]:
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Surana_N6086':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd00==', dic2[d])
            if dic2[d][1] != ' ' and dic2[d][3] == ' ' and dic2[d][4] != ' ' and len(
                    re.findall('\d\.\d', dic2[d][1])) == 1:
                print('if Rate with Parti')
                text = dic2[d][1].split()
                dic2[d][3] = text[-1]
                dic2[d][1] = dic2[d][1].replace(text[-1], '')

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'motherhood_N16105' or hospital == 'apollocradle_N5547':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd00==', dic2[d])
            if dic2[d][5]!=' ' and len(dic2[d][5].split())>=2 and len(re.findall('\d\.\d', dic2[d][5])) >= 1:
                text = dic2[d][5].split()
                dic2[d][5] = text[-1]

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Sight_N0382':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd00==', dic2[d])
            if d > 2 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d - 1][3]:
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', ' ', ' ', 'Subtotal', ' ', ' ']
            if d == len(dic2) and dic2[d][3] != 'Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', 'Subtotal', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'icare_N4346':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd00==', dic2[d])
            if d >= 1 and d < len(dic2) and dic2[d][0] != ' ' and dic2[d][0].__contains__('Procedure') and dic2[d][
                1] != ' ':
                dic2[d][0] = dic2[d][0] + ' ' + dic2[d][1]
                dic2[d][1] = ' '
            if d > 2 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d - 1][3]:
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', ' ', ' ', 'Subtotal', ' ', ' ']
            if d == len(dic2) and dic2[d][3] != 'Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', 'Subtotal', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Care_N0260':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd00==', dic2[d])
            if dic2[d][3] != ' ' and len(dic2[d][3].split()) == 2 and dic2[d][4] == ' ':
                a, b = dic2[d][3].split()
                dic2[d][3] = a
                dic2[d][4] = b
            if d > 1 and dic2[d][3] != ' ' and dic2[d][3].__contains__('TOTAL F') and dic2[d][2] != ' ':
                print('if line item in Total line')
                dic2[d - 1][2] = dic2[d - 1][2] + ' ' + dic2[d][2]
                dic2[d][2] = ' '

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Specialist_N16248':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd00==', dic2[d])
            if d > 1 and dic2[d][0] in src_dc['merge_set'] and dic2[d - 1][0].__contains__('Total') and dic2[d - 1][
                5] != ' ':
                dic2[d - 1][0] = ' '
                dic2[d - 1][5] = ' '

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'apollo_N15141':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d > 2 and dic2[d][0] in head_list and 'Sub Total' not in dic2[d - 1][2] and 'Sub Total' not in \
                    dic2[d - 2][2]:
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', ' ', 'Sub Total', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'apollo_N15141_1':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if dic2[d][2] != ' ' and dic2[d][3] != ' ' and dic2[d][2] == dic2[d][3]:
                dic2[d][2] = ' '
            if d > 1 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d - 1][2]:
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'KMS_N2554':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d>1 and dic2[d][0]!= ' ' and dic2[d-1][0]!= ' ' and dic2[d-1][0]==dic2[d][0] and dic2[d].count(' ')!=dic2[d-1].count(' '):
                dic2[d][0] = dic2[d][0].lower()
            if d > 2 and dic2[d][0] in head_list and 'Sub Total' not in dic2[d - 1][4] and 'Sub Total' not in dic2[d-1][3]:
                print('add sbt')
                dic1[lq] = [' ', ' ', ' ', ' ', 'Sub Total', ' ']
                lq+=1


            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'KMS_N2554-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d==1 and dic2[d][0]!='Pharmacy':
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = ['Pharmacy', ' ', ' ', ' ', ' ', ' ']
            if d==len(dic2) and dic2[d][2]!='Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', 'Subtotal', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'bhagwan_N15792':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d>1 and dic2[d][0]!=' ' and dic2[d][0].split()[0] in src_dc['merge_set'] and dic2[d][0] not in src_dc['merge_set'] and \
                    dic2[d][0] not in head_list and len(dic2[d][0].split())<=5:
                print('if subheader and line item merged')
                listnw = [dic2[d][0].split()[0], ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq+=1
                dic1[lq-1] = listnw
                dic2[d][0] = dic2[d][0].replace(dic2[d][0].split()[0],'')


            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'bhagwan_N15792-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd111===', dic2[d])
            if d==1 and dic2[d][0]!='Medicines':
                listnw = ['Medicines', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq-1] = listnw



            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'icon_N1504':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d>1 and d<len(dic2) and dic2[d][0] in head_list and dic2[d-1][0] in head_list and dic2[d][0] == dic2[d-1][0]:
                dic2[d][0] = dic2[d][0].lower()


            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'icon_N1504_daycare':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d==1 and dic2[d][0] in head_list:
                listnw = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq-1] = listnw
                dic2[d][0] = dic2[d][0].lower()
            if d>1 and dic2[d][0] in head_list:
                listnw = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq+=1
                dic1[lq-1] = listnw
                dic2[d][0] = dic2[d][0].lower()

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd11==', dic2[d])
            if d > 1 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d-1][2]:
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            if d==len(dic2) and dic2[d][1]!='Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Sankara_N2331':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])


            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Brahma_N1458':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if dic2[d][4]!= ' ' and len(dic2[d][4].split())==2:
                text = dic2[d][4].split()
                dic2[d][4] = text[0]
            if dic2[d][5] != ' ' and len(dic2[d][5].split()) == 2:
                text = dic2[d][5].split()
                dic2[d][5] = text[0]
            if d > 2 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d - 1][2]:
                print('add sbt')
                dic1[lq] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                lq+=1
            if d == len(dic2) and dic2[d][2] != 'Subtotal':
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'aj_N1035':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d>1 and dic2[d][0] in head_list and dic2[d-1][0] in head_list and dic2[d].count(' ')!=5:
                dic2[d][0] = dic2[d][0].lower()
            if d > 2 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d - 1][2]:
                print('add sbt')
                dic1[lq] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                lq+=1
            if d == len(dic2) and dic2[d][2] != 'Subtotal':
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'aj_N1035-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d==1 and dic2[d][0]!='Pharmacy':
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq-1] = ['Pharmacy', ' ', ' ', ' ', ' ', ' ']
            if d == len(dic2) and dic2[d][2] != 'Subtotal':
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Kanchi_N13513':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Shukan_N15961':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d > 2 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d - 1][2]:
                print('add sbt')
                dic1[lq] = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
                lq+=1
            if d == len(dic2) and dic2[d][2] != 'Subtotal':
                print('add sbt')
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Shukan_N15961-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            # if d > 2 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d - 1][2]:
            #     print('add sbt')
            #     dic1[lq] = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
            #     lq+=1
            # if d == len(dic2) and dic2[d][2] != 'Subtotal':
            #     print('add sbt')
            #     dic1[lq] = dic2[d]
            #     dic1[lq+1] = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Vadamalayan_N2487':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'apollo_N8396':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d==1 and dic2[d][0]!= ' ' and dic2[d][0]!='Head':
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = ['Head', ' ', ' ', ' ', ' ', ' ']
            if d==len(dic2) and dic2[d][2]!='Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', 'Subtotal', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Rubanhospital_N0330':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd111===', dic2[d])
            if d > 1 and dic2[d][0] == 'DIALYSIS SERVICES' and dic2[d + 1][0] not in src_dc['merge_set']:
                print('if sub header and heder are same')
                dic2[d][0] = dic2[d][0].lower()
            if d > 1 and dic2[d][0] != ' ' and dic2[d][0] in src_dc['merge_set'] and 'TOTAL' in dic2[d - 1][2]:
                dic2[d - 1][2] = dic2[d - 1][2].replace('TOTAL', 'Subtotal')
            if d > 1 and dic2[d][0] != ' ' and dic2[d][0] in src_dc['merge_set'] and 'TOTAL' in dic2[d - 1][3]:
                dic2[d - 1][3] = dic2[d - 1][3].replace('TOTAL', 'Subtotal')
            if d > 1 and 'TOTAL' in dic2[d][3] and 'TOTAL' in dic2[d - 1][3]:
                dic2[d - 1][3] = dic2[d - 1][3].replace('TOTAL', 'Subtotal')
            if d > 1 and 'TOTAL' in dic2[d][2] and 'TOTAL' in dic2[d - 1][2]:
                dic2[d - 1][2] = dic2[d - 1][2].replace('TOTAL', 'Subtotal')

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'holy':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f > 2 and dic2[d][0] in head_list and 'TOTAL' not in dic2[d-1][4] and 'TOTAL' not in dic2[d-1][5]:
                print('add sbt1', dic2[d - 1], dic2[d])
                dic1[lq] = [' ', ' ', ' ', ' ', 'TOTAL', ' ']
                lq += 1
            if f > 1 and d == fn and 'TOTAL' not in dic2[d][4] and 'TOTAL' not in dic2[d][5]:
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', ' ', 'TOTAL', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'raheja':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d > 2 and dic2[d][0]!=' ' and dic2[d][0] in head_list and 'Sub Total' not in dic2[d-1][3]:
                print('add sbt')
                listnw = [' ', ' ', ' ', 'Sub Total', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and 'Sub Total' not in dic2[d][3]:
                print('add sbt last')
                listnw = [' ', ' ', ' ', 'Sub Total', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Sushrut_N1598':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'LVPrasad_N0071':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if dic2[d][0]!=' ' and dic2[d][0].__contains__('underwent'):
                text = dic2[d][0]
                start_point = 'underwent'
                end_point = 'for the'
                start_index = dic2[d][0].find(start_point) + len(start_point)
                print('startindx',start_index)
                end_index = dic2[d][0].find(end_point)
                print('startindx', end_index)
                words_between = dic2[d][0][start_index:end_index]
                dic2[d][0] = words_between.strip()
                print('words_between',words_between)
                start_point_values = ['for Rs','for R$']
                for i in start_point_values:
                    # print('i==', i)
                    if i in text:
                        print('starti==', i)
                        start_point_for_amount = i
                end_point_values = ['or which','for which']
                for i in end_point_values:
                    # print('i==',i)
                    if i in text:
                        print('endi==',i)
                        end_point_for_amount = i
                # if end_point_for_amount != 'for which':
                #     end_point_for_amount = 'or which'
                start_index_for_amount = text.find(start_point_for_amount) + len(start_point_for_amount)
                end_index_for_amount = text.find(end_point_for_amount)
                amounts_between = text[start_index_for_amount:end_index_for_amount]
                print('amounts==',amounts_between)
                dic2[d][5] = amounts_between.strip()

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if dic2[d][5]!=' ' and dic2[d][5].__contains__('/-'):
                dic2[d][5] = dic2[d][5].replace('/-','').strip()
            if d==1 and dic2[d][0] not in head_list and dic2[d][0]!='Package':
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq-1] = ['Package', ' ', ' ', ' ', ' ', ' ']
            if d > 1 and dic2[d][0] != ' ' and dic2[d][0] in head_list and 'Subtotal' not in dic2[d - 1][3]:
                print('add sbt')
                listnw = [' ', ' ', ' ', 'Subtotal', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and 'Subtotal' not in dic2[d][3]:
                print('add sbt last')
                listnw = [' ', ' ', ' ', 'Subtotal', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Utkal_N16075':
        dic2 = dicA
        lq = 1
        for d in dic2:
            print('mmdd000==', dic2[d])
            if dic2[d][1] in head_list and dic2[d].count(' ')>=4:
                dic2[d][0] = dic2[d][1]
                dic2[d][1] =  ' '
            if dic2[d][3]!=' ' and len(re.findall('\d{1,2}', dic2[d][3])) == 0:
                print('if other character in 1ty indx')
                dic2[d][3] = ' '
            if dic2[d][3] == '0':
                dic2[d][3] = ' '
            if dic2[d][5]!=' ' and len(dic2[d][5].split())>=2 and len(re.findall('\d+\.\d+', dic2[d][5])) == 1 and "TOTAL" not in dic2[d][5]:
                print('if rate and something merged in 5th indx')
                text = dic2[d][5]
                matchamt = re.search(r'\d+\.\d+',text)
                dic2[d][5] = matchamt.group()
            if dic2[d][5]!=' ' and len(dic2[d][5].split())>=2 and len(re.findall('\d+\.\d+', dic2[d][5])) == 2 and "TOTAL" not in dic2[d][5]:
                print('if Rate, amount in 5th indx in mglinedic')
                text = dic2[d][5].split()
                dic2[d][5] = text[-1]
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][0] in head_list and dic2[d][0] == dic2[d-1][0]:
                dic2[d][0] = dic2[d][0].lower()

            dicA[lq] = dic2[d]
            lq += 1

        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('md111==', dic2[d])
            if 'TOTAL BILL AMOUNT' in dic2[d][1]:
                dic2[d][1] = 'TOTAL AMOUNT'
            if dic2[d][0] == 'MEDICAL RECORD' and 'TOTAL AMOUNT' not in dic2[d-1][1]:
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq+=1
                dic1[lq-1] = [' ', 'TOTAL AMOUNT', ' ', ' ', ' ', ' ']
            if d==len(dic2) and 'TOTAL AMOUNT' not in dic2[d][1]:
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', 'TOTAL AMOUNT', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Tata_N15878':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('md111==', dic2[d])
            if dic2[d][1]!=' ' and len(dic2[d][1].split())>=2 and len(re.findall('^\d{8}\s\w+', dic2[d][1])) == 1:
                print('if code, parti together in mglinedic')
                text = dic2[d][1]
                matchcode = re.search(r'^\d{8}',text)
                dic2[d][1] = matchcode.group()
                dic2[d][2] = text.replace(matchcode.group(),'')+dic2[d][2]
                dic2[d][2] = dic2[d][2].strip()
            if d>1 and dic2[d][0] in head_list and 'Subtotal' not in dic2[d-1][0]:
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = ['Subtotal', ' ', ' ', ' ', ' ', ' ']
            if d == len(dic2) and 'Subtotal' not in dic2[d][0]:
                dic1[lq] = dic2[d]
                dic1[lq + 1] = ['Subtotal', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Devi_N3046':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('md0000==', dic2[d])
            if d==1 and 'Procedure' in dic2[d][0]:
                listnw = ['Surgery', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq-1] = ['Surgery', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('md111==', dic2[d])
            if 'Procedure.. :' in dic2[d][0]:
                dic2[d][0] = dic2[d][0].replace('Procedure.. :','').strip()
            if 'Procedure...:' in dic2[d][0]:
                dic2[d][0] = dic2[d][0].replace('Procedure...:','').strip()
            if d > 1 and dic2[d][0] != ' ' and dic2[d][0] in head_list and 'Subtotal' not in dic2[d - 1][3]:
                print('add sbt')
                listnw = [' ', ' ', ' ', 'Subtotal', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and 'Subtotal' not in dic2[d][3]:
                print('add sbt last')
                listnw = [' ', ' ', ' ', 'Subtotal', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Isha_N4843':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('md==', dic2[d])
            if d > 1 and dic2[d][0] != ' ' and dic2[d][0] in head_list and 'Subtotal' not in dic2[d - 1][3]:
                print('add sbt')
                listnw = [' ', ' ', ' ', 'Subtotal', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and 'Subtotal' not in dic2[d][3]:
                print('add sbt last')
                listnw = [' ', ' ', ' ', 'Subtotal', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'Ankura_N12127_2':
        ward_list = ['NICU', 'General Ward','Pediatric General Ward','PICU','Deluxe Room']
        ward_charges_found = False
        for d in dic1:
            print('hhhhhh', dic1[d])
            if dic1[d][0] in ward_list:
                ward_charges_found = True
                wardfound = dic1[d][0]
                print('wardfound==',wardfound)
                dic1[d][0] = ' '
            elif dic1[d][0] != ' ' and dic1[d][0] not in ward_list and len(dic1[d][0].split()) <= 5 and dic1[d].count(
                    ' ') == 5 and dic1[d][0] not in head_list:
                print('removing extra ward info')
                dic1[d][0] = ' '
            elif ward_charges_found and dic1[d][1] != ' ' and dic1[d].count(' ') <= 3:
                print('adding wardfound')
                dic1[d][1] = dic1[d][1] + ' ' + wardfound
                dic1[d][5] = dic1[d][4]
                print('dic1[d][1]',dic1[d][1])
            elif dic1[d][0] in head_list and dic1[d].count(' ') == 5:
                print('found next header')
                break

        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('md==', dic2[d])
            if ('Doctor Visit' in dic2[d][0] or 'Anaesthetist Fees' in dic2[d][0] or 'Surgeon Fees' in dic2[d][0]) and 'Dr.' in dic2[d][0]:
                dic2[d][1] = dic2[d][0]
                dic2[d][0] = ' '
            if d>1 and dic2[d][0] in head_list and dic2[d-1][5]!=' ' and len(dic2[d-1][5].split())==2:
                print('total amount before header')
                text = dic2[d-1][5].split()
                dic2[d-1][5] = text[0]
            if d==len(dic2) and dic2[d][5]!=' ' and len(dic2[d][5].split())==2:
                print('last line 2 amounts')
                text = dic2[d][5].split()
                dic2[d][5] = text[0]
            if d>1 and dic2[d][0] == 'Bed Charges' and dic2[d].count(' ')!=5:
                print('add bed charges above')
                listnw = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
                dic2[d][0] = ' '
            if d > 1 and dic2[d][0] != ' ' and dic2[d][0] in head_list and 'Subtotal' not in dic2[d - 1][3] and dic2[d][0]!='Bed Charges':
                print('add sbt')
                listnw = [' ', ' ', ' ', 'Subtotal', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and 'Subtotal' not in dic2[d][3]:
                print('add sbt last')
                listnw = [' ', ' ', ' ', 'Subtotal', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    # //////////////////////////
    if hospital == 'ramaiahmemorial':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dddddd',dic2[d])
            if dic2[d][0]==' +Consultation Charges':
                dic2[d][0]='Consultation Charges'
            if dic2[d][0]==' laproscopic Surgery':
                dic2[d][0]='laproscopic Surgery'
            if dic2[d][5]!=' ' and len(dic2[d][5].split())>=2 and dic2[d][4] == ' ':
                text = dic2[d][5].split()
                dic2[d][4] = text[0]
                dic2[d][5] = text[-1]
            if dic2[d][0].__contains__('Pharmacy') and dic2[d+1][0].__contains__('Materials'):
                print('pharma',dic2[d])
                dic2[d+1][0]='materials'
            for i in head_list:
                if d>1 and i in dic2[d][0] and dic2[d].count(' ')<=2 and  len(dic2[d][0])!=len(i) and dic2[d-1][2].__contains__(sbt):
                    print('header with line',dic2[d][0])
                    newline =[i, ' ', ' ', ' ', ' ', ' ']
                    dic2[d][0]=dic2[d][0].replace(i,'')
                    dic1[lq]=dic2[d]
                    dic1[lq-1]=dic2[d-1]
                    lq+=1
                    dic1[lq-1]=newline
            for i in head_list:
                 if d>1 and i in dic2[d][0] and dic2[d].count(' ')<=3  and dic2[d][2].__contains__(sbt):
                    print('header with line',dic2[d][0])
                    newline =[' ', ' ', 'Sub Total', ' ', ' ', ' ']
                    dic2[d][2]=dic2[d][2].replace('Sub Total',' ')
                    dic1[lq]=dic2[d]
                    dic1[lq-1]=dic2[d-1]
                    lq+=1
                    dic1[lq-1]=newline




            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital=='Virinchi_N14695-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if d>1 and dic2[d][0] in head_list:
                listnw = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq+=1
                dic1[lq-1] = listnw
            if d==len(dic2):
                listnw = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq+1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Aditihospital_N1437':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Dr.Ramesh_N13693':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal' and dic2[d - 2][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
            if dic2[d][0] in sub_head:
                dic2[d][4] = ' '
                dic2[d][5] = ' '
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Dr.Ramesh_N13693_1':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal' and dic2[d - 2][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
            if dic2[d][4] == '0.00':
                dic2[d][4] = ' '
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Pace_N16481':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal' and dic2[d - 2][1] != 'Subtotal':
                print('stoa', dic2[d])
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'kims_N1251':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dddddd', dic2[d])
            for i in head_list:
                if d > 1 and i in dic2[d][0] and dic2[d].count(' ') <= 5 and len(dic2[d][0]) != len(i) and dic2[d - 1][
                    3].__contains__(sbt):
                    print('header with line', dic2[d][0])
                    newline = [i, ' ', ' ', ' ', ' ', ' ']
                    dic2[d][0] = dic2[d][0].replace(i, '')
                    dic1[lq] = dic2[d]
                    dic1[lq - 1] = dic2[d - 1]
                    lq += 1
                    dic1[lq - 1] = newline
            if len(re.findall('\d{1,}\.\d+\s?', dic2[d][3])) == 1:
                print('ddate', dic2[d])
                text = dic2[d][3]
                matchdate = re.search(r'\d{1,}\.\d+\s?', text)
                dic2[d][3] = matchdate.group()

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Saraswati_N17332':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d > 1  and dic2[d][0] in head_list and  dic2[d - 1][1] != 'Subtotal' and dic2[d - 2][1] != 'Subtotal':
                print('stoa',dic2[d])
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Kamineni_N0066':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d > 1  and dic2[d][0] in head_list and  dic2[d - 1][1] != 'Subtotal' and dic2[d - 2][1] != 'Subtotal':
                print('stoa',dic2[d])
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d==len(dic2) and dic2[d][1]!='Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq+1] = listnw
            if dic2[d][0] in sub_head:
                dic2[d] = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'pushpawati_daycare':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d==len(dic2) and dic2[d][1]!='Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq+1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Horizon_N18007':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            # if d > 1 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal' and dic2[d - 2][1] != 'Subtotal':
            #     listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            #     dic1[lq] = dic2[d]
            #     dic1[lq - 1] = dic2[d - 1]
            #     lq += 1
            #     dic1[lq - 1] = listnw
            # if f > 1 and d == fn and dic2[d][1] != 'Sub Total':
            #     print('add sbt', dic2[d])
            #     dic1[lq] = dic2[d]
            #     dic1[lq + 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            if f>2 and dic2[d][0] in head_list and dic2[d-1][1] != 'Sub Total':
                print('add sbt',dic2[d-1],dic2[d])
                #dic1[lq] = dic2[d]
                dic1[lq] = [' ', 'Sub Total', ' ', ' ', ' ', ' ']
                lq += 1
            if f > 1 and d==fn  and dic2[d][1]!='Sub Total' :
                print('add sbt',dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', 'Sub Total', ' ', ' ', ' ', ' ']


            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Horizon_N18007-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f > 1 and d==fn  and dic2[d][1]!='Sub Total' :
                print('add sbt',dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', 'Sub Total', ' ', ' ', ' ', ' ']


            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Srikara1_N130081':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Srikara_N13008':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            for i in head_list:
                if d>1 and i in dic2[d][0] and dic2[d].count(' ')<=5 and  len(dic2[d][0])!=len(i) and dic2[d-1][2].__contains__(sbt):
                    print('header with line',dic2[d][0])
                    newline =[i, ' ', ' ', ' ', ' ', ' ']
                    dic2[d][0]=dic2[d][0].replace(i,'')
                    dic1[lq]=dic2[d]
                    dic1[lq-1]=dic2[d-1]
                    lq+=1
                    dic1[lq-1]=newline

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Sainath_N13533':
        dic1_a = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d == 1 and dic2[d][0] in head_list and dic2[d].count(' ') < 5:
                print('heshshhs', dic2[d])
                listnw = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d > 1 and dic2[d][0] in head_list and dic2[d].count(' ') < 5:
                print('heshshhs', dic2[d])
                listnw = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d > 1 and dic2[d][0] in head_list and dic2[d].count(' ') < 5:
                dic2[d][0] = dic2[d][0].lower()
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal':
                print('stoa', dic2[d])
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic1_a = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('diccsls', dic2[d])
            f += 1
            ss = ''
            if d > 1 and dic2[d][0] in head_list and dic2[d].count(' ') < 3:
                dic2[d][0] = dic2[d][0].lower()
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][1] != sbt:
                print('alll subtotals', dic2[d - 1], dic2[d])
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d > 1 and dic2[d][0].__contains__('OT No:1'):
                listnw = ['OT No:1', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d > 1 and dic2[d][0].__contains__('OT No:2'):
                listnw = ['OT No:2', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d > 1 and dic2[d][0].__contains__('OT No:2') and dic2[d].count(' ') < 5:
                dic2[d][0] = dic2[d][0].replace('OT No:2.', '')
            if d > 1 and dic2[d][0].__contains__('OT No:1') and dic2[d].count(' ') < 5:
                dic2[d][0] = dic2[d][0].replace('OT No:1.', '')
            if (len(re.findall('\d\-\d{2}\-\d', dic2[d][0])) == 1 or len(
                    re.findall('\d\/\d{2}\/\d', dic2[d][0])) == 1) and dic2[d][1] == ' ':
                dic2[d][1] = dic2[d][0]
                dic2[d][0] = ' '
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Pinnacle_N17194-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal' and dic2[d - 2][1] != 'Subtotal':
                print('stoa', dic2[d])
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'psghospital':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if f>1 and dic2[d][0] in head_list and len(re.findall('\d\-\w{3}\-\d',dic2[d-1][1]))==1:
                print('ddddssc', dic2[d])
                dic1[lq] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                lq += 1
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Victor_N0472':
        dic1_a = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d>1 and dic2[d][0] in head_list and dic2[d].count(' ')<5 and dic2[d-1][3] == sbt:
                print('for adding admission charges',dic2[d])
                listnw = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d==1 and dic2[d][0] in head_list and dic2[d].count(' ')<5:
                print('for adding admission charges',dic2[d])
                listnw = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic1_a = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            print('hellp',dic2[d])
            if dic2[d][0]!=' ' and dic2[d].count(' ')<4:
                dic2[d][0] = ' '

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Neelkanth_N4462':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f>2 and dic2[d][0] in head_list and dic2[d-1][1] != 'Sub Total':
                print('add sbt',dic2[d-1],dic2[d])
                #dic1[lq] = dic2[d]
                dic1[lq] = [' ', 'Sub Total', ' ', ' ', ' ', ' ']
                lq += 1
            if f > 1 and d==fn  and dic2[d][1]!='Sub Total' :
                print('add sbt',dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', 'Sub Total', ' ', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Muruganhospitals_N16133':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            if f > 2 and dic2[d][0] in head_list and dic2[d - 1][3] != 'Sub Total':
                print('add sbt1', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', ' ', ' ', 'Sub Total', ' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][1] != 'Sub Total':
                print('add sbt', dic2[d])
                dic1[lq + 1] = [' ', ' ', ' ', ' ', 'Sub Total', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Olive_N8339':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f>2 and dic2[d][0] in head_list and dic2[d-1][4] != 'Sub Total :':
                print('add sbt',dic2[d-1],dic2[d])
                #dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', ' ', ' ', 'Sub Total :', ' ']
                lq += 1
            if f > 1 and d==fn  and dic2[d][1]!='Sub Total' :
                print('add sbt',dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', ' ', ' ', ' ', 'Sub Total :', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

    if hospital == 'Malik_N4525':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            if f > 2 and dic2[d][0] in head_list and dic2[d - 1][3] != 'SubTotal':
                print('add sbt1', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', ' ', ' ', 'SubTotal', ' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][1] != 'SubTotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', ' ', 'SubTotal', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Malik_N4525_lab':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd11==', dic2[d])
            if d == 1 and dic2[d][0] != 'Laboratory':
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = ['Laboratory', ' ', ' ', ' ', ' ', ' ']
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq + 1] = ['Subtotal', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

    if hospital == 'kles_N0964-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd11==', dic2[d])
            if d == 1 and dic2[d][0] != 'Pharmacy':
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = ['Pharmacy', ' ', ' ', ' ', ' ', ' ']
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq + 1] = ['Subtotal', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1

    if hospital == 'Ruk_N15156':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d==len(dic2) and dic2[d][0]!='Total':
                dic2[d][0] = 'Total'
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Cytecare_N15167':
        dic1_a = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d>1 and dic2[d][0].__contains__('CHEMO CHARGES') and dic2[d].count(' ')<5 and dic2[d-1][5].__contains__(sbt) and dic2[d][0] not in head_list:
                print('adding headers',dic2[d])
                listnw = ['CHEMO CHARGES', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Sevenstar_N16095-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f>2 and dic2[d][0] in head_list and dic2[d-1][1] != 'Sub Total':
                print('add sbt',dic2[d-1],dic2[d])
                #dic1[lq] = dic2[d]
                dic1[lq] = [' ', 'Sub Total', ' ', ' ', ' ', ' ']
                lq += 1
            if f > 1 and d==fn  and dic2[d][1]!='Sub Total' :
                print('add sbt',dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', 'Sub Total', ' ', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'MaaRam':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            # f += 1
            # ss = ''
            # if f > 2 and dic2[d][0] in head_list and dic2[d - 1][2].__contains__('Total for'):
            #     print('add sbt', dic2[d - 1], dic2[d])
            #     # dic1[lq] = dic2[d]
            #     dic1[lq] = [' ', ' ', 'Total for', ' ', ' ', ' ']
            #     lq += 1
        #for d in dic2:

            print('dddddd', dic2[d])
            for i in head_list:
                if d > 1 and i in dic2[d][0] and dic2[d].count(' ') <= 2 and len(dic2[d][0]) != len(i) and \
                        dic2[d - 1][2].__contains__(sbt):
                    print('header with line', dic2[d][0])
                    newline = [i, ' ', ' ', ' ', ' ', ' ']
                    dic2[d][0] = dic2[d][0].replace(i, '')
                    dic1[lq] = dic2[d]
                    dic1[lq - 1] = dic2[d - 1]
                    lq += 1
                    dic1[lq - 1] = newline
                if len(dic2[d][3].split()) == 2:
                    print('splitingg', dic2[d])
                    a, b = dic2[d][3].split()
                    dic2[d][3] = a
                    dic2[d][4] = b


            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Naruvi_N18695':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f>2 and dic2[d][0] in head_list and (dic2[d-1][2] != 'Sub Total' or dic2[d-2][2]!='Sub Total'):
                print('add sbt',dic2[d-1],dic2[d])
                #dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', 'Sub Total', ' ', ' ', ' ']
                lq += 1
            if f > 1 and d==fn  and dic2[d][2]!='Sub Total' :
                print('add sbt',dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', ' ', 'Sub Total', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'hcg_N16943':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                listnw = [' ', ' ', ' ', ' ', ' ', ' ', 'Dept Total :', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'royalcare_N16908':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d > 1 and dic2[d][0] in head_list and  dic2[d - 1][1] != 'Subtotal' and dic2[d - 2][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d==len(dic2) and dic2[d][1]!='Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq+1] = listnw
            if f>1 and dic2[d][0] in sub_head:
                dic2[d] = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
            if d>1 and dic2[d][0] not in head_list and dic2[d][0] not in sub_head and dic2[d][1] == ' ' and len(dic2[d][0].split())>1 and dic2[d].count(' ')<5:
                a,b = dic2[d][0].split(' ',1)
                dic2[d][0] = a
                dic2[d][1] = b
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'tulip_N17041':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d > 1 and len(re.findall('\d\s?\.\s?\d', dic2[d][5])) == 1 and dic2[d][0] != ' ' and dic2[d - 1][2].__contains__(sbt):
                print('for adding Head before Insurance Line')
                listnw = ['Head', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if dic2[d][0].__contains__('Total'):
                dic2[d][0] = dic2[d][0].lower()
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'tulip_N17041_1':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('ddddd===', dic2[d])
            if dic2[d][0] != ' ' and len(re.findall('^\d+\s\d+\-\d+\-\d+', dic2[d][0])) == 1 and len(
                    dic2[d][0].split()[0]) <= 3 and dic2[d][1]==' ':
                print('to remove sno and brackets')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\s\d+\-\d+\-\d+', text)
                dic2[d][0] = matchsno.group()
                dic2[d][1] = text.replace(matchsno.group(),'')
                dic2[d][0] = dic2[d][0].strip()
                dic2[d][1] = dic2[d][1].strip()
            if dic2[d][0] != ' ' and len(re.findall('^\d+\-\d+\-\d+', dic2[d][0])) == 1 and dic2[d][1]==' ':
                print('to remove sno and brackets')
                text = dic2[d][0]
                matchsno = re.search(r'^\d+\-\d+\-\d+', text)
                dic2[d][0] = matchsno.group()
                dic2[d][1] = text.replace(matchsno.group(),'')
                dic2[d][0] = dic2[d][0].strip()


            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'star_1':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d > 1 and dic2[d][0] in head_list and  dic2[d - 1][1] != 'Subtotal' and dic2[d - 2][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d==len(dic2) and dic2[d][1]!='Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq+1] = listnw
            if d>1 and len(re.findall('\d\.\d',dic2[d][3]))==2 and len(dic2[d][3].split())==2:
                a,b = dic2[d][3].split()
                dic2[d][3] = a
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'st_john':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d > 1 and dic2[d][0] in head_list and  dic2[d - 1][1] != 'Subtotal' and dic2[d - 2][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d==len(dic2) and dic2[d][1]!='Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq+1] = listnw
            if d>1 and dic2[d][0] in head_list and dic2[d].count(' ')<3:
                dic2[d][0] = dic2[d][0].lower()
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Poona-2':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            # if d==1:
            #     listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            #     dic1[lq] = dic2[d]
            if d==len(dic2) and dic2[d][1]!='Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq+1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Vedant_N14369-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd11==', dic2[d])
            if d == 1 and dic2[d][0] != 'Pharmacy':
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = ['Pharmacy', ' ', ' ', ' ', ' ', ' ']
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq + 1] = ['Subtotal', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Gunjkar_N18660':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d==len(dic2) and dic2[d][4]!= sbt:
                listnw = [' ', ' ', ' ', ' ', 'Total', ' ']
                dic1[lq] = dic2[d]
                dic1[lq+1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'kauvery-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd11==', dic2[d])
            if d == 1 and dic2[d][0] != 'Pharmacy':
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = ['Pharmacy', ' ', ' ', ' ', ' ', ' ']
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                dic1[lq + 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'lokpriya_N2720':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f > 2 and dic2[d][0] in head_list and dic2[d - 1][4] != 'Sub Total':
                print('add sbt', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', ' ', ' ', 'Sub Total', ' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][1] != 'Sub Total':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', ' ', 'Sub Total', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'kles_N0964':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f>2 and dic2[d][0] in head_list and dic2[d-1][3] != 'Sub Total':
                print('add sbt',dic2[d-1],dic2[d])
                #dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', ' ', ' ', 'Sub Total', ' ']
                lq += 1
            if f > 1 and d==fn  and dic2[d][1]!='Sub Total' :
                print('add sbt',dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', ' ', ' ', ' ', 'Sub Total', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Sita_N0449':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            if f > 2 and dic2[d][0] in head_list and dic2[d - 1][3] != 'SubTotal':
                print('add sbt', dic2[d - 1], dic2[d])
                dic1[lq] = dic2[d-1]
                dic1[lq][3] = 'SubTotal'

            if f > 1 and d == fn and dic2[d][1] != 'SubTotal':
                print('addsbt', dic2[d])
                dic2[d][3] = 'SubTotal'
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Chetti_N14512':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            if f > 2 and dic2[d][0] in head_list and dic2[d - 1][3] != 'SubTotal':
                print('add sbt', dic2[d - 1], dic2[d])
                dic1[lq] = dic2[d - 1]
                dic1[lq][3] = 'SubTotal'

            if f > 1 and d == fn and dic2[d][1] != 'SubTotal':
                print('addsbt', dic2[d])
                dic2[d][3] = 'SubTotal'
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Oscar_N15386':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if d > 1 and d < len(dic2) and dic2[d][0] in head_list and dic2[d - 1][0] in head_list:
                print('if d in head_list and d-1 in head_list')
                dic2[d][0] = dic2[d][0] + dic2[d][0][-1]
            if d > 1 and d < len(dic2) and len(re.findall('\d{2}\/\d{2}\/\d{4}', dic2[d][0])) and dic2[d].count(
                    ' ') == 5:
                dic2[d - 1][0] = dic2[d - 1][0] + ' ' + dic2[d][0]
                dic2[d][0] = ' '
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Divine_N2841':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d==len(dic2) and dic2[d][2].__contains__('Total')  and dic2[d-1][2].__contains__('Total'):
                dic2[d] = [' ', ' ', ' ', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'mpct_N15237':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d>1 and dic2[d][0] in head_list and dic2[d+1][0] in head_list :
                dic2[d+1][0] = dic2[d+1][0].lower()
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][3] != sbt and dic2[d - 2][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'prk_2_N18788':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            if f > 2 and dic2[d][0] in head_list and dic2[d - 1][3] != 'Subtotal':
                print('add sbt', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', ' ', ' ', 'Subtotal', ' ',' ',' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][1] != 'Subtotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', ' ', 'Subtotal', ' ',' ',' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Kongunad_N2388':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            # if d>=1 and d<len(dic2) and dic2[d][1]!=' ' and dic2[d].count(' ')==5 and len(re.findall('\d\.\d',dic2[d-1][5]))==1 and dic2[d][1] not in head_list:
            #     print('break',dic2[d])
            #     dic2[d-1][1]= dic2[d-1][1]+' '+dic2[d][1]
            #     dic2[d][1]=' '
            if dic2[d][0].__contains__('SURGERY CHARGES'):
                dic2[d][0]='SURGERY CHARGES'
            if dic2[d][0] in head_list and dic2[d][1] == ' ' and dic2[d][3] != ' ' and dic2[d].count(' ') <= 4:
                print('if header with lines', dic2[d],dic2[d-1])
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq += 1
                dic1[lq-1] = [' ', ' ', ' ',dic2[d][3], ' ',dic2[d][5]]
                dic2[d][3]=' '
                dic2[d][5]=' '
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Life_N6303-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd11==', dic2[d])
            if d == 1 and dic2[d][0] != 'Pharmacy':
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = ['Pharmacy', ' ', ' ', ' ', ' ', ' ']
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                dic2[d][1] = 'Subtotal'

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Life_N6303':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            if f > 1 and dic2[d][0] in head_list and dic2[d - 1][3] != 'Sub Total :':
                print('add sbt1', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', ' ', 'Sub Total :', ' ', ' ']
                lq += 1

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Vyhospital_N14429':
        dic1_a = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d>1 and dic2[d][1].__contains__('Admission Fee') and dic2[d-1][4] == sbt:
                print('for adding admission charges')
                listnw = ['ADMISSION CHARGE', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
        dic1_a = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][4] != sbt:
                print('for adding admission charges', dic2[d])
                listnw = [' ', ' ', ' ', ' ', 'Subtotal', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Ashwini1_N3171':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f > 1 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal':
                print('add sbt', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic1[lq] = [' ', 'Subtotal', ' ', ' ', ' ', ' ', ' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][1] != 'Subtotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ', ' ']
            if d == 1 and len(re.findall('\d\.\d', dic2[d][5])) == 1 and (
                    dic2[d][1] == 'Registration Fee' or dic2[d + 1][1] == 'Subtotal'):
                print('for adding header package exclusions')
                listnw = ['Registration Fees', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Ashwini_N3171-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            print('mddd==', dic2[d])
            if f > 1 and d == fn and dic2[d][1] != 'Sub Total':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', 'Sub Total', ' ', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Omni_13897':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d>1 and len(re.findall('\d+\-\d+\-\d+', dic2[d][0])) == 1 and dic2[d-1][4].__contains__('Sub Total') and dic2[d][0] not in head_list:
                print('removing unneccessary sbts')
                dic2[d-1][4] = ' '
                dic2[d-1][5] = ' '
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'cims' or hospital == 'Ciigma_N5041':
        print('mmmmmmmmmmmmmergedlineddicc')
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            print('ddddmmm===', dic2[d])
            if dic2[d][0].__contains__('Total Charges') and dic2[d][5] != ' ':
                dic2[d][5] = ' '
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'srm_N17102-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f > 1 and d==fn  and dic2[d][2]!='Subtotal' :
                print('add sbt',dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']


            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Sarvodaya_N2657':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f>2 and dic2[d][0] in head_list and dic2[d-1][1] != 'Sub Total':
                print('add sbt',dic2[d-1],dic2[d])
                #dic1[lq] = dic2[d]
                dic1[lq] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                lq += 1
            if f > 1 and d==fn  and dic2[d][1]!='Sub Total' :
                print('add sbt',dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Yenepoya_N15770':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd11==', dic2[d])
            if dic2[d][0]=='ADMINISTRATIVE EXPENSES PROCESSING CHARGES (INSURANCE)' and dic2[d][1]==' ' and len(re.findall('\d\.\d',dic2[d][5])) and dic2[d-1][0] not in head_list:
                print('Admin',dic2[d])
                newline = ['ADMINISTRATIVE EXPENSES', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq-1]=dic2[d-1]
                lq+=1
                dic1[lq-1]=newline
                dic2[d][1]='PROCESSING CHARGES (INSURANCE)'
                dic2[d][0]=' '
            if dic2[d][0] in head_list and dic2[d][1] != ' ' and dic2[d].count(' ') >= 2:
                print('if header with lines', dic2[d])
                dic1[lq] = dic2[d]
                # dic1[lq-1] = dic2[d-1]
                lq += 1
                dic1[lq - 1] = [dic2[d][0], ' ', ' ', ' ', ' ', ' ', ' ']
                dic2[d][0] = ' '
            # for i in head_list:
            #     if d>1 and i in dic2[d][0] and dic2[d].count(' ')<=5 and  len(dic2[d][0])!=len(i) and dic2[d-1][4].__contains__(sbt):
            #         print('header with line',dic2[d][0])
            #         newline =[i, ' ', ' ', ' ', ' ', ' ']
            #         dic2[d][0]=dic2[d][0].replace(i,'')
            #         dic1[lq]=dic2[d]
            #         dic1[lq-1]=dic2[d-1]
            #         lq+=1
            #         dic1[lq-1]=newline
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Yenepoya1_N15770':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd11==', dic2[d])
            # if dic2[d][0]=='ADMINISTRATIVE EXPENSES PROCESSING CHARGES (INSURANCE)' and dic2[d][1]==' ' and len(re.findall('\d\.\d',dic2[d][5])) and dic2[d-1][0] not in head_list:
            #     print('Admin',dic2[d])
            #     newline = ['ADMINISTRATIVE EXPENSES', ' ', ' ', ' ', ' ', ' ', ' ']
            #     dic1[lq] = dic2[d]
            #     dic1[lq-1]=dic2[d-1]
            #     lq+=1
            #     dic1[lq-1]=newline
            #     dic2[d][1]='PROCESSING CHARGES (INSURANCE)'
            #     dic2[d][0]=' '
            if dic2[d][0] in head_list  and dic2[d].count(' ') <= 2:
                print('if header with lines', dic2[d])
                dic1[lq] = dic2[d]
                # dic1[lq-1] = dic2[d-1]
                lq += 1
                dic1[lq - 1] = [dic2[d][0], ' ', ' ', ' ', ' ', ' ', ' ']
                dic2[d][0] = ' '
            # for i in head_list:
            #     if d>1 and i in dic2[d][0] and dic2[d].count(' ')<=5 and  len(dic2[d][0])!=len(i) and dic2[d-1][4].__contains__(sbt):
            #         print('header with line',dic2[d][0])
            #         newline =[i, ' ', ' ', ' ', ' ', ' ']
            #         dic2[d][0]=dic2[d][0].replace(i,'')
            #         dic1[lq]=dic2[d]
            #         dic1[lq-1]=dic2[d-1]
            #         lq+=1
            #         dic1[lq-1]=newline
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Rajagiri_N18901':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
        #for d in dic2:
            print('mddd11==', dic2[d])
            if f>3 and dic2[d][1].__contains__(sbt) and dic2[d][0]!=' ' :

                print('sbt',dic2[d])
                dic2[d-1][0] = dic2[d-1][0]+' '+dic2[d][0]
                dic2[d][0]= ' '
            for i in head_list:
                if d>=1 and i in dic2[d][0] and dic2[d].count(' ')<=5 and  len(dic2[d][0])!=len(i):
                    print('header with line',dic2[d][0])
                    newline =[i, ' ', ' ', ' ', ' ', ' ', ' ', ' ']
                    dic2[d][0]=dic2[d][0].replace(i,'')
                    dic1[lq]=dic2[d]
                    dic1[lq-1]=dic2[d-1]
                    lq+=1
                    dic1[lq-1]=newline
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Choithram_N1358':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd11==', dic2[d])
            if dic2[d][3]!=' ' and dic2[d][3] not in sbt and dic2[d].count(' ')<=3:
                dic2[d][3]=' '
            if dic2[d][0] in head_list and dic2[d][2] != ' ' and dic2[d].count(' ') >= 1:
                print('if headerss with lines', dic2[d])
                dic1[lq] = dic2[d]
                # dic1[lq-1] = dic2[d-1]
                lq += 1
                dic1[lq - 1] = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic2[d][0] = ' '

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
    if hospital == 'Choithram_N1358-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd11==', dic2[d])
            if dic2[d][1]!=' ' and dic2[d][0] not in head_list:
                text = dic2[d][0]
                dic2[d][0]=dic2[d][1]
                dic2[d][1]=text
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
    if hospital == 'Narayana_N14358':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f>2 and dic2[d][0] in head_list and dic2[d-1][4] != 'Total':
                print('add sbt',dic2[d-1],dic2[d])
                #dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', ' ', ' ', 'Total', ' ']
                lq += 1
            if f > 1 and d==fn  and dic2[d][4]!='Total' :
                print('add sbt',dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', ' ', ' ', ' ', 'Total', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'baps_N12409' or hospital == 'Pramukh_N16147':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f > 2 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal' and (
                    dic2[d - 1][4] != ' ' or dic2[d - 1][5] != ' '):
                print('add sbt', dic2[d - 1], dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                lq += 1
                # dic2[d][2] = 'Subtotal'
            if f > 1 and d == fn and dic2[d][1] != 'Subtotal':
                print('add sbt', dic2[d])
                # dic2[d][2] = 'Subtotal'
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', 'Subtotal', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Chennainational_N15220-Pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd11==', dic2[d])
            if d == 1 and dic2[d][0] != 'Pharmacy':
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = ['Pharmacy', ' ', ' ', ' ', ' ', ' ']
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq + 1] = ['Subtotal', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Hardikar_N1872':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dddddd',dic2[d])
            if dic2[d][0] in head_list and dic2[d][1]==' ' and dic2[d].count(' ')<=2:
                print('medicall',dic2[d])
                dic2[d][1] = dic2[d][0].lower()
            if d >=1 and dic2[d][0] in head_list and dic2[d][1] != ' ' and dic2[d].count(' ') <= 3:
                print('if header with lines')
                dic1[lq] = dic2[d]
                #dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic2[d][0] = ' '
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Hardikar_N1872-pharma':

        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:

            print('mddd11==', dic2[d])
            if d == 1 and dic2[d][0] != 'Pharmacy':
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = ['Pharmacy', ' ', ' ', ' ', ' ', ' ']
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                dic2[d][1] = 'Subtotal'
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'SRV_N16098':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if d>1 and dic2[d][0] in head_list and dic2[d-1][0] in head_list:
                print('if d in head_list and d-1 in head_list')
                dic2[d][0] = dic2[d][0]+dic2[d][0][-1]
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
        known_items = ['2 ASSISTANT SURGEON CHARGES by Dr. Himanshu Bendrey', '18 Urine-R',
                       '28 Ryles Tube Insertion(ICU) by Dr. Mita Vira And Team', '1 Admission Charges',
                       '14 Medicine Charge',
                       '3 HGT', 'BOYLES'

                       ]
        correct_map_known_items = {
            '2 ASSISTANT SURGEON CHARGES by Dr. Himanshu Bendrey': [['1', '17507.00 F', ' ', 'F 17507.00'],
                                                                    ['1', '17507.00', ' ', '17507.00']],
            '18 Urine-R': [['', '270.00', ' ', '270.00 HW It'], ['', '270.00', ' ', '270.00']],
            '28 Ryles Tube Insertion(ICU) by Dr. Mita Vira And Team': [['', '240.00 A', ' ', 'A 240.00'],
                                                                       ['', '240.00', ' ', '240.00']],
            '1 Admission Charges': [['', '300.00', ' ', '300.00 HVI'], ['', '300.00', ' ', '300.00']],
            '14 Medicine Charge': [['', '1940.00', ' ', '1940.00'], ['', '11940.00', ' ', '11940.00']],
            '3 HGT': [['W', '140.00', ' ', '420.00'], ['3', '140.00', ' ', '420.00']],
            'BOYLES': [['N', '500.00', ' ', '750.00'], ['2', '500.00', ' ', '750.00']],

        }
        for d in dic2:
            print('mmddd11==', dic2[d])
            try:
                if dic2[d][0].strip(' -,.') in known_items:
                    if dic2[d][0].strip(' -,.') in correct_map_known_items and dic2[d][2:] == \
                            correct_map_known_items[dic2[d][0].strip(' -,.')][0]:
                        print('itemsss', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:2] + correct_map_known_items[neww[0].strip(' -,.')][1]
                        dic1[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Inamdar_N8739':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            print('mddd==', dic2[d])
            if dic2[d][1] in src_dc['merge_set'] and dic2[d][0]==' ' and dic2[d+1][0] =='OPERATION THEATRE':
                dic2[d][0]=dic2[d][1]
                #dic2[d][1]=' '
            if dic2[d][0] in src_dc['merge_set'] and dic2[d][1]==dic2[d][0] and dic2[d+1][0] =='OPERATION THEATRE':
                #dic2[d][0]=dic2[d][1]
                dic2[d][1]=' '
                dic2[d+1][1]=' '
                text = dic2[d][0]
                dic2[d][0]=dic2[d+1][0]
                dic2[d+1][0]=text
                dic2[d+1][5]=' '
            if f > 1 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal':
                print('add sbt', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic1[lq] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][1] != 'Subtotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Inamdar_N8739-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            print('mddd==', dic2[d])
            if d==1 and  len(re.findall('\d\.\d', dic2[d + 1][5])) and dic2[d][0]!="pharmacy":
                print('empty', dic2[d])
                #dic2[d][0] = 'Pharmacy'
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = ['Pharmacy', ' ', ' ', ' ', ' ']
            if f > 1 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal':
                print('add sbt', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic1[lq] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][1] != 'Subtotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Hindu_N2283':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f > 2 and dic2[d][0] in head_list and dic2[d - 1][0] != 'SubTotal':
                print('add sbt1', dic2[d - 1], dic2[d])
                dic1[lq] = [' ', ' ', ' ', ' ', 'Subtotal', ' ']
                lq += 1

            if f > 1 and d == fn and dic2[d][1] != 'SubTotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', ' ', 'Subtotal', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Gokul_N1365':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if d==1:
                listnw = ['HEAD', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][1] != sbt:
                print('for adding admission charges', dic2[d])
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Christian_N12987':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f > 2 and dic2[d][0] in head_list and dic2[d - 1][0] != 'SubTotal':
                print('add sbt1', dic2[d - 1], dic2[d])
                dic2[d - 1][3] = 'SubTotal'

                lq += 1
            if f > 1 and d == fn and dic2[d][1] != 'SubTotal':
                print('add sbt', dic2[d])
                dic2[d - 2] = [' ', ' ', ' ', ' ', ' ', ' ']
                dic2[d - 1][3] = 'SubTotal'
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Christian_N12987-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f > 1 and d == fn and dic2[d][1] != 'SubTotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 2] = [' ', ' ', ' ', ' ', 'SubTotal', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Rhythm_N13889':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            print('mddd==', dic2[d])

            if f > 1 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal':
                print('add sbt', dic2[d - 1], dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][1] != 'Subtotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Mallige_N0897-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd111===', dic2[d])
            if d == 1 and dic2[d][0] != 'Pharmacy':
                listnw = ['Pharmacy', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Sanjeevani_N1570':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:

            print('mddd11==', dic2[d])
            if d >=1 and dic2[d][0] in head_list and dic2[d][1] != ' '  and dic2[d].count(' ') <= 2:
                print('if header with lines')
                dic1[lq] = dic2[d]
                #dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic2[d][0] = ' '

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd22==', dic2[d])
            if d > 2 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal' and dic2[d - 2][1] != 'Subtotal':
                print('yesssssssssssss')
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            if d == len(dic2) and dic2[d][1] != 'Subtotal' and dic2[d - 1][1] != 'Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

        dic2 = dicA
        dic1 = {}
        lq = 1
    if hospital == 'Masina_N3000':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            print('mddd==', dic2[d])

            if f>1 and dic2[d][0] in head_list and dic2[d-1][1] != 'Subtotal':
                print('add sbt',dic2[d-1],dic2[d])
                #dic1[lq] = dic2[d]
                dic1[lq] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                lq += 1
            if f > 1 and d==fn  and dic2[d][1]!='Subtotal' :
                print('add sbt',dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Masina_N3000-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd11==',dic2[d])
            if d==1 and dic2[d][0]!='Pharmacy':
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq-1] = ['Pharmacy', ' ', ' ', ' ', ' ', ' ']
            # if d==len(dic2) and dic2[d][1]!='Subtotal':
            #     dic2[d][1] = 'Subtotal'

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Lifeline_N5106':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d > 2  and dic2[d][0] in head_list and dic2[d - 1][0] != 'Sub Total' and dic2[d - 2][0] != 'Sub Total':
                print('stoa',dic2[d])
                listnw = ['Sub Total', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d==len(dic2) and dic2[d][0]!= 'Sub Total':
                listnw = ['Sub Total', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'National_N0420':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            if f > 2 and dic2[d][0] in head_list and dic2[d - 1][0] != 'Subtotal':
                print('add sbt', dic2[d - 1], dic2[d])
                dic1[lq] = ['Subtotal', ' ', ' ', ' ', '', ' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][0] != 'Subtotal':
                print('add sbt1', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = ['Subtotal', ' ', ' ', ' ', '', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Pulse_N18433':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            if dic2[d][2] == 'FREE SPECIAL/ Total for CARDIOLOGY':
                dic2[d][2] = 'Total for CARDIOLOGY'
            if dic2[d][0] == '2904/2022':
                dic2[d][0] = '29/04/2022'
            if dic2[d][0] == 'CHARGES':
                dic2[d][0] = 'MRD CHARGES'
            if len(dic2[d][3].split()) > 1 and len(re.findall('\d\.\d', dic2[d][3])) == 2:
                a, b = dic2[d][3].split(' ', 1)
                dic2[d][3] = a
                dic2[d][4] = b
            if len(dic2[d][4].split()) > 1 and dic2[d][3] != ' ' and len(re.findall('\d{2}\.\d', dic2[d][4])) == 1:
                a, b = dic2[d][4].split(' ', 1)
                dic2[d][3] = a
                dic2[d][4] = b
            if len(dic2[d][4].split()) > 1 and dic2[d][3] == ' ' and len(re.findall('\d\.\d{2}', dic2[d][4])) == 2:
                a, b = dic2[d][4].split(' ', 1)
                dic2[d][3] = a
                dic2[d][4] = b
            if len(dic2[d][5].split()) > 1 and len(re.findall('\d\.\d', dic2[d][5])) == 2:
                a, b = dic2[d][5].split(' ', 1)
                dic2[d][4] = a
                dic2[d][5] = b
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'st_philomenas_N0938-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd11==', dic2[d])
            if d == 1 and dic2[d][0] != 'Pharmacy':
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = ['Pharmacy', ' ', ' ', ' ', ' ', ' ']
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq + 1] = ['Subtotal', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'st_philomenas_N0938':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f > 2 and dic2[d][0] in head_list and dic2[d - 1][0] != 'Sub Total':
                print('add sbt1', dic2[d - 1], dic2[d])
                dic1[lq] = [' ', ' ', ' ', ' ', 'Sub Total', ' ']
                lq += 1

            if f > 1 and d == fn and dic2[d][1] != 'Sub Total':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', ' ', 'Sub Total', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Babymemo_N1108':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dddddd',dic2[d])
            if dic2[d][0] in head_list and dic2[d][1] != ' ':
                print('if header with lines', dic2[d])
                dic1[lq] = dic2[d]
                # dic1[lq-1] = dic2[d-1]
                lq += 1
                dic1[lq - 1] = [dic2[d][0], ' ', ' ', ' ', ' ', ' ']
                dic2[d][0] = ' '

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Mohandai_N13476':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            print('mddd==', dic2[d])

            if f > 1 and dic2[d][0] in head_list and dic2[d - 1][4] != 'Subtotal':
                print('add sbt', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', ' ', ' ', 'Subtotal', ' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][4] != 'Subtotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', ' ', 'Subtotal', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Ils_N2847':
        dic1_a = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if dic2[d][0] in head_list:
                print('headerrrr',dic2[d])
                # if i in dic1_a[d][0] and dic1_a[d].count(' ') == 5 and dic1_a[d][0] != ' ':
                #     print('head with line item')
                #     listnw = [i, ' ', ' ', ' ', ' ', ' ']
                #     dic1[lq] = dic1_a[d]
                #     lq += 1
                #     dic1[lq - 1] = listnw
                #     dic1_a[d][0] = dic1_a[d][0].replace(i,' ')
                #     dic1_a[d][0] = dic1_a[d][0].strip()
                # if i in dic1_a[d][0] and dic1_a[d].count(' ') == 4 and dic1_a[d][0] != ' ' and dic1_a[d][5] != ' ':
                #     print('head with line item')
                #     listnw = [i, ' ', ' ', ' ', ' ', ' ']
                #     dic1[lq] = dic1_a[d]
                #     lq += 1
                #     dic1[lq - 1] = listnw
                #     dic1_a[d][0] = dic1_a[d][0].replace(i,' ')
                #     dic1_a[d][0] = dic1_a[d][0].strip()
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][4] != sbt and dic2[d - 2][4] != 'Subtotal':
                listnw = [' ', ' ', ' ', ' ', 'Subtotal', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][4] != 'Subtotal':
                listnw = [' ', ' ', ' ', ' ', 'Subtotal', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Bhagwanmahavir_N13068-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dd00==', dic2[d])
            if len(re.findall('\d+\,\d+\.\d+', dic2[d][4])) == 1 and  len(dic2[d][4].split()) == 1  and  dic2[d][5] == '':
                print('if rate qty together wuth no space in 2nd index')
                dic2[d][5] = dic2[d][4]
                dic2[d][4] = ' '
            if len(re.findall('\d+\.\d+\.\d+', dic2[d][4])) == 1 and dic2[d][5] == ' ':
                print('if rate qty together wuth no space in 2nd index')
                text = dic2[d][4]
                if len(re.findall('\d+\.\d+\.\d+', dic2[d][4])) == 1:
                    matchrate = re.search(r'\d+\.\d+\.\d+', text)
                elif len(re.findall('\d+\.\d+\.\d+', dic2[d][4])) == 1:
                    matchrate = re.search(r'\d+\.\d+\.\d+', text)
                dic2[d][5] = matchrate.group()
                dic2[d][4] = text.replace(matchrate.group(), '')
            if len(re.findall('\-\d+\.\d+', dic2[d][4])) == 1 and dic2[d][5] == ' ':
                print('if rate qty together wuth no space in 2nd index')
                text = dic2[d][4]
                if len(re.findall('\-\d+\.\d+', dic2[d][4])) == 1:
                    matchrate = re.search(r'\-\d+\.\d+', text)
                elif len(re.findall('\-\d+\.\d+', dic2[d][4])) == 1:
                    matchrate = re.search(r'\-\d+\.\d+', text)
                dic2[d][5] = matchrate.group()
                dic2[d][4] = text.replace(matchrate.group(), '')
            if len(re.findall('\d+\.\d+', dic2[d][4])) == 1 and dic2[d][5] == ' ':
                print('if rate qty together wuth no space in 2nd index')
                text = dic2[d][4]
                if len(re.findall('\d+\.\d+', dic2[d][4])) == 1:
                    matchrate = re.search(r'\d+\.\d+', text)
                elif len(re.findall('\d+\.\d+', dic2[d][4])) == 1:
                    matchrate = re.search(r'\d+\.\d+', text)
                dic2[d][5] = matchrate.group()
                dic2[d][4] = text.replace(matchrate.group(), '')
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Bhagwanmahavir_N13068':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('pra', dic2[d])
            if len(re.findall('\d+\-\w{3}\-\d{2}', dic2[d][0])) == 1 and dic2[d][3] == ' ':
                print('if date batch together with no space in 2nd index')
                text = dic2[d][0]
                if len(re.findall('\d\-\w{3}\-\d{2}', dic2[d][0])) == 1:
                    matchrate = re.search(r'\d\-\w{3}\-\d{2}', text)
                elif len(re.findall('\d+\-\w{3}\-\d{2}', dic2[d][0])) == 1:
                    matchrate = re.search(r'\d+\-\w{3}\-\d{2}', text)

                dic2[d][3] = matchrate.group()
                dic2[d][0] = text.replace(matchrate.group(), '')
            if len(re.findall('\w+\-\w{3}\-\d{2}', dic2[d][0])) == 1 and dic2[d][3] == ' ':
                print('if date batch together with no space in 2nd index')
                text = dic2[d][0]
                if len(re.findall('\w\-\w{3}\-\d{2}', dic2[d][0])) == 1:
                    matchrate = re.search(r'\w\-\w{3}\-\d{2}', text)
                elif len(re.findall('\w+\-\w{3}\-\d{2}', dic2[d][0])) == 1:
                    matchrate = re.search(r'\w+\-\w{3}\-\d{2}', text)

                dic2[d][3] = matchrate.group()
                dic2[d][0] = text.replace(matchrate.group(), '')
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'Sugam_N3241':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            print('mddd==', dic2[d])

            if f > 1 and dic2[d][0] in head_list and dic2[d - 1][4] != 'Subtotal' and len(re.findall("\d\.\d",dic2[d-1][5]))==1:
                print('add sbt', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', ' ', ' ', 'Subtotal', ' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][4] != 'Subtotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', ' ', 'Subtotal', ' ']
            if dic2[d][0] in head_list and dic2[d][5]!=' ' and dic2[d][3]!=' ':
                dic2[d][0]=dic2[d][0].lower()
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Sugam_N3241-pharma':

        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            print('mddd==', dic2[d])

            if f > 1 and dic2[d][0] in head_list and dic2[d - 1][4] != 'Subtotal' and len(
                    re.findall("\d\.\d", dic2[d - 1][5])) == 1:
                print('add sbt', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', ' ', ' ', 'Subtotal', ' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][4] != 'Subtotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', ' ', 'Subtotal', ' ']
            if dic2[d][0] in head_list and dic2[d][5] != ' ' and dic2[d][3] != ' ':
                dic2[d][0] = dic2[d][0].lower()
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Sterling_N0562':
        print('mmmmmmmmmmmmm')
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd==', dic2[d])
            if d > 1 and d != len(dic2) and dic2[d][0] == dic2[d - 1][0] and dic2[d - 1][0] in head_list:
                print('if sub header and header are same')
                dic2[d][0] = dic2[d][0] + 's'
                sub_head.append(dic2[d][0] + 's')

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Sterling_N0562_pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd111===', dic2[d])
            if d == 1 and dic2[d][0] != 'Pharmacy':
                listnw = ['Pharmacy', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Sterling_N0562_pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][0] != 'Sub Total':
                listnw = ['Sub Total', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][0] != 'Sub Total':
                listnw = ['Sub Total', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'krims_N1828-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][0] != 'Sub Total':
                listnw = ['Sub Total', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][0] != 'Sub Total':
                listnw = ['Sub Total', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'krims_N1828-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd111===', dic2[d])
            if d == 1 and dic2[d][0] != 'Pharmacy':
                listnw = ['Pharmacy', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'krims_N1828':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][0] != 'Sub Total':
                listnw = ['Sub Total', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][0] != 'Sub Total':
                listnw = ['Sub Total', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Indianhospital':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            if f > 2 and dic2[d][0] in head_list and dic2[d - 1][0] != 'Subtotal':
                print('add sbt1', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', ' ', ' ', 'Subtotal', ' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][1] != 'Subtotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', ' ', 'Subtotal', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Aarogya_N10980':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            print('mddd==', dic2[d])

            if f > 1 and dic2[d][0] in head_list and dic2[d - 1][4] != 'Subtotal':
                print('add sbt', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', ' ', ' ', 'Subtotal', ' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][4] != 'Subtotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', ' ', 'Subtotal', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Kalinga_N18633':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if d>1 and dic2[d][0] not in head_list and dic2[d-1][3].__contains__('Total'):
                print('headddddd,',dic2[d],dic2[d-1])
                listnw = ['HEAD', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d>1 and dic2[d][0] not in head_list and dic2[d-1][3].__contains__('Total'):
                print('headddddd,',dic2[d],dic2[d-1])
                listnw = ['HEAD', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d > 1 and dic2[d][0] in head_list and  dic2[d - 1][3].__contains__('Total')==False and dic2[d - 1][2].__contains__('Total')==False:
                listnw = [' ', ' ', ' ', 'Total', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Somaiya_N15103-pharma' or hospital == 'Somaiya1_N15103':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal' and dic2[d - 2][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Somaiya_N15103' or hospital == 'Somaiya1_N15103' or hospital == 'lok':
        dicA = dic1
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][1] != sbt:
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Cloudnine_N12573':
        dic2 = dicA
        dic1_a = dic2
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if d == 1 and dic2[d][0] not in head_list:
                listnw = ['IP Package', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d > 2 and dic2[d][0] in head_list and dic2[d - 1][0] != 'Subtotal' and dic2[d - 2][0] != 'Subtotal':
                listnw = ['Subtotal', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][0] != 'Subtotal':
                listnw = ['Subtotal', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
        # //////////////////////////
    if hospital == 'Velammal_N15676':

        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            print('mddd==', dic2[d])

            if f > 1 and dic2[d][0] in head_list and dic2[d - 1][4] != 'Subtotal' and len(
                    re.findall("\d\.\d", dic2[d - 1][5])) == 1:
                print('add sbt', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', ' ', ' ', 'Subtotal', ' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][4] != 'Subtotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', ' ', 'Subtotal', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Velammal_N15676-pharma':
        dic2 = dic1
        dic1 = {}
        lq = 1
        for d in dic2:
            print('dddddd', dic2[d])
            if dic2[d][3].__contains__('Issued Amount') or dic2[d][3].__contains__('Returned Amount'):
                dic2[d][3] = "Subtotal"
            if d==len(dic2) and dic2[d-1][3] in sbt and dic2[d][3] in sbt:
                dic2[d][3]=' '
            dic1[lq] = dic2[d]
            lq += 1
    if hospital == 'yashoda_N16659':

        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            print('mddd==', dic2[d])

            if f > 1 and dic2[d][0] in head_list and dic2[d - 1][4] != 'Subtotal' and len(
                    re.findall("\d\.\d", dic2[d - 1][5])) == 1:
                print('add sbt', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', ' ', ' ', 'Subtotal', ' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][4] != 'Subtotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', ' ', 'Subtotal', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Life_N14710':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            print('mddd==', dic2[d])
            if len(dic2[d][4].split()) == 2:
                a, b = dic2[d][4].split()
                dic2[d][4] = b
            if dic2[d][0] in head_list and dic2[d].count(" ")<=3:
                dic2[d][0]=dic2[d][0].lower()
            if f > 1 and dic2[d][0] in head_list and dic2[d - 1][4] != 'Subtotal':
                print('add sbt', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', ' ', ' ', 'Subtotal', ' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][4] != 'Subtotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', ' ', 'Subtotal', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Cloudnine_N12572':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][0] != 'Sub Total':
                listnw = ['Sub Total', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][0] != 'Sub Total':
                listnw = ['Sub Total', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
        #///////////////////////////
    if hospital == 'Kalra_N0402-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][0] != 'Sub Total':
                listnw = ['Sub Total', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][0] != 'Sub Total':
                listnw = ['Sub Total', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Kalra_N0402-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd111===', dic2[d])
            if d == 1 and dic2[d][0] != 'Pharmacy':
                listnw = ['Pharmacy', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'sri_N13374':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('nddd==', dic2[d])
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][0] != 'Sum :':
                listnw = ['Sum :', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][0] != 'Sum :':
                listnw = ['Sum :', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw

            if len(dic2[d][0].split()) > 1 and dic2[d][1] == ' ' and len(re.findall('\d{2}\-\d{4}', dic2[d][0])) == 1:
                print('rate  in unit')
                text = dic2[d][0]
                if len(re.findall('\d{2}\-\d{4}', dic2[d][0])) == 1:
                    matchrate = re.search(r'\d{2}\-\d{4}', text)
                elif len(re.findall('\d{2}\-\d{4}', dic2[d][0])) == 1:
                    matchrate = re.search(r'\d{2}\-\d{4}', text)
                dic2[d][1] = dic2[d][0].replace(matchrate.group(), ' ')
                dic2[d][0] = matchrate.group()
            if len(dic2[d][0].split()) > 1 and dic2[d][1] != ' ' and len(re.findall('\d{2}\-\d{4}', dic2[d][0])) == 1:
                print('rate  in unit')
                text = dic2[d][0]
                if len(re.findall('\d{2}\-\d{4}', dic2[d][0])) == 1:
                    matchrate = re.search(r'\d{2}\-\d{4}', text)
                elif len(re.findall('\d{2}\-\d{4}', dic2[d][0])) == 1:
                    matchrate = re.search(r'\d{2}\-\d{4}', text)

                dic2[d][1] = dic2[d][0].replace(matchrate.group(), ' ')
                dic2[d][0] = matchrate.group()

            if len(dic2[d][1].split()) > 1 and dic2[d][2] == ' ' and len(re.findall('\w{2}\d{6}', dic2[d][1])) == 1:
                print('rate  in unit')
                text = dic2[d][1]
                if len(re.findall('\w{2}\d{6}', dic2[d][1])) == 1:
                    matchrate = re.search(r'\w{2}\d{6}', text)
                elif len(re.findall('\w{2}\d{6}', dic2[d][1])) == 1:
                    matchrate = re.search(r'\w{2}\d{6}', text)

                dic2[d][1] = dic2[d][1].replace(matchrate.group(), ' ')
                dic2[d][2] = matchrate.group()
            #
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'omnihospital':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            print('mddd==', dic2[d])
            if d > 1 and dic2[d][0].__contains__('PHARMACY') and dic2[d - 1][0].__contains__('RETURN'):
                dic2[d][0] = 'PHARMACY RETURNS'
                dic2[d - 1][0] = ' '
            if f>1 and dic2[d][0] in head_list and dic2[d-1][1] != 'Subtotal':
                print('add sbt',dic2[d-1],dic2[d])
                #dic1[lq] = dic2[d]
                dic1[lq] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                lq += 1
            if f > 1 and d==fn  and dic2[d][1]!='Subtotal' :
                print('add sbt',dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'omnihospital-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            print('mddd11==',dic2[d])
            if d==1 and dic2[d][0]!='Pharmacy':
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq-1] = ['Pharmacy', ' ', ' ', ' ', ' ', ' ']
            if f > 1 and d == fn and dic2[d][1] != 'Subtotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Kalra_N0402':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f > 2 and dic2[d][0] in head_list and dic2[d - 1][0] != 'Sub Total':
                print('add sbt1', dic2[d - 1], dic2[d])
                dic1[lq] = [' ', ' ', ' ', 'Sub Total', ' ', ' ']
                lq += 1

            if f > 1 and d == fn and dic2[d][1] != 'Sub Total':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', 'Sub Total', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Peerless-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd11==', dic2[d])
            if d == 1 and dic2[d][0] != 'Pharmacy':
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = ['Pharmacy', ' ', ' ', ' ', ' ', ' ']
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                dic1[lq] = dic2[d]
                dic1[lq + 1] = ['Subtotal', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Vinayak_N2742':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            print('mddd==', dic2[d])

            if f>1 and dic2[d][0] in head_list and dic2[d-1][1] != 'Subtotal':
                print('add sbt',dic2[d-1],dic2[d])
                #dic1[lq] = dic2[d]
                dic1[lq] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                lq += 1
            if f > 1 and d==fn  and dic2[d][1]!='Subtotal' :
                print('add sbt',dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq+1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'convenienthospital-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            #try:

            #     if dic2[d][4] == ' ' and dic2[d][5] == ' ' and len(dic2[d][3]) > 10 and dic2[d][3].__contains__('NOS'):
            #         print('lllllnnnnnmmmmmmm', dic2[d], len(dic2[d][3].split('NOS')[1].split()))
            #         if len(dic2[d][3].split('NOS')[1].split()) == 2:
            #             print('lllllnnnnnmmmmmmm111', dic2[d])
            #             four, five = dic2[d][3].split('NOS')[1].split()
            #             three = dic2[d][3].split('NOS')[0] + ' NOS'
            #             thl = copy.deepcopy(dic2[d])
            #             thl.pop(3)
            #             thl.insert(3, three)
            #             thl.pop(4)
            #             thl.insert(4, four)
            #             thl.pop(5)
            #             thl.insert(5, five)
            #             dic1[lq] = thl
            #             lq += 1
            #             print('coooobbb', dic2[d], thl)
            #             continue
            # except:
            #     print('known_items error')
            if f > 1 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal':
                print('add sbt', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic1[lq] = [' ', 'Subtotal', ' ', ' ', ' ', ' ', ' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][1] != 'Subtotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', 'Subtotal', ' ', ' ', ' ', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

    if hospital == 'Jehangir':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if dic2[d][3] == 'I':
                dic2[d][3] = '1'

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Jehangir-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mmdddd===', dic2[d])
            if dic2[d][2] != ' ' and len(dic2[d][2].split()) >= 2 and 'Number' in dic2[d][2]:
                text = dic2[d][2].split()
                dic2[d][3] = text[-2]
                dic2[d][2] = text[0] + text[1]

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Surana_N6086':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('mddd00==', dic2[d])
            if dic2[d][1] != ' ' and dic2[d][3] == ' ' and dic2[d][4] != ' ' and len(
                    re.findall('\d\.\d', dic2[d][1])) == 1:
                print('if Rate with Parti')
                text = dic2[d][1].split()
                dic2[d][3] = text[-1]
                dic2[d][1] = dic2[d][1].replace(text[-1], '')

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'gurushree_N3308':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f > 2 and dic2[d][0] in head_list and dic2[d - 1][0] != 'Sub Total':
                print('add sbt1', dic2[d - 1], dic2[d])
                dic1[lq] = [' ', ' ', ' ', 'Sub Total', ' ', ' ']
                lq += 1

            if f > 1 and d == fn and dic2[d][1] != 'Sub Total':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', 'Sub Total', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'N15028_tieten':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f > 2 and dic2[d][0] in head_list and dic2[d - 1][0] != 'Sub Total':
                print('add sbt1', dic2[d - 1], dic2[d])
                dic1[lq] = [' ', ' ', ' ', 'Sub Total', ' ', ' ']
                lq += 1

            if f > 1 and d == fn and dic2[d][1] != 'Sub Total':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', 'Sub Total', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Noble_N1377':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f > 2 and dic2[d][0] in head_list and dic2[d - 1][0] != 'Sub Total':
                print('add sbt1', dic2[d - 1], dic2[d])
                dic1[lq] = [' ', ' ', ' ', 'Sub Total', ' ', ' ']
                lq += 1

            if f > 1 and d == fn and dic2[d][1] != 'Sub Total':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', 'Sub Total', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

    if hospital == 'N15028_tieten_1':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f > 2 and dic2[d][0] in head_list and dic2[d - 1][0] != 'Sub Total':
                print('add sbt1', dic2[d - 1], dic2[d])
                dic1[lq] = [' ', ' ', ' ', 'Sub Total', ' ', ' ']
                lq += 1

            if f > 1 and d == fn and dic2[d][1] != 'Sub Total':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', 'Sub Total', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Kingsway_N17849':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            if f > 2 and dic2[d][0] in head_list and dic2[d - 1][3] != 'Subtotal':
                print('add sbt1', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic2[d - 1][1] = 'Subtotal'
                lq += 1
            if f > 1 and d == fn and dic2[d][1] != 'Subtotal':
                print('add sbt', dic2[d])
                dic2[d][1] = 'Subtotal'

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'lourdes_N3445':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d > 2 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal' and dic2[d - 2][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'navrang_N3390':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d > 2 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal' and dic2[d - 2][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital =='SPH':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][1] != 'Subtotal':
                listnw = [' ', 'Subtotal', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Iclinix_N16167':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('md111==', dic2[d])
            if d == 1 and dic2[d][0] != 'Head':
                listnw = ['Head', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][1] != 'Subtotal':
                listnw = [' ', 'Total', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Ckbirla_N2832':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            print('mddd==', dic2[d])

            if f > 1 and dic2[d][0] in head_list and dic2[d - 1][4] != 'Subtotal':
                print('add sbt', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', ' ', ' ', 'Subtotal', ' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][4] != 'Subtotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', ' ', 'Subtotal', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Healthway_N15806':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('nddd==', dic2[d])

            if dic2[d][5] == '100,000.00 100,000.00':
                dic2[d][5] = '100000.00 100000.00'
            if dic2[d][4] == '100,000.00 100,000.00':
                dic2[d][4] = '100000.00 100000.00'
            if dic2[d][0] == 'CARDI OLOGY':
                dic2[d][0] = 'CARDIOLOGY'
            if dic2[d][0] == 'nvestigation Charges':
                dic2[d][0] = 'Investigation Charges'
            if dic2[d][0] == 'Professional':
                dic2[d][0] = 'Professional Charges'
            if len(re.findall('\w{3}\d+', dic2[d][0])) == 1 or len(re.findall('\w{2}\d+', dic2[d][0])) == 1:
                print('to remove spaces')
                text = dic2[d][0]
                if len(re.findall('\w{3}\d+', dic2[d][0])) == 1:
                    matchsrno = re.search(r'\w{3}\d+', text)
                elif len(re.findall('\w{2}\d+', dic2[d][0])) == 1:
                    matchsrno = re.search(r'\w{2}\d+', text)
                    dic2[d][0] = dic2[d][0].replace(matchsrno.group(), '')
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][0] != 'Sub Total':
                listnw = ['Sub Total', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][0] != 'Sub Total':
                listnw = ['Sub Total', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw

            if d > 1 and dic2[d][0] not in head_list and dic2[d][0] not in sub_head and dic2[d][1] == ' ' and len(
                    dic2[d][0].split()) > 1 and dic2[d].count(' ') < 5:
                a, b = dic2[d][0].split(' ', 1)
                dic2[d][0] = a
                dic2[d][1] = b

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Healthway_N15806-pharma':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('nddd==', dic2[d])

            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][0] != 'Sub Total':
                listnw = ['Sub Total', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][0] != 'Sub Total':
                listnw = ['Sub Total', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
            if dic2[d][0] == "Bill No :'":
                dic2[d][0] = 'Bill No :'
            if dic2[d][4] == 'ECOSPRIN 75 MG TAB':
                dic2[d][4] = 'ECOSPRIN-75 MG TAB'
            if d > 1 and dic2[d][0] == head_list and dic2[d][1] == ' ' and len(dic2[d][0].split()) > 1 and dic2[
                d].count(' ') < 5:
                a, b = dic2[d][0].split(' ', 1)
                dic2[d][0] = a
                dic2[d][1] = b
            if d > 1 and dic2[d][0] != head_list and dic2[d][1] == ' ' and len(dic2[d][0].split()) == 1 and dic2[
                d].count(' ') < 2:
                dic2[d][1] == dic2[d][0]

                dic2[d][0] == ' '
            if len(re.findall('\d\s', dic2[d][1])) == 1 or len(re.findall('\s\d{2}\s', dic2[d][1])) == 1:
                print('to remove sr no and space')
                text = dic2[d][1]
                if len(re.findall('\s\d{2}\s', dic2[d][1])) == 1:
                    matchsrno = re.search(r'\s\d{2}\s', text)
                elif len(re.findall('\d\s', dic2[d][1])) == 1:
                    matchsrno = re.search(r'\d\s', text)
                dic2[d][1] = dic2[d][1].replace(matchsrno.group(), '')
            if len(re.findall('\d', dic2[d][0])) == 1 or len(re.findall('\d{2}', dic2[d][0])) == 1:
                print('to remove sr no and space')
                text = dic2[d][0]
                if len(re.findall('\d{2}', dic2[d][0])) == 1:
                    matchsrno = re.search(r'\d{2}', text)
                elif len(re.findall('\d', dic2[d][0])) == 1:
                    matchsrno = re.search(r'\d', text)
                dic2[d][0] = dic2[d][0].replace(matchsrno.group(), ' ')
            if len(dic2[d][1].split()) >= 1 and dic2[d][2] == ' ' and len(
                    re.findall('\d+\w{2}\d+', dic2[d][1])) == 1 and dic2[d][4] == ' ':
                print('rate  in unit')
                text = dic2[d][1]
                if len(re.findall('\d+\w{2}\d+', dic2[d][1])) == 1:
                    matchrate = re.search(r'\d+\w{2}\d+', text)
                elif len(re.findall('\d+\w{2}\d+', dic2[d][1])) == 1:
                    matchrate = re.search(r'\d+\w{2}\d+', text)
                elif len(re.findall('\d+\w{2}\d+', dic2[d][1])) == 1:
                    matchrate = re.search(r'\d+\w{2}\d+', text)
                dic2[d][1] = dic2[d][1].replace(matchrate.group(), ' ')
                dic2[d][2] = matchrate.group()

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Samford_N16568':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            print('mddd==', dic2[d])
            if d > 1 and d < len(dic2) and len(re.findall('\d+\/\d+\/\d+', dic2[d][0])) and dic2[d + 1][4] != ' ' and dic2[d + 1][5] != ' ' and dic2[d + 1].count(' ') >= 3:
                print('add===', dic2[d], dic2[d + 1])
                dic2[d + 1][4] = ' '
                dic2[d + 1][5] = ' '


                # dic2[d +1][0] = dic2[d + 1][1] # print('rrr===',dic2[d],dic2[d + 1]) # dic2[d ][1] = dic2[d][1] + ' ' + dic2[d + 1][0] #print('zzz===',dic2[d],dic2[d +1]) dic2[d + 1][2] = ' '
            # if dic2[d][0].__contains__(head_list)==True and len(re.findall('\d\.\d',dic2[d][0]))==1:
            #     dic2[d][0]=re.sub('\(\d+\.\d+\)','',dic2[d][0])
            #     dic2[d][0]=dic2[d][0].strip()
            if f > 1 and dic2[d][0] in head_list and dic2[d - 1][3] != 'Subtotal':
                print('add sbt', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', ' ', 'Subtotal', ' ', ' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][3] != 'Subtotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', 'Subtotal', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'AIMS_N13444':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            print('mddd==', dic2[d])

            if f > 1 and dic2[d][0] in head_list and dic2[d - 1][3] != 'Subtotal':
                print('add sbt', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', ' ', 'Subtotal', ' ', ' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][3] != 'Subtotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', 'Subtotal', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Bengal_N2890_daycare':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d==1:
                listnw = ['Head', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            if d > 1 and dic2[d][0] not in head_list and dic2[d-1][4].__contains__(sbt)==True:
                listnw = ['Head', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                lq += 1
                dic1[lq - 1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Shankara_N16938':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            f += 1
            ss = ''
            if d>1 and dic2[d][0] not in head_list and dic2[d-1][1].__contains__('Total'):
                listnw = ['Head', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq-1] = dic2[d-1]
                lq+=1
                dic1[lq-1] = listnw
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Ashwini_N16821':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            print('mddd==', dic2[d])

            if f > 1 and dic2[d][0] in head_list and dic2[d - 1][3] != 'Subtotal':
                print('add sbt', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', ' ', 'Subtotal', ' ', ' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][3] != 'Subtotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', 'Subtotal', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Ernakulam_N1127':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            print('mddd==', dic2[d])
            if d > 1 and d < len(dic2) and dic2[d][2].__contains__('Total') and dic2[d + 1][0] not in head_list:
                print("$$$$$$$$$", dic2[d])
                dic2[d][2] = ' '
                dic2[d][5] = ' '
            # if f > 1 and dic2[d][0] in head_list and dic2[d - 1][3] != 'Subtotal':
            #     print('add sbt', dic2[d - 1], dic2[d])
            #     # dic1[lq] = dic2[d]
            #     dic1[lq] = [' ', ' ', ' ', 'Subtotal', ' ', ' ']
            #     lq += 1
            # if f > 1 and d == fn and dic2[d][3] != 'Subtotal':
            #     print('add sbt', dic2[d])
            #     dic1[lq] = dic2[d]
            #     dic1[lq + 1] = [' ', ' ', ' ', 'Subtotal', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Believers_N14138':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            print('mddd==', dic2[d])

            if f > 1 and dic2[d][0] in head_list and dic2[d - 1][3] != 'Subtotal':
                print('add sbt', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', ' ', 'Subtotal', ' ', ' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][3] != 'Subtotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', 'Subtotal', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Patil_N16418':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''

            print('mddd==', dic2[d])

            if f > 1 and dic2[d][0] in head_list and dic2[d - 1][3] != 'Subtotal':
                print('add sbt', dic2[d - 1], dic2[d])
                # dic1[lq] = dic2[d]
                dic1[lq] = [' ', ' ', ' ', 'Subtotal', ' ', ' ']
                lq += 1
            if f > 1 and d == fn and dic2[d][3] != 'Subtotal':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', 'Subtotal', ' ', ' ']

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'apollo_N18424':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('md111==', dic2[d])
            if d > 2 and d < len(dic2) and dic2[d][0] in head_list and 'Sub Total' not in dic2[d - 1][5]:
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                lq+=1
                dic1[lq - 1] = [' ', ' ', ' ', ' ', ' ', 'Sub Total']
            if d>1 and dic2[d][0] not in head_list and 'Sub Total' in dic2[d-1][5]:
                print('removing extra sbt')
                dic2[d-1][5] = ' '
            if d>1 and 'Sub Total' in dic2[d][5] and  'Sub Total' in dic2[d-1][5]:
                dic2[d][5] = ' '
            
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'motherhood_N17272':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('md111==', dic2[d])

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'prakriya_N18524':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('nddd==', dic2[d])

            if dic2[d][5] == '$490.00':
                dic2[d][5] = '490.00'
            if dic2[d][4] == '$490.00':
                dic2[d][4] = '490.00'
            if dic2[d][5] == '2MI. SYRINGE DISPOSABLE':
                dic2[d][5] = '2ML SYRINGE DISPOSABLE'
            if dic2[d][0] == 'ABORATORY CHARGES':
                dic2[d][0] = 'LABORATORY CHARGES'

            if dic2[d][3] == 'NN':
                dic2[d][3] = '2'
            if dic2[d][5] == '<30475.00':
                dic2[d][5] = '30475.00'
            if dic2[d][3] == 'N':
                dic2[d][3] = '2'
            if dic2[d][5] == '<360.00':
                dic2[d][5] = '360.00'
            if dic2[d][4] == '$72000.00':
                dic2[d][4] = '72000.00'
            if dic2[d][5] == '$72000.00':
                dic2[d][5] = '72000.00'
            if dic2[d][4] == '<300.00':
                dic2[d][4] = '300.00'
            if dic2[d][5] == '<300.00':
                dic2[d][5] = '300.00'
            if dic2[d][5] == '<104.00':
                dic2[d][5] = '104.00'
            if dic2[d][4] == '<104.00':
                dic2[d][4] = '104.00'
            if dic2[d][1] == 'ET CHARGES':
                dic2[d][1] = 'DIET CHARGES'
            if dic2[d][0] == 'ANAPSTHESIA CHARGES':
                dic2[d][0] = 'ANAESTHESIA CHARGES'

            if len(re.findall('^\d{2}', dic2[d][0])) == 1 or len(re.findall('^\d{3}', dic2[d][0])) == 1:
                print('to remove spaces')
                text = dic2[d][0]
                if len(re.findall('^\d{3}', dic2[d][0])) == 1:
                    matchsrno = re.search(r'^\d{3}', text)
                elif len(re.findall('^\d{2}', dic2[d][0])) == 1:
                    matchsrno = re.search(r'^\d{2}', text)
                    dic2[d][0] = dic2[d][0].replace(matchsrno.group(), '')
            if dic2[d][5].__contains__("SubTotal"):
                dic2[d][5] = ' '
            if dic2[d][0] in head_list and dic2[d].count(" ") <= 3:
                dic2[d][0] = dic2[d][0].lower()
            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][0] != 'Total':
                listnw = ['Total', ' ', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][0] != 'Total':
                listnw = ['Total', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
            if len(dic2[d][1].split()) >= 1 and dic2[d][2] == ' ' and len(
                    re.findall('\d{2}\/\d{2}\/\d{4}\s\d{2}\:\d{2}', dic2[d][1])) == 1 and dic2[d][4] != ' ':
                print('rate  in unit')
                text = dic2[d][1]
                if len(re.findall('\d{2}\/\d{2}\/\d{4}\s\d{2}\:\d{2}', dic2[d][1])) == 1:
                    matchrate = re.search(r'\d{2}\/\d{2}\/\d{4}\s\d{2}\:\d{2}', text)
                elif len(re.findall('\d{2}\/\d{2}\/\d{4}\s\d{2}\:\d{2}', dic2[d][1])) == 1:
                    matchrate = re.search(r'\d{2}\/\d{2}\/\d{4}\s\d{2}\:\d{2}', text)

                dic2[d][1] = dic2[d][1].replace(matchrate.group(), ' ')
                dic2[d][2] = matchrate.group()

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'haria_N0710':
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            print('nddd==', dic2[d])

            if dic2[d][0] == 'FD_CHARGES':
                dic2[d][0] = 'BED CHARGES'
            if dic2[d][0] == 'X-RAY 8/F':
                dic2[d][0] = 'X-RAY'

            if dic2[d][0] == 'ABORATORY':
                dic2[d][0] = 'LABORATORY'
            if dic2[d][0] == 'CU PROCEDURES':
                dic2[d][0] = 'ICU PROCEDURES'
            if dic2[d][0] == 'RES GLUCOMETER':
                dic2[d][0] = 'RBS GLUCOMETER'

            if dic2[d][5] == 'SOD 00':
                dic2[d][5] = '500.00'
            if dic2[d][5] == 'Sco.CO':
                dic2[d][5] = '500.00'

            if len(re.findall('^\d{2}', dic2[d][0])) == 1 or len(re.findall('^\d{3}', dic2[d][0])) == 1:
                print('to remove spaces')
                text = dic2[d][0]
                if len(re.findall('^\d{3}', dic2[d][0])) == 1:
                    matchsrno = re.search(r'^\d{3}', text)
                elif len(re.findall('^\d{2}', dic2[d][0])) == 1:
                    matchsrno = re.search(r'^\d{2}', text)
                    dic2[d][0] = dic2[d][0].replace(matchsrno.group(), '')

            if d > 1 and dic2[d][0] in head_list and dic2[d - 1][0] != 'Total':
                listnw = ['Total', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq - 1] = dic2[d - 1]
                lq += 1
                dic1[lq - 1] = listnw
            if d == len(dic2) and dic2[d][0] != 'Total':
                listnw = ['Total', ' ', ' ', ' ', ' ', ' ']
                dic1[lq] = dic2[d]
                dic1[lq + 1] = listnw
            if len(re.findall('\d+\/\d+\/\d+', dic2[d][0])) == 1:
                print('if date in 0th index')
                text = dic2[d][0]
                matchdate = re.search(r'\d+\/\d+\/\d+', text)
                dic2[d][2] = matchdate.group()
                dic2[d][0] = dic2[d][0].replace(matchdate.group(), '')
            if len(re.findall('\d+\/\d+\s\d+', dic2[d][0])) == 1:
                print('if date in 0th index')
                text = dic2[d][0]
                matchdate = re.search(r'\d+\/\d+\s\d+', text)
                dic2[d][2] = matchdate.group()
                dic2[d][0] = dic2[d][0].replace(matchdate.group(), '')
            if len(re.findall('\d+\/\d+\/\s\d+', dic2[d][0])) == 1:
                print('if date in 0th index')
                text = dic2[d][0]
                matchdate = re.search(r'\d+\/\d+\/\s\d+', text)
                dic2[d][2] = matchdate.group()
                dic2[d][0] = dic2[d][0].replace(matchdate.group(), '')

            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if hospital == 'Relife_N7895':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f > 2 and dic2[d][0] in head_list and dic2[d - 1][0] != 'Sub Total':
                print('add sbt1', dic2[d - 1], dic2[d])
                dic1[lq] = [' ', ' ', ' ', 'Sub Total', ' ', ' ']
                lq += 1

            if f > 1 and d == fn and dic2[d][1] != 'Sub Total':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', 'Sub Total', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1

    if hospital == 'prasad_N3814':
        dic2 = dicA
        dic1 = {}
        lq = 1
        f = 0
        fn = len(dic2)
        for d in dic2:
            print('ddd==', dic2[d])
            f += 1
            ss = ''
            if f > 2 and dic2[d][0] in head_list and dic2[d - 1][0] != 'Sub Total':
                print('add sbt1', dic2[d - 1], dic2[d])
                dic1[lq] = [' ', ' ', ' ', 'Sub Total', ' ', ' ']
                lq += 1

            if f > 1 and d == fn and dic2[d][1] != 'Sub Total':
                print('add sbt', dic2[d])
                dic1[lq] = dic2[d]
                dic1[lq + 1] = [' ', ' ', ' ', 'Sub Total', ' ', ' ']
            dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    if len(src_dc['correct_combination'])>1:
        dic2=dicA
        dic1={}
        lq=1
        for d in dic2:
            ss=''
            if ss.join(dic2[d]).__contains__(sbt)==False:
                # print('yyyyyyyy',dic2[d])
                dic1[lq]=correct_combination(dic2[d],src_dc['correct_combination'])
                # print('gggggggg',dic1[lq])
            else:
                # print('yyyyyyyygggg',dic2[d])
                dic1[lq]=dic2[d]
            lq +=1
        dicA=dic1

    return dicA
def merged_lines_dic_one(dic1: dict, src_dc, head_list):
    hospital = src_dc['Hospital']
    sbt = src_dc['sbt']
    dic_c = dic1
    dic1 = {}
    cl = 1
    noc = int(src_dc['#colm'])
    last1 = []
    if noc == 6:
        list1 = [' ', ' ', ' ', ' ', ' ', ' ']
    elif noc == 7:
        list1 = [' ', ' ', ' ', ' ', ' ', ' ', ' ']
    elif noc == 8:
        list1 = [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ']
    elif noc == 9:
        list1 = [' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ', ' ']

    for d in dic_c:
        if dic_c[d].count(' ') == noc:
            continue
        dic1[cl] = dic_c[d]
        cl += 1

    dicA = {}
    ll = 1
    last = list1
    for dd in dic1:
        print('mmmmdd1111=', dic1[dd])
        if dd > 1 and (
                len(re.findall('\d\s\.\s\d', dic1[dd][3])) == 1 or len(re.findall('\d\.\d', dic1[dd][3])) == 1 or len(
                re.findall('\d\s\.\d', dic1[dd][3])) == 1 or len(re.findall('\d\.\s\d', dic1[dd][3])) == 1) and (
                len(re.findall('\d\s\.\s\d', dic1[dd][5])) == 1 or len(re.findall('\d\.\d', dic1[dd][5])) == 1 or len(
                re.findall('\d\s\.\d', dic1[dd][5])) == 1 or len(re.findall('\d\.\s\d', dic1[dd][5])) == 1) and dic1[
            dd].count(' ') >= 4 and dic1[dd - 1].count(' ') >= 4 and len(
                re.findall('\d\s\.\s\d', dic1[dd - 1][5])) == 0 and len(re.findall('\d\s\.\s\d', dic1[dd - 1][3])) == 0:
            print('for 220100588993 parti and num separet lines')
            dic1[dd - 1][3] = dic1[dd][3]
            dic1[dd - 1][5] = dic1[dd][5]
            dic1[dd] = [' ', ' ', ' ', ' ', ' ', ' ']
        # if dic1[dd][1] in head_list:
        # print('555555555',dic1[dd])
        if dic1[dd][1] in head_list and len(dicA) == 0:
            # print('kkkkkkkkkkkkkkkkkkkkkkkkk', len(dicA))
            dicA[ll] = dic1[dd]
            ll += 1
            continue
        if dic1[dd][1] in head_list and len(dicA) >= 1:
            # print('lllllllllllllllllllllllllll',len(dicA) )
            dicA[ll] = last
            ll += 1
            dicA[ll] = dic1[dd]
            ll += 1
            last = list1
        elif ((len(last[-1]) > 1 or len(last[-3]) > 1) and (
                len(re.findall('\d\s?\.\s?\d', last[-1].replace(' ', ''))) >= 1 or len(
                re.findall('\d\,\:\d', last[-1].replace(' ', ''))) >= 1 or len(
                re.findall('\d\.\d', last[-3].replace(' ', ''))) >= 1 or len(
                re.findall('\d\s\.\d', last[-3].replace(' ', ''))) >= 1 or len(
                re.findall('\d\s\.\d', last[-1].replace(' ', ''))) >= 1 or len(re.findall('\d\s\d', last[-1])) >= 1)):
            # print('222222',dic1[dd])
            dicA[ll] = last
            ll += 1
            last = list1
            last = opr1(last, dic1[dd], src_dc)
        else:
            # print('33333',dic1[dd])
            last = opr1(last, dic1[dd], src_dc)
    dicA[ll] = last

    # below 3 lines for removing empty lists
    filtered = {k: v for k, v in dicA.items() if not v == [' ', ' ', ' ', ' ', ' ', ' ']}
    dicA = filtered
    # //////////////////////////////////////
    if hospital == 'gangaram':
        dic2 = dicA
        dicA = {}
        lq = 1
        known_items = ['Room rent 17/10/2020)',
                       'Skin grafting - minorr - PLASTIC & COSMETIC SURG (UNIT 1) - DR. MANGAL (16/09/2020)',
                       'Micropore surgical tape ( 3 inch width ) 1530-3-3M (16/09/2020)  (  (R04200517) )',
                       'midaz vial (22/09/2020)',
                       'Micropore surgical tape ( 3 inch width ) 1530-3-3M (26/09/2020)  (  (R11190544) )',
                       'Mezolam Vial (26/09/2020)',
                       'Micropore surgical tape ( 3 inch width ) 1530-3-3M (17/10/2020)  (  (R04200516T) )',
                       'VICRYL ( NW2338 ) 90 cm ( 1-0 ) 1/2 Circle Round body 30mm 22/10/2020)  ( (T706AQ) )',
                       'Micropore surgical tape ( 3 inch width ) 1530-3-3M (22/10/2020)  ( . (R0420016T) )',
                       'Doctor visit charges - GYNAE ENDOSCOPY (UNIT V B) - D', 'Inj . Ketamin 09/09/2019)',
                       'Amp. MEZOLAM 1 ml 5 mg/ml ( Midazolam ) (09/09/2019)  ( (1233015) )',
                       'Foam sclerotherapy for varicose veins - VASCULAR & ENDOVASCULAR SURGERY (DR. V. S. BEDI) (19/09/2020)',
                       'Debridement ( large ) - ORTHOPAEDICS (UNIT 2B) -DR. MANISH DHAWAN (16/09/2020)',
                       'Durapore Surgical Tape 1538 - 3 ( 3 Inch Width ) - 3M (26/09/2020) . 5 (.5 (R12190308) )']
        correct_map_known_items = {
            'Room rent 17/10/2020)': [[' ', '5 12900.00', ' ', '6450.00'], ['0.5', '12900.00', ' ', '6450.00']],
            'Skin grafting - minorr - PLASTIC & COSMETIC SURG (UNIT 1) - DR. MANGAL (16/09/2020)': [
                [' ', ' ', ' ', '11150. 00'], ['1', '11150.0', ' ', '11150. 00']],
            'Micropore surgical tape ( 3 inch width ) 1530-3-3M (16/09/2020)  (  (R04200517) )': [
                ['. 25', '246. 00', ' ', '61 . 50'], ['0.25', '246. 00', ' ', '61 . 50']],
            'midaz vial (22/09/2020)': [['1', '65 . 00', ' ', '6.50'], ['0.1', '65 . 00', ' ', '6.50']],
            'Micropore surgical tape ( 3 inch width ) 1530-3-3M (26/09/2020)  (  (R11190544) )': [
                ['. 25', '246.00', ' ', '61. 50'], ['0.25', '246.00', ' ', '61. 50']],
            'Mezolam Vial (26/09/2020)': [['. 1', '63 . 80', ' ', '6. 38'], ['0.1', '63 . 80', ' ', '6. 38']],
            'Micropore surgical tape ( 3 inch width ) 1530-3-3M (17/10/2020)  (  (R04200516T) )': [
                ['. 25', '246.00', ' ', '61 . 50'], ['0.25', '246.00', ' ', '61 . 50']],
            'VICRYL ( NW2338 ) 90 cm ( 1-0 ) 1/2 Circle Round body 30mm 22/10/2020)  ( (T706AQ) )': [
                ['1', '62 . 00', ' ', '562 .00'], ['1', '562 . 00', ' ', '562 .00']],
            'Micropore surgical tape ( 3 inch width ) 1530-3-3M (22/10/2020)  ( . (R0420016T) )': [
                ['5', '246.00', ' ', '123.00'], ['0.5', '246.00', ' ', '123.00']],
            'Doctor visit charges - GYNAE ENDOSCOPY (UNIT V B) - D': [['1', '11600 . 00', ' ', '1600.00'],
                                                                      ['1', '1600 . 00', ' ', '1600.00']],
            'Inj . Ketamin 09/09/2019)': [['. 1', '53 .80', ' ', '5.38'], ['0.1', '53 .80', ' ', '5.38']],
            'Amp. MEZOLAM 1 ml 5 mg/ml ( Midazolam ) (09/09/2019)  ( (1233015) )': [['. 1', '15 . 10', ' ', '1 . 51'],
                                                                                    ['0.1', '15 . 10', ' ', '1 . 51']],
            'Foam sclerotherapy for varicose veins - VASCULAR & ENDOVASCULAR SURGERY (DR. V. S. BEDI) (19/09/2020)': [
                ['1', '118530 . 00', ' ', '18530. 00'], ['1', '18530.00', ' ', '18530.00']],
            'Debridement ( large ) - ORTHOPAEDICS (UNIT 2B) -DR. MANISH DHAWAN (16/09/2020)': [
                [' ', '3405 . 00', ' ', '8405 . 00'], ['1', '8405.00', ' ', '8405.00']],
            'Durapore Surgical Tape 1538 - 3 ( 3 Inch Width ) - 3M (26/09/2020) . 5 (.5 (R12190308) )': [
                [' ', '1531. 26', ' ', '765 . 63'], ['0.5', '1531.26', ' ', '765.63']],
        }
        for d in dic2:
            print('diccc==', dic2[d])
            try:
                if dic2[d][1] != ' ' and dic2[d][4] != ' ' and len(re.findall('\d\s?\.\s?\d', dic2[d][4])) == 0:
                    print('for adding 4th index to 1st index')
                    dic2[d][1] = dic2[d][1] + dic2[d][4]
                    dic2[d][4] = ' '
                if dic2[d][1].strip(' -,.') in known_items:
                    if dic2[d][1].strip(' -,.') in correct_map_known_items and dic2[d][2:] == \
                            correct_map_known_items[dic2[d][1].strip(' -,.')][0]:
                        print('itemssss', dic2[d])
                        neww = copy.deepcopy(dic2[d])
                        neww = neww[:2] + correct_map_known_items[neww[1].strip(' -,.')][1]
                        dicA[lq] = neww
                        lq += 1
                        continue
            except:
                print('known_items error')
            dicA[lq] = dic2[d]
            lq += 1

    if hospital == 'fortismohali':
        dic2 = dicA
        lq = 1
        for d in dic2:
            print('mmdd11==', dic2[d])
            if len(re.findall('\d\s?\.\s?\d', dic2[d][2])) == 1 and dic2[d][2] == dic2[d][3]:
                print('if rate is repeated in 2nd index')
                dic2[d][2] = ' '
            if dic2[d][1].__contains__('Total IC'):
                dic2[d][4] = ' '
                dic2[d][5] = ' '
            if dic2[d][0] != ' ' and dic2[d][1] == ' ' and dic2[d][1] not in head_list:
                dic2[d][1] = dic2[d][0]
                dic2[d][0] = ' '
            if dic2[d][1] != ' ' and dic2[d][0] != ' ' and dic2[d][1] not in head_list:
                dic2[d][1] = dic2[d][1] + dic2[d][0]
                dic2[d][0] = ' '
            if dic2[d][1] == 'Total' or dic2[d][1] == 'Net Payable':
                dic2[d][5] = ' '
            dicA[lq] = dic2[d]
            lq += 1

    if hospital == 'manipaldelhi' or hospital == 'manipal_N0900' or hospital == 'Columbia_N16420' or hospital == 'Vikram':
        dic2 = dicA
        lq = 1
        dicA = {}
        for d in dic2:
            print('mmdd11==', dic2[d])
            if d > 1 and dic2[d][1] == 'Admission Charges' and dic2[d][3] != ' ' and dic2[d][5] != ' ':
                print('changed')
                dic2[d][1] = 'Admission Chargess'
            if d > 1 and len(dic2[d][2].split()) == 2 and len(re.findall('\d\s?\.\s?\d', dic2[d][2])) == 1:
                print('if Qty, rate is in 2nd indx')
                a, b = dic2[d][2].split()
                dic2[d][2] = a
                dic2[d][3] = b
            if d > 1 and len(re.findall('\d\s?\.\s?\d', dic2[d][2])) == 1 and dic2[d][3] == ' ':
                print('if rate is in 2nd indx and 3rd indx is empty')
                dic2[d][3] = dic2[d][2]
                dic2[d][2] = ''
            if dic2[d][0] != ' ' and dic2[d][1] == ' ' and dic2[d][1] not in head_list:
                dic2[d][1] = dic2[d][0]
                dic2[d][0] = ' '
            if dic2[d][1] != ' ' and dic2[d][0] != ' ' and dic2[d][1] not in head_list:
                dic2[d][1] = dic2[d][0] + dic2[d][1]
                dic2[d][0] = ' '

            dicA[lq] = dic2[d]
            lq += 1

    for d in dicA:
        print(dicA[d])
    if len(src_dc['correct_combination']) > 1:
        dic2 = dicA
        dic1 = {}
        lq = 1
        for d in dic2:
            ss = ''
            if ss.join(dic2[d]).__contains__(sbt) == False:
                # print('yyyyyyyy',dic2[d])
                dic1[lq] = correct_combination(dic2[d], src_dc['correct_combination'])
                # print('gggggggg',dic1[lq])
            else:
                # print('yyyyyyyygggg',dic2[d])
                dic1[lq] = dic2[d]
            lq += 1
        dicA = dic1
    return dicA
def final_dictionary(ddic:dict,lebels):
    dic3=ddic    
    dic_final={}
    for dd in dic3:
        dcf1={}
        lf=1
        for d in dic3[dd]:
            dcf1_1={}
            c=0
            for x in dic3[dd][d]:
                if len((dic3[dd][d][c]).strip())==0:
                    c +=1
                    continue
                else:
                    dcf1_1[lebels[c]] = dic3[dd][d][c]
                c +=1
            dcf1[lf] = dcf1_1
            lf +=1
        dic_final[dd] = dcf1
    return dic_final
def for_csv_copy(dicA,flcs,lebels):
    new_list=[]
    for d in dicA:
        new_list.append(dicA[d])
    with open(flcs, 'w', newline='', encoding='utf-8', errors='ignore') as f:
        write = csv.writer(f)
        write.writerow(lebels)
        write.writerows(new_list)
    return
def nested_dictionary(dicA,src_dc,head_list):
    if src_dc['recognise_head']=='yes':
        dic_1=dicA
        dicA=recognise_head(dic_1,src_dc,head_list)
    
    for d in dicA:
        print(dicA[d])
    # LOG.debug("to find dictionaryA")
    # LOG.debug(str(dicA))
    print('#################################################')
    # head_list=src_dc['head_list'].split(',')
    sbt=src_dc['sbt']
    
    sbt_n=src_dc['sbt_no']
    ddic={}
    ddic1={}
    hd=''
    if src_dc['add_head']=='yes':
        hd='Head'
    nl=1
    if len(src_dc['hdl_no'])>1:
        # print('1qqqqqqqqqqqq')
        id1,cnd1,id2,cnd2,cnd_mn=src_dc['hdl_no'].split(',')
        id1,id2=int(id1),int(id2)
        # print(id1,'-',cnd1,'-',id2,'-',cnd2,'-',cnd_mn,'-----')
        for d in dicA:
            st11=''         
            if (dicA[d][id1].__contains__(cnd1) or dicA[d][id2].__contains__(cnd2)):
                hd=(dicA[d][id1]+' '+dicA[d][id2]).split(cnd_mn)[0]
                hd=re.sub('[0-9]','',hd).strip()
                ddic1[nl]=dicA[d]
                nl += 1
                continue
            elif st11.join(dicA[d]).__contains__(sbt)==True and st11.join(dicA[d]).__contains__(sbt_n)==False:
                ddic1[nl]=dicA[d]
                ddic[hd]=ddic1
                ddic1={}
                nl=1
            else:
                ddic1[nl]=dicA[d]
                nl += 1
    else:
        # print('1rrrrrrrrrrrrrrrrrrrrr')
        last_line=''
        x=1
        # print(head_list)
        for d in dicA:
            # print('000000000',dicA[d])
            st11=''         
            if len(dicA[d][0])>=3 and dicA[d][0] in head_list:
                # print('11111111',dicA[d])
                hd=dicA[d][0]
                if hd in ddic:
                    hd=hd+str(x)
                    x +=1
                continue
            elif st11.join(dicA[d]).__contains__(sbt)==True and st11.join(dicA[d]).__contains__(sbt_n)==False:
                # print('22222222',dicA[d])
                ddic1[nl]=dicA[d]
                ddic[hd]=ddic1
                ddic1={}
                nl=1
            else:
                # print('333333333',dicA[d])
                ddic1[nl]=dicA[d]
                nl += 1
    if src_dc['Hospital'] == 'lilavati':
        print('we have to reconsider as this is Lilalvati Hospital')
        ddic_new = ddic
        ddic = {}
        for dd in ddic_new:
            if dd not in ['Pharmacy', 'Materials']:
                ddic[dd] = ddic_new[dd]
    
    if src_dc['Hospital'] == 'srch':
        hdl_now=[]
        hdl_pst=[]
        for dd in ddic:
            # print()
            # print(dd,'00000_pppppjjjjjjffffffff')
            if len(hdl_now)==0:
                hdl_now.append(dd)
                hdl_pst.append(dd)
                print(dd,'11111_pppppjjjjjjffffffff')
            else:
                # print(dd[:-1],hdl_now)
                if partially_presennt_also(hdl_now,dd)=='Yes':
                    hdl_pst.append(dd)
                    print(dd,'22222_pppppjjjjjjffffffff')
                else:
                    hdl_now.append(dd)
                    hdl_pst.append(dd)
                    print(dd,'33333_pppppjjjjjjffffffff')
        print(hdl_now,'pppppjjjjjjffffffff')
        if len(hdl_now)>4:
            ddic_new = ddic
            ddic = {}
            for dd in ddic_new:
                if dd in hdl_now:
                    ddic[dd] = ddic_new[dd] 

    if src_dc['Hospital'] == 'srch-pharma':
        ddic_new = ddic
        ddic = {}
        for dd in ddic_new:
            if 'CRED' in dd or 'CRRT' in dd:
                continue
            else:
                ddic[dd] = ddic_new[dd]

    if src_dc['Hospital'] == 'hinduja':
        ddic_new = ddic
        ddic = {}
        roomtypes = ['MEDIAN A','MEDIAN B','MEDIAN C','DELUX','SPECIAL','SUITE','MEDIAN','SSS Premium']
        roomfind1 = ''
        for dd in ddic_new:
            if 'BED CHARGES' in dd:
                for key,value in ddic_new[dd].items():
                    print('keyy',key)
                    print('value',value)
                    for i in roomtypes:
                        if i in value[0]:
                            print('present==',i)
                            roomfind1 = i
                            break
                    if roomfind1 not in value[0] and value[0]!= ' ':
                        print('roomtype not presnt in bedcharges so adding it')
                        value[0] = value[0]+' '+roomfind1
                    else:
                        print('roomtype presnt in bedcharges')
                        pass
            ddic[dd] = ddic_new[dd]

    if src_dc['Hospital'] == 'Horizon_N18007':
        ddic_new = ddic
        ddic = {}
        for dd in ddic_new:
            if 'DOCTOR VISIT CHARGES' in dd or 'ROOM CHARGES' in dd:
                for key, value in ddic_new[dd].items():
                    print('keyy', key)
                    print('value', value)
                    text = value[5]
                    value[5] = value[2]
                    value[2] = text
            ddic[dd] = ddic_new[dd]

    if src_dc['Hospital'] == 'max':
        ddic_new = ddic
        ddic = {}
        count = 0
        for dd in dict(reversed(list(ddic_new.items()))):
            print('headerr before',dd)
            if 'Surgery' in dd and count==0:
                print('yess present')
                count+=1
            elif 'Surgery' in dd and count>=1:
                print('count+111')
                continue
            ddic[dd] = ddic_new[dd]

        ddic_new = ddic
        ddic = {}
        count = 0
        for dd in dict(reversed(list(ddic_new.items()))):
            print('headerr after', dd)

            ddic[dd] = ddic_new[dd]
    if src_dc['Hospital'] == 'omnihospital':
        ddic_new = ddic
        ddic = {}
        for dd in ddic_new:
            if 'Doctor Charges' in dd:
                for key,value in ddic_new[dd].items():
                    print('keyy',key)
                    print('value',value)
                    value[2] = value[1]+" "+value[2]
                    value[1]=' '
                    value[2] = value[2].strip()
            if 'ICU Charges' in dd:
                for key,value in ddic_new[dd].items():
                    print('keyy',key)
                    print('value',value)
                    value[2] = value[1]+" "+value[2]
                    value[1]=' '
                    value[2] = value[2].strip()
            ddic[dd] = ddic_new[dd]
    for dd in ddic:
        print(dd)
        print('#################')
        for d in ddic[dd]:
            print(ddic[dd][d])
    return ddic
def nested_dictionary_spl_one(dicA,src_dc,head_list):
    for d in dicA:
        print(dicA[d])
    print('#################################################')
    # head_list=src_dc['head_list'].split(',')
    sbt=src_dc['sbt']    
    sbt_n=src_dc['sbt_no']
    ddic={}
    ddic1={}
    hd=''
    nl=1
    chk_t=-1
    dic_list=[]
    one_chk=[]
    for d in dicA:
        dic_list.append(dicA[d])
    one_chk=dic_list[0]
    dic_list.append(one_chk)
    for d in dicA:
        chk_t +=1
        # print('00000',dicA[d])
        st11=''         
        if len(dicA[d][0])>=3 and dicA[d][0] in head_list:
            # print('11111',dicA[d])
            hd=dicA[d][0]
            continue
        elif st11.join(dicA[d]).__contains__(sbt)==True and dicA[d][0].replace(sbt,'').replace('(','').replace(')','').strip() in head_list and dicA[d][0]!=dic_list[chk_t+1][0]:
            # print('22222',dicA[d])
            ddic1[nl]=dicA[d]
            ddic[hd]=ddic1
            ddic1={}
            nl=1
        else:
            # print('33333',dicA[d])
            ddic1[nl]=dicA[d]
            nl += 1
    for dd in ddic:
        print(dd)
        print('#################')
        for d in ddic[dd]:
            print(ddic[dd][d])
    return ddic
def nested_dictionary_spl_three(dicA,src_dc,head_list):
    for d in dicA:
        print(dicA[d])
    sbt=src_dc['sbt']    
    sbt_n=src_dc['sbt_no']
    ddic={}
    ddic1={}
    hd=''
    nl=1
    x=1
    chk_t=-1
    dic_list=[]
    one_chk=[]
    for d in dicA:
        dic_list.append(dicA[d])
    one_chk=dic_list[0]
    dic_list.append(one_chk)
    for d in dicA:
        chk_t +=1
        # print('00000',dicA[d])
        st11=''         
        if len(dicA[d][0])>=3 and dicA[d][0] in head_list and len(hd)==0 and len(ddic1)==0:
            # print('11111',dicA[d])
            hd=dicA[d][0]
            if hd in ddic:
                hd=hd+str(x)
                x +=1
            continue
        elif st11.join(dicA[d]).__contains__(sbt)==True and dicA[d][0].replace('(Subtotal,','(Subtotal)').replace('(Subtotal;','(Subtotal)').replace(sbt,'').replace('(','').replace(')','').strip() in head_list and dicA[d][0]!=dic_list[chk_t+1][0] and dic_list[chk_t-1][0].__contains__(sbt):
            # print('22222',dicA[d])
            ddic1[nl]=dicA[d]
            ddic[hd]=ddic1
            ddic1={}
            nl=1
            hd=''
        else:
            # print('33333',dicA[d])
            ddic1[nl]=dicA[d]
            nl += 1
    for dd in ddic:
        print(dd)
        print('#################')
        for d in ddic[dd]:
            print(ddic[dd][d])
    return ddic
def nested_dictionary_spl_two(dicA,src_dc,head_list):
    
    type=1
    for d in dicA:
        sss=''
        if sss.join(dicA[d]).__contains__('Sub Total'):
            type=2
            break

    if type==2:
        ddic={}
        hd='Top'
        ddic[hd]=dicA
    else:
        ddic={}
        ddic1={}
        hd=''
        nl=1
        xf=0
        head = []
        count = 1
        for d in dicA:
            print('lasstt',dicA[d])
            if xf==0:
                hd=dicA[d][1]
            xf += 1
            if len(dicA[d][1])>2 and dicA[d][1] in head_list:
                print('222222',dicA[d][1])
                head.append(dicA[d][1])
                ddic[hd]=ddic1
                ddic1={}
                nl=1
                hd=dicA[d][1]
            if dicA[d][1] in head and head.count(dicA[d][1])>1:
                print('already presnt')
                count+=1
                dicA[d][1] = dicA[d][1]+str(count)
                hd = dicA[d][1]
            else:
                # print('333333',dicA[d])
                ddic1[nl]=dicA[d]
                nl +=1
        if hd not in ddic:
            ddic[hd]=ddic1
    # else:
    # this is previous one
    #     ddic={}
    #     ddic1={}
    #     hd=''
    #     nl=1
    #     xf=0
    #     for d in dicA:
    #         if xf==0:
    #             hd=dicA[d][1]
    #         xf += 1
    #         if len(dicA[d][1])>2 and dicA[d][1] in head_list:
    #             # print('222222',dicA[d][1])
    #             ddic[hd]=ddic1
    #             ddic1={}
    #             nl=1
    #             hd=dicA[d][1]
    #         else:
    #             # print('333333',dicA[d])
    #             ddic1[nl]=dicA[d]
    #             nl +=1
    #     if hd not in ddic:
    #         ddic[hd]=ddic1
    for dd in ddic:
        print(dd)
        print('#################')
        for d in ddic[dd]:
            print(ddic[dd][d])
    return ddic
def vld_dot_zz(lst:list):
    qty=lst
    qty1=[]
    qty_new=[]
    punc=[',',':']
    for q in qty:
        q=q.strip('.').strip(':').strip(';').strip(',')        
        if len(q)>=3 and q[-3] in punc:
            # print(q)
            q=q[:-3]+'.'+q[-2:]
            # print(q)
            qty_new.append(q)
        else:
            qty_new.append(q)
    # print(qty_new) 
    qty_new
    return qty_new
def date_time_match(date11:str,date22:str,sepr1,sepr2):
    dd=''
    mm=''
    yy=''
    t1=''
    t2=''
    date_one=''
    time_one=''
    if date11.__contains__(sepr1) and date11.__contains__(sepr2) and len(date11.split(sepr1))==3:
        dd=date11.split(sepr1)[0]
        mm=date11.split(sepr1)[1]
        yy=date11.split(sepr1)[1].split()[0]
        t1=date11.split(sepr2)[0].split()[1]
        t2=date11.split(sepr2)[1]
    date22=date22.strip()
    if len(date22.split())==2:
        date_one=date22.split()[0]
        time_one=date22.split()[1]
        if date_one.__contains__(sepr1) and len(date_one.split(sepr1))==3 and len(date22.split(sepr1)[0])==1:
            date_one=dd[0]+date_one
        elif date_one.__contains__(sepr1) and len(date_one.split(sepr1))==3 and len(date22.split(sepr1)[0])==0:
            date_one=dd+date_one
        if date_one.__contains__(sepr1) and len(date_one.split(sepr1))==2 and len(date22.split(sepr1)[0])==1:
            date_one=dd+sepr1+mm[0]+date_one
        elif date_one.__contains__(sepr1) and len(date_one.split(sepr1))==2 and len(date22.split(sepr1)[0])==0:
            date_one=dd+sepr1+mm+date_one
        if date_one.__contains__(sepr1)==False and len(date_one)==4:
            date_one=dd+sepr1+mm+sepr1+date_one
        elif date_one.__contains__(sepr1)==False and len(date_one)<4:
            date_one=dd+sepr1+mm+sepr1+yy
        if time_one.__contains__(sepr2) and len(time_one.split(sepr2))==2 and len(time_one.split(sepr2)[1])==1:
            time_one=time_one+t2[-1]
        elif time_one.__contains__(sepr2) and len(time_one.split(sepr2))==2 and len(time_one.split(sepr2)[1])==0:
            time_one=time_one+t2
        if time_one.__contains__(sepr2)==False and len(time_one)==2:
            time_one=time_one+sepr2+t2
        elif time_one.__contains__(sepr2)==False and len(time_one)<2:
            time_one=t1+sepr2+t2
    date22=date_one+' '+time_one
    return date22
def vld_datetime(lst:list,pattern,sepr1,sepr2):
    date=lst
    date1=[]
    date_new=[]
    for d in date:
        if d==' ':        
            if len(date1)!=0:
                date2=[]
                if len(date1)>=2:
                    date2=date1
                    date1=[]
                    lst=''
                    for i in date2:
                        i=re.sub('[^0-9a-z,A-Z-/: ]','',i).strip(':').strip('.')
                        l=re.findall(pattern,i)
                        if len(l)==1:
                            date1.append(i)
                        else:
                            if len(lst)!=0:
                                # print(lst,'----',i)
                                i=date_time_match(lst,i)
                                # print(i)
                                date1.append(i)
                            else:
                                date1.append(i)
                        lst=i
                date_new.extend(date1)
            date_new.append(' ')
            date1=[] 
        else:
            date1.append(d)
    if len(date_new)!=len(date):
        date_new=date        
    return date_new
def cross_validation_discount(x1,x2,x3):
    punc=['$','#','!','%','*']
    x1=x1.strip().strip('.').strip(',').strip(';').replace(' ','')
    x2=x2.strip().strip('.').strip(',').strip(';').replace(' ','')
    x3=x3.strip().strip('.').strip(',').strip(';').replace(' ','')
    # print(x1,'--',x2,'--',x3,'---',type(x2))
    if len(x1)==0 or len(x2)==0 or len(x3)==0:
        return x1,x2,x3
    try:
        d1,d2,d3=0,0,0
        if len(x1)>=1:
            d1=float(re.sub('[^0-9.]','',x1))
        if len(x2)>=1:
            d2=float(re.sub('[^0-9.]','',x2))
        if len(x3)>=1:
            d3=float(re.sub('[^0-9.]','',x3))
        if d1+d2==d3:
            return x1,x2,x3
        if len(x1)>=1 and x1[0] in punc:
            x1=str(d3-d2)
        elif len(x3)>=1 and x3[0] in punc:
            x3=str(d1+d2)
    except:
        print("An exception occurred",x1,'--',x2,'--',x3)
    return x1,x2,x3
def cross_validation_rate(x1,x2,x3):
    punc=['$','#','!','%','*']
    x1=x1.strip().strip('.').strip(',').strip(';').replace(' ','')
    x2=x2.strip().strip('.').strip(',').strip(';').replace(' ','')
    x3=x3.strip().strip('.').strip(',').strip(';').replace(' ','')
    # print(x1,'--',x2,'--',x3,'---',type(x2))
    if len(x1)==0 or len(x2)==0 or len(x3)==0:
        return x1,x2,x3
    try:
        d1,d2,d3=0,0,0
        if len(x1)>=1:
            d1=float(re.sub('[^0-9.]','',x1))
        if len(x2)>=1:
            d2=float(re.sub('[^0-9.]','',x2))
        if len(x3)>=1:
            d3=float(re.sub('[^0-9.]','',x3))
        if d1*d2==d3:
            return x1,x2,x3
        # if len(x2)>=1:
        #     x1=str(d3-d2)
        # elif len(x3)>=1:
        #     x3=str(d1+d2)
    except:
        print("An exception occurred",x1,'--',x2,'--',x3)
    return x1,x2,x3
def date_only_match(date11:str,date22:str,sepr):
    dd=''
    if date11.__contains__(sepr) and len(date11.split(sepr))==3:
        dd=date11.split(sepr)[0]
    date22=date22.strip()
    if date22.__contains__(sepr) and len(date11.split(sepr))==3:
        if len(date22.split(sepr)[0])==1:
            date22=dd[0]+date22
        elif len(date22.split(sepr)[0])==2:
            date22=dd+date22
    return date22
def vld_dateonly(lst:list,pattern,sepr):
    date=lst
    date1=[]
    date_new=[]
    # print(date)
    for d in date:
        if d==' ':        
            if len(date1)!=0:
                date2=[]
                if len(date1)>=2:
                    date2=date1
                    date1=[]
                    lst=''
                    for i in date2:
                        i=re.sub('[^0-9a-z,A-Z-/: ]','',i).strip(',').strip('.')
                        # l=re.findall('\d{2}\-\w{3}\-\d{4}',i)
                        l=re.findall(pattern,i)
                        if len(l)==1:
                            date1.append(i)
                        else:
                            if len(lst.strip())!=0:
                                # print(lst,'----',i)
                                i=date_only_match(lst,i)
                                # print(i)
                                date1.append(i)
                            else:
                                date1.append(i)
                        lst=i
                date_new.extend(date1)
            date_new.append(' ')
            date1=[] 
        else:
            date1.append(d)
    print(date,'*******************************************',date_new)
    return date_new
def validation_one(dicA:dict,src_dc):
    data=[]
    for d in dicA:
        data.append(dicA[d])
    dicA={}
    li=1
    dtm,qtm,rtm,ttm,istm,atm=0,0,0,0,0,0
    
    if len(src_dc['date'])>1:
        dtm=int(src_dc['date'][-1])-1
    if len(src_dc['qty'])>1:
        qtm=int(src_dc['qty'][-1])-1
    if len(src_dc['rate'])>1:
        rtm=int(src_dc['rate'][-1])-1
    if len(src_dc['total'])>1:
        ttm=int(src_dc['total'][-1])-1
    if len(src_dc['discount'])>1:
        istm=int(src_dc['discount'][-1])-1
    if len(src_dc['amount'])>1:
        atm=int(src_dc['amount'][-1])-1
    date=[]
    date_new=[]
    qty=[]
    qty_new=[]
    rate=[]
    rate_new=[]
    total=[]
    total_new=[] 
    dis=[]
    dis_new=[]
    amt=[]
    amt_new=[]
    datetime=src_dc['datetime_func']
    dateonly=src_dc['date_func']
    
    # print(data)
    for d in data:
        x1,x2,x3='','',''
        if src_dc['disc_func']=='yes':
            x1=d[ttm]
            x2=d[istm]
            x3=d[atm]
            x1,x2,x3=cross_validation_discount(x1,x2,x3)
        elif src_dc['rate_func']=='yes':
            x1=d[qtm]
            x2=d[rtm]
            x3=d[atm]
            x1,x2,x3=cross_validation_rate(x1,x2,x3)
        if dtm!=0:
            date.append(d[dtm])
        if qtm!=0:
            qty.append(d[qtm])
        if rtm!=0:
            rate.append(d[rtm])
        if ttm!=0:
            if x1!='':
                total.append(x1)
            else:
                total.append(d[ttm])
        if istm!=0:
            if x2!='':
                dis.append(x2)
            else:
                dis.append(d[istm])            
        if atm!=0:
            if x3!='':
                amt.append(x3)
            else:
                amt.append(d[atm])
            
    if len(date)!=0: 
        if datetime=='yes':
            pattern,sepr1,sepr2=src_dc['dtf_yes']      
            date_new=vld_datetime(date,pattern,sepr1,sepr2)
        if dateonly=='yes':
            pattern,sepr=src_dc['df_yes']
            date_new=vld_dateonly(date,pattern,sepr)
        else:
            date_new=date
    if len(qty)!=0:
        qty_new=vld_dot_zz(qty)
    if len(rate)!=0:
        rate_new=vld_dot_zz(rate)
    if len(total)!=0:
        total_new=vld_dot_zz(total)
    if len(dis)!=0:
        dis_new=vld_dot_zz(dis)
    if len(amt)!=0:
        amt_new=vld_dot_zz(amt)
    # print(date_new)
    # print('*******************************************')
    # print(qty_new)
    # print('*******************************************')
    # print(rate_new)
    # print('*******************************************')
    # print(total_new)
    # print('*******************************************')
    # print(dis_new)
    # print('*******************************************')
    # print(amt_new)
    # print('*******************************************')
    i=0
    for d in data:
        # print(dtm,'-',qtm,'-',rtm,'-',ttm,'-',istm,'-',atm,'--',d)
        if dtm!=0:
            d.pop(dtm)
            d.insert(dtm,date_new[i])
        if qtm!=0:
            d.pop(qtm)
            d.insert(qtm,qty_new[i])
        if rtm!=0:
            d.pop(rtm)
            d.insert(rtm,rate_new[i])
        if ttm!=0:
            d.pop(ttm)
            d.insert(ttm,total_new[i])
        if istm!=0:
            d.pop(istm)
            d.insert(istm,dis_new[i])
        if atm!=0:
            d.pop(atm)
            d.insert(atm,amt_new[i])
        i +=1
    lebels=['Item','Date','Batch/Exp Date','Quantity','Total','Discount','Amount']
    with open('new_one.csv', 'w', newline='', encoding='utf-8', errors='ignore') as f:
        write = csv.writer(f)
        write.writerow(lebels)
        write.writerows(data)
    for i in data:
        dicA[li]=i
        li +=1
    # for d in dicA:
    #     print(dicA[d])
    return dicA

def bill_ext(page_set: list, hs_name: str):
    # summary_headers=['Consultation(999311)', 'CSSD(999311)', 'Equipment(999311)', 'Invasive Procedures(999311)', 'Investigations (999311)', 'Medical Administration(999311)', 'Medical Services(999311)', 'OT Consumables(999311)', 'OT Pharmacy(999311)', '10 Professional Charges(999311)', '1 Profile(999311)', '2 Room Rent(999311)', '13 Ward Pharmacy(999311)']
    summary_headers = []
    filename1 = "interpretation_directions.csv"
    hospital_name = hs_name
    src_dc = source_dictinary(filename1, hospital_name)
    # print(src_dc)
    hospital = src_dc['Hospital']
    head_list = src_dc['head_list'].split(',')
    ddic = {}
    last_dic = {}
    clm_univ_6 = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    clm_univ_7 = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    clm_univ_8 = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]
    clm_univ_9 = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]

    lmrk_univ = 0
    noc = int(src_dc['#colm'])
    if noc == 6:
        clm_universal = clm_univ_6
    elif noc == 7:
        clm_universal = clm_univ_7
    elif noc == 8:
        clm_universal = clm_univ_8
    elif noc == 9:
        clm_universal = clm_univ_9
    esk = 0

    import json
    print(page_set)
    json_files = 'all_bill.json'
    json_files = glob.glob('*.json')[0]
    f = open(json_files, )
    json_dic = json.load(f)
    pg_cnt = 0
    for jd in json_dic:
        pg_cnt += 1
        if pg_cnt not in page_set:
            continue
        if jd.__contains__('original'):
            continue
        print(jd)
        json_data = json_dic[jd]
        # if pg_cnt>=1:
        #     for i in range(len(json_data)):
        #         print(json_data[i].get('text'))
        #         print(json_data[i].get('boundingBox'))
        #         print("**********")
        if src_dc['var_colm_stuc'] == 'yes':
            print('yess111')
            clm_rng, clm_universal = claim_range_spl(json_data, src_dc, clm_universal)
        else:
            print('yess222')
            clm_rng, clm_universal, lmrk_univ = claim_range(json_data, src_dc, clm_universal, lmrk_univ)
            try:
                # print('ffffffffff',src_dc['default_clm_rng'])
                # print('ffffffffff11', clm_rng.count(0) >= 2)
                if len(src_dc['default_clm_rng']) > 1 and clm_rng.count(0) >= 2:
                    num_col = int(src_dc['#colm'])
                    print('we_get_new_clm_rng_NOWW', len(src_dc['default_clm_rng'].split(',')), num_col,
                          len(src_dc['default_clm_rng'].split(',')) == int(2 * num_col))
                    if len(src_dc['default_clm_rng'].split(',')) == int(2 * num_col):
                        print('now_seeee', src_dc['default_clm_rng'].split(','))
                        new_clm_rng = []
                        for dcr in src_dc['default_clm_rng'].split(','):
                            if dcr.strip().isdigit() == True:
                                new_clm_rng.append(int(dcr.strip()))
                        if len(new_clm_rng) == len(src_dc['default_clm_rng'].split(',')):
                            clm_rng = correct_zero_element(clm_rng, new_clm_rng)
                            print('we_get_new_clm_rng_NOWW', clm_rng)
            except:
                print('something_miss_while_default_clm_rng')
        if hospital == 'gangaram' or hospital == 'fortismohali' or hospital == 'manipaldelhi' or hospital == 'Columbia_N16420' or hospital == 'Vikram' or hospital == 'Ils_N14829' or hospital == "parasNewFormat":
            dic1 = basic_extracted_dic_one(json_data, src_dc, clm_rng, esk)
        else:
            dic1 = basic_extracted_dic(json_data, src_dc, clm_rng)

        if len(src_dc['fc_yes']) > 1:
            pattern = src_dc['fc_yes'].split(',')[0]
            cnn = int(src_dc['fc_yes'].split(',')[1])
            indx1 = int(src_dc['fc_yes'].split(',')[2])
            indx2 = int(src_dc['fc_yes'].split(',')[3])
            dic_f = dic1
            dic1 = footer_cln_one(dic_f, pattern, cnn, indx1, indx2)

        if len(src_dc['num_data'].split(',')) == 4:
            dic_n = dic1
            dic1 = avoid_split_line_forfour(dic_n, head_list, src_dc)
        elif len(src_dc['num_data'].split(',')) == 3:
            dic_n = dic1
            dic1 = avoid_split_line_forthree(dic_n, head_list, src_dc)
        elif len(src_dc['num_data'].split(',')) == 2:
            dic_n = dic1
            dic1 = avoid_split_line_fortwo(dic_n, head_list, src_dc)

        if hospital.lower() == 'kokilaben' or hospital.lower() == 'reliance-2'or hospital.lower() == 'medanta' or hospital.lower() == 'medanta-lucknow':
            dic_1 = dic1
            dic1 = add_sbt_for_packages(dic_1)
        elif hospital.lower() == 'artemis':
            dic_1 = dic1
            dic1 = add_sbt_for_packages_one(dic_1, src_dc)

        if len(src_dc['one_to_two_line']) > 1:
            dic_1 = dic1
            dic1 = one_to_two_line(dic_1, src_dc, head_list)
        if len(src_dc['spf_spl_corr']) > 1:
            for x in src_dc['spf_spl_corr'].split('#'):
                if len(x) > 1 and len(x.split(',')) == 2:
                    p1, p2 = x.split(',')
                    dic_1 = dic1
                    dic1 = spf_spl_corr(dic_1, head_list, noc, p1, p2)

        if src_dc['add_to_cnld'] == 'yes':
            dic_1 = dic1
            dic1 = add_to_cnld(dic_1, src_dc, head_list)
        if len(src_dc['add_subtotal']) > 1:
            if src_dc['add_subtotal'].split(',')[0] == 'yes':
                dic_1 = dic1
                # dic1=add_subtotal_one(dic_1,src_dc,head_list)
                dic1 = add_subtotal(dic_1, src_dc, head_list)
        if src_dc['clean_data_1'] == 'yes':
            pattern = src_dc['cd1_yes'].split(',')[0]
            indx1 = int(src_dc['cd1_yes'].split(',')[1])
            indx2 = int(src_dc['cd1_yes'].split(',')[2])
            dic_3 = dic1
            dic1 = clean_row_one(dic_3, pattern, indx1, indx2)

        if src_dc['skip_data_1'] == 'yes':
            dic_3 = dic1
            dic1 = skip_data_one(dic_3, src_dc)

        if len(src_dc['prefer_next']) > 1:
            pattern1 = src_dc['prefer_next']
            dic_3 = dic1
            dic1 = prefer_next(dic_3, pattern1)

        if len(src_dc['head_pos_corr']) >= 1:
            idx = int(src_dc['head_pos_corr'])
            dic_3 = dic1
            dic1 = head_pos_corr(dic_3, idx, src_dc, head_list)

        if len(src_dc['crop_data_1']) > 1:
            indx = int(src_dc['crop_data_1'].split(',')[0])
            skp = int(src_dc['crop_data_1'].split(',')[2])
            param = src_dc['crop_data_1'].split(',')[1]
            dic_3 = dic1
            dic1 = clean_row_onetwo(dic_3, indx, param, skp)

        if len(src_dc['shift_data_1']) > 1:
            indx1 = int(src_dc['shift_data_1'].split(',')[0])
            indx2 = int(src_dc['shift_data_1'].split(',')[1])
            param = src_dc['shift_data_1'].split(',')[2]
            dic_3 = dic1
            dic1 = clean_row_onethree(dic_3, indx1, indx2, param, noc)

        if len(src_dc['addj_overlap']) > 1:
            indx1 = int(src_dc['addj_overlap'].split(',')[0])
            indx2 = int(src_dc['addj_overlap'].split(',')[1])
            prt = src_dc['addj_overlap'].split(',')[2]
            if prt == 'space':
                prt = ' '
            dic_3 = dic1
            dic1 = addj_overlap(dic_3, indx1, indx2, prt)

        if len(src_dc['ss1_yes']) > 1:
            for x in src_dc['ss1_yes'].split('#'):
                if len(x) > 1 and len(x.split(',')) == 3:
                    prt = x.split(',')[2]
                    if prt == 'space':
                        prt = ' '
                    if prt == '\sx\s':
                        prt = ' x '
                    indx1 = int(x.split(',')[0])
                    indx2 = int(x.split(',')[1])
                    dic_3 = dic1
                    dic1 = clean_row_two(dic_3, indx1, indx2, prt)
                if len(x) > 1 and len(x.split(',')) == 4:
                    cnd = x.split(',')[3]
                    prt = x.split(',')[2]
                    if prt == '\s-\s':
                        prt = ' - '
                    indx1 = int(x.split(',')[0])
                    indx2 = int(x.split(',')[1])
                    dic_3 = dic1
                    dic1 = clean_row_two_one(dic_3, indx1, indx2, prt, cnd)
        if src_dc['crop_shift_1'] == 'yes':
            dic_3 = dic1
            dic1 = clean_row_three(dic_3, src_dc)
        if src_dc['clean_amt'] == 'yes':
            dic1 = clean_amt_specific(dic1, src_dc)
        dicA1 = {}
        lx = 1
        if len(last_dic) == 0:
            lx = 1
        else:
            lx = len(last_dic) + 1
        for d in dic1:
            dicA1[lx] = dic1[d]
            lx += 1
        last_dic.update(dicA1)

    if hospital == 'gangaram' or hospital == 'fortismohali' or hospital == 'manipaldelhi' or hospital == 'Columbia_N16420' or hospital == 'Vikram' or hospital == 'Ils_N14829':
        dicA = merged_lines_dic_one(last_dic, src_dc, head_list)

    else:
        dicA = merged_lines_dic(last_dic, src_dc, head_list, summary_headers)
        if len(dicA) == 1:
            return {}
    # dicA=validation_one(dicA,src_dc)

    flcs = hospital + str(page_set[0]) + '.csv'
    lebels = src_dc['lebels'].split(',')
    # print('lebels==',lebels)
    # for_csv_copy(dicA,flcs,lebels)
    print(dicA)
    sbt = src_dc['sbt']
    if len(src_dc['spl_bottom']) > 1:
        if src_dc['spl_bottom'].split(',')[1] == '1':
            ddic = nested_dictionary_spl_one(dicA, src_dc, head_list)
        elif src_dc['spl_bottom'].split(',')[1] == '2':
            ddic = nested_dictionary_spl_two(dicA, src_dc, head_list)
        elif src_dc['spl_bottom'].split(',')[1] == '3':
            ddic = nested_dictionary_spl_three(dicA, src_dc, head_list)

    else:
        ddic = nested_dictionary(dicA, src_dc, head_list)
    # print('uuuuuuyyyyy')
    # print(ddic)
    dic_final = final_dictionary(ddic, lebels)
    if hospital == 'srch':
        for key, value in dic_final.items():
            # print('yessss')
            if key == 'ROOM CHARGES':
                for item in value.values():
                    if 'Remark' in item:
                        item['Rate'] = item['Remark']
                        del item['Remark']
    # print('dicfinal==',dic_final)
    nm = flcs.split('.')[0]
    with open(str(nm) + ".json", "w") as outfile:
        json.dump(dic_final, outfile)
    my_file = str(nm) + ".json"
    # print('uuuu_out',head_list)
    print("$$$$$$$$$$$$$$$$$$$$$")
    print(my_file)
    input_data = dic_final
    output_data = [{"Description": item.get("Description", ""), "Amount": item.get("Amount", "")}
                for item in input_data["LABORATORY"].values()]
    with open(str(nm) + ".json", "w") as outfile:
        json.dump(output_data, outfile)
    # print("------------")
    # print(type(output_data))
    # print("$$$$$$$$$$$$$$$$$$$$$")
    return output_data

app = FastAPI()
# handler = Mangum(app)

class DataType(BaseModel):
    hospn: str
    file1: UploadFile = File(...)

# @app.post("/upload")
# async def upload_pdf_file(hospn: DataType):
#     try:
#         # url = "https://example.com/your_target_api_endpoint" #API Need to be changed
#         # files = {"file": (file.filename, await file.read())}
#         # headers = {"Authorization": "Bearer YOUR_ACCESS_TOKEN"}  # Replace with any required headers
#         # response = requests.post(url, files=files, headers=headers)
#         # with open('all_bill.json', 'w') as json_file:
#         #     json.dump(response.json(), json_file)
#         # return "Recieved"
#         page_set = []
#         for p in range(1, 101):
#             page_set.append(p)
#         # print(page_set)
#         # print(hospn)
#         hs_name = 'continental'
#         print("------------------------------------")
#         print("I did It")
#         print(bill_ext(page_set, hs_name))
#         print("----------------$$$$-----------------")
#     except Exception as e:
#         return {"error": str(e)}
page_set = []
for p in range(1, 101):
    page_set.append(p)
hs_name = 'continental'
print("------------------------------------")
print("I did It")
print(bill_ext(page_set, hs_name))
print("----------------$$$$-----------------")

# app = FastAPI()

# @app.post("/process_hospital")
# async def process_hospital(hospital_name: str, file: UploadFile = File(...)):
#     return {"hospital_name": hospital_name}